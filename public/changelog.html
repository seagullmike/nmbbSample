<!DOCTYPE html>
<html>
<head>
<title>DZ New York - Intranet ChangeLog</title>
<meta name=viewport content='width=device-width, initial-scale=1.0'>
<link rel='shortcut icon' href='/dzfavicon.png' /> 
<meta name=description content='DZ Bank NY intraNet Changlog'>
<meta name=author content='T. Killilea'>
<link href='/components/bootstrap/docs/assets/css/bootstrap.css' rel=stylesheet type='text/css' media=screen >
<style>
body {
padding-top: 60px;
padding-bottom: 40px;
} 
</style>
</head>
<body>
<div class='navbar navbar-inverse navbar-fixed-top'>
<div class=navbar-inner>
<div class=container-fluid>
<a class='btn btn-navbar' data-toggle=collapse data-target='.nav-collapse'><span
class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span>
</a><a class=brand href='/'>DZ Bank-New York</a>
<div class='btn-group pull-right'>
<a class='btn dropdown-toggle' data-toggle='dropdown' href='#'><i class=icon-user>
</i> User <span class=caret></span></a>
<ul class=dropdown-menu>
<li><a id=username href=# >My Profile</a></li>
<li class=divider></li>
<li><a href='/logout.aspx'>Sign Out</a></li>
</ul>
</div>
<div class=nav-collapse>
<ul class=nav>
<li><a href=/ >Home</a></li>
</ul>
</div>
</div>
</div>
</div>
<div class=container>
<div class=hero-unit><h2>DZ New York <small>Intranet website software change log history</small></h2><p>GIT - <abbr title='Distributed Version Control System'>DVCS: </abbr> Commit-log/Version control reporting.</p></div>
 <div class='row'>
 <div class='span12'>
 <h4><span class=text-info>Revision-Subject: update Backbone 1.0 and all node packages</span></h4>
 <div class=row>
 <div class=span6><strong>Author: Ted Killilea</strong></div><div class=span6><strong>Email: lrrs259@gmail.com</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Date: Sun Mar 31 16:58:09 2013 -0400</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Description: </strong></div>
 </div>
 <div class=row>
 <div class=span12><p>STATISTICS</p></div>
 </div>
 <div class=row>
<div class=span12>
<strong>List of modified files:</strong>
<ul class=unstyled>
 <li>.c9revisions/component.json.c9save<div>diff --git a/.c9revisions/component.json.c9save b/.c9revisions/component.json.c9save
index 01d26e7..dc90867 100644
--- a/.c9revisions/component.json.c9save
+++ b/.c9revisions/component.json.c9save
@@ -4,3 +4,7 @@
 {"contributors":[],"silentsave":false,"ts":1360643554961,"patch":[[{"diffs":[[0,"\"~1."],[-1,"8.3"],[1,"9.1"],[0,"\",\n "]],"start1":129,"start2":129,"length1":11,"length2":11},{"diffs":[[0,": \"~0.9."],[-1,"9"],[1,"10"],[0,"\",\n    \""]],"start1":153,"start2":153,"length1":17,"length2":18},{"diffs":[[0,"\"~2.1.2\""],[1,",\n    \"bootstrap\": \"~2.2.3\""],[0,"\n  }\n}"]],"start1":269,"start2":269,"length1":14,"length2":41}]],"length":310,"saved":false}
 {"contributors":[],"silentsave":false,"ts":1362573141499,"patch":[[{"diffs":[[0,": {\n"],[-1,"    \"jquery\": \"~1.9.1\",\n"],[0,"    "]],"start1":111,"start2":111,"length1":32,"length2":8},{"diffs":[[0,": \"~1.4."],[-1,"3"],[1,"4"],[0,"\",\n    \""]],"start1":158,"start2":158,"length1":17,"length2":17},{"diffs":[[0,"\"~2."],[-1,"2.3\"\n  "],[1,"3.1\",\n    \"jquery\": \">=1.9.1\",\n"],[0,"}\n}"]],"start1":272,"start2":272,"length1":14,"length2":38}]],"length":310,"saved":false}
 {"ts":1362573155670,"patch":[[{"diffs":[[0,"1.9.1\",\n"],[1,"    "],[0,"}\n}"]],"start1":299,"start2":299,"length1":11,"length2":15}]],"length":314,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364740445645,"patch":[[{"diffs":[[0,"\": \""],[-1,"~0.9.10"],[1,"*"],[0,"\",\n "]],"start1":128,"start2":128,"length1":15,"length2":9},{"diffs":[[0,"\": \""],[-1,"~1.4.4"],[1,"*"],[0,"\",\n    \""],[-1,"text\": \"git://github.com/"],[0,"requ"]],"start1":151,"start2":151,"length1":47,"length2":17},{"diffs":[[0,"rejs"],[-1,"/"],[1,"-"],[0,"text"],[-1,".git#~2.0.3"],[1,"\": \"*"],[0,"\",\n "]],"start1":169,"start2":169,"length1":24,"length2":18},{"diffs":[[0,"\": \""],[-1,"~2.1.2"],[1,"*"],[0,"\",\n "]],"start1":200,"start2":200,"length1":14,"length2":9},{"diffs":[[0,"\": \""],[-1,"~2.3.1"],[1,"*"],[0,"\",\n "]],"start1":222,"start2":222,"length1":14,"length2":9},{"diffs":[[0,"\": \""],[-1,">=1.9.1"],[1,"*"],[0,"\",\n "]],"start1":241,"start2":241,"length1":15,"length2":9}]],"length":256,"saved":false}
+{"ts":1364740775827,"patch":[[{"diffs":[[0,"backbone\": \""],[-1,"*"],[1,"~1.0.0"],[0,"\",\n    \"unde"]],"start1":120,"start2":120,"length1":25,"length2":30},{"diffs":[[0,"derscore\": \""],[-1,"*"],[1,"~1.4.4"],[0,"\",\n    \"requ"]],"start1":148,"start2":148,"length1":25,"length2":30},{"diffs":[[0,"ejs-text\": \""],[-1,"*"],[1,"~2.0.5"],[0,"\",\n    \"requ"]],"start1":180,"start2":180,"length1":25,"length2":30},{"diffs":[[0,"equirejs\": \""],[-1,"*"],[1,"~2.1.2"],[0,"\",\n    \"boot"]],"start1":207,"start2":207,"length1":25,"length2":30},{"diffs":[[0,"ootstrap\": \""],[-1,"*"],[1,"~2.3.1"],[0,"\",\n    \"jque"]],"start1":234,"start2":234,"length1":25,"length2":30},{"diffs":[[0,"\": \""],[-1,"*"],[1,">=1.9.1"],[0,"\",\n "]],"start1":266,"start2":266,"length1":9,"length2":15}]],"length":287,"saved":false}
+{"ts":1364740833768,"patch":[[{"diffs":[[0,">=1.9.1\""],[-1,","],[0,"\n    }\n}"]],"start1":270,"start2":270,"length1":17,"length2":16}]],"length":286,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364741451152,"patch":[[{"diffs":[[0,"\": \""],[-1,">="],[1,"~"],[0,"1.9.1\"\n"],[-1,"  "],[0,"  }\n"]],"start1":266,"start2":266,"length1":19,"length2":16}]],"length":283,"saved":false}</div></li>
 <li>.c9revisions/public/js/SocialNetSockets.js.c9save<div>diff --git a/.c9revisions/public/js/SocialNetSockets.js.c9save b/.c9revisions/public/js/SocialNetSockets.js.c9save
index b7a2f0d..0ad7649 100644
--- a/.c9revisions/public/js/SocialNetSockets.js.c9save
+++ b/.c9revisions/public/js/SocialNetSockets.js.c9save
@@ -14,3 +14,5 @@
 {"contributors":[],"silentsave":false,"ts":1358131012729,"patch":[[{"diffs":[[0,"countId = null;\n"],[-1,"\n"],[0,"        var sock"]],"start1":177,"start2":177,"length1":33,"length2":32},{"diffs":[[0,");\n    }"],[1,";"],[0,"\n\n    re"]],"start1":1959,"start2":1959,"length1":16,"length2":17}]],"length":2099,"saved":false}
 {"ts":1358131044906,"patch":[[{"diffs":[[0,"();\n            "],[1,"//"],[0,"console.dir(sock"]],"start1":416,"start2":416,"length1":32,"length2":34}]],"length":2101,"saved":false}
 {"contributors":[],"silentsave":false,"ts":1358181723732,"patch":[[{"diffs":[[0,"untId);\n"],[-1,"\n"],[0,"        "]],"start1":375,"start2":375,"length1":17,"length2":16},{"diffs":[[0,"t();"],[-1,"\n            //console.dir(socket);"],[0,"\n\n  "]],"start1":414,"start2":414,"length1":43,"length2":8},{"diffs":[[0,"      })"],[1,";\n\n            socket"],[0,".on('con"]],"start1":545,"start2":545,"length1":16,"length2":37}]],"length":2086,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364747014041,"patch":[[{"diffs":[[0,"patcher."],[-1,"bind"],[1,"on"],[0,"('socket"]],"start1":689,"start2":689,"length1":20,"length2":18},{"diffs":[[0,"her."],[-1,"bind"],[1,"on"],[0,"('ap"]],"start1":1906,"start2":1906,"length1":12,"length2":10}]],"length":2082,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364748739422,"patch":[[{"diffs":[[0,"s.fetch("],[1,"{reset:true}"],[0,");\n     "]],"start1":1324,"start2":1324,"length1":16,"length2":28}]],"length":2094,"saved":false}</div></li>
 <li>.c9revisions/public/js/main.js.c9save<div>diff --git a/.c9revisions/public/js/main.js.c9save b/.c9revisions/public/js/main.js.c9save
index 13bb680..9f3c291 100644
--- a/.c9revisions/public/js/main.js.c9save
+++ b/.c9revisions/public/js/main.js.c9save
@@ -15,3 +15,10 @@
 {"contributors":[],"silentsave":false,"ts":1360718228514,"patch":[[{"diffs":[[0,"otstrap."],[-1,"js"],[1,"min"],[0,"',\n     "]],"start1":348,"start2":348,"length1":18,"length2":19},{"diffs":[[0,"tes'"],[-1," //, "],[1,","],[0,"\n   "]],"start1":391,"start2":391,"length1":13,"length2":9},{"diffs":[[0,"    "],[-1,"//SocialNetView: '/js/SocialNetView'\n    },\n\n    shim: {"],[1,"jqMigrate: '/components/jquery/jquery-migrate'\n    },\n\n    shim: {\n        'jqMigrate':['jquery'],"],[0,"\n   "]],"start1":401,"start2":401,"length1":64,"length2":106},{"diffs":[[0,"ckbone']"],[1,",\n        'bootstrap' : ['jQuery']"],[0,"\n    }\n}"]],"start1":575,"start2":575,"length1":16,"length2":50},{"diffs":[[0,"cialNet'"],[1,", 'bootstrap','jqMigrate'"],[0,"], funct"]],"start1":641,"start2":641,"length1":16,"length2":41}]],"length":735,"saved":false}
 {"contributors":[],"silentsave":false,"ts":1360718520111,"patch":[[{"diffs":[[0,"      jq"],[-1,"M"],[1,"m"],[0,"igrate: "]],"start1":399,"start2":399,"length1":17,"length2":17},{"diffs":[[0,"     'jq"],[-1,"M"],[1,"m"],[0,"igrate':"]],"start1":475,"start2":475,"length1":17,"length2":17},{"diffs":[[0,"ate':['j"],[-1,"q"],[1,"Q"],[0,"uery'],\n"]],"start1":487,"start2":487,"length1":17,"length2":17},{"diffs":[[0,",'jq"],[-1,"M"],[1,"m"],[0,"igra"]],"start1":662,"start2":662,"length1":9,"length2":9}]],"length":735,"saved":false}
 {"contributors":[],"silentsave":false,"ts":1362574137379,"patch":[[{"diffs":[[0,"mplates'"],[-1,","],[0,"\n       "]],"start1":387,"start2":387,"length1":17,"length2":16},{"diffs":[[0,"        "],[1,"//"],[0,"jqmigrat"]],"start1":396,"start2":396,"length1":16,"length2":18},{"diffs":[[0,"otstrap'"],[1," /*"],[0,",'jqmigr"]],"start1":655,"start2":655,"length1":16,"length2":19},{"diffs":[[0,"migrate'"],[1,"*/"],[0,"], funct"]],"start1":670,"start2":670,"length1":16,"length2":18}]],"length":741,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364741762141,"patch":[[{"diffs":[[0,"ponents/"],[1,"requirejs-"],[0,"text/tex"]],"start1":269,"start2":269,"length1":16,"length2":26}]],"length":751,"saved":false}
+{"ts":1364741838201,"patch":[[{"diffs":[[0,"    "],[-1,"'jqmigrate':['jQuery'],"],[1,"\n"],[0,"\n   "]],"start1":487,"start2":487,"length1":31,"length2":9},{"diffs":[[0,"ap' "],[-1,"/*,'jqmigrate'*/"],[0,"], f"]],"start1":648,"start2":648,"length1":24,"length2":8}]],"length":713,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364742661200,"patch":[[{"diffs":[[0,"es'\n"],[-1,"        //jqmigrate: '/components/jquery/jquery-migrate'\n"],[0,"    "]],"start1":402,"start2":402,"length1":65,"length2":8},{"diffs":[[0,": {\n"],[-1,"        \n\n"],[0,"    "]],"start1":422,"start2":422,"length1":18,"length2":8}]],"length":646,"saved":false}
+{"ts":1364743122092,"patch":[[{"diffs":[[0,"    },\n\n"],[-1,"  "],[0,"  shim: "]],"start1":406,"start2":406,"length1":18,"length2":16},{"diffs":[[0,"    "],[-1,"    'Backbone': ['Underscore', 'jQuery'],\n        'SocialNet'"],[1,"'Underscore': {\n      exports: '_'\n    },\n    'Backbone': {\n      deps: ['Underscore']\n    , exports"],[0,": "],[-1,"["],[0,"'Bac"]],"start1":424,"start2":424,"length1":72,"length2":110},{"diffs":[[0,"one'"],[-1,"],"],[0,"\n    "],[1,"},\n"],[0,"    "]],"start1":536,"start2":536,"length1":15,"length2":16},{"diffs":[[0,"otstrap'"],[-1," "],[0,": ['jQue"]],"start1":555,"start2":555,"length1":17,"length2":16},{"diffs":[[0,"ery']\n  "],[-1,"  "],[0,"}"],[1,"\n"],[0,"\n});\n\nre"]],"start1":570,"start2":570,"length1":19,"length2":18}]],"length":681,"saved":false}
+{"ts":1364743423294,"patch":[[{"diffs":[[0,"    },\n\n"],[1,"    "],[0,"  shim: "]],"start1":406,"start2":406,"length1":16,"length2":20},{"diffs":[[0,"    shim: {\n"],[1,"    "],[0,"    'Undersc"]],"start1":416,"start2":416,"length1":24,"length2":28},{"diffs":[[0,"{\n      "],[1,"  "],[1,"  "],[0,"exports:"]],"start1":450,"start2":450,"length1":16,"length2":20},{"diffs":[[0,"ts: '_'\n    "],[-1,"},\n"],[1,"    },\n    "],[0,"    'Backbon"]],"start1":467,"start2":467,"length1":27,"length2":35},{"diffs":[[0,"{\n      "],[1,"    "],[0,"deps: ['"]],"start1":506,"start2":506,"length1":16,"length2":20},{"diffs":[[0,"e']\n    "],[1," "],[1,"   "],[0,", export"]],"start1":535,"start2":535,"length1":16,"length2":20},{"diffs":[[0,"ckbone'\n    "],[1,"  "],[1,"  "],[0,"},\n"],[1,"    "],[0,"    'bootstr"]],"start1":561,"start2":561,"length1":27,"length2":35},{"diffs":[[0,"Query']\n"],[1,"    "],[0,"  }\n\n});"]],"start1":604,"start2":604,"length1":16,"length2":20}]],"length":721,"saved":false}
+{"ts":1364743849440,"patch":[[{"diffs":[[0,"        "],[-1,"U"],[1,"u"],[0,"nderscor"]],"start1":75,"start2":75,"length1":17,"length2":17},{"diffs":[[0,"        "],[-1,"B"],[1,"b"],[0,"ackbone:"]],"start1":132,"start2":132,"length1":17,"length2":17},{"diffs":[[0,"\n    },\n"],[1,"      "],[0,"\n"],[-1,""],[0,"      sh"]],"start1":405,"start2":405,"length1":17,"length2":23},{"diffs":[[0,"       '"],[-1,"U"],[1,"u"],[0,"nderscor"]],"start1":435,"start2":435,"length1":17,"length2":17},{"diffs":[[0,"       '"],[-1,"B"],[1,"b"],[0,"ackbone'"]],"start1":493,"start2":493,"length1":17,"length2":17},{"diffs":[[0,": ['"],[-1,"U"],[1,"u"],[0,"nder"]],"start1":528,"start2":528,"length1":9,"length2":9},{"diffs":[[0,"y']\n"],[1,""],[0,"      }\n"],[-1,"\n"],[0,"});\n"]],"start1":614,"start2":614,"length1":17,"length2":16}]],"length":726,"saved":false}
+{"ts":1364744265433,"patch":[[{"diffs":[[0,"        "],[-1,"u"],[1,"U"],[0,"nderscor"]],"start1":75,"start2":75,"length1":17,"length2":17},{"diffs":[[0,"        "],[-1,"b"],[1,"B"],[0,"ackbone:"]],"start1":132,"start2":132,"length1":17,"length2":17},{"diffs":[[0," },\n    "],[-1,"  \n  "],[1,"\n"],[0,"    shim"]],"start1":409,"start2":409,"length1":21,"length2":17},{"diffs":[[0,"   '"],[-1,"underscore': {\n          exports: '_'\n        },\n        'backbone': {\n          deps"],[1,"Backbone'"],[0,": ['"],[-1,"u"],[1,"U"],[0,"nder"]],"start1":435,"start2":435,"length1":98,"length2":22},{"diffs":[[0,"ore'"],[-1,"]\n        , exports"],[1,", 'jQuery'],\n        'SocialNet'"],[0,": "],[1,"["],[0,"'Bac"]],"start1":459,"start2":459,"length1":29,"length2":43},{"diffs":[[0,"one'"],[-1,"\n        }"],[1,"]"],[0,",\n  "]],"start1":504,"start2":504,"length1":18,"length2":9},{"diffs":[[0,"otstrap'"],[1," "],[0,": ['jQue"]],"start1":522,"start2":522,"length1":16,"length2":17},{"diffs":[[0,"Query']\n"],[-1,"  "],[0,"    }\n})"]],"start1":536,"start2":536,"length1":18,"length2":16}]],"length":650,"saved":false}</div></li>
 <li>.c9revisions/public/js/router.js.c9save<div>diff --git a/.c9revisions/public/js/router.js.c9save b/.c9revisions/public/js/router.js.c9save
index 970a7db..91bc8f8 100644
--- a/.c9revisions/public/js/router.js.c9save
+++ b/.c9revisions/public/js/router.js.c9save
@@ -4,3 +4,6 @@
 {"ts":1357784544322,"patch":[[{"diffs":[[0,"og(id+ '"],[1," "],[0,"contacts"]],"start1":1848,"start2":1848,"length1":16,"length2":17}]],"length":2213,"saved":false}
 {"contributors":[],"silentsave":false,"ts":1357785277213,"patch":[[{"diffs":[[0,"ts route"],[-1,"r"],[0,""],[1,""],[0,"');\n    "]],"start1":1863,"start2":1863,"length1":17,"length2":16},{"diffs":[[0,"     var contact"],[-1,"s"],[0,"Collection = new"]],"start1":1914,"start2":1914,"length1":33,"length2":32},{"diffs":[[0,");\n      contact"],[-1,"s"],[0,"Collection.url ="]],"start1":1965,"start2":1965,"length1":33,"length2":32},{"diffs":[[0,"tacts';\n"],[1,"      console.log(contactCollection.url);\n"],[0,"      th"]],"start1":2030,"start2":2030,"length1":16,"length2":58},{"diffs":[[0,"lection: contact"],[-1,"s"],[0,"Collection\n     "]],"start1":2132,"start2":2132,"length1":33,"length2":32},{"diffs":[[0," contact"],[-1,"s"],[0,"Collecti"]],"start1":2175,"start2":2175,"length1":17,"length2":16}]],"length":2250,"saved":false}
 {"contributors":[],"silentsave":false,"ts":1358110489097,"patch":[[{"diffs":[[0,"/login',"],[-1,"\n       "],[0," 'views/"]],"start1":47,"start2":47,"length1":24,"length2":16},{"diffs":[[0,"ntacts',"],[-1,"\n       "],[0," 'views/"]],"start1":106,"start2":106,"length1":24,"length2":16},{"diffs":[[0,"ection',"],[-1,"\n       "],[0," 'models"]],"start1":171,"start2":171,"length1":24,"length2":16},{"diffs":[[0,"tion'],\n"],[1,"\n"],[0,"function"]],"start1":201,"start2":201,"length1":16,"length2":17},{"diffs":[[0,"leView,\n"],[-1,"         "],[0,"Contacts"]],"start1":280,"start2":280,"length1":25,"length2":16},{"diffs":[[0,"on,\n"],[-1,"         "],[0,"Cont"]],"start1":341,"start2":341,"length1":17,"length2":8},{"diffs":[[0,"on) {\n  "],[1," "],[1," "],[0,"var Soci"]],"start1":360,"start2":360,"length1":16,"length2":18},{"diffs":[[0,"xtend({\n"],[1,"    "],[0,"    curr"]],"start1":406,"start2":406,"length1":16,"length2":20},{"diffs":[[0," null,\n\n    "],[1,"  "],[1,"  "],[0,"socketEvents"]],"start1":434,"start2":434,"length1":24,"length2":28},{"diffs":[[0,"ents),\n\n"],[1,"    "],[0,"    rout"]],"start1":488,"start2":488,"length1":16,"length2":20},{"diffs":[[0,"{\n      "],[1," "],[1,"     "],[0,"'addcont"]],"start1":512,"start2":512,"length1":16,"length2":22},{"diffs":[[0,"ntact',\n"],[1,"      "],[0,"      'i"]],"start1":546,"start2":546,"length1":16,"length2":22},{"diffs":[[0,",\n      "],[1,"    "],[1,"  "],[0,"'login':"]],"start1":582,"start2":582,"length1":16,"length2":22},{"diffs":[[0,",\n      "],[1,"     "],[1," "],[0,"'registe"]],"start1":612,"start2":612,"length1":16,"length2":22},{"diffs":[[0,"ister',\n"],[1,"      "],[0,"      'f"]],"start1":642,"start2":642,"length1":16,"length2":22},{"diffs":[[0,"sword',\n"],[1,"      "],[0,"      'p"]],"start1":690,"start2":690,"length1":16,"length2":22},{"diffs":[[0,",\n      "],[1," "],[1,"     "],[0,"'contact"]],"start1":734,"start2":734,"length1":16,"length2":22},{"diffs":[[0,"ntacts'\n    "],[1,"  "],[1,"  "],[0,"},\n\n"],[1,"    "],[0,"    changeVi"]],"start1":767,"start2":767,"length1":28,"length2":36},{"diffs":[[0,"    "],[1," "],[1,"     "],[0,"if ("],[-1," "],[0,"null"]],"start1":826,"start2":826,"length1":13,"length2":18},{"diffs":[[0,"View"],[-1," "],[0,") {\n"],[1,"        "],[0,"    "]],"start1":861,"start2":861,"length1":13,"length2":20},{"diffs":[[0,"teEvents();\n"],[1,"      "],[0,"      }\n    "]],"start1":910,"start2":910,"length1":24,"length2":30},{"diffs":[[0,"    }\n      "],[1," "],[1,"     "],[0,"this.current"]],"start1":930,"start2":930,"length1":24,"length2":30},{"diffs":[[0,"view;\n      "],[1,"  "],[1,"    "],[0,"this.current"]],"start1":967,"start2":967,"length1":24,"length2":30},{"diffs":[[0,"nder();\n    "],[1,"   "],[1," "],[0,"},\n\n"],[1,"    "],[0,"    index: f"]],"start1":1004,"start2":1004,"length1":28,"length2":36},{"diffs":[[0,"unction() {\n"],[1,"      "],[0,"      var st"]],"start1":1040,"start2":1040,"length1":24,"length2":30},{"diffs":[[0,"ection();\n      "],[1,"    "],[1,"  "],[0,"statusCollection"]],"start1":1101,"start2":1101,"length1":32,"length2":38},{"diffs":[[0,"ivity';\n"],[1,"      "],[0,"      th"]],"start1":1163,"start2":1163,"length1":16,"length2":22},{"diffs":[[0,"xView({\n        "],[1,"      "],[1,"  "],[0,"collection: stat"]],"start1":1207,"start2":1207,"length1":32,"length2":40},{"diffs":[[0,"ection,\n        "],[1,"      "],[1,"  "],[0,"socketEvents:thi"]],"start1":1253,"start2":1253,"length1":32,"length2":40},{"diffs":[[0,"   socketEvents:"],[1," "],[0,"this.socketEvent"]],"start1":1274,"start2":1274,"length1":32,"length2":33},{"diffs":[[0,"vents\n      "],[1,"    "],[1,"  "],[0,"}));\n"],[1,"      "],[0,"      status"]],"start1":1303,"start2":1303,"length1":29,"length2":41},{"diffs":[[0,"ection.fetch();\n"],[1,"    "],[0,"    },\n\n    addc"]],"start1":1348,"start2":1348,"length1":32,"length2":36},{"diffs":[[0,"},\n\n    "],[1,"  "],[1,"  "],[0,"addconta"]],"start1":1372,"start2":1372,"length1":16,"length2":20},{"diffs":[[0,"t: function() {\n"],[1,"      "],[0,"      this.chang"]],"start1":1393,"start2":1393,"length1":32,"length2":38},{"diffs":[[0,"ContactView());\n"],[1,"    "],[0,"    },\n\n    logi"]],"start1":1444,"start2":1444,"length1":32,"length2":36},{"diffs":[[0,"},\n\n    "],[1,"  "],[1,"  "],[0,"login: f"]],"start1":1468,"start2":1468,"length1":16,"length2":20},{"diffs":[[0,"n: function() {\n"],[1,"      "],[0,"      this.chang"]],"start1":1484,"start2":1484,"length1":32,"length2":38},{"diffs":[[0,"inView({"],[1,"\n                "],[0,"socketEv"]],"start1":1535,"start2":1535,"length1":16,"length2":33},{"diffs":[[0,"   socketEvents:"],[1," "],[0,"this.socketEvent"]],"start1":1557,"start2":1557,"length1":32,"length2":33},{"diffs":[[0,"ents"],[1,"\n            "],[0,"}));\n"],[1,"    "],[0,"    },\n\n"],[1,"    "],[0,"    "]],"start1":1587,"start2":1587,"length1":21,"length2":42},{"diffs":[[0,"d: function() {\n"],[1,"      "],[0,"      this.chang"]],"start1":1642,"start2":1642,"length1":32,"length2":38},{"diffs":[[0,"asswordView());\n"],[1,"    "],[0,"    },\n\n    regi"]],"start1":1697,"start2":1697,"length1":32,"length2":36},{"diffs":[[0,"},\n\n    "],[1," "],[1,"   "],[0,"register"]],"start1":1721,"start2":1721,"length1":16,"length2":20},{"diffs":[[0,"unction() {\n"],[1,"      "],[0,"      this.c"]],"start1":1744,"start2":1744,"length1":24,"length2":30},{"diffs":[[0,"terView());\n"],[1,"    "],[0,"    },\n\n    "]],"start1":1793,"start2":1793,"length1":24,"length2":28},{"diffs":[[0,"},\n\n    "],[1," "],[1,"   "],[0,"profile:"]],"start1":1813,"start2":1813,"length1":16,"length2":20},{"diffs":[[0,"id) {\n      "],[1,"     "],[1," "],[0,"var model = "]],"start1":1843,"start2":1843,"length1":24,"length2":30},{"diffs":[[0,"nt({"],[1,"\n                "],[0,"id:"],[1," "],[0,"id"],[-1,"});\n"],[1,"\n            });\n      "],[0,"    "]],"start1":1882,"start2":1882,"length1":17,"length2":54},{"diffs":[[0,"ew({"],[1,"\n                "],[0,"model:"],[1," "],[0,"model,"],[1,"\n               "],[0," soc"]],"start1":1967,"start2":1967,"length1":20,"length2":54},{"diffs":[[0,"tEvents:"],[1," "],[0,"this.soc"]],"start1":2023,"start2":2023,"length1":16,"length2":17},{"diffs":[[0,"etEvents"],[-1,"}));\n"],[1,"\n            }));\n      "],[0,"      mo"]],"start1":2041,"start2":2041,"length1":21,"length2":40},{"diffs":[[0,"etch();\n    "],[1," "],[1,"   "],[0,"},\n\n"],[1,"    "],[0,"    contacts"]],"start1":2086,"start2":2086,"length1":28,"length2":36},{"diffs":[[0,") {\n        "],[1,"    "],[0,"console.log("]],"start1":2135,"start2":2135,"length1":24,"length2":28},{"diffs":[[0,"e.log(id"],[1," "],[0,"+ ' cont"]],"start1":2157,"start2":2157,"length1":16,"length2":17},{"diffs":[[0," route');\n      "],[1,"  "],[1,"    "],[0,"var contactId = "]],"start1":2178,"start2":2178,"length1":32,"length2":38},{"diffs":[[0,": 'me';\n"],[1,"      "],[0,"      va"]],"start1":2224,"start2":2224,"length1":16,"length2":22},{"diffs":[[0,"ection();\n      "],[1,"     "],[1," "],[0,"contactCollectio"]],"start1":2283,"start2":2283,"length1":32,"length2":38},{"diffs":[[0,"tacts';\n"],[1,"      "],[0,"      co"]],"start1":2361,"start2":2361,"length1":16,"length2":22},{"diffs":[[0,"n.url);\n"],[1,"      "],[0,"      th"]],"start1":2409,"start2":2409,"length1":16,"length2":22},{"diffs":[[0,"sView({\n        "],[1," "],[1,"       "],[0,"collection: cont"]],"start1":2456,"start2":2456,"length1":32,"length2":40},{"diffs":[[0,"lection\n"],[1,"      "],[0,"      })"]],"start1":2502,"start2":2502,"length1":16,"length2":22},{"diffs":[[0," }));\n      "],[1," "],[1,"     "],[0,"contactColle"]],"start1":2521,"start2":2521,"length1":24,"length2":30},{"diffs":[[0,"    "],[1,"  "],[1,"  "],[0,"}\n  "],[1," "],[1," "],[0,"});\n\n"],[1,"  "],[0,"  re"]],"start1":2566,"start2":2566,"length1":17,"length2":25},{"diffs":[[0,"uter();\n});\n"],[-1,"\n"]],"start1":2608,"start2":2608,"length1":13,"length2":12}]],"length":2620,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364748696103,"patch":[[{"diffs":[[0,"ollection.fetch("],[1,"{reset:true}"],[0,");\n        },\n\n "]],"start1":1345,"start2":1345,"length1":32,"length2":44}]],"length":2632,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364749727441,"patch":[[{"diffs":[[0,"ction.fetch("],[1,"{reset:true}"],[0,");\n        }"]],"start1":2563,"start2":2563,"length1":24,"length2":36}]],"length":2644,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364750700838,"patch":[[{"diffs":[[0,") {\n            "],[1,"//"],[0,"console.log(id +"]],"start1":2147,"start2":2147,"length1":32,"length2":34},{"diffs":[[0,"        "],[1,"//"],[0,"console."]],"start1":2387,"start2":2387,"length1":16,"length2":18}]],"length":2648,"saved":false}</div></li>
 <li>.c9revisions/public/js/views/addcontact.js.c9save<div>diff --git a/.c9revisions/public/js/views/addcontact.js.c9save b/.c9revisions/public/js/views/addcontact.js.c9save
index 5319f68..7f7ef20 100644
--- a/.c9revisions/public/js/views/addcontact.js.c9save
+++ b/.c9revisions/public/js/views/addcontact.js.c9save
@@ -5,3 +5,4 @@
 {"contributors":[],"silentsave":false,"ts":1357871674805,"patch":[[{"diffs":[[0," null !="],[1,"="],[0," resultL"]],"start1":746,"start2":746,"length1":16,"length2":17}]],"length":1086,"saved":false}
 {"contributors":[],"silentsave":false,"ts":1357910634273,"patch":[[{"diffs":[[0,"        "],[1,"//"],[0,"console."]],"start1":421,"start2":421,"length1":16,"length2":18},{"diffs":[[0,"    "],[-1,"var contactModel = new Contact(contactJson);\n"],[1,"  console.log(contactJson );\n            \n          var contactModel = new Contact(contactJson);\n          console   .dir(contactModel   );\n\n  "],[0,"    "]],"start1":830,"start2":830,"length1":53,"length2":151}]],"length":1185,"saved":false}
 {"contributors":[],"silentsave":false,"ts":1358110445876,"patch":[[{"diffs":[[0,"html'],\n"],[1,"\n"],[0,"function"]],"start1":87,"start2":87,"length1":16,"length2":17},{"diffs":[[0,"ate)"],[-1,"\n"],[1," "],[0,"{\n"],[1,"  "],[0,"  va"]],"start1":157,"start2":157,"length1":11,"length2":13},{"diffs":[[0,"xtend({\n"],[1,"    "],[0,"    el: "]],"start1":204,"start2":204,"length1":16,"length2":20},{"diffs":[[0,"ent'),\n\n"],[1,"    "],[0,"    even"]],"start1":232,"start2":232,"length1":16,"length2":20},{"diffs":[[0,"{\n      "],[1,"    "],[1,"  "],[0,"\"submit "]],"start1":256,"start2":256,"length1":16,"length2":22},{"diffs":[[0,"search\"\n"],[1,"    "],[0,"    },\n\n"]],"start1":286,"start2":286,"length1":16,"length2":20},{"diffs":[[0,"},\n\n    "],[1,"  "],[1,"  "],[0,"search: "]],"start1":302,"start2":302,"length1":16,"length2":20},{"diffs":[[0,"unction() {\n"],[1,"      "],[0,"      var vi"]],"start1":323,"start2":323,"length1":24,"length2":30},{"diffs":[[0,"iew = this;\n"],[1,"      "],[0,"      $.post"]],"start1":352,"start2":352,"length1":24,"length2":30},{"diffs":[[0,"/find',\n"],[1,"    "],[0,"        "]],"start1":393,"start2":393,"length1":16,"length2":20},{"diffs":[[0,"        "],[1,"    "],[0,"//consol"]],"start1":462,"start2":462,"length1":16,"length2":20},{"diffs":[[0,"        "],[1,"   "],[1,"     "],[0,"view.ren"]],"start1":495,"start2":495,"length1":16,"length2":24},{"diffs":[[0,";\n      "],[1,"   "],[1,"   "],[0,"}).error"]],"start1":528,"start2":528,"length1":16,"length2":22},{"diffs":[[0,"nction()"],[1," "],[0,"{\n      "]],"start1":553,"start2":553,"length1":16,"length2":17},{"diffs":[[0,"ion() {\n        "],[1,"    "],[1,"    "],[0,"$(\"#results\").te"]],"start1":556,"start2":556,"length1":32,"length2":40},{"diffs":[[0,"und.');\n"],[1,"        "],[0,"        "]],"start1":614,"start2":614,"length1":16,"length2":24},{"diffs":[[0,"wn();\n      "],[1,"     "],[1," "],[0,"});\n"],[1,"      "],[0,"      return"]],"start1":659,"start2":659,"length1":28,"length2":40},{"diffs":[[0," false;\n    "],[1," "],[1,"   "],[0,"},\n\n"],[1,"    "],[0,"    render: "]],"start1":699,"start2":699,"length1":28,"length2":36},{"diffs":[[0,"st) {\n      "],[1," "],[1,"     "],[0,"var view = t"]],"start1":752,"start2":752,"length1":24,"length2":30},{"diffs":[[0,"iew = this;\n"],[1,"      "],[0,"      this.$"]],"start1":775,"start2":775,"length1":24,"length2":30},{"diffs":[[0,"late));\n"],[1,"      "],[0,"      if"]],"start1":838,"start2":838,"length1":16,"length2":22},{"diffs":[[0,"    if ("],[-1," "],[0,"null !=="]],"start1":854,"start2":854,"length1":17,"length2":16},{"diffs":[[0,"sultList"],[-1," "],[0,") {\n    "]],"start1":873,"start2":873,"length1":17,"length2":16},{"diffs":[[0,"        "],[1,"      "],[1,"  "],[0,"_.each(r"]],"start1":885,"start2":885,"length1":16,"length2":24},{"diffs":[[0,"function"],[-1," "],[0,"(contact"]],"start1":920,"start2":920,"length1":17,"length2":16},{"diffs":[[0,"            "],[1,"     "],[1,"   "],[0,"console.log("]],"start1":944,"start2":944,"length1":24,"length2":32},{"diffs":[[0,"tactJson"],[-1," "],[0,");\n"],[1,"\n"],[0,"        "]],"start1":979,"start2":979,"length1":20,"length2":20},{"diffs":[[0,"        "],[-1,"\n  "],[0,"        "]],"start1":995,"start2":995,"length1":19,"length2":16},{"diffs":[[0,"    "],[1,"         "],[1," "],[0,"console"],[-1,"   "],[0,".dir"]],"start1":1062,"start2":1062,"length1":18,"length2":25},{"diffs":[[0,"odel"],[-1,"   "],[0,");\n\n"],[1,"        "],[0,"    "]],"start1":1096,"start2":1096,"length1":15,"length2":20},{"diffs":[[0,"ew({"],[-1," addButton: true, model: contactModel"],[1,"\n                        addButton: true,\n                        model: contactModel\n                   "],[0," }))"]],"start1":1156,"start2":1156,"length1":45,"length2":113},{"diffs":[[0,"r().el;\n"],[1,"          "],[0,"        "]],"start1":1275,"start2":1275,"length1":16,"length2":26},{"diffs":[[0,"    "],[1,"      "],[1,"  "],[0,"});\n"],[1,"      "],[0,"      }\n"],[1,"    "],[0,"    }\n"],[1,"  "],[0,"  });\n\n"],[1,"  "],[0,"  re"]],"start1":1342,"start2":1342,"length1":33,"length2":55}]],"length":1422,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364761295800,"patch":[[{"diffs":[[0,"        "],[1," // promise\n            var postFind ="],[0," $.post("]],"start1":367,"start2":367,"length1":16,"length2":54},{"diffs":[[0,"s/find',"],[-1,"\n            "],[0,"this.$('"]],"start1":430,"start2":430,"length1":29,"length2":16},{"diffs":[[0,"ialize()"],[-1,", "],[1,");\n            \n            postFind.done("],[0,"function"]],"start1":456,"start2":456,"length1":18,"length2":58},{"diffs":[[0,"  })"],[-1,".error"],[1,";\n            \n            postFind.fail"],[0,"(fun"]],"start1":605,"start2":605,"length1":14,"length2":48},{"diffs":[[0,"se;\n        },\n\n"],[1,"        // collectionview\n"],[0,"        render: "]],"start1":802,"start2":802,"length1":32,"length2":58},{"diffs":[[0,") {\n            "],[1,"//"],[0,"var view = this;"]],"start1":879,"start2":879,"length1":32,"length2":34},{"diffs":[[0,"                "],[1,"//"],[0,"console.log(cont"]],"start1":1075,"start2":1075,"length1":32,"length2":34},{"diffs":[[0,"tJson);\n"],[-1,""],[0,"        "]],"start1":1177,"start2":1177,"length1":16,"length2":16},{"diffs":[[0,"        "],[1,"//"],[0,"console."]],"start1":1197,"start2":1197,"length1":16,"length2":18}]],"length":1553,"saved":false}</div></li>
 <li>.c9revisions/public/js/views/chat.js.c9save<div>diff --git a/.c9revisions/public/js/views/chat.js.c9save b/.c9revisions/public/js/views/chat.js.c9save
index a34ae4c..79b806d 100644
--- a/.c9revisions/public/js/views/chat.js.c9save
+++ b/.c9revisions/public/js/views/chat.js.c9save
@@ -1,2 +1,3 @@
 {"ts":1358111014716,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"define(['SocialNetView', 'views/chatsession', 'views/chatitem', 'text!templates/chat.html'],\nfunction(SocialNetView, ChatSessionView, ChatItemView, chatItemTemplate) {\n  var chatView = SocialNetView.extend({\n    el: $('#chat'),\n\n    chatSessions: {},\n\n    initialize: function(options) {\n      this.socketEvents = options.socketEvents;\n      this.collection.on('reset', this.renderCollection, this);\n    },\n\n    render: function() {\n      this.$el.html(chatItemTemplate);\n    },\n\n    startChatSession: function(model) {\n      var accountId = model.get('accountId');\n      if ( !this.chatSessions[accountId]) {\n        var chatSessionView = new ChatSessionView({model:model, socketEvents: this.socketEvents});\n        this.$el.prepend(chatSessionView.render().el);\n        this.chatSessions[accountId] = chatSessionView;\n      }\n    },\n\n    renderCollection: function(collection) {\n      var that = this;\n      $('.chat_list').empty();\n      collection.each(function(contact) {\n        var chatItemView = new ChatItemView({ socketEvents: that.socketEvents, model: contact });\n        chatItemView.bind('chat:start', that.startChatSession, that);\n        var statusHtml = (chatItemView).render().el;\n        $(statusHtml).appendTo('.chat_list');\n      });\n    }\n  });\n\n  return chatView;\n});\n"]],"start1":0,"start2":0,"length1":0,"length2":1290}]],"length":1290}
 {"contributors":[],"silentsave":false,"ts":1358111022662,"patch":[[{"diffs":[[0,"html'],\n"],[1,"\n"],[0,"function"]],"start1":85,"start2":85,"length1":16,"length2":17},{"diffs":[[0,"late) {\n"],[1,"  "],[0,"  var ch"]],"start1":161,"start2":161,"length1":16,"length2":18},{"diffs":[[0,"xtend({\n"],[1,"    "],[0,"    el: "]],"start1":203,"start2":203,"length1":16,"length2":20},{"diffs":[[0,"hat'),\n\n    "],[1,"   "],[1," "],[0,"chatSessions"]],"start1":228,"start2":228,"length1":24,"length2":28},{"diffs":[[0,"sions: {},\n\n"],[1,"    "],[0,"    initiali"]],"start1":251,"start2":251,"length1":24,"length2":28},{"diffs":[[0,"ns) {\n      "],[1,"    "],[1,"  "],[0,"this.socketE"]],"start1":297,"start2":297,"length1":24,"length2":30},{"diffs":[[0,"Events;\n"],[1,"      "],[0,"      th"]],"start1":349,"start2":349,"length1":16,"length2":22},{"diffs":[[0," this);\n    "],[1," "],[1,"   "],[0,"},\n\n"],[1,"    "],[0,"    render: "]],"start1":419,"start2":419,"length1":28,"length2":36},{"diffs":[[0,"n() {\n      "],[1," "],[1,"     "],[0,"this.$el.htm"]],"start1":462,"start2":462,"length1":24,"length2":30},{"diffs":[[0,"plate);\n"],[1,"    "],[0,"    },\n\n"],[1,"    "],[0,"    star"]],"start1":505,"start2":505,"length1":24,"length2":32},{"diffs":[[0,"el) {\n      "],[1,"     "],[1," "],[0,"var accountI"]],"start1":563,"start2":563,"length1":24,"length2":30},{"diffs":[[0,"ccountId');\n"],[1,"      "],[0,"      if ( !"]],"start1":609,"start2":609,"length1":24,"length2":30},{"diffs":[[0,"    if ("],[-1," "],[0,"!this.ch"]],"start1":629,"start2":629,"length1":17,"length2":16},{"diffs":[[0,"tId]) {\n        "],[1," "],[1,"       "],[0,"var chatSessionV"]],"start1":662,"start2":662,"length1":32,"length2":40},{"diffs":[[0,"ew({"],[1,"\n                    "],[0,"model:"],[1," "],[0,"model,"],[1,"\n                   "],[0," soc"]],"start1":725,"start2":725,"length1":20,"length2":62},{"diffs":[[0,"etEvents"],[-1,"});\n"],[1,"\n                });\n        "],[0,"        "]],"start1":807,"start2":807,"length1":20,"length2":45},{"diffs":[[0,"l);\n        "],[1,"   "],[1,"     "],[0,"this.chatSes"]],"start1":895,"start2":895,"length1":24,"length2":32},{"diffs":[[0,"onView;\n"],[1,"      "],[0,"      }\n"]],"start1":955,"start2":955,"length1":16,"length2":22},{"diffs":[[0,"  }\n    "],[1," "],[1,"   "],[0,"},\n\n    "],[1,"   "],[1," "],[0,"renderCo"]],"start1":973,"start2":973,"length1":24,"length2":32},{"diffs":[[0,"llection) {\n"],[1,"      "],[0,"      var th"]],"start1":1026,"start2":1026,"length1":24,"length2":30},{"diffs":[[0,";\n      "],[1,"  "],[1,"    "],[0,"$('.chat"]],"start1":1065,"start2":1065,"length1":16,"length2":22},{"diffs":[[0,";\n      "],[1,"    "],[1,"  "],[0,"collecti"]],"start1":1102,"start2":1102,"length1":16,"length2":22},{"diffs":[[0,"tact) {\n        "],[1,"       "],[1," "],[0,"var chatItemView"]],"start1":1144,"start2":1144,"length1":32,"length2":40},{"diffs":[[0,"emView({"],[1,"\n                   "],[0," socketE"]],"start1":1197,"start2":1197,"length1":16,"length2":36},{"diffs":[[0,"nts,"],[-1," model: contact"],[1,"\n                    model: contact\n               "],[0," });"]],"start1":1254,"start2":1254,"length1":23,"length2":59},{"diffs":[[0,"});\n        "],[1,"    "],[1,"    "],[0,"chatItemView"]],"start1":1310,"start2":1310,"length1":24,"length2":32},{"diffs":[[0," that);\n"],[1,"        "],[0,"        "]],"start1":1384,"start2":1384,"length1":16,"length2":24},{"diffs":[[0,"        "],[1,"     "],[1,"   "],[0,"$(status"]],"start1":1453,"start2":1453,"length1":16,"length2":24},{"diffs":[[0,"hat_list');\n"],[1,"      "],[0,"      });\n  "]],"start1":1495,"start2":1495,"length1":24,"length2":30},{"diffs":[[0,"    "],[1," "],[1,"   "],[0,"}\n  "],[1," "],[1," "],[0,"});\n\n"],[1,"  "],[0,"  re"]],"start1":1523,"start2":1523,"length1":17,"length2":25}]],"length":1567,"saved":false}
+{"ts":1364747411520,"patch":[[{"diffs":[[0,"iew."],[-1,"bind"],[1,"on"],[0,"('ch"]],"start1":1339,"start2":1339,"length1":12,"length2":10}]],"length":1565,"saved":false}</div></li>
 <li>.c9revisions/public/js/views/chatitem.js.c9save<div>diff --git a/.c9revisions/public/js/views/chatitem.js.c9save b/.c9revisions/public/js/views/chatitem.js.c9save
index c683d99..a771733 100644
--- a/.c9revisions/public/js/views/chatitem.js.c9save
+++ b/.c9revisions/public/js/views/chatitem.js.c9save
@@ -1,3 +1,5 @@
 {"ts":1358111027161,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"define(['SocialNetView', 'text!templates/chatitem.html'],\nfunction(SocialNetView, chatItemTemplate) {\n  var chatItemView = SocialNetView.extend({\n    tagName: 'li',\n\n    $el: $(this.el),\n\n    events: {\n      'click': 'startChatSession',\n    },\n\n    initialize: function(options) {\n      var accountId = this.model.get('accountId');\n      options.socketEvents.bind(\n        'login:' + accountId,\n        this.handleContactLogin,\n        this\n      );\n      options.socketEvents.bind(\n        'logout:' + accountId,\n        this.handleContactLogout,\n        this\n      );\n      options.socketEvents.bind(\n        'socket:chat:start:' + accountId,\n        this.startChatSession,\n        this\n      );\n    },\n\n    handleContactLogin: function() {\n      this.model.set('online', true);\n      this.$el.find('.online_indicator').addClass('online');\n    },\n\n    handleContactLogout: function() {\n      this.model.set('online', false);\n      $onlineIndicator = this.$el.find('.online_indicator');\n      while ( $onlineIndicator.hasClass('online') ) {\n        $onlineIndicator.removeClass('online');\n      }\n    },\n\n    startChatSession: function() {\n      this.trigger('chat:start', this.model);\n    },\n\n    render: function() {\n      this.$el.html(_.template(chatItemTemplate, {\n        model: this.model.toJSON()\n      }));\n      if ( this.model.get('online') ) this.handleContactLogin();\n      return this;\n    }\n  });\n\n  return chatItemView;\n});"]],"start1":0,"start2":0,"length1":0,"length2":1440}]],"length":1440}
 {"contributors":[],"silentsave":false,"ts":1358111032188,"patch":[[{"diffs":[[0,"html'],\n"],[1,"\n"],[0,"function"]],"start1":50,"start2":50,"length1":16,"length2":17},{"diffs":[[0,"late) {\n"],[1,"  "],[0,"  var ch"]],"start1":95,"start2":95,"length1":16,"length2":18},{"diffs":[[0,"xtend({\n"],[1,"    "],[0,"    tagN"]],"start1":141,"start2":141,"length1":16,"length2":20},{"diffs":[[0,"',\n\n    "],[1,"  "],[1,"  "],[0,"$el: $(t"]],"start1":169,"start2":169,"length1":16,"length2":20},{"diffs":[[0,"s.el),\n\n"],[1,"    "],[0,"    even"]],"start1":191,"start2":191,"length1":16,"length2":20},{"diffs":[[0,"{\n      "],[1," "],[1,"     "],[0,"'click':"]],"start1":215,"start2":215,"length1":16,"length2":22},{"diffs":[[0,"ssion',\n    "],[1,"  "],[1,"  "],[0,"},\n\n"],[1,"    "],[0,"    initiali"]],"start1":250,"start2":250,"length1":28,"length2":36},{"diffs":[[0,"ns) {\n      "],[1," "],[1,"     "],[0,"var accountI"]],"start1":304,"start2":304,"length1":24,"length2":30},{"diffs":[[0,"ccountId');\n"],[1,"      "],[0,"      option"]],"start1":355,"start2":355,"length1":24,"length2":30},{"diffs":[[0,"Events.bind("],[-1,"\n        "],[0,"'login:' + a"]],"start1":393,"start2":393,"length1":33,"length2":24},{"diffs":[[0,":' + accountId,\n"],[1,"    "],[0,"        this.han"]],"start1":411,"start2":411,"length1":32,"length2":36},{"diffs":[[0,"in,\n        "],[1,"    "],[0,"this"],[1,");"],[0,"\n      "],[-1,");\n"],[0,"      option"]],"start1":460,"start2":460,"length1":38,"length2":41},{"diffs":[[0,"ts.bind("],[-1,"\n        "],[0,"'logout:"]],"start1":513,"start2":513,"length1":25,"length2":16},{"diffs":[[0,"ountId,\n        "],[1,"  "],[1,"  "],[0,"this.handleConta"]],"start1":536,"start2":536,"length1":32,"length2":36},{"diffs":[[0,"ut,\n        "],[1,"    "],[0,"this"],[1,");"],[0,"\n      "],[-1,");\n"],[0,"      option"]],"start1":578,"start2":578,"length1":38,"length2":41},{"diffs":[[0,"ts.bind("],[-1,"\n        "],[0,"'socket:"]],"start1":631,"start2":631,"length1":25,"length2":16},{"diffs":[[0,"Id,\n        "],[1,"    "],[0,"this.startCh"]],"start1":669,"start2":669,"length1":24,"length2":28},{"diffs":[[0,"ession,\n"],[1,"    "],[0,"        "]],"start1":700,"start2":700,"length1":16,"length2":20},{"diffs":[[0,"this"],[1,");"],[0,"\n     "],[-1," );\n"],[0,"   "],[-1," "],[0,"},\n\n"],[1,"    "],[0,"    "]],"start1":720,"start2":720,"length1":26,"length2":27},{"diffs":[[0,"ction() {\n      "],[1,"   "],[1,"   "],[0,"this.model.set('"]],"start1":770,"start2":770,"length1":32,"length2":38},{"diffs":[[0,"ne', true);\n"],[1,"      "],[0,"      this.$"]],"start1":812,"start2":812,"length1":24,"length2":30},{"diffs":[[0,"('online');\n"],[1,"    "],[0,"    },\n\n    "]],"start1":879,"start2":879,"length1":24,"length2":28},{"diffs":[[0,"    },\n\n    "],[1,"  "],[1,"  "],[0,"handleContac"]],"start1":895,"start2":895,"length1":24,"length2":28},{"diffs":[[0,"n() {\n      "],[1,"     "],[1," "],[0,"this.model.s"]],"start1":939,"start2":939,"length1":24,"length2":30},{"diffs":[[0,"e', false);\n"],[1,"      "],[0,"      $onlin"]],"start1":978,"start2":978,"length1":24,"length2":30},{"diffs":[[0,"ndicator');\n"],[1,"      "],[0,"      while "]],"start1":1045,"start2":1045,"length1":24,"length2":30},{"diffs":[[0," while ("],[-1," "],[0,"$onlineI"]],"start1":1068,"start2":1068,"length1":17,"length2":16},{"diffs":[[0,"online')"],[-1," "],[0,") {\n    "]],"start1":1103,"start2":1103,"length1":17,"length2":16},{"diffs":[[0,"ne')) {\n        "],[1,"       "],[1," "],[0,"$onlineIndicator"]],"start1":1107,"start2":1107,"length1":32,"length2":40},{"diffs":[[0,"('online');\n"],[1,"      "],[0,"      }\n    "]],"start1":1159,"start2":1159,"length1":24,"length2":30},{"diffs":[[0,"  }\n    "],[1," "],[1,"   "],[0,"},\n\n    "],[1,"   "],[1," "],[0,"startCha"]],"start1":1181,"start2":1181,"length1":24,"length2":32},{"diffs":[[0,"n: function() {\n"],[1,"      "],[0,"      this.trigg"]],"start1":1220,"start2":1220,"length1":32,"length2":38},{"diffs":[[0,"model);\n    "],[-1,"},\n\n"],[1,"    },\n\n    "],[0,"    render: "]],"start1":1280,"start2":1280,"length1":28,"length2":36},{"diffs":[[0,"unction() {\n"],[1,"      "],[0,"      this.$"]],"start1":1317,"start2":1317,"length1":24,"length2":30},{"diffs":[[0,"late, {\n"],[1,"        "],[0,"        "]],"start1":1378,"start2":1378,"length1":16,"length2":24},{"diffs":[[0,"oJSON()\n"],[1,"      "],[0,"      })"]],"start1":1421,"start2":1421,"length1":16,"length2":22},{"diffs":[[0,"    "],[1," "],[1,"     "],[0,"if ("],[-1," "],[0,"this"]],"start1":1448,"start2":1448,"length1":13,"length2":18},{"diffs":[[0,"online')"],[-1," "],[0,") this.h"]],"start1":1478,"start2":1478,"length1":17,"length2":16},{"diffs":[[0,"ogin();\n"],[1,"      "],[0,"      re"]],"start1":1507,"start2":1507,"length1":16,"length2":22},{"diffs":[[0,"    "],[1," "],[1,"   "],[0,"}\n  "],[1," "],[1," "],[0,"});\n\n"],[1,"  "],[0,"  re"]],"start1":1540,"start2":1540,"length1":17,"length2":25}]],"length":1587,"saved":false}
 {"contributors":[],"silentsave":false,"ts":1358186067628,"patch":[[{"diffs":[[0,"e);\n            "],[1,"var  "],[0,"$onlineIndicator"]],"start1":986,"start2":986,"length1":32,"length2":37}]],"length":1592,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364744906742,"patch":[[{"diffs":[[0,"    var "],[-1," "],[0,"$onlineI"]],"start1":998,"start2":998,"length1":17,"length2":16}]],"length":1591,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364747254008,"patch":[[{"diffs":[[0,"ocketEvents."],[-1,"bind"],[1,"on"],[0,"('login:' + "]],"start1":388,"start2":388,"length1":28,"length2":26},{"diffs":[[0,"tEvents."],[-1,"bind"],[1,"on"],[0,"('logout"]],"start1":506,"start2":506,"length1":20,"length2":18},{"diffs":[[0,"nts."],[-1,"bind"],[1,"on"],[0,"('so"]],"start1":626,"start2":626,"length1":12,"length2":10}]],"length":1585,"saved":false}</div></li>
 <li>.c9revisions/public/js/views/chatsession.js.c9save<div>diff --git a/.c9revisions/public/js/views/chatsession.js.c9save b/.c9revisions/public/js/views/chatsession.js.c9save
index 99230e9..f263934 100644
--- a/.c9revisions/public/js/views/chatsession.js.c9save
+++ b/.c9revisions/public/js/views/chatsession.js.c9save
@@ -1,2 +1,3 @@
 {"ts":1358111034762,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"define(['SocialNetView', 'text!templates/chatsession.html'],\nfunction(SocialNetView, chatItemTemplate) {\n  var chatItemView = SocialNetView.extend({\n    tagName: 'div',\n\n    className: 'chat_session',\n\n    $el: $(this.el),\n\n    events: {\n      'submit form': 'sendChat'\n    },\n\n    initialize: function(options) {\n      this.socketEvents = options.socketEvents;\n      var accountId = this.model.get('accountId');\n      this.socketEvents.on('socket:chat:in:' + accountId, this.receiveChat, this);\n      this.socketEvents.bind(\n        'login:' + accountId,\n        this.handleContactLogin,\n        this\n      );\n      this.socketEvents.bind(\n        'logout:' + accountId,\n        this.handleContactLogout,\n        this\n      );\n    },\n\n    handleContactLogin: function() {\n      this.$el.find('.online_indicator').addClass('online');\n      this.model.set('online', true);\n    },\n\n    handleContactLogout: function() {\n      this.model.set('online', false);\n      $onlineIndicator = this.$el.find('.online_indicator');\n      while ( $onlineIndicator.hasClass('online') ) {\n        $onlineIndicator.removeClass('online');\n      }\n    },\n\n    receiveChat: function(data) {\n      var chatLine = this.model.get('name').first + ': ' + data.text;\n      this.$el.find('.chat_log').append($('<li>' + chatLine + '</li>'));\n    },\n\n    sendChat: function() {\n      var chatText = this.$el.find('input[name=chat]').val();\n      if ( chatText && /[^\\s]+/.test(chatText) ) {\n        var chatLine = 'Me: ' + chatText;\n        this.$el.find('.chat_log').append($('<li>' + chatLine + '</li>'));\n        this.socketEvents.trigger('socket:chat', {\n          to: this.model.get('accountId'),\n          text: chatText\n        });\n      }\n      return false;\n    },\n\n    render: function() {\n      this.$el.html(_.template(chatItemTemplate, {\n        model: this.model.toJSON()\n      }));\n      if ( this.model.get('online') ) this.handleContactLogin();\n      return this;\n    }\n  });\n\n  return chatItemView;\n});"]],"start1":0,"start2":0,"length1":0,"length2":1990}]],"length":1990}
 {"contributors":[],"silentsave":false,"ts":1358111040722,"patch":[[{"diffs":[[0,"html'],\n"],[1,"\n"],[0,"function"]],"start1":53,"start2":53,"length1":16,"length2":17},{"diffs":[[0,"late) {\n"],[1,"  "],[0,"  var ch"]],"start1":98,"start2":98,"length1":16,"length2":18},{"diffs":[[0,"xtend({\n"],[1,"    "],[0,"    tagN"]],"start1":144,"start2":144,"length1":16,"length2":20},{"diffs":[[0,"me: 'div',\n\n"],[1,"    "],[0,"    classNam"]],"start1":165,"start2":165,"length1":24,"length2":28},{"diffs":[[0,"_session',\n\n"],[1,"    "],[0,"    $el: $(t"]],"start1":201,"start2":201,"length1":24,"length2":28},{"diffs":[[0,"s.el),\n\n"],[1,"    "],[0,"    even"]],"start1":231,"start2":231,"length1":16,"length2":20},{"diffs":[[0,"{\n      "],[1,"  "],[1,"    "],[0,"'submit "]],"start1":255,"start2":255,"length1":16,"length2":22},{"diffs":[[0,"ndChat'\n"],[1,"    "],[0,"    },\n\n"]],"start1":287,"start2":287,"length1":16,"length2":20},{"diffs":[[0,"},\n\n    "],[1,"  "],[1,"  "],[0,"initiali"]],"start1":303,"start2":303,"length1":16,"length2":20},{"diffs":[[0,"(options) {\n"],[1,"      "],[0,"      this.s"]],"start1":335,"start2":335,"length1":24,"length2":30},{"diffs":[[0,"ents;\n      "],[1,"  "],[1,"    "],[0,"var accountI"]],"start1":395,"start2":395,"length1":24,"length2":30},{"diffs":[[0,"ccountId');\n"],[1,"      "],[0,"      this.s"]],"start1":446,"start2":446,"length1":24,"length2":30},{"diffs":[[0," this);\n"],[1,"      "],[0,"      th"]],"start1":539,"start2":539,"length1":16,"length2":22},{"diffs":[[0,"Events.bind("],[-1,"\n        "],[0,"'login:' + a"]],"start1":570,"start2":570,"length1":33,"length2":24},{"diffs":[[0,":' + accountId,\n"],[1,"    "],[0,"        this.han"]],"start1":588,"start2":588,"length1":32,"length2":36},{"diffs":[[0,"in,\n        "],[1," "],[1,"   "],[0,"this"],[1,");"],[0,"\n      "],[-1,");\n"],[0,"      this.s"]],"start1":637,"start2":637,"length1":38,"length2":41},{"diffs":[[0,"ts.bind("],[-1,"\n        "],[0,"'logout:"]],"start1":687,"start2":687,"length1":25,"length2":16},{"diffs":[[0,"ountId,\n        "],[1,"  "],[1,"  "],[0,"this.handleConta"]],"start1":710,"start2":710,"length1":32,"length2":36},{"diffs":[[0,"    "],[1,"    "],[0,"this"],[1,");"],[0,"\n    "],[-1,"  );\n"],[0,"    },\n\n"],[1,"    "],[0,"    "]],"start1":760,"start2":760,"length1":30,"length2":35},{"diffs":[[0,"ction() {\n      "],[1,"   "],[1,"   "],[0,"this.$el.find('."]],"start1":818,"start2":818,"length1":32,"length2":38},{"diffs":[[0,"('online');\n"],[1,"      "],[0,"      this.m"]],"start1":883,"start2":883,"length1":24,"length2":30},{"diffs":[[0," true);\n    "],[1," "],[1,"   "],[0,"},\n\n"],[1,"    "],[0,"    handleCo"]],"start1":931,"start2":931,"length1":28,"length2":36},{"diffs":[[0,"n() {\n      "],[1,"   "],[1,"   "],[0,"this.model.s"]],"start1":987,"start2":987,"length1":24,"length2":30},{"diffs":[[0,"e', false);\n"],[1,"      "],[0,"      $onlin"]],"start1":1026,"start2":1026,"length1":24,"length2":30},{"diffs":[[0,"    "],[1," "],[1,"     "],[0,"while ("],[-1," "],[0,"$onl"]],"start1":1107,"start2":1107,"length1":16,"length2":21},{"diffs":[[0,"online')"],[-1," "],[0,") {\n    "]],"start1":1151,"start2":1151,"length1":17,"length2":16},{"diffs":[[0,"ne')) {\n        "],[1,"   "],[1,"     "],[0,"$onlineIndicator"]],"start1":1155,"start2":1155,"length1":32,"length2":40},{"diffs":[[0,"    "],[1,"    "],[-1,"}\n"],[1,"  }\n   "],[0,"    "],[1," "],[0,"},\n\n"],[1,"    "],[0,"    "]],"start1":1221,"start2":1221,"length1":18,"length2":32},{"diffs":[[0,"ion(data) {\n"],[1,"      "],[0,"      var ch"]],"start1":1271,"start2":1271,"length1":24,"length2":30},{"diffs":[[0,"text;\n      "],[1,"    "],[1,"  "],[0,"this.$el.fin"]],"start1":1353,"start2":1353,"length1":24,"length2":30},{"diffs":[[0,"li>'));\n    "],[-1,"},\n\n"],[1,"    },\n\n    "],[0,"    sendChat"]],"start1":1430,"start2":1430,"length1":28,"length2":36},{"diffs":[[0,"unction() {\n"],[1,"      "],[0,"      var ch"]],"start1":1469,"start2":1469,"length1":24,"length2":30},{"diffs":[[0,";\n      "],[1,"    "],[1,"  "],[0,"if ("],[-1," "],[0,"chatText"]],"start1":1547,"start2":1547,"length1":21,"length2":26},{"diffs":[[0,"hatText)"],[-1," "],[0,") {\n    "]],"start1":1592,"start2":1592,"length1":17,"length2":16},{"diffs":[[0,"ext)) {\n        "],[1,"      "],[1,"  "],[0,"var chatLine = '"]],"start1":1596,"start2":1596,"length1":32,"length2":40},{"diffs":[[0,"+ chatText;\n"],[1,"        "],[0,"        this"]],"start1":1642,"start2":1642,"length1":24,"length2":32},{"diffs":[[0,"ne + '</li>'));\n"],[1,"        "],[0,"        this.soc"]],"start1":1721,"start2":1721,"length1":32,"length2":40},{"diffs":[[0,"et:chat', {\n"],[1,"          "],[0,"          to"]],"start1":1784,"start2":1784,"length1":24,"length2":34},{"diffs":[[0,"        "],[1," "],[1,"         "],[0,"text: ch"]],"start1":1851,"start2":1851,"length1":16,"length2":26},{"diffs":[[0,"        "],[1," "],[1,"       "],[0,"});\n    "]],"start1":1884,"start2":1884,"length1":16,"length2":24},{"diffs":[[0,"  });\n      "],[1,"   "],[-1,"}\n"],[1,"   }\n      "],[0,"      return"]],"start1":1898,"start2":1898,"length1":26,"length2":38},{"diffs":[[0," false;\n    "],[1," "],[1,"   "],[0,"},\n\n"],[1,"    "],[0,"    render: "]],"start1":1936,"start2":1936,"length1":28,"length2":36},{"diffs":[[0,"n() {\n      "],[1,"   "],[1,"   "],[0,"this.$el.htm"]],"start1":1979,"start2":1979,"length1":24,"length2":30},{"diffs":[[0,"        "],[1,"       "],[1," "],[0,"model: t"]],"start1":2042,"start2":2042,"length1":16,"length2":24},{"diffs":[[0,"oJSON()\n"],[1,"      "],[0,"      })"]],"start1":2077,"start2":2077,"length1":16,"length2":22},{"diffs":[[0,"    "],[1,"   "],[1,"   "],[0,"if ("],[-1," "],[0,"this"]],"start1":2104,"start2":2104,"length1":13,"length2":18},{"diffs":[[0,"online')"],[-1," "],[0,") this.h"]],"start1":2134,"start2":2134,"length1":17,"length2":16},{"diffs":[[0,"in();\n      "],[1,"     "],[1," "],[0,"return this;"]],"start1":2165,"start2":2165,"length1":24,"length2":30},{"diffs":[[0,"is;\n"],[1,"    "],[0,"    }\n"],[1,"  "],[0,"  });\n\n"],[1,"  "],[0,"  re"]],"start1":2192,"start2":2192,"length1":21,"length2":29}]],"length":2243,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364747205600,"patch":[[{"diffs":[[0,"ocketEvents."],[-1,"bind"],[1,"on"],[0,"('login:' + "]],"start1":565,"start2":565,"length1":28,"length2":26},{"diffs":[[0,"nts."],[-1,"bind"],[1,"on"],[0,"('lo"]],"start1":684,"start2":684,"length1":12,"length2":10},{"diffs":[[0,"e);\n            "],[1,"var "],[0,"$onlineIndicator"]],"start1":1030,"start2":1030,"length1":32,"length2":36}]],"length":2243,"saved":false}</div></li>
 <li>.c9revisions/public/js/views/contact.js.c9save<div>diff --git a/.c9revisions/public/js/views/contact.js.c9save b/.c9revisions/public/js/views/contact.js.c9save
index 77a2f97..8f04042 100644
--- a/.c9revisions/public/js/views/contact.js.c9save
+++ b/.c9revisions/public/js/views/contact.js.c9save
@@ -11,3 +11,4 @@
 {"ts":1358103139400,"patch":[[{"diffs":[[0,"name"],[1,"')"],[0,".first"],[-1,"')"],[0,");\n "]],"start1":699,"start2":699,"length1":16,"length2":16}]],"length":1892,"saved":false}
 {"ts":1358110077374,"patch":[[{"diffs":[[0,"ton: false,\n"],[-1,"\n"],[0,"    removeBu"]],"start1":153,"start2":153,"length1":25,"length2":24},{"diffs":[[0," false,\n"],[-1,"\n"],[0,"    tagN"]],"start1":182,"start2":182,"length1":17,"length2":16},{"diffs":[[0,") {\n"],[-1,"        console.log('client-> addContact');\n"],[0,"    "]],"start1":342,"start2":342,"length1":52,"length2":8},{"diffs":[[0,"r that=this;"],[1,"  // callback context"],[0,"\n        var"]],"start1":356,"start2":356,"length1":24,"length2":45},{"diffs":[[0,"tionarea');\n"],[1,"        // deferred\n"],[0,"        var "]],"start1":429,"start2":429,"length1":24,"length2":44},{"diffs":[[0,"e(function () {\n"],[-1,""],[0,"          consol"]],"start1":568,"start2":568,"length1":32,"length2":32},{"diffs":[[0,"        "],[1,"//"],[0,"console."]],"start1":586,"start2":586,"length1":16,"length2":18},{"diffs":[[0,"ion "],[-1,"onSuccess"],[0,"() {"]],"start1":1132,"start2":1132,"length1":17,"length2":8},{"diffs":[[0,"ion "],[-1,"onError"],[0,"() {"]],"start1":1211,"start2":1211,"length1":15,"length2":8}]],"length":1873,"saved":false}
 {"ts":1358110488888,"patch":[[{"diffs":[[0,"late) {\n"],[1,"  "],[0,"  var co"]],"start1":92,"start2":92,"length1":16,"length2":18},{"diffs":[[0,"xtend({\n"],[1,"    "],[0,"    addB"]],"start1":137,"start2":137,"length1":16,"length2":20},{"diffs":[[0,"ton: false,\n"],[1,"    "],[0,"    removeBu"]],"start1":159,"start2":159,"length1":24,"length2":28},{"diffs":[[0,"se,\n    "],[1," "],[1,"   "],[0,"tagName:"]],"start1":196,"start2":196,"length1":16,"length2":20},{"diffs":[[0,"',\n\n    "],[1,"   "],[1," "],[0,"events: "]],"start1":220,"start2":220,"length1":16,"length2":20},{"diffs":[[0,"ts: {\n      "],[1,"    "],[1,"  "],[0,"\"click .addb"]],"start1":236,"start2":236,"length1":24,"length2":30},{"diffs":[[0,"ntact\",\n"],[1,"      "],[0,"      \"c"]],"start1":280,"start2":280,"length1":16,"length2":22},{"diffs":[[0,"ontact\"\n    "],[1,"   "],[1," "],[0,"},\n\n"],[1,"    "],[0,"    addConta"]],"start1":331,"start2":331,"length1":28,"length2":36},{"diffs":[[0,"    "],[1,"    "],[0,"var that"],[-1,"="],[1," = "],[0,"this;"],[-1," "],[0," // "]],"start1":388,"start2":388,"length1":23,"length2":28},{"diffs":[[0,"context\n"],[1,"    "],[0,"        "]],"start1":425,"start2":425,"length1":16,"length2":20},{"diffs":[[0,"        "],[1,"    "],[0,"// defer"]],"start1":488,"start2":488,"length1":16,"length2":20},{"diffs":[[0,"red\n        "],[1," "],[1,"   "],[0,"var posted ="]],"start1":508,"start2":508,"length1":24,"length2":28},{"diffs":[[0,"tact', {"],[1,"\n                "],[0,"contactI"]],"start1":561,"start2":561,"length1":16,"length2":33},{"diffs":[[0,"t('_id')"],[-1,"});\n"],[1,"\n            });\n    "],[0,"        "]],"start1":610,"start2":610,"length1":20,"length2":37},{"diffs":[[0,"ed.done(function"],[-1," "],[0,"() {\n          /"]],"start1":651,"start2":651,"length1":33,"length2":32},{"diffs":[[0,"        "],[1,"     "],[1," "],[0,"//consol"]],"start1":674,"start2":674,"length1":16,"length2":22},{"diffs":[[0,"ss');\n          "],[1,"     "],[1," "],[0,"$responseArea.te"]],"start1":720,"start2":720,"length1":32,"length2":38},{"diffs":[[0,"ded: ' +"],[1," "],[0,"that.mod"]],"start1":772,"start2":772,"length1":16,"length2":17},{"diffs":[[0,"first);\n        "],[1,"   "],[1," "],[0,"});\n"],[1,"    "],[0,"        posted.f"]],"start1":804,"start2":804,"length1":36,"length2":44},{"diffs":[[0,"ed.fail(function"],[-1," "],[0,"() {\n"],[1,"      "],[0,"          $respo"]],"start1":844,"start2":844,"length1":38,"length2":43},{"diffs":[[0,"    "],[-1,"  }\n"],[0,"      "],[1,"}"],[0,");\n"],[1,"    "],[0,"    },\n\n"],[1,"    "],[0,"    "]],"start1":928,"start2":928,"length1":29,"length2":34},{"diffs":[[0,"unction() {\n"],[1,"      "],[0,"      var $r"]],"start1":978,"start2":978,"length1":24,"length2":30},{"diffs":[[0,"ea');\n      "],[1," "],[1,"     "],[0,"$responseAre"]],"start1":1039,"start2":1039,"length1":24,"length2":30},{"diffs":[[0,"ntact...');\n"],[1,"      "],[0,"      $.ajax"]],"start1":1088,"start2":1088,"length1":24,"length2":30},{"diffs":[[0,".ajax({\n"],[1,"        "],[0,"        "]],"start1":1113,"start2":1113,"length1":16,"length2":24},{"diffs":[[0,"ntact',\n"],[1,"        "],[0,"        "]],"start1":1158,"start2":1158,"length1":16,"length2":24},{"diffs":[[0,"    "],[1,"     "],[1,"   "],[0,"data: {\n"],[1,"          "],[0,"    "]],"start1":1202,"start2":1202,"length1":16,"length2":34},{"diffs":[[0,"        "],[-1,"}"],[1,"        }\n            "],[0,"}).done("]],"start1":1281,"start2":1281,"length1":17,"length2":38},{"diffs":[[0,"}).done(function"],[-1," "],[0,"() {\n"],[1,"      "],[0,"          $respo"]],"start1":1311,"start2":1311,"length1":38,"length2":43},{"diffs":[[0,"        "],[1,"  "],[1,"  "],[0,"}).fail("]],"start1":1387,"start2":1387,"length1":16,"length2":20},{"diffs":[[0,"tion"],[-1," "],[0,"() {\n"],[1,"      "],[0,"    "]],"start1":1411,"start2":1411,"length1":14,"length2":19},{"diffs":[[0,"    "],[1,"  "],[1,"  "],[0,"});\n    "],[1,"   "],[1," "],[0,"},\n\n"],[1,"    "],[0,"    "]],"start1":1488,"start2":1488,"length1":20,"length2":32},{"diffs":[[0,"{\n      "],[1," "],[1,"     "],[0,"// Set t"]],"start1":1543,"start2":1543,"length1":16,"length2":22},{"diffs":[[0,"tructor\n"],[1,"      "],[0,"      if"]],"start1":1624,"start2":1624,"length1":16,"length2":22},{"diffs":[[0,"            if ("],[-1," "],[0,"this.options.add"]],"start1":1632,"start2":1632,"length1":33,"length2":32},{"diffs":[[0,"ns.addButton"],[-1," "],[0,") {\n"],[1,"        "],[0,"        this"]],"start1":1658,"start2":1658,"length1":29,"length2":36},{"diffs":[[0,"    "],[-1,"}\n\n"],[1,"      }\n\n     "],[0,"      "],[1," "],[0,"if ("],[-1," "],[0,"this"]],"start1":1733,"start2":1733,"length1":22,"length2":33},{"diffs":[[0,"tton"],[-1," "],[0,") {\n"],[1,"        "],[0,"    "]],"start1":1783,"start2":1783,"length1":13,"length2":20},{"diffs":[[0,"Button;\n"],[1,"      "],[0,"      }\n"],[1,"    "],[0,"    },\n\n"]],"start1":1846,"start2":1846,"length1":24,"length2":34},{"diffs":[[0,"},\n\n    "],[1," "],[1,"   "],[0,"render: "]],"start1":1876,"start2":1876,"length1":16,"length2":20},{"diffs":[[0,"unction() {\n"],[1,"      "],[0,"      $(this"]],"start1":1897,"start2":1897,"length1":24,"length2":30},{"diffs":[[0,"        "],[1," "],[1,"       "],[0,"model: t"]],"start1":1967,"start2":1967,"length1":16,"length2":24},{"diffs":[[0,"JSON(),\n        "],[1,"    "],[1,"    "],[0,"addButton: this."]],"start1":2003,"start2":2003,"length1":32,"length2":40},{"diffs":[[0,"Button,\n        "],[1,"       "],[1," "],[0,"removeButton: th"]],"start1":2046,"start2":2046,"length1":32,"length2":40},{"diffs":[[0,"eButton\n"],[1,"      "],[0,"      })"]],"start1":2094,"start2":2094,"length1":16,"length2":22},{"diffs":[[0,";\n      "],[1,"    "],[1,"  "],[0,"return t"]],"start1":2117,"start2":2117,"length1":16,"length2":22},{"diffs":[[0,"    "],[1,"   "],[1," "],[0,"}\n"],[1,"  "],[0,"  });\n\n"],[1,"  "],[0,"  re"]],"start1":2144,"start2":2144,"length1":17,"length2":25}]],"length":2191,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364762878345,"patch":[[{"diffs":[[0,"d.done(function("],[1,"data"],[0,") {\n            "]],"start1":652,"start2":652,"length1":32,"length2":36},{"diffs":[[0,"        "],[-1,"//"],[0,"console."]],"start1":684,"start2":684,"length1":18,"length2":16},{"diffs":[[0,"Success'"],[1," + data"],[0,");\n     "]],"start1":717,"start2":717,"length1":16,"length2":23},{"diffs":[[0,"        "],[1," var ajax ="],[0," $.ajax("]],"start1":1112,"start2":1112,"length1":16,"length2":27},{"diffs":[[0,"      })"],[1,";\n            \n            ajax"],[0,".done(fu"]],"start1":1325,"start2":1325,"length1":16,"length2":47},{"diffs":[[0," Removed');\n"],[-1,""],[0,"            "]],"start1":1426,"start2":1426,"length1":24,"length2":24},{"diffs":[[0,"      })"],[1,";\n            \n            ajax"],[0,".fail(fu"]],"start1":1444,"start2":1444,"length1":16,"length2":47}]],"length":2273,"saved":false}</div></li>
 <li>.c9revisions/public/js/views/forgotpassword.js.c9save<div>diff --git a/.c9revisions/public/js/views/forgotpassword.js.c9save b/.c9revisions/public/js/views/forgotpassword.js.c9save
index 7cedf38..563a126 100644
--- a/.c9revisions/public/js/views/forgotpassword.js.c9save
+++ b/.c9revisions/public/js/views/forgotpassword.js.c9save
@@ -1,2 +1,4 @@
 {"ts":1358111220508,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"define(['SocialNetView', 'text!templates/forgotpassword.html'], function(SocialNetView, forgotpasswordTemplate) {\n  var forgotpasswordView = SocialNetView.extend({\n    requireLogin: false,\n\n    el: $('#content'),\n\n    events: {\n      \"submit form\": \"password\"\n    },\n\n    password: function() {\n      $.post('/forgotpassword', {\n        email: $('input[name=email]').val()\n      }, function(data) {\n        console.log(data);\n      });\n      return false;\n    },\n\n    render: function() {\n      this.$el.html(forgotpasswordTemplate);\n    }\n  });\n\n  return forgotpasswordView;\n});\n"]],"start1":0,"start2":0,"length1":0,"length2":580}]],"length":580}
 {"contributors":[],"silentsave":false,"ts":1358111225253,"patch":[[{"diffs":[[0,"late) {\n"],[1,"  "],[0,"  var fo"]],"start1":106,"start2":106,"length1":16,"length2":18},{"diffs":[[0,"xtend({\n"],[1,"    "],[0,"    requ"]],"start1":158,"start2":158,"length1":16,"length2":20},{"diffs":[[0,"false,\n\n"],[1,"    "],[0,"    el: "]],"start1":188,"start2":188,"length1":16,"length2":20},{"diffs":[[0,"),\n\n    "],[1,"  "],[1,"  "],[0,"events: "]],"start1":220,"start2":220,"length1":16,"length2":20},{"diffs":[[0,"ents: {\n"],[1,"      "],[0,"      \"s"]],"start1":234,"start2":234,"length1":16,"length2":22},{"diffs":[[0,"ssword\"\n    "],[1,"   "],[1," "],[0,"},\n\n"],[1,"    "],[0,"    password"]],"start1":272,"start2":272,"length1":28,"length2":36},{"diffs":[[0,"unction() {\n"],[1,"      "],[0,"      $.post"]],"start1":311,"start2":311,"length1":24,"length2":30},{"diffs":[[0,"ord', {\n"],[1,"        "],[0,"        "]],"start1":355,"start2":355,"length1":16,"length2":24},{"diffs":[[0,")\n      "],[1,"   "],[1,"   "],[0,"}, funct"]],"start1":413,"start2":413,"length1":16,"length2":22},{"diffs":[[0,"        "],[1,"   "],[1,"     "],[0,"console."]],"start1":447,"start2":447,"length1":16,"length2":24},{"diffs":[[0,";\n      "],[1," "],[-1,"});\n"],[1,"     });\n      "],[0,"      re"]],"start1":480,"start2":480,"length1":20,"length2":32},{"diffs":[[0," false;\n    "],[-1,"},\n\n"],[1,"    },\n\n    "],[0,"    render: "]],"start1":516,"start2":516,"length1":28,"length2":36},{"diffs":[[0,"{\n      "],[1,"   "],[1,"   "],[0,"this.$el"]],"start1":563,"start2":563,"length1":16,"length2":22},{"diffs":[[0,"e);\n"],[1,"    "],[0,"    }\n"],[1,"  "],[0,"  });\n\n"],[1,"  "],[0,"  re"]],"start1":612,"start2":612,"length1":21,"length2":29}]],"length":670,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364762099344,"patch":[[{"diffs":[[0,"word', {"],[-1,"\n                "],[0,"email: $"]],"start1":354,"start2":354,"length1":33,"length2":16},{"diffs":[[0,"').val()"],[1,"})"],[0,"\n       "]],"start1":389,"start2":389,"length1":16,"length2":18},{"diffs":[[0,"    "],[-1,"}, "],[1,".done("],[0,"func"]],"start1":408,"start2":408,"length1":11,"length2":14},{"diffs":[[0,"    });\n"],[1,"            \n"],[0,"        "]],"start1":478,"start2":478,"length1":16,"length2":29},{"diffs":[[0,"lse;\n        },\n"],[1,"        "],[0,"\n        render:"]],"start1":520,"start2":520,"length1":32,"length2":40}]],"length":679,"saved":false}
+{"ts":1364762261113,"patch":[[{"diffs":[[0,"        "],[1," var post ="],[0," $.post("]],"start1":326,"start2":326,"length1":16,"length2":27},{"diffs":[[0,".val()})"],[1,";"],[0,"\n       "]],"start1":402,"start2":402,"length1":16,"length2":17},{"diffs":[[0,"        "],[1,"\n            post"],[0,".done(fu"]],"start1":416,"start2":416,"length1":16,"length2":33}]],"length":708,"saved":false}</div></li>
 <li>.c9revisions/public/js/views/index.js.c9save<div>diff --git a/.c9revisions/public/js/views/index.js.c9save b/.c9revisions/public/js/views/index.js.c9save
index 2cb41eb..83cffa4 100644
--- a/.c9revisions/public/js/views/index.js.c9save
+++ b/.c9revisions/public/js/views/index.js.c9save
@@ -1,3 +1,5 @@
 {"ts":1357692448193,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"define(['SocialNetView', 'text!templates/index.html',\n        'views/status', 'models/Status'],\nfunction(SocialNetView, indexTemplate, StatusView, Status) {\n  var indexView = SocialNetView.extend({\n    el: $('#content'),\n\n    events: {\n      \"submit form\": \"updateStatus\"\n    },\n\n    initialize: function(options) {\n      options.socketEvents.bind('status:me', this.onSocketStatusAdded, this );\n      this.collection.on('add', this.onStatusAdded, this);\n      this.collection.on('reset', this.onStatusCollectionReset, this);\n    },\n\n    onStatusCollectionReset: function(collection) {\n      var that = this;\n      collection.each(function (model) {\n        that.onStatusAdded(model);\n      });\n    },\n\n    onSocketStatusAdded: function(data) {\n      var newStatus = data.data;\n      var found = false;\n      this.collection.forEach(function(status) {\n        var name = status.get('name');\n        if ( name && name.full == newStatus.name.full && status.get('status') == newStatus.status ) {\n          found = true;\n        }\n      });\n      if (!found ) {\n        this.collection.add(new Status({status:newStatus.status,name:newStatus.name}))\n      }\n    },\n\n    onStatusAdded: function(status) {\n      var statusHtml = (new StatusView({ model: status })).render().el;\n      $(statusHtml).prependTo('.status_list').hide().fadeIn('slow');\n    },\n\n    updateStatus: function() {\n      var statusText = $('input[name=status]').val();\n      var statusCollection = this.collection;\n      $.post('/accounts/me/status', {\n        status: statusText\n      }); // New: no longer adding to screen\n      return false;\n    },\n\n    render: function() {\n      this.$el.html(indexTemplate);\n    }\n  });\n\n  return indexView;\n});\n"]],"start1":0,"start2":0,"length1":0,"length2":1714}]],"length":1714}
 {"contributors":[],"silentsave":false,"ts":1358111232598,"patch":[[{"diffs":[[0,"x.html',"],[-1,"\n       "],[0," 'views/"]],"start1":45,"start2":45,"length1":24,"length2":16},{"diffs":[[0,"atus'],\n"],[1,"\n"],[0,"function"]],"start1":80,"start2":80,"length1":16,"length2":17},{"diffs":[[0,"atus) {\n"],[1,"  "],[0,"  var in"]],"start1":142,"start2":142,"length1":16,"length2":18},{"diffs":[[0,"xtend({\n"],[1,"    "],[0,"    el: "]],"start1":185,"start2":185,"length1":16,"length2":20},{"diffs":[[0,"ent'),\n\n"],[1,"    "],[0,"    even"]],"start1":213,"start2":213,"length1":16,"length2":20},{"diffs":[[0,"{\n      "],[1," "],[1,"     "],[0,"\"submit "]],"start1":237,"start2":237,"length1":16,"length2":22},{"diffs":[[0,"Status\"\n"],[1,"    "],[0,"    },\n\n"]],"start1":273,"start2":273,"length1":16,"length2":20},{"diffs":[[0,"},\n\n    "],[1,"  "],[1,"  "],[0,"initiali"]],"start1":289,"start2":289,"length1":16,"length2":20},{"diffs":[[0,"(options) {\n"],[1,"      "],[0,"      option"]],"start1":321,"start2":321,"length1":24,"length2":30},{"diffs":[[0,"ed, this"],[-1," "],[0,");\n     "]],"start1":406,"start2":406,"length1":17,"length2":16},{"diffs":[[0,"d, this);\n      "],[1,"  "],[1,"    "],[0,"this.collection."]],"start1":407,"start2":407,"length1":32,"length2":38},{"diffs":[[0,"ded, this);\n"],[1,"      "],[0,"      this.c"]],"start1":470,"start2":470,"length1":24,"length2":30},{"diffs":[[0," this);\n    "],[-1,"},\n\n"],[1,"    },\n\n    "],[0,"    onStatus"]],"start1":551,"start2":551,"length1":28,"length2":36},{"diffs":[[0,"on) {\n      "],[1,"   "],[1,"   "],[0,"var that = t"]],"start1":621,"start2":621,"length1":24,"length2":30},{"diffs":[[0,";\n      "],[1,"   "],[1,"   "],[0,"collecti"]],"start1":654,"start2":654,"length1":16,"length2":22},{"diffs":[[0,"function"],[-1," "],[0,"(model) "]],"start1":684,"start2":684,"length1":17,"length2":16},{"diffs":[[0,"        "],[1," "],[1,"       "],[0,"that.onS"]],"start1":702,"start2":702,"length1":16,"length2":24},{"diffs":[[0,"model);\n"],[1,"      "],[0,"      })"]],"start1":737,"start2":737,"length1":16,"length2":22},{"diffs":[[0,"    });\n    "],[1," "],[1,"   "],[0,"},\n\n"],[1,"    "],[0,"    onSocket"]],"start1":753,"start2":753,"length1":28,"length2":36},{"diffs":[[0,"ion(data) {\n"],[1,"      "],[0,"      var ne"]],"start1":807,"start2":807,"length1":24,"length2":30},{"diffs":[[0,"data;\n      "],[1,"     "],[1," "],[0,"var found = "]],"start1":852,"start2":852,"length1":24,"length2":30},{"diffs":[[0,"nd = false;\n"],[1,"      "],[0,"      this.c"]],"start1":877,"start2":877,"length1":24,"length2":30},{"diffs":[[0,") {\n        "],[1,"    "],[1,"    "],[0,"var name = s"]],"start1":940,"start2":940,"length1":24,"length2":32},{"diffs":[[0,"et('name');\n"],[1,"        "],[0,"        if ("]],"start1":979,"start2":979,"length1":24,"length2":32},{"diffs":[[0,"    if ("],[-1," "],[0,"name && "]],"start1":1003,"start2":1003,"length1":17,"length2":16},{"diffs":[[0,"s.status"],[-1," "],[0,") {\n    "]],"start1":1087,"start2":1087,"length1":17,"length2":16},{"diffs":[[0,"        "],[1,"       "],[1,"   "],[0,"found = "]],"start1":1101,"start2":1101,"length1":16,"length2":26},{"diffs":[[0,"= true;\n"],[1,"        "],[0,"        "]],"start1":1125,"start2":1125,"length1":16,"length2":24},{"diffs":[[0,"}\n      "],[-1,"});\n"],[1,"      });\n     "],[0,"      "],[1," "],[0,"if (!fou"]],"start1":1149,"start2":1149,"length1":26,"length2":38},{"diffs":[[0,"ound"],[-1," "],[0,") {\n"],[1,"        "],[0,"    "]],"start1":1185,"start2":1185,"length1":13,"length2":20},{"diffs":[[0,"Status({"],[1,"\n                    "],[0,"status:"],[1," "],[0,"newStatu"]],"start1":1233,"start2":1233,"length1":23,"length2":45},{"diffs":[[0,"tus,"],[1,"\n                    "],[0,"name:"],[1," "],[0,"newS"]],"start1":1283,"start2":1283,"length1":13,"length2":35},{"diffs":[[0,"name"],[-1,"}))\n      }\n"],[1,"\n                }))\n            }\n   "],[0,"    "],[1," "],[0,"},\n\n"],[1,"    "],[0,"    "]],"start1":1324,"start2":1324,"length1":28,"length2":59},{"diffs":[[0,"status) {\n      "],[1," "],[1,"     "],[0,"var statusHtml ="]],"start1":1407,"start2":1407,"length1":32,"length2":38},{"diffs":[[0,"usView({"],[1,"\n               "],[0," model: "]],"start1":1455,"start2":1455,"length1":16,"length2":32},{"diffs":[[0,": status"],[1,"\n           "],[0," })).ren"]],"start1":1485,"start2":1485,"length1":16,"length2":28},{"diffs":[[0,"r().el;\n"],[1,"      "],[0,"      $("]],"start1":1515,"start2":1515,"length1":16,"length2":22},{"diffs":[[0,"slow');\n"],[1,"    "],[0,"    },\n\n"],[1,"    "],[0,"    upda"]],"start1":1590,"start2":1590,"length1":24,"length2":32},{"diffs":[[0,"unction() {\n"],[1,"      "],[0,"      var st"]],"start1":1633,"start2":1633,"length1":24,"length2":30},{"diffs":[[0,"al();\n      "],[1," "],[1,"     "],[0,"var statusCo"]],"start1":1699,"start2":1699,"length1":24,"length2":30},{"diffs":[[0,";\n      "],[1,"     "],[1," "],[0,"$.post('"]],"start1":1755,"start2":1755,"length1":16,"length2":22},{"diffs":[[0,"tus', {\n"],[1,"        "],[0,"        "]],"start1":1793,"start2":1793,"length1":16,"length2":24},{"diffs":[[0,"t\n      "],[1,"  "],[1,"    "],[0,"}); // N"]],"start1":1834,"start2":1834,"length1":16,"length2":22},{"diffs":[[0," screen\n"],[1,"      "],[0,"      re"]],"start1":1879,"start2":1879,"length1":16,"length2":22},{"diffs":[[0," false;\n    "],[1," "],[1,"   "],[0,"},\n\n"],[1,"    "],[0,"    render: "]],"start1":1905,"start2":1905,"length1":28,"length2":36},{"diffs":[[0,"n() {\n      "],[1,"    "],[1,"  "],[0,"this.$el.htm"]],"start1":1948,"start2":1948,"length1":24,"length2":30},{"diffs":[[0,"e);\n"],[1,"    "],[0,"    }\n"],[1,"  "],[0,"  });\n\n"],[1,"  "],[0,"  re"]],"start1":1992,"start2":1992,"length1":21,"length2":29}]],"length":2041,"saved":false}
 {"contributors":[],"silentsave":false,"ts":1358117946957,"patch":[[{"diffs":[[0,"eIn("],[-1,"'slow'"],[0,");\n "]],"start1":1585,"start2":1585,"length1":14,"length2":8},{"diffs":[[0,"        "],[1,"}).done(function(data) {console.log(data)"],[0,"}); // N"]],"start1":1834,"start2":1834,"length1":16,"length2":57}]],"length":2076,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364747105946,"patch":[[{"diffs":[[0,"nts."],[-1,"bind"],[1,"on"],[0,"('st"]],"start1":362,"start2":362,"length1":12,"length2":10}]],"length":2074,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364761969207,"patch":[[{"diffs":[[0,"     }))"],[1,";"],[0,"\n       "]],"start1":1338,"start2":1338,"length1":16,"length2":17},{"diffs":[[0,"();\n            "],[1,"//"],[0,"var statusCollec"]],"start1":1694,"start2":1694,"length1":32,"length2":34}]],"length":2077,"saved":false}</div></li>
 <li>.c9revisions/public/js/views/profile.js.c9save<div>diff --git a/.c9revisions/public/js/views/profile.js.c9save b/.c9revisions/public/js/views/profile.js.c9save
index 120d0a9..271c874 100644
--- a/.c9revisions/public/js/views/profile.js.c9save
+++ b/.c9revisions/public/js/views/profile.js.c9save
@@ -3,3 +3,6 @@
 {"contributors":[],"silentsave":false,"ts":1358111245182,"patch":[[{"diffs":[[0,"e.html',"],[-1,"\n       "],[0," 'text!t"]],"start1":47,"start2":47,"length1":24,"length2":16},{"diffs":[[0,"Status',"],[-1,"\n       "],[0," 'views/"]],"start1":94,"start2":94,"length1":24,"length2":16},{"diffs":[[0,"atus'],\n"],[1,"\n"],[0,"function"]],"start1":112,"start2":112,"length1":16,"length2":17},{"diffs":[[0,"NetView,"],[-1," "],[0," profile"]],"start1":136,"start2":136,"length1":17,"length2":16},{"diffs":[[0,"mplate,\n"],[-1,"         "],[0,"statusTe"]],"start1":154,"start2":154,"length1":25,"length2":16},{"diffs":[[0,"iew)"],[-1,"\n"],[1," "],[0,"{\n"],[1,"  "],[0,"  va"]],"start1":193,"start2":193,"length1":11,"length2":13},{"diffs":[[0,"d({\n    "],[1,"  "],[1,"  "],[0,"el: $('#"]],"start1":241,"start2":241,"length1":16,"length2":20},{"diffs":[[0,"ent'),\n\n"],[1,"    "],[0,"    even"]],"start1":265,"start2":265,"length1":16,"length2":20},{"diffs":[[0,"{\n      "],[1,"     "],[1," "],[0,"\"submit "]],"start1":289,"start2":289,"length1":16,"length2":22},{"diffs":[[0,"Status\"\n"],[1,"    "],[0,"    },\n\n"]],"start1":323,"start2":323,"length1":16,"length2":20},{"diffs":[[0,"},\n\n    "],[1," "],[1,"   "],[0,"initiali"]],"start1":339,"start2":339,"length1":16,"length2":20},{"diffs":[[0,"function"],[-1," "],[0,"(options"]],"start1":363,"start2":363,"length1":17,"length2":16},{"diffs":[[0,"ns) {\n      "],[1," "],[1,"     "],[0,"this.socketE"]],"start1":377,"start2":377,"length1":24,"length2":30},{"diffs":[[0,"Events;\n"],[1,"      "],[0,"      th"]],"start1":429,"start2":429,"length1":16,"length2":22},{"diffs":[[0," this);\n    "],[-1,"},\n\n"],[1,"    },\n\n    "],[0,"    postStat"]],"start1":487,"start2":487,"length1":28,"length2":36},{"diffs":[[0,"n() {\n      "],[1,"   "],[1,"   "],[0,"var that = t"]],"start1":534,"start2":534,"length1":24,"length2":30},{"diffs":[[0,"hat = this;\n"],[1,"      "],[0,"      var st"]],"start1":557,"start2":557,"length1":24,"length2":30},{"diffs":[[0,"al();\n      "],[1," "],[1,"     "],[0,"var statusCo"]],"start1":623,"start2":623,"length1":24,"length2":30},{"diffs":[[0,"ection;\n"],[1,"      "],[0,"      $."]],"start1":673,"start2":673,"length1":16,"length2":22},{"diffs":[[0,"tus', {\n"],[1,"        "],[0,"        "]],"start1":744,"start2":744,"length1":16,"length2":24},{"diffs":[[0,"sText\n      "],[1,"   "],[1,"   "],[0,"});\n"],[1,"      "],[0,"      return"]],"start1":781,"start2":781,"length1":28,"length2":40},{"diffs":[[0," false;\n    "],[1,"  "],[1,"  "],[0,"},\n\n"],[1,"    "],[0,"    onSocket"]],"start1":821,"start2":821,"length1":28,"length2":36},{"diffs":[[0,"ta) {\n      "],[1,"     "],[1," "],[0,"var newStatu"]],"start1":881,"start2":881,"length1":24,"length2":30},{"diffs":[[0,"data;\n      "],[1,"     "],[1," "],[0,"this.prepend"]],"start1":920,"start2":920,"length1":24,"length2":30},{"diffs":[[0,"Status({"],[1,"\n                "],[0,"status:"],[1," "],[0,"newStatu"]],"start1":961,"start2":961,"length1":23,"length2":41},{"diffs":[[0,"tus,"],[1,"\n                "],[0,"name:"],[1," "],[0,"newS"]],"start1":1007,"start2":1007,"length1":13,"length2":31},{"diffs":[[0,"name"],[1,"\n            "],[0,"}))\n    "],[1,"   "],[1," "],[0,"},\n\n"],[1,"    "],[0,"    "]],"start1":1044,"start2":1044,"length1":20,"length2":41},{"diffs":[[0,"el) {\n      "],[1," "],[1,"     "],[0,"var statusHt"]],"start1":1118,"start2":1118,"length1":24,"length2":30},{"diffs":[[0,"usView({"],[1,"\n               "],[0," model: "]],"start1":1162,"start2":1162,"length1":16,"length2":32},{"diffs":[[0,"tusModel"],[1,"\n           "],[0," })).ren"]],"start1":1197,"start2":1197,"length1":16,"length2":28},{"diffs":[[0,"r().el;\n"],[1,"      "],[0,"      $("]],"start1":1227,"start2":1227,"length1":16,"length2":22},{"diffs":[[0,"In('slow');\n"],[1,"    "],[0,"    },\n\n    "]],"start1":1298,"start2":1298,"length1":24,"length2":28},{"diffs":[[0,"},\n\n    "],[1," "],[1,"   "],[0,"render: "]],"start1":1318,"start2":1318,"length1":16,"length2":20},{"diffs":[[0,"unction() {\n"],[1,"      "],[0,"      if ( t"]],"start1":1339,"start2":1339,"length1":24,"length2":30},{"diffs":[[0,"    if ("],[-1," "],[0,"this.mod"]],"start1":1359,"start2":1359,"length1":17,"length2":16},{"diffs":[[0,"t('_id')) {\n"],[1,"        "],[0,"        this"]],"start1":1380,"start2":1380,"length1":24,"length2":32},{"diffs":[[0,"ed, this"],[-1," "],[0,");\n     "]],"start1":1488,"start2":1488,"length1":17,"length2":16},{"diffs":[[0,"his);\n      "],[1,"  "],[-1,"}\n"],[1,"    }\n      "],[0,"      var th"]],"start1":1493,"start2":1493,"length1":26,"length2":38},{"diffs":[[0,"this;\n      "],[1," "],[1,"     "],[0,"this.$el.htm"]],"start1":1536,"start2":1536,"length1":24,"length2":30},{"diffs":[[0,"        "],[1," "],[1,"   "],[0,"_.templa"]],"start1":1569,"start2":1569,"length1":16,"length2":20},{"diffs":[[0,"emplate,"],[1," "],[0,"this.mod"]],"start1":1600,"start2":1600,"length1":16,"length2":17},{"diffs":[[0,"N())"],[1,")"],[1,";\n"],[0,"\n      "],[-1,");\n\n"],[0,"    "]],"start1":1625,"start2":1625,"length1":19,"length2":18},{"diffs":[[0,"('status');\n"],[1,"      "],[0,"      if ( n"]],"start1":1682,"start2":1682,"length1":24,"length2":30},{"diffs":[[0,"    if ("],[-1," "],[0,"null != "]],"start1":1702,"start2":1702,"length1":17,"length2":16},{"diffs":[[0,"tion"],[-1," "],[0,") {\n"],[1,"        "],[0,"    "]],"start1":1730,"start2":1730,"length1":13,"length2":20},{"diffs":[[0,"function"],[-1," "],[0,"(statusJ"]],"start1":1779,"start2":1779,"length1":17,"length2":16},{"diffs":[[0,"atusJson) {\n"],[1,"          "],[0,"          va"]],"start1":1790,"start2":1790,"length1":24,"length2":34},{"diffs":[[0,"sJson);\n"],[1,"          "],[0,"        "]],"start1":1856,"start2":1856,"length1":16,"length2":26},{"diffs":[[0,"    "],[1," "],[-1,"});\n      }\n"],[1,"       });\n            }\n   "],[0,"    "],[1," "],[0,"}\n"],[1,"  "],[0,"  });\n\n"],[1,"  "],[0,"  re"]],"start1":1921,"start2":1921,"length1":33,"length2":55}]],"length":1998,"saved":false}
 {"contributors":[],"silentsave":false,"ts":1358118756600,"patch":[[{"diffs":[[0,"eIn("],[-1,"'slow'"],[0,");\n "]],"start1":1297,"start2":1297,"length1":14,"length2":8},{"diffs":[[0,"(null !="],[1,"="],[0," statusC"]],"start1":1703,"start2":1703,"length1":16,"length2":17}]],"length":1993,"saved":false}
 {"ts":1358118775975,"patch":[[{"diffs":[[0,") {\n            "],[1,"//"],[0,"var that = this;"]],"start1":536,"start2":536,"length1":32,"length2":34},{"diffs":[[0,"();\n            "],[1,"//"],[0,"var statusCollec"]],"start1":627,"start2":627,"length1":32,"length2":34}]],"length":1997,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364747463763,"patch":[[{"diffs":[[0,"s.model."],[-1,"bind"],[1,"on"],[0,"('change"]],"start1":452,"start2":452,"length1":20,"length2":18},{"diffs":[[0,"nts."],[-1,"bind"],[1,"on"],[0,"('st"]],"start1":1418,"start2":1418,"length1":12,"length2":10}]],"length":1993,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364762420685,"patch":[[{"diffs":[[0,"     }))"],[1,";"],[0,"\n       "]],"start1":1058,"start2":1058,"length1":16,"length2":17},{"diffs":[[0,";\n            }\n"],[1,"\n"],[0,"            var "]],"start1":1492,"start2":1492,"length1":32,"length2":33}]],"length":1995,"saved":false}
+{"ts":1364762444915,"patch":[[{"diffs":[[0,"emplate,"],[-1,"\n"],[1," "],[0,"statusTe"]],"start1":153,"start2":153,"length1":17,"length2":17}]],"length":1995,"saved":false}</div></li>
 <li>.c9revisions/public/js/views/register.js.c9save<div>diff --git a/.c9revisions/public/js/views/register.js.c9save b/.c9revisions/public/js/views/register.js.c9save
index 4a383cc..2527908 100644
--- a/.c9revisions/public/js/views/register.js.c9save
+++ b/.c9revisions/public/js/views/register.js.c9save
@@ -2,3 +2,4 @@
 {"contributors":[],"silentsave":false,"ts":1358111251594,"patch":[[{"diffs":[[0,"late) {\n"],[1,"  "],[0,"  var re"]],"start1":94,"start2":94,"length1":16,"length2":18},{"diffs":[[0,"xtend({\n"],[1,"    "],[0,"    requ"]],"start1":140,"start2":140,"length1":16,"length2":20},{"diffs":[[0,"e,\n\n"],[-1,"\t"],[1,"        "],[0,"el: "]],"start1":174,"start2":174,"length1":9,"length2":16},{"diffs":[[0,"ent'),\n\n"],[1,"    "],[0,"    even"]],"start1":198,"start2":198,"length1":16,"length2":20},{"diffs":[[0,"ents: {\n"],[1,"      "],[0,"      \"s"]],"start1":216,"start2":216,"length1":16,"length2":22},{"diffs":[[0,"gister\"\n"],[1,"    "],[0,"    },\n\n"]],"start1":254,"start2":254,"length1":16,"length2":20},{"diffs":[[0,"},\n\n    "],[1," "],[1,"   "],[0,"register"]],"start1":270,"start2":270,"length1":16,"length2":20},{"diffs":[[0,"{\n      "],[1,"     "],[1," "],[0,"$.post('"]],"start1":303,"start2":303,"length1":16,"length2":22},{"diffs":[[0,"        "],[1,"      "],[1,"  "],[0,"firstNam"]],"start1":339,"start2":339,"length1":16,"length2":24},{"diffs":[[0,"        "],[1,"      "],[1,"  "],[0,"lastName"]],"start1":400,"start2":400,"length1":16,"length2":24},{"diffs":[[0,"        "],[1,"     "],[1,"   "],[0,"email: $"]],"start1":459,"start2":459,"length1":16,"length2":24},{"diffs":[[0,"        "],[1,"     "],[1,"   "],[0,"password"]],"start1":512,"start2":512,"length1":16,"length2":24},{"diffs":[[0,",\n      "],[1,"    "],[1,"  "],[0,"}, funct"]],"start1":569,"start2":569,"length1":16,"length2":22},{"diffs":[[0,"        "],[1,"      "],[1,"  "],[0,"console."]],"start1":603,"start2":603,"length1":16,"length2":24},{"diffs":[[0,";\n      "],[1,"     "],[1," "],[0,"});\n"],[1,"      "],[0,"      re"]],"start1":636,"start2":636,"length1":20,"length2":32},{"diffs":[[0," false;\n    "],[-1,"},\n\n"],[1,"    },\n\n    "],[0,"    render: "]],"start1":672,"start2":672,"length1":28,"length2":36},{"diffs":[[0,"unction() {\n"],[1,"      "],[0,"      this.$"]],"start1":709,"start2":709,"length1":24,"length2":30},{"diffs":[[0,"e);\n"],[1,"    "],[0,"    }\n"],[1,"  "],[0,"  });\n\n"],[1,"  "],[0,"  re"]],"start1":762,"start2":762,"length1":21,"length2":29}]],"length":814,"saved":false}
 {"contributors":[],"silentsave":false,"ts":1358116894381,"patch":[[{"diffs":[[0,"       }"],[-1,", "],[1,").done("],[0,"function"]],"start1":576,"start2":576,"length1":18,"length2":23},{"diffs":[[0,"ole.log("],[-1,"data"],[1,"'register:success');\n                window.location.hash = 'login';\n            }).fail(function() {\n                console.log('register:fail'"],[0,");\n     "]],"start1":628,"start2":628,"length1":20,"length2":161}]],"length":960,"saved":false}
 {"ts":1358116921028,"patch":[[{"diffs":[[0,").fail(function("],[1,"data"],[0,") {\n            "]],"start1":718,"start2":718,"length1":32,"length2":36},{"diffs":[[0,"ter:fail"],[-1,"'"],[1,"code: '+data"],[0,");\n     "]],"start1":776,"start2":776,"length1":17,"length2":28}]],"length":975,"saved":false}
+{"contributors":[],"silentsave":false,"ts":1364762648611,"patch":[[{"diffs":[[0,"        "],[1,"var post="],[0," $.post("]],"start1":308,"start2":308,"length1":16,"length2":25},{"diffs":[[0,"ter', {\n"],[-1,""],[0,"        "]],"start1":340,"start2":340,"length1":16,"length2":16},{"diffs":[[0,"      })"],[1,";\n            \n            post"],[0,".done(fu"]],"start1":586,"start2":586,"length1":16,"length2":47},{"diffs":[[0,"      })"],[1,";\n            \n            post"],[0,".fail(fu"]],"start1":751,"start2":751,"length1":16,"length2":47},{"diffs":[[0,"+data);\n"],[-1,""],[0,"        "]],"start1":862,"start2":862,"length1":16,"length2":16},{"diffs":[[0,"            });\n"],[1,"\n"],[0,"            retu"]],"start1":870,"start2":870,"length1":32,"length2":33}]],"length":1047,"saved":false}</div></li>
 <li>component.json<div>diff --git a/component.json b/component.json
index 0b4eaa2..6c03958 100644
--- a/component.json
+++ b/component.json
@@ -3,11 +3,11 @@
   "description": "Node Mongo Backbone Sample",
   "version": "0.0.1",
   "dependencies": {
-    "backbone": "~0.9.10",
+    "backbone": "~1.0.0",
     "underscore": "~1.4.4",
-    "text": "git://github.com/requirejs/text.git#~2.0.3",
+    "requirejs-text": "~2.0.5",
     "requirejs": "~2.1.2",
     "bootstrap": "~2.3.1",
-    "jquery": ">=1.9.1",
-    }
+    "jquery": "~1.9.1"
+  }
 }
\ No newline at end of file</div></li>
 <li>gitlog.sh<div>diff --git a/gitlog.sh b/gitlog.sh
index caf7d0f..bbca764 100755
--- a/gitlog.sh
+++ b/gitlog.sh
@@ -1,5 +1,5 @@
 #!/bin/sh
-revlist=$(git rev-list -4 HEAD)
+revlist=$(git rev-list -12 HEAD)
 (
 echo $"<!DOCTYPE html>
 <html></div></li>
 <li>public/components/backbone/.npmignore<div>diff --git a/public/components/backbone/.npmignore b/public/components/backbone/.npmignore
index 62947b3..6bcb69f 100644
--- a/public/components/backbone/.npmignore
+++ b/public/components/backbone/.npmignore
@@ -4,3 +4,4 @@ docs/
 raw/
 examples/
 index.html
+.jshintrc</div></li>
 <li>public/components/backbone/CONTRIBUTING.md<div>diff --git a/public/components/backbone/CONTRIBUTING.md b/public/components/backbone/CONTRIBUTING.md
index 7a09e32..5f4ff1a 100644
--- a/public/components/backbone/CONTRIBUTING.md
+++ b/public/components/backbone/CONTRIBUTING.md
@@ -1,11 +1,17 @@
 ## How to contribute to Backbone.js
 
-* Before you open a ticket or send a pull request, [search](https://github.com/documentcloud/backbone/issues) for previous discussions about the same feature or issue. Add to the earlier ticket if you find one.
+* Before you open a ticket or send a pull request,
+[search](https://github.com/documentcloud/backbone/issues) for previous
+discussions about the same feature or issue. Add to the earlier ticket if you
+find one.
 
-* Before sending a pull request for a feature or bug fix, be sure to have [tests](http://backbonejs.org/test/test.html).
+* Before sending a pull request for a feature or bug fix, be sure to have
+[tests](http://backbonejs.org/test/test.html).
 
-* If your pull request affects Backbone's public API, make relevant changes to the [documentation](https://github.com/documentcloud/backbone/blob/master/index.html). If appropriate, also add a line in the "Change Log" section.
+* Use the same coding style as the rest of the
+[codebase](https://github.com/documentcloud/backbone/blob/master/backbone.js).
 
-* Use the same coding style as the rest of the [codebase](https://github.com/documentcloud/backbone/blob/master/backbone.js).
+* In your pull request, do not add documentation or rebuild the minified
+`backbone-min.js` file. We'll do that before cutting a new release.
 
-* In your pull request, do not re-build the minified `backbone-min.js` file. We'll do that before cutting a new release.
+* All pull requests should be made to the `master` branch.</div></li>
 <li>public/components/backbone/LICENSE<div>diff --git a/public/components/backbone/LICENSE b/public/components/backbone/LICENSE
index f79bb00..dda0a58 100644
--- a/public/components/backbone/LICENSE
+++ b/public/components/backbone/LICENSE
@@ -1,4 +1,4 @@
-Copyright (c) 2010-2012 Jeremy Ashkenas, DocumentCloud
+Copyright (c) 2010-2013 Jeremy Ashkenas, DocumentCloud
 
 Permission is hereby granted, free of charge, to any person
 obtaining a copy of this software and associated documentation
@@ -19,4 +19,4 @@ NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
-OTHER DEALINGS IN THE SOFTWARE.
\ No newline at end of file
+OTHER DEALINGS IN THE SOFTWARE.</div></li>
 <li>public/components/backbone/Rakefile<div>diff --git a/public/components/backbone/Rakefile b/public/components/backbone/Rakefile
index d8f951c..e972364 100644
--- a/public/components/backbone/Rakefile
+++ b/public/components/backbone/Rakefile
@@ -1,26 +1,13 @@
-require 'rubygems'
-
-HEADER = /((^\s*\/\/.*\n)+)/
-
 desc "rebuild the backbone-min.js files for distribution"
 task :build do
-  begin
-    require 'closure-compiler'
-  rescue LoadError
-    puts "closure-compiler not found.\nInstall it by running 'gem install closure-compiler'"
-    exit
-  end
-  source = File.read 'backbone.js'
-  header = source.match(HEADER)
-  File.open('backbone-min.js', 'w+') do |file|
-    file.write header[1].squeeze(' ') + Closure::Compiler.new.compress(source)
-  end
+  check 'uglifyjs', 'UglifyJS', 'https://github.com/mishoo/UglifyJS2'
+  system 'uglifyjs backbone.js --source-map backbone-min.map -o backbone-min.js'
 end
 
 desc "build the docco documentation"
 task :doc do
   check 'docco', 'docco', 'https://github.com/jashkenas/docco'
-  system 'docco backbone.js && docco examples/todos/todos.js examples/backbone-localstorage.js'
+  system 'docco backbone.js && docco examples/todos/todos.js examples/backbone.localstorage.js'
 end
 
 desc "run JavaScriptLint on the source"
@@ -29,12 +16,6 @@ task :lint do
   system "jsl -nofilelisting -nologo -conf docs/jsl.conf -process backbone.js"
 end
 
-desc "test the CoffeeScript integration"
-task :test do
-  check 'coffee', 'CoffeeScript', 'http://coffeescript.org/'
-  system "coffee test/*.coffee"
-end
-
 # Check for the existence of an executable.
 def check(exec, name, url)
   return unless `which #{exec}`.empty?</div></li>
 <li>public/components/backbone/backbone-min.js<div>diff --git a/public/components/backbone/backbone-min.js b/public/components/backbone/backbone-min.js
index d4b0314..7243e5f 100644
--- a/public/components/backbone/backbone-min.js
+++ b/public/components/backbone/backbone-min.js
@@ -1,42 +1,4 @@
-// Backbone.js 0.9.10
-
-// (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
-// Backbone may be freely distributed under the MIT license.
-// For all details and documentation:
-// http://backbonejs.org
-(function(){var n=this,B=n.Backbone,h=[],C=h.push,u=h.slice,D=h.splice,g;g="undefined"!==typeof exports?exports:n.Backbone={};g.VERSION="0.9.10";var f=n._;!f&&"undefined"!==typeof require&&(f=require("underscore"));g.$=n.jQuery||n.Zepto||n.ender;g.noConflict=function(){n.Backbone=B;return this};g.emulateHTTP=!1;g.emulateJSON=!1;var v=/\s+/,q=function(a,b,c,d){if(!c)return!0;if("object"===typeof c)for(var e in c)a[b].apply(a,[e,c[e]].concat(d));else if(v.test(c)){c=c.split(v);e=0;for(var f=c.length;e<
-f;e++)a[b].apply(a,[c[e]].concat(d))}else return!0},w=function(a,b){var c,d=-1,e=a.length;switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);break;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,b[0]);break;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,b[0],b[1]);break;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,b[0],b[1],b[2]);break;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},h=g.Events={on:function(a,b,c){if(!q(this,"on",a,[b,c])||!b)return this;this._events||(this._events=
-{});(this._events[a]||(this._events[a]=[])).push({callback:b,context:c,ctx:c||this});return this},once:function(a,b,c){if(!q(this,"once",a,[b,c])||!b)return this;var d=this,e=f.once(function(){d.off(a,e);b.apply(this,arguments)});e._callback=b;this.on(a,e,c);return this},off:function(a,b,c){var d,e,t,g,j,l,k,h;if(!this._events||!q(this,"off",a,[b,c]))return this;if(!a&&!b&&!c)return this._events={},this;g=a?[a]:f.keys(this._events);j=0;for(l=g.length;j<l;j++)if(a=g[j],d=this._events[a]){t=[];if(b||
-c){k=0;for(h=d.length;k<h;k++)e=d[k],(b&&b!==e.callback&&b!==e.callback._callback||c&&c!==e.context)&&t.push(e)}this._events[a]=t}return this},trigger:function(a){if(!this._events)return this;var b=u.call(arguments,1);if(!q(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;c&&w(c,b);d&&w(d,arguments);return this},listenTo:function(a,b,c){var d=this._listeners||(this._listeners={}),e=a._listenerId||(a._listenerId=f.uniqueId("l"));d[e]=a;a.on(b,"object"===typeof b?this:c,this);
-return this},stopListening:function(a,b,c){var d=this._listeners;if(d){if(a)a.off(b,"object"===typeof b?this:c,this),!b&&!c&&delete d[a._listenerId];else{"object"===typeof b&&(c=this);for(var e in d)d[e].off(b,c,this);this._listeners={}}return this}}};h.bind=h.on;h.unbind=h.off;f.extend(g,h);var r=g.Model=function(a,b){var c,d=a||{};this.cid=f.uniqueId("c");this.attributes={};b&&b.collection&&(this.collection=b.collection);b&&b.parse&&(d=this.parse(d,b)||{});if(c=f.result(this,"defaults"))d=f.defaults({},
-d,c);this.set(d,b);this.changed={};this.initialize.apply(this,arguments)};f.extend(r.prototype,h,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},sync:function(){return g.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return f.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,c){var d,e,g,p,j,l,k;if(null==a)return this;"object"===typeof a?(e=a,c=b):(e={})[a]=b;c||(c={});
-if(!this._validate(e,c))return!1;g=c.unset;p=c.silent;a=[];j=this._changing;this._changing=!0;j||(this._previousAttributes=f.clone(this.attributes),this.changed={});k=this.attributes;l=this._previousAttributes;this.idAttribute in e&&(this.id=e[this.idAttribute]);for(d in e)b=e[d],f.isEqual(k[d],b)||a.push(d),f.isEqual(l[d],b)?delete this.changed[d]:this.changed[d]=b,g?delete k[d]:k[d]=b;if(!p){a.length&&(this._pending=!0);b=0;for(d=a.length;b<d;b++)this.trigger("change:"+a[b],this,k[a[b]],c)}if(j)return this;
-if(!p)for(;this._pending;)this._pending=!1,this.trigger("change",this,c);this._changing=this._pending=!1;return this},unset:function(a,b){return this.set(a,void 0,f.extend({},b,{unset:!0}))},clear:function(a){var b={},c;for(c in this.attributes)b[c]=void 0;return this.set(b,f.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!f.isEmpty(this.changed):f.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this.changed):!1;var b,c=!1,d=this._changing?
-this._previousAttributes:this.attributes,e;for(e in a)if(!f.isEqual(d[e],b=a[e]))(c||(c={}))[e]=b;return c},previous:function(a){return null==a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return f.clone(this._previousAttributes)},fetch:function(a){a=a?f.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=a.success;a.success=function(a,d,e){if(!a.set(a.parse(d,e),e))return!1;b&&b(a,d,e)};return this.sync("read",this,a)},save:function(a,b,c){var d,e,g=this.attributes;
-null==a||"object"===typeof a?(d=a,c=b):(d={})[a]=b;if(d&&(!c||!c.wait)&&!this.set(d,c))return!1;c=f.extend({validate:!0},c);if(!this._validate(d,c))return!1;d&&c.wait&&(this.attributes=f.extend({},g,d));void 0===c.parse&&(c.parse=!0);e=c.success;c.success=function(a,b,c){a.attributes=g;var k=a.parse(b,c);c.wait&&(k=f.extend(d||{},k));if(f.isObject(k)&&!a.set(k,c))return!1;e&&e(a,b,c)};a=this.isNew()?"create":c.patch?"patch":"update";"patch"===a&&(c.attrs=d);a=this.sync(a,this,c);d&&c.wait&&(this.attributes=
-g);return a},destroy:function(a){a=a?f.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};a.success=function(a,b,e){(e.wait||a.isNew())&&d();c&&c(a,b,e)};if(this.isNew())return a.success(this,null,a),!1;var e=this.sync("delete",this,a);a.wait||d();return e},url:function(){var a=f.result(this,"urlRoot")||f.result(this.collection,"url")||x();return this.isNew()?a:a+("/"===a.charAt(a.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this.attributes)},
-isNew:function(){return null==this.id},isValid:function(a){return!this.validate||!this.validate(this.attributes,a)},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=f.extend({},this.attributes,a);var c=this.validationError=this.validate(a,b)||null;if(!c)return!0;this.trigger("invalid",this,c,b||{});return!1}});var s=g.Collection=function(a,b){b||(b={});b.model&&(this.model=b.model);void 0!==b.comparator&&(this.comparator=b.comparator);this.models=[];this._reset();this.initialize.apply(this,
-arguments);a&&this.reset(a,f.extend({silent:!0},b))};f.extend(s.prototype,h,{model:r,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return g.sync.apply(this,arguments)},add:function(a,b){a=f.isArray(a)?a.slice():[a];b||(b={});var c,d,e,g,p,j,l,k,h,m;l=[];k=b.at;h=this.comparator&&null==k&&!1!=b.sort;m=f.isString(this.comparator)?this.comparator:null;c=0;for(d=a.length;c<d;c++)(e=this._prepareModel(g=a[c],b))?(p=this.get(e))?b.merge&&(p.set(g===
-e?e.attributes:g,b),h&&(!j&&p.hasChanged(m))&&(j=!0)):(l.push(e),e.on("all",this._onModelEvent,this),this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e)):this.trigger("invalid",this,g,b);l.length&&(h&&(j=!0),this.length+=l.length,null!=k?D.apply(this.models,[k,0].concat(l)):C.apply(this.models,l));j&&this.sort({silent:!0});if(b.silent)return this;c=0;for(d=l.length;c<d;c++)(e=l[c]).trigger("add",e,this,b);j&&this.trigger("sort",this,b);return this},remove:function(a,b){a=f.isArray(a)?a.slice():[a];
-b||(b={});var c,d,e,g;c=0;for(d=a.length;c<d;c++)if(g=this.get(a[c]))delete this._byId[g.id],delete this._byId[g.cid],e=this.indexOf(g),this.models.splice(e,1),this.length--,b.silent||(b.index=e,g.trigger("remove",g,this,b)),this._removeReference(g);return this},push:function(a,b){a=this._prepareModel(a,b);this.add(a,f.extend({at:this.length},b));return a},pop:function(a){var b=this.at(this.length-1);this.remove(b,a);return b},unshift:function(a,b){a=this._prepareModel(a,b);this.add(a,f.extend({at:0},
-b));return a},shift:function(a){var b=this.at(0);this.remove(b,a);return b},slice:function(a,b){return this.models.slice(a,b)},get:function(a){if(null!=a)return this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[a.id||a.cid||a[this._idAttr]||a]},at:function(a){return this.models[a]},where:function(a){return f.isEmpty(a)?[]:this.filter(function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},sort:function(a){if(!this.comparator)throw Error("Cannot sort a set without a comparator");
-a||(a={});f.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(f.bind(this.comparator,this));a.silent||this.trigger("sort",this,a);return this},pluck:function(a){return f.invoke(this.models,"get",a)},update:function(a,b){b=f.extend({add:!0,merge:!0,remove:!0},b);b.parse&&(a=this.parse(a,b));var c,d,e,g,h=[],j=[],l={};f.isArray(a)||(a=a?[a]:[]);if(b.add&&!b.remove)return this.add(a,b);d=0;for(e=a.length;d<e;d++)c=a[d],g=this.get(c),
-b.remove&&g&&(l[g.cid]=!0),(b.add&&!g||b.merge&&g)&&h.push(c);if(b.remove){d=0;for(e=this.models.length;d<e;d++)c=this.models[d],l[c.cid]||j.push(c)}j.length&&this.remove(j,b);h.length&&this.add(h,b);return this},reset:function(a,b){b||(b={});b.parse&&(a=this.parse(a,b));for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);b.previousModels=this.models.slice();this._reset();a&&this.add(a,f.extend({silent:!0},b));b.silent||this.trigger("reset",this,b);return this},fetch:function(a){a=
-a?f.clone(a):{};void 0===a.parse&&(a.parse=!0);var b=a.success;a.success=function(a,d,e){a[e.update?"update":"reset"](d,e);b&&b(a,d,e)};return this.sync("read",this,a)},create:function(a,b){b=b?f.clone(b):{};if(!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var c=this,d=b.success;b.success=function(a,b,f){f.wait&&c.add(a,f);d&&d(a,b,f)};a.save(null,b);return a},parse:function(a){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models.length=
-0;this._byId={}},_prepareModel:function(a,b){if(a instanceof r)return a.collection||(a.collection=this),a;b||(b={});b.collection=this;var c=new this.model(a,b);return!c._validate(a,b)?!1:c},_removeReference:function(a){this===a.collection&&delete a.collection;a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"===a||"remove"===a)&&c!==this||("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=
-b)),this.trigger.apply(this,arguments))},sortedIndex:function(a,b,c){b||(b=this.comparator);var d=f.isFunction(b)?b:function(a){return a.get(b)};return f.sortedIndex(this.models,a,d,c)}});f.each("forEach each map collect reduce foldl inject reduceRight foldr find detect filter select reject every all some any include contains invoke max min toArray size first head take initial rest tail drop last without indexOf shuffle lastIndexOf isEmpty chain".split(" "),function(a){s.prototype[a]=function(){var b=
-u.call(arguments);b.unshift(this.models);return f[a].apply(f,b)}});f.each(["groupBy","countBy","sortBy"],function(a){s.prototype[a]=function(b,c){var d=f.isFunction(b)?b:function(a){return a.get(b)};return f[a](this.models,d,c)}});var y=g.Router=function(a){a||(a={});a.routes&&(this.routes=a.routes);this._bindRoutes();this.initialize.apply(this,arguments)},E=/\((.*?)\)/g,F=/(\(\?)?:\w+/g,G=/\*\w+/g,H=/[\-{}\[\]+?.,\\\^$|#\s]/g;f.extend(y.prototype,h,{initialize:function(){},route:function(a,b,c){f.isRegExp(a)||
-(a=this._routeToRegExp(a));c||(c=this[b]);g.history.route(a,f.bind(function(d){d=this._extractParameters(a,d);c&&c.apply(this,d);this.trigger.apply(this,["route:"+b].concat(d));this.trigger("route",b,d);g.history.trigger("route",this,b,d)},this));return this},navigate:function(a,b){g.history.navigate(a,b);return this},_bindRoutes:function(){if(this.routes)for(var a,b=f.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])},_routeToRegExp:function(a){a=a.replace(H,"\\$&").replace(E,"(?:$1)?").replace(F,
-function(a,c){return c?a:"([^/]+)"}).replace(G,"(.*?)");return RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});var m=g.History=function(){this.handlers=[];f.bindAll(this,"checkUrl");"undefined"!==typeof window&&(this.location=window.location,this.history=window.history)},z=/^[#\/]|\s+$/g,I=/^\/+|\/+$/g,J=/msie [\w.]+/,K=/\/$/;m.started=!1;f.extend(m.prototype,h,{interval:50,getHash:function(a){return(a=(a||this).location.href.match(/#(.*)$/))?a[1]:""},getFragment:function(a,
-b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=this.location.pathname;var c=this.root.replace(K,"");a.indexOf(c)||(a=a.substr(c.length))}else a=this.getHash();return a.replace(z,"")},start:function(a){if(m.started)throw Error("Backbone.history has already been started");m.started=!0;this.options=f.extend({},{root:"/"},this.options,a);this.root=this.options.root;this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=!(!this.options.pushState||
-!this.history||!this.history.pushState);a=this.getFragment();var b=document.documentMode,b=J.exec(navigator.userAgent.toLowerCase())&&(!b||7>=b);this.root=("/"+this.root+"/").replace(I,"/");b&&this._wantsHashChange&&(this.iframe=g.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(a));if(this._hasPushState)g.$(window).on("popstate",this.checkUrl);else if(this._wantsHashChange&&"onhashchange"in window&&!b)g.$(window).on("hashchange",this.checkUrl);
-else this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval));this.fragment=a;a=this.location;b=a.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!b)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&(this._hasPushState&&b&&a.hash)&&(this.fragment=this.getHash().replace(z,""),this.history.replaceState({},document.title,
-this.root+this.fragment+a.search));if(!this.options.silent)return this.loadUrl()},stop:function(){g.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);m.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a===this.fragment&&this.iframe&&(a=this.getFragment(this.getHash(this.iframe)));if(a===this.fragment)return!1;this.iframe&&this.navigate(a);this.loadUrl()||this.loadUrl(this.getHash())},
-loadUrl:function(a){var b=this.fragment=this.getFragment(a);return f.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0})},navigate:function(a,b){if(!m.started)return!1;if(!b||!0===b)b={trigger:b};a=this.getFragment(a||"");if(this.fragment!==a){this.fragment=a;var c=this.root+a;if(this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else if(this._wantsHashChange)this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&
-(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace));else return this.location.assign(c);b.trigger&&this.loadUrl(a)}},_updateHash:function(a,b,c){c?(c=a.href.replace(/(javascript:|#).*$/,""),a.replace(c+"#"+b)):a.hash="#"+b}});g.history=new m;var A=g.View=function(a){this.cid=f.uniqueId("view");this._configure(a||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},L=/^(\S+)\s*(.*)$/,M="model collection el id attributes className tagName events".split(" ");
-f.extend(A.prototype,h,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(a,b){this.$el&&this.undelegateEvents();this.$el=a instanceof g.$?a:g.$(a);this.el=this.$el[0];!1!==b&&this.delegateEvents();return this},delegateEvents:function(a){if(a||(a=f.result(this,"events"))){this.undelegateEvents();for(var b in a){var c=a[b];f.isFunction(c)||(c=this[a[b]]);
-if(!c)throw Error('Method "'+a[b]+'" does not exist');var d=b.match(L),e=d[1],d=d[2],c=f.bind(c,this),e=e+(".delegateEvents"+this.cid);if(""===d)this.$el.on(e,c);else this.$el.on(e,d,c)}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=f.extend({},f.result(this,"options"),a));f.extend(this,f.pick(a,M));this.options=a},_ensureElement:function(){if(this.el)this.setElement(f.result(this,"el"),!1);else{var a=f.extend({},f.result(this,"attributes"));
-this.id&&(a.id=f.result(this,"id"));this.className&&(a["class"]=f.result(this,"className"));a=g.$("<"+f.result(this,"tagName")+">").attr(a);this.setElement(a,!1)}}});var N={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};g.sync=function(a,b,c){var d=N[a];f.defaults(c||(c={}),{emulateHTTP:g.emulateHTTP,emulateJSON:g.emulateJSON});var e={type:d,dataType:"json"};c.url||(e.url=f.result(b,"url")||x());if(null==c.data&&b&&("create"===a||"update"===a||"patch"===a))e.contentType="application/json",
-e.data=JSON.stringify(c.attrs||b.toJSON(c));c.emulateJSON&&(e.contentType="application/x-www-form-urlencoded",e.data=e.data?{model:e.data}:{});if(c.emulateHTTP&&("PUT"===d||"DELETE"===d||"PATCH"===d)){e.type="POST";c.emulateJSON&&(e.data._method=d);var h=c.beforeSend;c.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",d);if(h)return h.apply(this,arguments)}}"GET"!==e.type&&!c.emulateJSON&&(e.processData=!1);var m=c.success;c.success=function(a){m&&m(b,a,c);b.trigger("sync",b,a,c)};
-var j=c.error;c.error=function(a){j&&j(b,a,c);b.trigger("error",b,a,c)};a=c.xhr=g.ajax(f.extend(e,c));b.trigger("request",b,a,c);return a};g.ajax=function(){return g.$.ajax.apply(g.$,arguments)};r.extend=s.extend=y.extend=A.extend=m.extend=function(a,b){var c=this,d;d=a&&f.has(a,"constructor")?a.constructor:function(){return c.apply(this,arguments)};f.extend(d,c,b);var e=function(){this.constructor=d};e.prototype=c.prototype;d.prototype=new e;a&&f.extend(d.prototype,a);d.__super__=c.prototype;return d};
-var x=function(){throw Error('A "url" property or function must be specified');}}).call(this);
+(function(){var root=this;var previousBackbone=root.Backbone;var array=[];var push=array.push;var slice=array.slice;var splice=array.splice;var Backbone;if(typeof exports!=="undefined"){Backbone=exports}else{Backbone=root.Backbone={}}Backbone.VERSION="1.0.0";var _=root._;if(!_&&typeof require!=="undefined")_=require("underscore");Backbone.$=root.jQuery||root.Zepto||root.ender||root.$;Backbone.noConflict=function(){root.Backbone=previousBackbone;return this};Backbone.emulateHTTP=false;Backbone.emulateJSON=false;var Events=Backbone.Events={on:function(name,callback,context){if(!eventsApi(this,"on",name,[callback,context])||!callback)return this;this._events||(this._events={});var events=this._events[name]||(this._events[name]=[]);events.push({callback:callback,context:context,ctx:context||this});return this},once:function(name,callback,context){if(!eventsApi(this,"once",name,[callback,context])||!callback)return this;var self=this;var once=_.once(function(){self.off(name,once);callback.apply(this,arguments)});once._callback=callback;return this.on(name,once,context)},off:function(name,callback,context){var retain,ev,events,names,i,l,j,k;if(!this._events||!eventsApi(this,"off",name,[callback,context]))return this;if(!name&&!callback&&!context){this._events={};return this}names=name?[name]:_.keys(this._events);for(i=0,l=names.length;i<l;i++){name=names[i];if(events=this._events[name]){this._events[name]=retain=[];if(callback||context){for(j=0,k=events.length;j<k;j++){ev=events[j];if(callback&&callback!==ev.callback&&callback!==ev.callback._callback||context&&context!==ev.context){retain.push(ev)}}}if(!retain.length)delete this._events[name]}}return this},trigger:function(name){if(!this._events)return this;var args=slice.call(arguments,1);if(!eventsApi(this,"trigger",name,args))return this;var events=this._events[name];var allEvents=this._events.all;if(events)triggerEvents(events,args);if(allEvents)triggerEvents(allEvents,arguments);return this},stopListening:function(obj,name,callback){var listeners=this._listeners;if(!listeners)return this;var deleteListener=!name&&!callback;if(typeof name==="object")callback=this;if(obj)(listeners={})[obj._listenerId]=obj;for(var id in listeners){listeners[id].off(name,callback,this);if(deleteListener)delete this._listeners[id]}return this}};var eventSplitter=/\s+/;var eventsApi=function(obj,action,name,rest){if(!name)return true;if(typeof name==="object"){for(var key in name){obj[action].apply(obj,[key,name[key]].concat(rest))}return false}if(eventSplitter.test(name)){var names=name.split(eventSplitter);for(var i=0,l=names.length;i<l;i++){obj[action].apply(obj,[names[i]].concat(rest))}return false}return true};var triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:while(++i<l)(ev=events[i]).callback.call(ev.ctx);return;case 1:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:while(++i<l)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);return;default:while(++i<l)(ev=events[i]).callback.apply(ev.ctx,args)}};var listenMethods={listenTo:"on",listenToOnce:"once"};_.each(listenMethods,function(implementation,method){Events[method]=function(obj,name,callback){var listeners=this._listeners||(this._listeners={});var id=obj._listenerId||(obj._listenerId=_.uniqueId("l"));listeners[id]=obj;if(typeof name==="object")callback=this;obj[implementation](name,callback,this);return this}});Events.bind=Events.on;Events.unbind=Events.off;_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var defaults;var attrs=attributes||{};options||(options={});this.cid=_.uniqueId("c");this.attributes={};_.extend(this,_.pick(options,modelOptions));if(options.parse)attrs=this.parse(attrs,options)||{};if(defaults=_.result(this,"defaults")){attrs=_.defaults({},attrs,defaults)}this.set(attrs,options);this.changed={};this.initialize.apply(this,arguments)};var modelOptions=["url","urlRoot","collection"];_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(options){return _.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(attr){return this.attributes[attr]},escape:function(attr){return _.escape(this.get(attr))},has:function(attr){return this.get(attr)!=null},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,prev,current;if(key==null)return this;if(typeof key==="object"){attrs=key;options=val}else{(attrs={})[key]=val}options||(options={});if(!this._validate(attrs,options))return false;unset=options.unset;silent=options.silent;changes=[];changing=this._changing;this._changing=true;if(!changing){this._previousAttributes=_.clone(this.attributes);this.changed={}}current=this.attributes,prev=this._previousAttributes;if(this.idAttribute in attrs)this.id=attrs[this.idAttribute];for(attr in attrs){val=attrs[attr];if(!_.isEqual(current[attr],val))changes.push(attr);if(!_.isEqual(prev[attr],val)){this.changed[attr]=val}else{delete this.changed[attr]}unset?delete current[attr]:current[attr]=val}if(!silent){if(changes.length)this._pending=true;for(var i=0,l=changes.length;i<l;i++){this.trigger("change:"+changes[i],this,current[changes[i]],options)}}if(changing)return this;if(!silent){while(this._pending){this._pending=false;this.trigger("change",this,options)}}this._pending=false;this._changing=false;return this},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:true}))},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:true}))},hasChanged:function(attr){if(attr==null)return!_.isEmpty(this.changed);return _.has(this.changed,attr)},changedAttributes:function(diff){if(!diff)return this.hasChanged()?_.clone(this.changed):false;var val,changed=false;var old=this._changing?this._previousAttributes:this.attributes;for(var attr in diff){if(_.isEqual(old[attr],val=diff[attr]))continue;(changed||(changed={}))[attr]=val}return changed},previous:function(attr){if(attr==null||!this._previousAttributes)return null;return this._previousAttributes[attr]},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var model=this;var success=options.success;options.success=function(resp){if(!model.set(model.parse(resp,options),options))return false;if(success)success(model,resp,options);model.trigger("sync",model,resp,options)};wrapError(this,options);return this.sync("read",this,options)},save:function(key,val,options){var attrs,method,xhr,attributes=this.attributes;if(key==null||typeof key==="object"){attrs=key;options=val}else{(attrs={})[key]=val}if(attrs&&(!options||!options.wait)&&!this.set(attrs,options))return false;options=_.extend({validate:true},options);if(!this._validate(attrs,options))return false;if(attrs&&options.wait){this.attributes=_.extend({},attributes,attrs)}if(options.parse===void 0)options.parse=true;var model=this;var success=options.success;options.success=function(resp){model.attributes=attributes;var serverAttrs=model.parse(resp,options);if(options.wait)serverAttrs=_.extend(attrs||{},serverAttrs);if(_.isObject(serverAttrs)&&!model.set(serverAttrs,options)){return false}if(success)success(model,resp,options);model.trigger("sync",model,resp,options)};wrapError(this,options);method=this.isNew()?"create":options.patch?"patch":"update";if(method==="patch")options.attrs=attrs;xhr=this.sync(method,this,options);if(attrs&&options.wait)this.attributes=attributes;return xhr},destroy:function(options){options=options?_.clone(options):{};var model=this;var success=options.success;var destroy=function(){model.trigger("destroy",model,model.collection,options)};options.success=function(resp){if(options.wait||model.isNew())destroy();if(success)success(model,resp,options);if(!model.isNew())model.trigger("sync",model,resp,options)};if(this.isNew()){options.success();return false}wrapError(this,options);var xhr=this.sync("delete",this,options);if(!options.wait)destroy();return xhr},url:function(){var base=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError();if(this.isNew())return base;return base+(base.charAt(base.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(options){return this._validate({},_.extend(options||{},{validate:true}))},_validate:function(attrs,options){if(!options.validate||!this.validate)return true;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;if(!error)return true;this.trigger("invalid",this,error,_.extend(options||{},{validationError:error}));return false}});var modelMethods=["keys","values","pairs","invert","pick","omit"];_.each(modelMethods,function(method){Model.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.attributes);return _[method].apply(_,args)}});var Collection=Backbone.Collection=function(models,options){options||(options={});if(options.url)this.url=options.url;if(options.model)this.model=options.model;if(options.comparator!==void 0)this.comparator=options.comparator;this._reset();this.initialize.apply(this,arguments);if(models)this.reset(models,_.extend({silent:true},options))};var setOptions={add:true,remove:true,merge:true};var addOptions={add:true,merge:false,remove:false};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(models,options){return this.set(models,_.defaults(options||{},addOptions))},remove:function(models,options){models=_.isArray(models)?models.slice():[models];options||(options={});var i,l,index,model;for(i=0,l=models.length;i<l;i++){model=this.get(models[i]);if(!model)continue;delete this._byId[model.id];delete this._byId[model.cid];index=this.indexOf(model);this.models.splice(index,1);this.length--;if(!options.silent){options.index=index;model.trigger("remove",model,this,options)}this._removeReference(model)}return this},set:function(models,options){options=_.defaults(options||{},setOptions);if(options.parse)models=this.parse(models,options);if(!_.isArray(models))models=models?[models]:[];var i,l,model,attrs,existing,sort;var at=options.at;var sortable=this.comparator&&at==null&&options.sort!==false;var sortAttr=_.isString(this.comparator)?this.comparator:null;var toAdd=[],toRemove=[],modelMap={};for(i=0,l=models.length;i<l;i++){if(!(model=this._prepareModel(models[i],options)))continue;if(existing=this.get(model)){if(options.remove)modelMap[existing.cid]=true;if(options.merge){existing.set(model.attributes,options);if(sortable&&!sort&&existing.hasChanged(sortAttr))sort=true}}else if(options.add){toAdd.push(model);model.on("all",this._onModelEvent,this);this._byId[model.cid]=model;if(model.id!=null)this._byId[model.id]=model}}if(options.remove){for(i=0,l=this.length;i<l;++i){if(!modelMap[(model=this.models[i]).cid])toRemove.push(model)}if(toRemove.length)this.remove(toRemove,options)}if(toAdd.length){if(sortable)sort=true;this.length+=toAdd.length;if(at!=null){splice.apply(this.models,[at,0].concat(toAdd))}else{push.apply(this.models,toAdd)}}if(sort)this.sort({silent:true});if(options.silent)return this;for(i=0,l=toAdd.length;i<l;i++){(model=toAdd[i]).trigger("add",model,this,options)}if(sort)this.trigger("sort",this,options);return this},reset:function(models,options){options||(options={});for(var i=0,l=this.models.length;i<l;i++){this._removeReference(this.models[i])}options.previousModels=this.models;this._reset();this.add(models,_.extend({silent:true},options));if(!options.silent)this.trigger("reset",this,options);return this},push:function(model,options){model=this._prepareModel(model,options);this.add(model,_.extend({at:this.length},options));return model},pop:function(options){var model=this.at(this.length-1);this.remove(model,options);return model},unshift:function(model,options){model=this._prepareModel(model,options);this.add(model,_.extend({at:0},options));return model},shift:function(options){var model=this.at(0);this.remove(model,options);return model},slice:function(begin,end){return this.models.slice(begin,end)},get:function(obj){if(obj==null)return void 0;return this._byId[obj.id!=null?obj.id:obj.cid||obj]},at:function(index){return this.models[index]},where:function(attrs,first){if(_.isEmpty(attrs))return first?void 0:[];return this[first?"find":"filter"](function(model){for(var key in attrs){if(attrs[key]!==model.get(key))return false}return true})},findWhere:function(attrs){return this.where(attrs,true)},sort:function(options){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");options||(options={});if(_.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(_.bind(this.comparator,this))}if(!options.silent)this.trigger("sort",this,options);return this},sortedIndex:function(model,value,context){value||(value=this.comparator);var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _.sortedIndex(this.models,model,iterator,context)},pluck:function(attr){return _.invoke(this.models,"get",attr)},fetch:function(options){options=options?_.clone(options):{};if(options.parse===void 0)options.parse=true;var success=options.success;var collection=this;options.success=function(resp){var method=options.reset?"reset":"set";collection[method](resp,options);if(success)success(collection,resp,options);collection.trigger("sync",collection,resp,options)};wrapError(this,options);return this.sync("read",this,options)},create:function(model,options){options=options?_.clone(options):{};if(!(model=this._prepareModel(model,options)))return false;if(!options.wait)this.add(model,options);var collection=this;var success=options.success;options.success=function(resp){if(options.wait)collection.add(model,options);if(success)success(model,resp,options)};model.save(null,options);return model},parse:function(resp,options){return resp},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(attrs,options){if(attrs instanceof Model){if(!attrs.collection)attrs.collection=this;return attrs}options||(options={});options.collection=this;var model=new this.model(attrs,options);if(!model._validate(attrs,options)){this.trigger("invalid",this,attrs,options);return false}return model},_removeReference:function(model){if(this===model.collection)delete model.collection;model.off("all",this._onModelEvent,this)},_onModelEvent:function(event,model,collection,options){if((event==="add"||event==="remove")&&collection!==this)return;if(event==="destroy")this.remove(model,options);if(model&&event==="change:"+model.idAttribute){delete this._byId[model.previous(model.idAttribute)];if(model.id!=null)this._byId[model.id]=model}this.trigger.apply(this,arguments)}});var methods=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];_.each(methods,function(method){Collection.prototype[method]=function(){var args=slice.call(arguments);args.unshift(this.models);return _[method].apply(_,args)}});var attributeMethods=["groupBy","countBy","sortBy"];_.each(attributeMethods,function(method){Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _[method](this.models,iterator,context)}});var View=Backbone.View=function(options){this.cid=_.uniqueId("view");this._configure(options||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var delegateEventSplitter=/^(\S+)\s*(.*)$/;var viewOptions=["model","collection","el","id","attributes","className","tagName","events"];_.extend(View.prototype,Events,{tagName:"div",$:function(selector){return this.$el.find(selector)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();this.stopListening();return this},setElement:function(element,delegate){if(this.$el)this.undelegateEvents();this.$el=element instanceof Backbone.$?element:Backbone.$(element);this.el=this.$el[0];if(delegate!==false)this.delegateEvents();return this},delegateEvents:function(events){if(!(events||(events=_.result(this,"events"))))return this;this.undelegateEvents();for(var key in events){var method=events[key];if(!_.isFunction(method))method=this[events[key]];if(!method)continue;var match=key.match(delegateEventSplitter);var eventName=match[1],selector=match[2];method=_.bind(method,this);eventName+=".delegateEvents"+this.cid;if(selector===""){this.$el.on(eventName,method)}else{this.$el.on(eventName,selector,method)}}return this},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid);return this},_configure:function(options){if(this.options)options=_.extend({},_.result(this,"options"),options);_.extend(this,_.pick(options,viewOptions));this.options=options},_ensureElement:function(){if(!this.el){var attrs=_.extend({},_.result(this,"attributes"));if(this.id)attrs.id=_.result(this,"id");if(this.className)attrs["class"]=_.result(this,"className");var $el=Backbone.$("<"+_.result(this,"tagName")+">").attr(attrs);this.setElement($el,false)}else{this.setElement(_.result(this,"el"),false)}}});Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:"json"};if(!options.url){params.url=_.result(model,"url")||urlError()}if(options.data==null&&model&&(method==="create"||method==="update"||method==="patch")){params.contentType="application/json";params.data=JSON.stringify(options.attrs||model.toJSON(options))}if(options.emulateJSON){params.contentType="application/x-www-form-urlencoded";params.data=params.data?{model:params.data}:{}}if(options.emulateHTTP&&(type==="PUT"||type==="DELETE"||type==="PATCH")){params.type="POST";if(options.emulateJSON)params.data._method=type;var beforeSend=options.beforeSend;options.beforeSend=function(xhr){xhr.setRequestHeader("X-HTTP-Method-Override",type);if(beforeSend)return beforeSend.apply(this,arguments)}}if(params.type!=="GET"&&!options.emulateJSON){params.processData=false}if(params.type==="PATCH"&&window.ActiveXObject&&!(window.external&&window.external.msActiveXFilteringEnabled)){params.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")}}var xhr=options.xhr=Backbone.ajax(_.extend(params,options));model.trigger("request",model,xhr,options);return xhr};var methodMap={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var Router=Backbone.Router=function(options){options||(options={});if(options.routes)this.routes=options.routes;this._bindRoutes();this.initialize.apply(this,arguments)};var optionalParam=/\((.*?)\)/g;var namedParam=/(\(\?)?:\w+/g;var splatParam=/\*\w+/g;var escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){if(!_.isRegExp(route))route=this._routeToRegExp(route);if(_.isFunction(name)){callback=name;name=""}if(!callback)callback=this[name];var router=this;Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);callback&&callback.apply(router,args);router.trigger.apply(router,["route:"+name].concat(args));router.trigger("route",name,args);Backbone.history.trigger("route",router,name,args)});return this},navigate:function(fragment,options){Backbone.history.navigate(fragment,options);return this},_bindRoutes:function(){if(!this.routes)return;this.routes=_.result(this,"routes");var route,routes=_.keys(this.routes);while((route=routes.pop())!=null){this.route(route,this.routes[route])}},_routeToRegExp:function(route){route=route.replace(escapeRegExp,"\\$&").replace(optionalParam,"(?:$1)?").replace(namedParam,function(match,optional){return optional?match:"([^/]+)"}).replace(splatParam,"(.*?)");return new RegExp("^"+route+"$")},_extractParameters:function(route,fragment){var params=route.exec(fragment).slice(1);return _.map(params,function(param){return param?decodeURIComponent(param):null})}});var History=Backbone.History=function(){this.handlers=[];_.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var routeStripper=/^[#\/]|\s+$/g;var rootStripper=/^\/+|\/+$/g;var isExplorer=/msie [\w.]+/;var trailingSlash=/\/$/;History.started=false;_.extend(History.prototype,Events,{interval:50,getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:""},getFragment:function(fragment,forcePushState){if(fragment==null){if(this._hasPushState||!this._wantsHashChange||forcePushState){fragment=this.location.pathname;var root=this.root.replace(trailingSlash,"");if(!fragment.indexOf(root))fragment=fragment.substr(root.length)}else{fragment=this.getHash()}}return fragment.replace(routeStripper,"")},start:function(options){if(History.started)throw new Error("Backbone.history has already been started");History.started=true;this.options=_.extend({},{root:"/"},this.options,options);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var fragment=this.getFragment();var docMode=document.documentMode;var oldIE=isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||docMode<=7);this.root=("/"+this.root+"/").replace(rootStripper,"/");if(oldIE&&this._wantsHashChange){this.iframe=Backbone.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(fragment)}if(this._hasPushState){Backbone.$(window).on("popstate",this.checkUrl)}else if(this._wantsHashChange&&"onhashchange"in window&&!oldIE){Backbone.$(window).on("hashchange",this.checkUrl)}else if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}this.fragment=fragment;var loc=this.location;var atRoot=loc.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!atRoot){this.fragment=this.getFragment(null,true);this.location.replace(this.root+this.location.search+"#"+this.fragment);return true}else if(this._wantsPushState&&this._hasPushState&&atRoot&&loc.hash){this.fragment=this.getHash().replace(routeStripper,"");this.history.replaceState({},document.title,this.root+this.fragment+loc.search)}if(!this.options.silent)return this.loadUrl()},stop:function(){Backbone.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);History.started=false},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(e){var current=this.getFragment();if(current===this.fragment&&this.iframe){current=this.getFragment(this.getHash(this.iframe))}if(current===this.fragment)return false;if(this.iframe)this.navigate(current);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(fragmentOverride){var fragment=this.fragment=this.getFragment(fragmentOverride);var matched=_.any(this.handlers,function(handler){if(handler.route.test(fragment)){handler.callback(fragment);return true}});return matched},navigate:function(fragment,options){if(!History.started)return false;if(!options||options===true)options={trigger:options};fragment=this.getFragment(fragment||"");if(this.fragment===fragment)return;this.fragment=fragment;var url=this.root+fragment;if(this._hasPushState){this.history[options.replace?"replaceState":"pushState"]({},document.title,url)}else if(this._wantsHashChange){this._updateHash(this.location,fragment,options.replace);if(this.iframe&&fragment!==this.getFragment(this.getHash(this.iframe))){if(!options.replace)this.iframe.document.open().close();this._updateHash(this.iframe.location,fragment,options.replace)}}else{return this.location.assign(url)}if(options.trigger)this.loadUrl(fragment)},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,"");location.replace(href+"#"+fragment)}else{location.hash="#"+fragment}}});Backbone.history=new History;var extend=function(protoProps,staticProps){var parent=this;var child;if(protoProps&&_.has(protoProps,"constructor")){child=protoProps.constructor}else{child=function(){return parent.apply(this,arguments)}}_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child};Surrogate.prototype=parent.prototype;child.prototype=new Surrogate;if(protoProps)_.extend(child.prototype,protoProps);child.__super__=parent.prototype;return child};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A "url" property or function must be specified')};var wrapError=function(model,options){var error=options.error;options.error=function(resp){if(error)error(model,resp,options);model.trigger("error",model,resp,options)}}}).call(this);
+/*
+//@ sourceMappingURL=backbone-min.map
+*/
\ No newline at end of file</div></li>
 <li>public/components/backbone/backbone-min.map<div>diff --git a/public/components/backbone/backbone-min.map b/public/components/backbone/backbone-min.map
new file mode 100644
index 0000000..5d6ad35
--- /dev/null
+++ b/public/components/backbone/backbone-min.map
@@ -0,0 +1 @@
+{"version":3,"file":"backbone-min.js","sources":["backbone.js"],"names":["root","this","previousBackbone","Backbone","array","push","slice","splice","exports","VERSION","_","require","$","jQuery","Zepto","ender","noConflict","emulateHTTP","emulateJSON","Events","on","name","callback","context","eventsApi","_events","events","ctx","once","self","off","apply","arguments","_callback","retain","ev","names","i","l","j","k","keys","length","trigger","args","call","allEvents","all","triggerEvents","stopListening","obj","listeners","_listeners","deleteListener","_listenerId","id","eventSplitter","action","rest","key","concat","test","split","a1","a2","a3","listenMethods","listenTo","listenToOnce","each","implementation","method","uniqueId","bind","unbind","extend","Model","attributes","options","defaults","attrs","cid","pick","modelOptions","parse","result","set","changed","initialize","prototype","validationError","idAttribute","toJSON","clone","sync","get","attr","escape","has","val","unset","changes","silent","changing","prev","current","_validate","_changing","_previousAttributes","isEqual","_pending","clear","hasChanged","isEmpty","changedAttributes","diff","old","previous","previousAttributes","fetch","model","success","resp","wrapError","save","xhr","wait","validate","serverAttrs","isObject","isNew","patch","destroy","collection","url","base","urlError","charAt","encodeURIComponent","constructor","isValid","error","modelMethods","unshift","Collection","models","comparator","_reset","reset","setOptions","add","remove","merge","addOptions","map","isArray","index","_byId","indexOf","_removeReference","existing","sort","at","sortable","sortAttr","isString","toAdd","toRemove","modelMap","_prepareModel","_onModelEvent","previousModels","pop","shift","begin","end","where","first","findWhere","Error","sortBy","sortedIndex","value","iterator","isFunction","pluck","invoke","create","event","methods","attributeMethods","View","_configure","_ensureElement","delegateEvents","delegateEventSplitter","viewOptions","tagName","selector","$el","find","render","setElement","element","delegate","undelegateEvents","el","match","eventName","className","type","methodMap","params","dataType","data","contentType","JSON","stringify","_method","beforeSend","setRequestHeader","processData","window","ActiveXObject","external","msActiveXFilteringEnabled","ajax","update","delete","read","Router","routes","_bindRoutes","optionalParam","namedParam","splatParam","escapeRegExp","route","isRegExp","_routeToRegExp","router","history","fragment","_extractParameters","navigate","replace","optional","RegExp","exec","param","decodeURIComponent","History","handlers","bindAll","location","routeStripper","rootStripper","isExplorer","trailingSlash","started","interval","getHash","href","getFragment","forcePushState","_hasPushState","_wantsHashChange","pathname","substr","start","hashChange","_wantsPushState","pushState","docMode","document","documentMode","oldIE","navigator","userAgent","toLowerCase","iframe","hide","appendTo","contentWindow","checkUrl","_checkUrlInterval","setInterval","loc","atRoot","search","hash","replaceState","title","loadUrl","stop","clearInterval","e","fragmentOverride","matched","any","handler","_updateHash","open","close","assign","protoProps","staticProps","parent","child","Surrogate","__super__"],"mappings":"CAOA,WAOE,GAAIA,MAAOC,IAIX,IAAIC,kBAAmBF,KAAKG,QAG5B,IAAIC,SACJ,IAAIC,MAAOD,MAAMC,IACjB,IAAIC,OAAQF,MAAME,KAClB,IAAIC,QAASH,MAAMG,MAInB,IAAIJ,SACJ,UAAWK,WAAY,YAAa,CAClCL,SAAWK,YACN,CACLL,SAAWH,KAAKG,YAIlBA,SAASM,QAAU,OAGnB,IAAIC,GAAIV,KAAKU,CACb,KAAKA,SAAaC,WAAY,YAAcD,EAAIC,QAAQ,aAIxDR,UAASS,EAAIZ,KAAKa,QAAUb,KAAKc,OAASd,KAAKe,OAASf,KAAKY,CAI7DT,UAASa,WAAa,WACpBhB,KAAKG,SAAWD,gBAChB,OAAOD,MAMTE,UAASc,YAAc,KAMvBd,UAASe,YAAc,KAevB,IAAIC,QAAShB,SAASgB,QAIpBC,GAAI,SAASC,KAAMC,SAAUC,SAC3B,IAAKC,UAAUvB,KAAM,KAAMoB,MAAOC,SAAUC,YAAcD,SAAU,MAAOrB,KAC3EA,MAAKwB,UAAYxB,KAAKwB,WACtB,IAAIC,QAASzB,KAAKwB,QAAQJ,QAAUpB,KAAKwB,QAAQJ,SACjDK,QAAOrB,MAAMiB,SAAUA,SAAUC,QAASA,QAASI,IAAKJ,SAAWtB,MACnE,OAAOA,OAKT2B,KAAM,SAASP,KAAMC,SAAUC,SAC7B,IAAKC,UAAUvB,KAAM,OAAQoB,MAAOC,SAAUC,YAAcD,SAAU,MAAOrB,KAC7E,IAAI4B,MAAO5B,IACX,IAAI2B,MAAOlB,EAAEkB,KAAK,WAChBC,KAAKC,IAAIT,KAAMO,KACfN,UAASS,MAAM9B,KAAM+B,YAEvBJ,MAAKK,UAAYX,QACjB,OAAOrB,MAAKmB,GAAGC,KAAMO,KAAML,UAO7BO,IAAK,SAAST,KAAMC,SAAUC,SAC5B,GAAIW,QAAQC,GAAIT,OAAQU,MAAOC,EAAGC,EAAGC,EAAGC,CACxC,KAAKvC,KAAKwB,UAAYD,UAAUvB,KAAM,MAAOoB,MAAOC,SAAUC,UAAW,MAAOtB,KAChF,KAAKoB,OAASC,WAAaC,QAAS,CAClCtB,KAAKwB,UACL,OAAOxB,MAGTmC,MAAQf,MAAQA,MAAQX,EAAE+B,KAAKxC,KAAKwB,QACpC,KAAKY,EAAI,EAAGC,EAAIF,MAAMM,OAAQL,EAAIC,EAAGD,IAAK,CACxChB,KAAOe,MAAMC,EACb,IAAIX,OAASzB,KAAKwB,QAAQJ,MAAO,CAC/BpB,KAAKwB,QAAQJ,MAAQa,SACrB,IAAIZ,UAAYC,QAAS,CACvB,IAAKgB,EAAI,EAAGC,EAAId,OAAOgB,OAAQH,EAAIC,EAAGD,IAAK,CACzCJ,GAAKT,OAAOa,EACZ,IAAKjB,UAAYA,WAAaa,GAAGb,UAAYA,WAAaa,GAAGb,SAASW,WACjEV,SAAWA,UAAYY,GAAGZ,QAAU,CACvCW,OAAO7B,KAAK8B,MAIlB,IAAKD,OAAOQ,aAAezC,MAAKwB,QAAQJ,OAI5C,MAAOpB,OAOT0C,QAAS,SAAStB,MAChB,IAAKpB,KAAKwB,QAAS,MAAOxB,KAC1B,IAAI2C,MAAOtC,MAAMuC,KAAKb,UAAW,EACjC,KAAKR,UAAUvB,KAAM,UAAWoB,KAAMuB,MAAO,MAAO3C,KACpD,IAAIyB,QAASzB,KAAKwB,QAAQJ,KAC1B,IAAIyB,WAAY7C,KAAKwB,QAAQsB,GAC7B,IAAIrB,OAAQsB,cAActB,OAAQkB,KAClC,IAAIE,UAAWE,cAAcF,UAAWd,UACxC,OAAO/B,OAKTgD,cAAe,SAASC,IAAK7B,KAAMC,UACjC,GAAI6B,WAAYlD,KAAKmD,UACrB,KAAKD,UAAW,MAAOlD,KACvB,IAAIoD,iBAAkBhC,OAASC,QAC/B,UAAWD,QAAS,SAAUC,SAAWrB,IACzC,IAAIiD,KAAMC,cAAgBD,IAAII,aAAeJ,GAC7C,KAAK,GAAIK,MAAMJ,WAAW,CACxBA,UAAUI,IAAIzB,IAAIT,KAAMC,SAAUrB,KAClC,IAAIoD,qBAAuBpD,MAAKmD,WAAWG,IAE7C,MAAOtD,OAMX,IAAIuD,eAAgB,KAKpB,IAAIhC,WAAY,SAAS0B,IAAKO,OAAQpC,KAAMqC,MAC1C,IAAKrC,KAAM,MAAO,KAGlB,UAAWA,QAAS,SAAU,CAC5B,IAAK,GAAIsC,OAAOtC,MAAM,CACpB6B,IAAIO,QAAQ1B,MAAMmB,KAAMS,IAAKtC,KAAKsC,MAAMC,OAAOF,OAEjD,MAAO,OAIT,GAAIF,cAAcK,KAAKxC,MAAO,CAC5B,GAAIe,OAAQf,KAAKyC,MAAMN,cACvB,KAAK,GAAInB,GAAI,EAAGC,EAAIF,MAAMM,OAAQL,EAAIC,EAAGD,IAAK,CAC5Ca,IAAIO,QAAQ1B,MAAMmB,KAAMd,MAAMC,IAAIuB,OAAOF,OAE3C,MAAO,OAGT,MAAO,MAMT,IAAIV,eAAgB,SAAStB,OAAQkB,MACnC,GAAIT,IAAIE,GAAK,EAAGC,EAAIZ,OAAOgB,OAAQqB,GAAKnB,KAAK,GAAIoB,GAAKpB,KAAK,GAAIqB,GAAKrB,KAAK,EACzE,QAAQA,KAAKF,QACX,IAAK,GAAG,QAASL,EAAIC,GAAIH,GAAKT,OAAOW,IAAIf,SAASuB,KAAKV,GAAGR,IAAM,OAChE,KAAK,GAAG,QAASU,EAAIC,GAAIH,GAAKT,OAAOW,IAAIf,SAASuB,KAAKV,GAAGR,IAAKoC,GAAK,OACpE,KAAK,GAAG,QAAS1B,EAAIC,GAAIH,GAAKT,OAAOW,IAAIf,SAASuB,KAAKV,GAAGR,IAAKoC,GAAIC,GAAK,OACxE,KAAK,GAAG,QAAS3B,EAAIC,GAAIH,GAAKT,OAAOW,IAAIf,SAASuB,KAAKV,GAAGR,IAAKoC,GAAIC,GAAIC,GAAK,OAC5E,SAAS,QAAS5B,EAAIC,GAAIH,GAAKT,OAAOW,IAAIf,SAASS,MAAMI,GAAGR,IAAKiB,OAIrE,IAAIsB,gBAAiBC,SAAU,KAAMC,aAAc,OAKnD1D,GAAE2D,KAAKH,cAAe,SAASI,eAAgBC,QAC7CpD,OAAOoD,QAAU,SAASrB,IAAK7B,KAAMC,UACnC,GAAI6B,WAAYlD,KAAKmD,aAAenD,KAAKmD,cACzC,IAAIG,IAAKL,IAAII,cAAgBJ,IAAII,YAAc5C,EAAE8D,SAAS,KAC1DrB,WAAUI,IAAML,GAChB,UAAW7B,QAAS,SAAUC,SAAWrB,IACzCiD,KAAIoB,gBAAgBjD,KAAMC,SAAUrB,KACpC,OAAOA,QAKXkB,QAAOsD,KAAStD,OAAOC,EACvBD,QAAOuD,OAASvD,OAAOW,GAIvBpB,GAAEiE,OAAOxE,SAAUgB,OAYnB,IAAIyD,OAAQzE,SAASyE,MAAQ,SAASC,WAAYC,SAChD,GAAIC,SACJ,IAAIC,OAAQH,cACZC,WAAYA,WACZ7E,MAAKgF,IAAMvE,EAAE8D,SAAS,IACtBvE,MAAK4E,aACLnE,GAAEiE,OAAO1E,KAAMS,EAAEwE,KAAKJ,QAASK,cAC/B,IAAIL,QAAQM,MAAOJ,MAAQ/E,KAAKmF,MAAMJ,MAAOF,YAC7C,IAAIC,SAAWrE,EAAE2E,OAAOpF,KAAM,YAAa,CACzC+E,MAAQtE,EAAEqE,YAAaC,MAAOD,UAEhC9E,KAAKqF,IAAIN,MAAOF,QAChB7E,MAAKsF,UACLtF,MAAKuF,WAAWzD,MAAM9B,KAAM+B,WAI9B,IAAImD,eAAgB,MAAO,UAAW,aAGtCzE,GAAEiE,OAAOC,MAAMa,UAAWtE,QAGxBoE,QAAS,KAGTG,gBAAiB,KAIjBC,YAAa,KAIbH,WAAY,aAGZI,OAAQ,SAASd,SACf,MAAOpE,GAAEmF,MAAM5F,KAAK4E,aAKtBiB,KAAM,WACJ,MAAO3F,UAAS2F,KAAK/D,MAAM9B,KAAM+B,YAInC+D,IAAK,SAASC,MACZ,MAAO/F,MAAK4E,WAAWmB,OAIzBC,OAAQ,SAASD,MACf,MAAOtF,GAAEuF,OAAOhG,KAAK8F,IAAIC,QAK3BE,IAAK,SAASF,MACZ,MAAO/F,MAAK8F,IAAIC,OAAS,MAM3BV,IAAK,SAAS3B,IAAKwC,IAAKrB,SACtB,GAAIkB,MAAMhB,MAAOoB,MAAOC,QAASC,OAAQC,SAAUC,KAAMC,OACzD,IAAI9C,KAAO,KAAM,MAAO1D,KAGxB,UAAW0D,OAAQ,SAAU,CAC3BqB,MAAQrB,GACRmB,SAAUqB,QACL,EACJnB,UAAYrB,KAAOwC,IAGtBrB,UAAYA,WAGZ,KAAK7E,KAAKyG,UAAU1B,MAAOF,SAAU,MAAO,MAG5CsB,OAAkBtB,QAAQsB,KAC1BE,QAAkBxB,QAAQwB,MAC1BD,WACAE,UAAkBtG,KAAK0G,SACvB1G,MAAK0G,UAAa,IAElB,KAAKJ,SAAU,CACbtG,KAAK2G,oBAAsBlG,EAAEmF,MAAM5F,KAAK4E,WACxC5E,MAAKsF,WAEPkB,QAAUxG,KAAK4E,WAAY2B,KAAOvG,KAAK2G,mBAGvC,IAAI3G,KAAK0F,cAAeX,OAAO/E,KAAKsD,GAAKyB,MAAM/E,KAAK0F,YAGpD,KAAKK,OAAQhB,OAAO,CAClBmB,IAAMnB,MAAMgB,KACZ,KAAKtF,EAAEmG,QAAQJ,QAAQT,MAAOG,KAAME,QAAQhG,KAAK2F,KACjD,KAAKtF,EAAEmG,QAAQL,KAAKR,MAAOG,KAAM,CAC/BlG,KAAKsF,QAAQS,MAAQG,QAChB,OACElG,MAAKsF,QAAQS,MAEtBI,YAAeK,SAAQT,MAAQS,QAAQT,MAAQG,IAIjD,IAAKG,OAAQ,CACX,GAAID,QAAQ3D,OAAQzC,KAAK6G,SAAW,IACpC,KAAK,GAAIzE,GAAI,EAAGC,EAAI+D,QAAQ3D,OAAQL,EAAIC,EAAGD,IAAK,CAC9CpC,KAAK0C,QAAQ,UAAY0D,QAAQhE,GAAIpC,KAAMwG,QAAQJ,QAAQhE,IAAKyC,UAMpE,GAAIyB,SAAU,MAAOtG,KACrB,KAAKqG,OAAQ,CACX,MAAOrG,KAAK6G,SAAU,CACpB7G,KAAK6G,SAAW,KAChB7G,MAAK0C,QAAQ,SAAU1C,KAAM6E,UAGjC7E,KAAK6G,SAAW,KAChB7G,MAAK0G,UAAY,KACjB,OAAO1G,OAKTmG,MAAO,SAASJ,KAAMlB,SACpB,MAAO7E,MAAKqF,IAAIU,SAAW,GAAGtF,EAAEiE,UAAWG,SAAUsB,MAAO,SAI9DW,MAAO,SAASjC,SACd,GAAIE,SACJ,KAAK,GAAIrB,OAAO1D,MAAK4E,WAAYG,MAAMrB,SAAY,EACnD,OAAO1D,MAAKqF,IAAIN,MAAOtE,EAAEiE,UAAWG,SAAUsB,MAAO,SAKvDY,WAAY,SAAShB,MACnB,GAAIA,MAAQ,KAAM,OAAQtF,EAAEuG,QAAQhH,KAAKsF,QACzC,OAAO7E,GAAEwF,IAAIjG,KAAKsF,QAASS,OAS7BkB,kBAAmB,SAASC,MAC1B,IAAKA,KAAM,MAAOlH,MAAK+G,aAAetG,EAAEmF,MAAM5F,KAAKsF,SAAW,KAC9D,IAAIY,KAAKZ,QAAU,KACnB,IAAI6B,KAAMnH,KAAK0G,UAAY1G,KAAK2G,oBAAsB3G,KAAK4E,UAC3D,KAAK,GAAImB,QAAQmB,MAAM,CACrB,GAAIzG,EAAEmG,QAAQO,IAAIpB,MAAQG,IAAMgB,KAAKnB,OAAS,UAC7CT,UAAYA,aAAeS,MAAQG,IAEtC,MAAOZ,UAKT8B,SAAU,SAASrB,MACjB,GAAIA,MAAQ,OAAS/F,KAAK2G,oBAAqB,MAAO,KACtD,OAAO3G,MAAK2G,oBAAoBZ,OAKlCsB,mBAAoB,WAClB,MAAO5G,GAAEmF,MAAM5F,KAAK2G,sBAMtBW,MAAO,SAASzC,SACdA,QAAUA,QAAUpE,EAAEmF,MAAMf,WAC5B,IAAIA,QAAQM,YAAe,GAAGN,QAAQM,MAAQ,IAC9C,IAAIoC,OAAQvH,IACZ,IAAIwH,SAAU3C,QAAQ2C,OACtB3C,SAAQ2C,QAAU,SAASC,MACzB,IAAKF,MAAMlC,IAAIkC,MAAMpC,MAAMsC,KAAM5C,SAAUA,SAAU,MAAO,MAC5D,IAAI2C,QAASA,QAAQD,MAAOE,KAAM5C,QAClC0C,OAAM7E,QAAQ,OAAQ6E,MAAOE,KAAM5C,SAErC6C,WAAU1H,KAAM6E,QAChB,OAAO7E,MAAK6F,KAAK,OAAQ7F,KAAM6E,UAMjC8C,KAAM,SAASjE,IAAKwC,IAAKrB,SACvB,GAAIE,OAAOT,OAAQsD,IAAKhD,WAAa5E,KAAK4E,UAG1C,IAAIlB,KAAO,YAAeA,OAAQ,SAAU,CAC1CqB,MAAQrB,GACRmB,SAAUqB,QACL,EACJnB,UAAYrB,KAAOwC,IAItB,GAAInB,SAAWF,UAAYA,QAAQgD,QAAU7H,KAAKqF,IAAIN,MAAOF,SAAU,MAAO,MAE9EA,SAAUpE,EAAEiE,QAAQoD,SAAU,MAAOjD,QAGrC,KAAK7E,KAAKyG,UAAU1B,MAAOF,SAAU,MAAO,MAG5C,IAAIE,OAASF,QAAQgD,KAAM,CACzB7H,KAAK4E,WAAanE,EAAEiE,UAAWE,WAAYG,OAK7C,GAAIF,QAAQM,YAAe,GAAGN,QAAQM,MAAQ,IAC9C,IAAIoC,OAAQvH,IACZ,IAAIwH,SAAU3C,QAAQ2C,OACtB3C,SAAQ2C,QAAU,SAASC,MAEzBF,MAAM3C,WAAaA,UACnB,IAAImD,aAAcR,MAAMpC,MAAMsC,KAAM5C,QACpC,IAAIA,QAAQgD,KAAME,YAActH,EAAEiE,OAAOK,UAAagD,YACtD,IAAItH,EAAEuH,SAASD,eAAiBR,MAAMlC,IAAI0C,YAAalD,SAAU,CAC/D,MAAO,OAET,GAAI2C,QAASA,QAAQD,MAAOE,KAAM5C,QAClC0C,OAAM7E,QAAQ,OAAQ6E,MAAOE,KAAM5C,SAErC6C,WAAU1H,KAAM6E,QAEhBP,QAAStE,KAAKiI,QAAU,SAAYpD,QAAQqD,MAAQ,QAAU,QAC9D,IAAI5D,SAAW,QAASO,QAAQE,MAAQA,KACxC6C,KAAM5H,KAAK6F,KAAKvB,OAAQtE,KAAM6E,QAG9B,IAAIE,OAASF,QAAQgD,KAAM7H,KAAK4E,WAAaA,UAE7C,OAAOgD,MAMTO,QAAS,SAAStD,SAChBA,QAAUA,QAAUpE,EAAEmF,MAAMf,WAC5B,IAAI0C,OAAQvH,IACZ,IAAIwH,SAAU3C,QAAQ2C,OAEtB,IAAIW,SAAU,WACZZ,MAAM7E,QAAQ,UAAW6E,MAAOA,MAAMa,WAAYvD,SAGpDA,SAAQ2C,QAAU,SAASC,MACzB,GAAI5C,QAAQgD,MAAQN,MAAMU,QAASE,SACnC,IAAIX,QAASA,QAAQD,MAAOE,KAAM5C,QAClC,KAAK0C,MAAMU,QAASV,MAAM7E,QAAQ,OAAQ6E,MAAOE,KAAM5C,SAGzD,IAAI7E,KAAKiI,QAAS,CAChBpD,QAAQ2C,SACR,OAAO,OAETE,UAAU1H,KAAM6E,QAEhB,IAAI+C,KAAM5H,KAAK6F,KAAK,SAAU7F,KAAM6E,QACpC,KAAKA,QAAQgD,KAAMM,SACnB,OAAOP,MAMTS,IAAK,WACH,GAAIC,MAAO7H,EAAE2E,OAAOpF,KAAM,YAAcS,EAAE2E,OAAOpF,KAAKoI,WAAY,QAAUG,UAC5E,IAAIvI,KAAKiI,QAAS,MAAOK,KACzB,OAAOA,OAAQA,KAAKE,OAAOF,KAAK7F,OAAS,KAAO,IAAM,GAAK,KAAOgG,mBAAmBzI,KAAKsD,KAK5F6B,MAAO,SAASsC,KAAM5C,SACpB,MAAO4C,OAIT7B,MAAO,WACL,MAAO,IAAI5F,MAAK0I,YAAY1I,KAAK4E,aAInCqD,MAAO,WACL,MAAOjI,MAAKsD,IAAM,MAIpBqF,QAAS,SAAS9D,SAChB,MAAO7E,MAAKyG,aAAchG,EAAEiE,OAAOG,aAAiBiD,SAAU,SAKhErB,UAAW,SAAS1B,MAAOF,SACzB,IAAKA,QAAQiD,WAAa9H,KAAK8H,SAAU,MAAO,KAChD/C,OAAQtE,EAAEiE,UAAW1E,KAAK4E,WAAYG,MACtC,IAAI6D,OAAQ5I,KAAKyF,gBAAkBzF,KAAK8H,SAAS/C,MAAOF,UAAY,IACpE,KAAK+D,MAAO,MAAO,KACnB5I,MAAK0C,QAAQ,UAAW1C,KAAM4I,MAAOnI,EAAEiE,OAAOG,aAAgBY,gBAAiBmD,QAC/E,OAAO,SAMX,IAAIC,eAAgB,OAAQ,SAAU,QAAS,SAAU,OAAQ,OAGjEpI,GAAE2D,KAAKyE,aAAc,SAASvE,QAC5BK,MAAMa,UAAUlB,QAAU,WACxB,GAAI3B,MAAOtC,MAAMuC,KAAKb,UACtBY,MAAKmG,QAAQ9I,KAAK4E,WAClB,OAAOnE,GAAE6D,QAAQxC,MAAMrB,EAAGkC,QAiB9B,IAAIoG,YAAa7I,SAAS6I,WAAa,SAASC,OAAQnE,SACtDA,UAAYA,WACZ,IAAIA,QAAQwD,IAAKrI,KAAKqI,IAAMxD,QAAQwD,GACpC,IAAIxD,QAAQ0C,MAAOvH,KAAKuH,MAAQ1C,QAAQ0C,KACxC,IAAI1C,QAAQoE,iBAAoB,GAAGjJ,KAAKiJ,WAAapE,QAAQoE,UAC7DjJ,MAAKkJ,QACLlJ,MAAKuF,WAAWzD,MAAM9B,KAAM+B,UAC5B,IAAIiH,OAAQhJ,KAAKmJ,MAAMH,OAAQvI,EAAEiE,QAAQ2B,OAAQ,MAAOxB,UAI1D,IAAIuE,aAAcC,IAAK,KAAMC,OAAQ,KAAMC,MAAO,KAClD,IAAIC,aAAcH,IAAK,KAAME,MAAO,MAAOD,OAAQ,MAGnD7I,GAAEiE,OAAOqE,WAAWvD,UAAWtE,QAI7BqG,MAAO5C,MAIPY,WAAY,aAIZI,OAAQ,SAASd,SACf,MAAO7E,MAAKyJ,IAAI,SAASlC,OAAQ,MAAOA,OAAM5B,OAAOd,YAIvDgB,KAAM,WACJ,MAAO3F,UAAS2F,KAAK/D,MAAM9B,KAAM+B,YAInCsH,IAAK,SAASL,OAAQnE,SACpB,MAAO7E,MAAKqF,IAAI2D,OAAQvI,EAAEqE,SAASD,YAAe2E,cAIpDF,OAAQ,SAASN,OAAQnE,SACvBmE,OAASvI,EAAEiJ,QAAQV,QAAUA,OAAO3I,SAAW2I,OAC/CnE,WAAYA,WACZ,IAAIzC,GAAGC,EAAGsH,MAAOpC,KACjB,KAAKnF,EAAI,EAAGC,EAAI2G,OAAOvG,OAAQL,EAAIC,EAAGD,IAAK,CACzCmF,MAAQvH,KAAK8F,IAAIkD,OAAO5G,GACxB,KAAKmF,MAAO,eACLvH,MAAK4J,MAAMrC,MAAMjE,UACjBtD,MAAK4J,MAAMrC,MAAMvC,IACxB2E,OAAQ3J,KAAK6J,QAAQtC,MACrBvH,MAAKgJ,OAAO1I,OAAOqJ,MAAO,EAC1B3J,MAAKyC,QACL,KAAKoC,QAAQwB,OAAQ,CACnBxB,QAAQ8E,MAAQA,KAChBpC,OAAM7E,QAAQ,SAAU6E,MAAOvH,KAAM6E,SAEvC7E,KAAK8J,iBAAiBvC,OAExB,MAAOvH,OAOTqF,IAAK,SAAS2D,OAAQnE,SACpBA,QAAUpE,EAAEqE,SAASD,YAAeuE,WACpC,IAAIvE,QAAQM,MAAO6D,OAAShJ,KAAKmF,MAAM6D,OAAQnE,QAC/C,KAAKpE,EAAEiJ,QAAQV,QAASA,OAASA,QAAUA,UAC3C,IAAI5G,GAAGC,EAAGkF,MAAOxC,MAAOgF,SAAUC,IAClC,IAAIC,IAAKpF,QAAQoF,EACjB,IAAIC,UAAWlK,KAAKiJ,YAAegB,IAAM,MAASpF,QAAQmF,OAAS,KACnE,IAAIG,UAAW1J,EAAE2J,SAASpK,KAAKiJ,YAAcjJ,KAAKiJ,WAAa,IAC/D,IAAIoB,UAAYC,YAAeC,WAI/B,KAAKnI,EAAI,EAAGC,EAAI2G,OAAOvG,OAAQL,EAAIC,EAAGD,IAAK,CACzC,KAAMmF,MAAQvH,KAAKwK,cAAcxB,OAAO5G,GAAIyC,UAAW,QAIvD,IAAIkF,SAAW/J,KAAK8F,IAAIyB,OAAQ,CAC9B,GAAI1C,QAAQyE,OAAQiB,SAASR,SAAS/E,KAAO,IAC7C,IAAIH,QAAQ0E,MAAO,CACjBQ,SAAS1E,IAAIkC,MAAM3C,WAAYC,QAC/B,IAAIqF,WAAaF,MAAQD,SAAShD,WAAWoD,UAAWH,KAAO,UAI5D,IAAInF,QAAQwE,IAAK,CACtBgB,MAAMjK,KAAKmH,MAIXA,OAAMpG,GAAG,MAAOnB,KAAKyK,cAAezK,KACpCA,MAAK4J,MAAMrC,MAAMvC,KAAOuC,KACxB,IAAIA,MAAMjE,IAAM,KAAMtD,KAAK4J,MAAMrC,MAAMjE,IAAMiE,OAKjD,GAAI1C,QAAQyE,OAAQ,CAClB,IAAKlH,EAAI,EAAGC,EAAIrC,KAAKyC,OAAQL,EAAIC,IAAKD,EAAG,CACvC,IAAKmI,UAAUhD,MAAQvH,KAAKgJ,OAAO5G,IAAI4C,KAAMsF,SAASlK,KAAKmH,OAE7D,GAAI+C,SAAS7H,OAAQzC,KAAKsJ,OAAOgB,SAAUzF,SAI7C,GAAIwF,MAAM5H,OAAQ,CAChB,GAAIyH,SAAUF,KAAO,IACrBhK,MAAKyC,QAAU4H,MAAM5H,MACrB,IAAIwH,IAAM,KAAM,CACd3J,OAAOwB,MAAM9B,KAAKgJ,QAASiB,GAAI,GAAGtG,OAAO0G,YACpC,CACLjK,KAAK0B,MAAM9B,KAAKgJ,OAAQqB,QAK5B,GAAIL,KAAMhK,KAAKgK,MAAM3D,OAAQ,MAE7B,IAAIxB,QAAQwB,OAAQ,MAAOrG,KAG3B,KAAKoC,EAAI,EAAGC,EAAIgI,MAAM5H,OAAQL,EAAIC,EAAGD,IAAK,EACvCmF,MAAQ8C,MAAMjI,IAAIM,QAAQ,MAAO6E,MAAOvH,KAAM6E,SAIjD,GAAImF,KAAMhK,KAAK0C,QAAQ,OAAQ1C,KAAM6E,QACrC,OAAO7E,OAOTmJ,MAAO,SAASH,OAAQnE,SACtBA,UAAYA,WACZ,KAAK,GAAIzC,GAAI,EAAGC,EAAIrC,KAAKgJ,OAAOvG,OAAQL,EAAIC,EAAGD,IAAK,CAClDpC,KAAK8J,iBAAiB9J,KAAKgJ,OAAO5G,IAEpCyC,QAAQ6F,eAAiB1K,KAAKgJ,MAC9BhJ,MAAKkJ,QACLlJ,MAAKqJ,IAAIL,OAAQvI,EAAEiE,QAAQ2B,OAAQ,MAAOxB,SAC1C,KAAKA,QAAQwB,OAAQrG,KAAK0C,QAAQ,QAAS1C,KAAM6E,QACjD,OAAO7E,OAITI,KAAM,SAASmH,MAAO1C,SACpB0C,MAAQvH,KAAKwK,cAAcjD,MAAO1C,QAClC7E,MAAKqJ,IAAI9B,MAAO9G,EAAEiE,QAAQuF,GAAIjK,KAAKyC,QAASoC,SAC5C,OAAO0C,QAIToD,IAAK,SAAS9F,SACZ,GAAI0C,OAAQvH,KAAKiK,GAAGjK,KAAKyC,OAAS,EAClCzC,MAAKsJ,OAAO/B,MAAO1C,QACnB,OAAO0C,QAITuB,QAAS,SAASvB,MAAO1C,SACvB0C,MAAQvH,KAAKwK,cAAcjD,MAAO1C,QAClC7E,MAAKqJ,IAAI9B,MAAO9G,EAAEiE,QAAQuF,GAAI,GAAIpF,SAClC,OAAO0C,QAITqD,MAAO,SAAS/F,SACd,GAAI0C,OAAQvH,KAAKiK,GAAG,EACpBjK,MAAKsJ,OAAO/B,MAAO1C,QACnB,OAAO0C,QAITlH,MAAO,SAASwK,MAAOC,KACrB,MAAO9K,MAAKgJ,OAAO3I,MAAMwK,MAAOC,MAIlChF,IAAK,SAAS7C,KACZ,GAAIA,KAAO,KAAM,WAAY,EAC7B,OAAOjD,MAAK4J,MAAM3G,IAAIK,IAAM,KAAOL,IAAIK,GAAKL,IAAI+B,KAAO/B,MAIzDgH,GAAI,SAASN,OACX,MAAO3J,MAAKgJ,OAAOW,QAKrBoB,MAAO,SAAShG,MAAOiG,OACrB,GAAIvK,EAAEuG,QAAQjC,OAAQ,MAAOiG,WAAa,KAC1C,OAAOhL,MAAKgL,MAAQ,OAAS,UAAU,SAASzD,OAC9C,IAAK,GAAI7D,OAAOqB,OAAO,CACrB,GAAIA,MAAMrB,OAAS6D,MAAMzB,IAAIpC,KAAM,MAAO,OAE5C,MAAO,SAMXuH,UAAW,SAASlG,OAClB,MAAO/E,MAAK+K,MAAMhG,MAAO,OAM3BiF,KAAM,SAASnF,SACb,IAAK7E,KAAKiJ,WAAY,KAAM,IAAIiC,OAAM,yCACtCrG,WAAYA,WAGZ,IAAIpE,EAAE2J,SAASpK,KAAKiJ,aAAejJ,KAAKiJ,WAAWxG,SAAW,EAAG,CAC/DzC,KAAKgJ,OAAShJ,KAAKmL,OAAOnL,KAAKiJ,WAAYjJ,UACtC,CACLA,KAAKgJ,OAAOgB,KAAKvJ,EAAE+D,KAAKxE,KAAKiJ,WAAYjJ,OAG3C,IAAK6E,QAAQwB,OAAQrG,KAAK0C,QAAQ,OAAQ1C,KAAM6E,QAChD,OAAO7E,OAKToL,YAAa,SAAS7D,MAAO8D,MAAO/J,SAClC+J,QAAUA,MAAQrL,KAAKiJ,WACvB,IAAIqC,UAAW7K,EAAE8K,WAAWF,OAASA,MAAQ,SAAS9D,OACpD,MAAOA,OAAMzB,IAAIuF,OAEnB,OAAO5K,GAAE2K,YAAYpL,KAAKgJ,OAAQzB,MAAO+D,SAAUhK,UAIrDkK,MAAO,SAASzF,MACd,MAAOtF,GAAEgL,OAAOzL,KAAKgJ,OAAQ,MAAOjD,OAMtCuB,MAAO,SAASzC,SACdA,QAAUA,QAAUpE,EAAEmF,MAAMf,WAC5B,IAAIA,QAAQM,YAAe,GAAGN,QAAQM,MAAQ,IAC9C,IAAIqC,SAAU3C,QAAQ2C,OACtB,IAAIY,YAAapI,IACjB6E,SAAQ2C,QAAU,SAASC,MACzB,GAAInD,QAASO,QAAQsE,MAAQ,QAAU,KACvCf,YAAW9D,QAAQmD,KAAM5C,QACzB,IAAI2C,QAASA,QAAQY,WAAYX,KAAM5C,QACvCuD,YAAW1F,QAAQ,OAAQ0F,WAAYX,KAAM5C,SAE/C6C,WAAU1H,KAAM6E,QAChB,OAAO7E,MAAK6F,KAAK,OAAQ7F,KAAM6E,UAMjC6G,OAAQ,SAASnE,MAAO1C,SACtBA,QAAUA,QAAUpE,EAAEmF,MAAMf,WAC5B,MAAM0C,MAAQvH,KAAKwK,cAAcjD,MAAO1C,UAAW,MAAO,MAC1D,KAAKA,QAAQgD,KAAM7H,KAAKqJ,IAAI9B,MAAO1C,QACnC,IAAIuD,YAAapI,IACjB,IAAIwH,SAAU3C,QAAQ2C,OACtB3C,SAAQ2C,QAAU,SAASC,MACzB,GAAI5C,QAAQgD,KAAMO,WAAWiB,IAAI9B,MAAO1C,QACxC,IAAI2C,QAASA,QAAQD,MAAOE,KAAM5C,SAEpC0C,OAAMI,KAAK,KAAM9C,QACjB,OAAO0C,QAKTpC,MAAO,SAASsC,KAAM5C,SACpB,MAAO4C,OAIT7B,MAAO,WACL,MAAO,IAAI5F,MAAK0I,YAAY1I,KAAKgJ,SAKnCE,OAAQ,WACNlJ,KAAKyC,OAAS,CACdzC,MAAKgJ,SACLhJ,MAAK4J,UAKPY,cAAe,SAASzF,MAAOF,SAC7B,GAAIE,gBAAiBJ,OAAO,CAC1B,IAAKI,MAAMqD,WAAYrD,MAAMqD,WAAapI,IAC1C,OAAO+E,OAETF,UAAYA,WACZA,SAAQuD,WAAapI,IACrB,IAAIuH,OAAQ,GAAIvH,MAAKuH,MAAMxC,MAAOF,QAClC,KAAK0C,MAAMd,UAAU1B,MAAOF,SAAU,CACpC7E,KAAK0C,QAAQ,UAAW1C,KAAM+E,MAAOF,QACrC,OAAO,OAET,MAAO0C,QAITuC,iBAAkB,SAASvC,OACzB,GAAIvH,OAASuH,MAAMa,iBAAmBb,OAAMa,UAC5Cb,OAAM1F,IAAI,MAAO7B,KAAKyK,cAAezK,OAOvCyK,cAAe,SAASkB,MAAOpE,MAAOa,WAAYvD,SAChD,IAAK8G,QAAU,OAASA,QAAU,WAAavD,aAAepI,KAAM,MACpE,IAAI2L,QAAU,UAAW3L,KAAKsJ,OAAO/B,MAAO1C,QAC5C,IAAI0C,OAASoE,QAAU,UAAYpE,MAAM7B,YAAa,OAC7C1F,MAAK4J,MAAMrC,MAAMH,SAASG,MAAM7B,aACvC,IAAI6B,MAAMjE,IAAM,KAAMtD,KAAK4J,MAAMrC,MAAMjE,IAAMiE,MAE/CvH,KAAK0C,QAAQZ,MAAM9B,KAAM+B,aAQ7B,IAAI6J,UAAW,UAAW,OAAQ,MAAO,UAAW,SAAU,QAC5D,SAAU,cAAe,QAAS,OAAQ,SAAU,SAAU,SAC9D,SAAU,QAAS,MAAO,OAAQ,MAAO,UAAW,WAAY,SAChE,MAAO,MAAO,UAAW,OAAQ,QAAS,OAAQ,OAAQ,UAAW,OACrE,OAAQ,OAAQ,OAAQ,UAAW,UAAW,UAAW,cACzD,UAAW,QAGbnL,GAAE2D,KAAKwH,QAAS,SAAStH,QACvByE,WAAWvD,UAAUlB,QAAU,WAC7B,GAAI3B,MAAOtC,MAAMuC,KAAKb,UACtBY,MAAKmG,QAAQ9I,KAAKgJ,OAClB,OAAOvI,GAAE6D,QAAQxC,MAAMrB,EAAGkC,QAK9B,IAAIkJ,mBAAoB,UAAW,UAAW,SAG9CpL,GAAE2D,KAAKyH,iBAAkB,SAASvH,QAChCyE,WAAWvD,UAAUlB,QAAU,SAAS+G,MAAO/J,SAC7C,GAAIgK,UAAW7K,EAAE8K,WAAWF,OAASA,MAAQ,SAAS9D,OACpD,MAAOA,OAAMzB,IAAIuF,OAEnB,OAAO5K,GAAE6D,QAAQtE,KAAKgJ,OAAQsC,SAAUhK,WAiB5C,IAAIwK,MAAO5L,SAAS4L,KAAO,SAASjH,SAClC7E,KAAKgF,IAAMvE,EAAE8D,SAAS,OACtBvE,MAAK+L,WAAWlH,YAChB7E,MAAKgM,gBACLhM,MAAKuF,WAAWzD,MAAM9B,KAAM+B,UAC5B/B,MAAKiM,iBAIP,IAAIC,uBAAwB,gBAG5B,IAAIC,cAAe,QAAS,aAAc,KAAM,KAAM,aAAc,YAAa,UAAW,SAG5F1L,GAAEiE,OAAOoH,KAAKtG,UAAWtE,QAGvBkL,QAAS,MAITzL,EAAG,SAAS0L,UACV,MAAOrM,MAAKsM,IAAIC,KAAKF,WAKvB9G,WAAY,aAKZiH,OAAQ,WACN,MAAOxM,OAKTsJ,OAAQ,WACNtJ,KAAKsM,IAAIhD,QACTtJ,MAAKgD,eACL,OAAOhD,OAKTyM,WAAY,SAASC,QAASC,UAC5B,GAAI3M,KAAKsM,IAAKtM,KAAK4M,kBACnB5M,MAAKsM,IAAMI,kBAAmBxM,UAASS,EAAI+L,QAAUxM,SAASS,EAAE+L,QAChE1M,MAAK6M,GAAK7M,KAAKsM,IAAI,EACnB,IAAIK,WAAa,MAAO3M,KAAKiM,gBAC7B,OAAOjM,OAkBTiM,eAAgB,SAASxK,QACvB,KAAMA,SAAWA,OAAShB,EAAE2E,OAAOpF,KAAM,YAAa,MAAOA,KAC7DA,MAAK4M,kBACL,KAAK,GAAIlJ,OAAOjC,QAAQ,CACtB,GAAI6C,QAAS7C,OAAOiC,IACpB,KAAKjD,EAAE8K,WAAWjH,QAASA,OAAStE,KAAKyB,OAAOiC,KAChD,KAAKY,OAAQ,QAEb,IAAIwI,OAAQpJ,IAAIoJ,MAAMZ,sBACtB,IAAIa,WAAYD,MAAM,GAAIT,SAAWS,MAAM,EAC3CxI,QAAS7D,EAAE+D,KAAKF,OAAQtE,KACxB+M,YAAa,kBAAoB/M,KAAKgF,GACtC,IAAIqH,WAAa,GAAI,CACnBrM,KAAKsM,IAAInL,GAAG4L,UAAWzI,YAClB,CACLtE,KAAKsM,IAAInL,GAAG4L,UAAWV,SAAU/H,SAGrC,MAAOtE,OAMT4M,iBAAkB,WAChB5M,KAAKsM,IAAIzK,IAAI,kBAAoB7B,KAAKgF,IACtC,OAAOhF,OAOT+L,WAAY,SAASlH,SACnB,GAAI7E,KAAK6E,QAASA,QAAUpE,EAAEiE,UAAWjE,EAAE2E,OAAOpF,KAAM,WAAY6E,QACpEpE,GAAEiE,OAAO1E,KAAMS,EAAEwE,KAAKJ,QAASsH,aAC/BnM,MAAK6E,QAAUA,SAOjBmH,eAAgB,WACd,IAAKhM,KAAK6M,GAAI,CACZ,GAAI9H,OAAQtE,EAAEiE,UAAWjE,EAAE2E,OAAOpF,KAAM,cACxC,IAAIA,KAAKsD,GAAIyB,MAAMzB,GAAK7C,EAAE2E,OAAOpF,KAAM,KACvC,IAAIA,KAAKgN,UAAWjI,MAAM,SAAWtE,EAAE2E,OAAOpF,KAAM,YACpD,IAAIsM,KAAMpM,SAASS,EAAE,IAAMF,EAAE2E,OAAOpF,KAAM,WAAa,KAAK+F,KAAKhB,MACjE/E,MAAKyM,WAAWH,IAAK,WAChB,CACLtM,KAAKyM,WAAWhM,EAAE2E,OAAOpF,KAAM,MAAO,UAwB5CE,UAAS2F,KAAO,SAASvB,OAAQiD,MAAO1C,SACtC,GAAIoI,MAAOC,UAAU5I,OAGrB7D,GAAEqE,SAASD,UAAYA,aACrB7D,YAAad,SAASc,YACtBC,YAAaf,SAASe,aAIxB,IAAIkM,SAAUF,KAAMA,KAAMG,SAAU,OAGpC,KAAKvI,QAAQwD,IAAK,CAChB8E,OAAO9E,IAAM5H,EAAE2E,OAAOmC,MAAO,QAAUgB,WAIzC,GAAI1D,QAAQwI,MAAQ,MAAQ9F,QAAUjD,SAAW,UAAYA,SAAW,UAAYA,SAAW,SAAU,CACvG6I,OAAOG,YAAc,kBACrBH,QAAOE,KAAOE,KAAKC,UAAU3I,QAAQE,OAASwC,MAAM5B,OAAOd,UAI7D,GAAIA,QAAQ5D,YAAa,CACvBkM,OAAOG,YAAc,mCACrBH,QAAOE,KAAOF,OAAOE,MAAQ9F,MAAO4F,OAAOE,SAK7C,GAAIxI,QAAQ7D,cAAgBiM,OAAS,OAASA,OAAS,UAAYA,OAAS,SAAU,CACpFE,OAAOF,KAAO,MACd,IAAIpI,QAAQ5D,YAAakM,OAAOE,KAAKI,QAAUR,IAC/C,IAAIS,YAAa7I,QAAQ6I,UACzB7I,SAAQ6I,WAAa,SAAS9F,KAC5BA,IAAI+F,iBAAiB,yBAA0BV,KAC/C,IAAIS,WAAY,MAAOA,YAAW5L,MAAM9B,KAAM+B,YAKlD,GAAIoL,OAAOF,OAAS,QAAUpI,QAAQ5D,YAAa,CACjDkM,OAAOS,YAAc,MAMvB,GAAIT,OAAOF,OAAS,SAAWY,OAAOC,iBAC9BD,OAAOE,UAAYF,OAAOE,SAASC,2BAA4B,CACrEb,OAAOvF,IAAM,WACX,MAAO,IAAIkG,eAAc,sBAK7B,GAAIlG,KAAM/C,QAAQ+C,IAAM1H,SAAS+N,KAAKxN,EAAEiE,OAAOyI,OAAQtI,SACvD0C,OAAM7E,QAAQ,UAAW6E,MAAOK,IAAK/C,QACrC,OAAO+C,KAIT,IAAIsF,YACFxB,OAAU,OACVwC,OAAU,MACVhG,MAAU,QACViG,SAAU,SACVC,KAAU,MAKZlO,UAAS+N,KAAO,WACd,MAAO/N,UAASS,EAAEsN,KAAKnM,MAAM5B,SAASS,EAAGoB,WAQ3C,IAAIsM,QAASnO,SAASmO,OAAS,SAASxJ,SACtCA,UAAYA,WACZ,IAAIA,QAAQyJ,OAAQtO,KAAKsO,OAASzJ,QAAQyJ,MAC1CtO,MAAKuO,aACLvO,MAAKuF,WAAWzD,MAAM9B,KAAM+B,WAK9B,IAAIyM,eAAgB,YACpB,IAAIC,YAAgB,cACpB,IAAIC,YAAgB,QACpB,IAAIC,cAAgB,0BAGpBlO,GAAEiE,OAAO2J,OAAO7I,UAAWtE,QAIzBqE,WAAY,aAQZqJ,MAAO,SAASA,MAAOxN,KAAMC,UAC3B,IAAKZ,EAAEoO,SAASD,OAAQA,MAAQ5O,KAAK8O,eAAeF,MACpD,IAAInO,EAAE8K,WAAWnK,MAAO,CACtBC,SAAWD,IACXA,MAAO,GAET,IAAKC,SAAUA,SAAWrB,KAAKoB,KAC/B,IAAI2N,QAAS/O,IACbE,UAAS8O,QAAQJ,MAAMA,MAAO,SAASK,UACrC,GAAItM,MAAOoM,OAAOG,mBAAmBN,MAAOK,SAC5C5N,WAAYA,SAASS,MAAMiN,OAAQpM,KACnCoM,QAAOrM,QAAQZ,MAAMiN,QAAS,SAAW3N,MAAMuC,OAAOhB,MACtDoM,QAAOrM,QAAQ,QAAStB,KAAMuB,KAC9BzC,UAAS8O,QAAQtM,QAAQ,QAASqM,OAAQ3N,KAAMuB,OAElD,OAAO3C,OAITmP,SAAU,SAASF,SAAUpK,SAC3B3E,SAAS8O,QAAQG,SAASF,SAAUpK,QACpC,OAAO7E,OAMTuO,YAAa,WACX,IAAKvO,KAAKsO,OAAQ,MAClBtO,MAAKsO,OAAS7N,EAAE2E,OAAOpF,KAAM,SAC7B,IAAI4O,OAAON,OAAS7N,EAAE+B,KAAKxC,KAAKsO,OAChC,QAAQM,MAAQN,OAAO3D,QAAU,KAAM,CACrC3K,KAAK4O,MAAMA,MAAO5O,KAAKsO,OAAOM,UAMlCE,eAAgB,SAASF,OACvBA,MAAQA,MAAMQ,QAAQT,aAAc,QACtBS,QAAQZ,cAAe,WACvBY,QAAQX,WAAY,SAAS3B,MAAOuC,UACnC,MAAOA,UAAWvC,MAAQ,YAE3BsC,QAAQV,WAAY,QAClC,OAAO,IAAIY,QAAO,IAAMV,MAAQ,MAMlCM,mBAAoB,SAASN,MAAOK,UAClC,GAAI9B,QAASyB,MAAMW,KAAKN,UAAU5O,MAAM,EACxC,OAAOI,GAAEgJ,IAAI0D,OAAQ,SAASqC,OAC5B,MAAOA,OAAQC,mBAAmBD,OAAS,SAcjD,IAAIE,SAAUxP,SAASwP,QAAU,WAC/B1P,KAAK2P,WACLlP,GAAEmP,QAAQ5P,KAAM,WAGhB,UAAW6N,UAAW,YAAa,CACjC7N,KAAK6P,SAAWhC,OAAOgC,QACvB7P,MAAKgP,QAAUnB,OAAOmB,SAK1B,IAAIc,eAAgB,cAGpB,IAAIC,cAAe,YAGnB,IAAIC,YAAa,aAGjB,IAAIC,eAAgB,KAGpBP,SAAQQ,QAAU,KAGlBzP,GAAEiE,OAAOgL,QAAQlK,UAAWtE,QAI1BiP,SAAU,GAIVC,QAAS,SAASvC,QAChB,GAAIf,QAASe,QAAU7N,MAAM6P,SAASQ,KAAKvD,MAAM,SACjD,OAAOA,OAAQA,MAAM,GAAK,IAK5BwD,YAAa,SAASrB,SAAUsB,gBAC9B,GAAItB,UAAY,KAAM,CACpB,GAAIjP,KAAKwQ,gBAAkBxQ,KAAKyQ,kBAAoBF,eAAgB,CAClEtB,SAAWjP,KAAK6P,SAASa,QACzB,IAAI3Q,MAAOC,KAAKD,KAAKqP,QAAQa,cAAe,GAC5C,KAAKhB,SAASpF,QAAQ9J,MAAOkP,SAAWA,SAAS0B,OAAO5Q,KAAK0C,YACxD,CACLwM,SAAWjP,KAAKoQ,WAGpB,MAAOnB,UAASG,QAAQU,cAAe,KAKzCc,MAAO,SAAS/L,SACd,GAAI6K,QAAQQ,QAAS,KAAM,IAAIhF,OAAM,4CACrCwE,SAAQQ,QAAU,IAIlBlQ,MAAK6E,QAAmBpE,EAAEiE,WAAY3E,KAAM,KAAMC,KAAK6E,QAASA,QAChE7E,MAAKD,KAAmBC,KAAK6E,QAAQ9E,IACrCC,MAAKyQ,iBAAmBzQ,KAAK6E,QAAQgM,aAAe,KACpD7Q,MAAK8Q,kBAAqB9Q,KAAK6E,QAAQkM,SACvC/Q,MAAKwQ,iBAAsBxQ,KAAK6E,QAAQkM,WAAa/Q,KAAKgP,SAAWhP,KAAKgP,QAAQ+B,UAClF,IAAI9B,UAAoBjP,KAAKsQ,aAC7B,IAAIU,SAAoBC,SAASC,YACjC,IAAIC,OAAqBnB,WAAWT,KAAK6B,UAAUC,UAAUC,kBAAoBN,SAAWA,SAAW,EAGvGhR,MAAKD,MAAQ,IAAMC,KAAKD,KAAO,KAAKqP,QAAQW,aAAc,IAE1D,IAAIoB,OAASnR,KAAKyQ,iBAAkB,CAClCzQ,KAAKuR,OAASrR,SAASS,EAAE,+CAA+C6Q,OAAOC,SAAS,QAAQ,GAAGC,aACnG1R,MAAKmP,SAASF,UAKhB,GAAIjP,KAAKwQ,cAAe,CACtBtQ,SAASS,EAAEkN,QAAQ1M,GAAG,WAAYnB,KAAK2R,cAClC,IAAI3R,KAAKyQ,kBAAqB,gBAAkB5C,UAAYsD,MAAO,CACxEjR,SAASS,EAAEkN,QAAQ1M,GAAG,aAAcnB,KAAK2R,cACpC,IAAI3R,KAAKyQ,iBAAkB,CAChCzQ,KAAK4R,kBAAoBC,YAAY7R,KAAK2R,SAAU3R,KAAKmQ,UAK3DnQ,KAAKiP,SAAWA,QAChB,IAAI6C,KAAM9R,KAAK6P,QACf,IAAIkC,QAASD,IAAIpB,SAAStB,QAAQ,SAAU,SAAWpP,KAAKD,IAI5D,IAAIC,KAAKyQ,kBAAoBzQ,KAAK8Q,kBAAoB9Q,KAAKwQ,gBAAkBuB,OAAQ,CACnF/R,KAAKiP,SAAWjP,KAAKsQ,YAAY,KAAM,KACvCtQ,MAAK6P,SAAST,QAAQpP,KAAKD,KAAOC,KAAK6P,SAASmC,OAAS,IAAMhS,KAAKiP,SAEpE,OAAO,UAIF,IAAIjP,KAAK8Q,iBAAmB9Q,KAAKwQ,eAAiBuB,QAAUD,IAAIG,KAAM,CAC3EjS,KAAKiP,SAAWjP,KAAKoQ,UAAUhB,QAAQU,cAAe,GACtD9P,MAAKgP,QAAQkD,gBAAiBjB,SAASkB,MAAOnS,KAAKD,KAAOC,KAAKiP,SAAW6C,IAAIE,QAGhF,IAAKhS,KAAK6E,QAAQwB,OAAQ,MAAOrG,MAAKoS,WAKxCC,KAAM,WACJnS,SAASS,EAAEkN,QAAQhM,IAAI,WAAY7B,KAAK2R,UAAU9P,IAAI,aAAc7B,KAAK2R,SACzEW,eAActS,KAAK4R,kBACnBlC,SAAQQ,QAAU,OAKpBtB,MAAO,SAASA,MAAOvN,UACrBrB,KAAK2P,SAAS7G,SAAS8F,MAAOA,MAAOvN,SAAUA,YAKjDsQ,SAAU,SAASY,GACjB,GAAI/L,SAAUxG,KAAKsQ,aACnB,IAAI9J,UAAYxG,KAAKiP,UAAYjP,KAAKuR,OAAQ,CAC5C/K,QAAUxG,KAAKsQ,YAAYtQ,KAAKoQ,QAAQpQ,KAAKuR,SAE/C,GAAI/K,UAAYxG,KAAKiP,SAAU,MAAO,MACtC,IAAIjP,KAAKuR,OAAQvR,KAAKmP,SAAS3I,QAC/BxG,MAAKoS,WAAapS,KAAKoS,QAAQpS,KAAKoQ,YAMtCgC,QAAS,SAASI,kBAChB,GAAIvD,UAAWjP,KAAKiP,SAAWjP,KAAKsQ,YAAYkC,iBAChD,IAAIC,SAAUhS,EAAEiS,IAAI1S,KAAK2P,SAAU,SAASgD,SAC1C,GAAIA,QAAQ/D,MAAMhL,KAAKqL,UAAW,CAChC0D,QAAQtR,SAAS4N,SACjB,OAAO,QAGX,OAAOwD,UAUTtD,SAAU,SAASF,SAAUpK,SAC3B,IAAK6K,QAAQQ,QAAS,MAAO,MAC7B,KAAKrL,SAAWA,UAAY,KAAMA,SAAWnC,QAASmC,QACtDoK,UAAWjP,KAAKsQ,YAAYrB,UAAY,GACxC,IAAIjP,KAAKiP,WAAaA,SAAU,MAChCjP,MAAKiP,SAAWA,QAChB,IAAI5G,KAAMrI,KAAKD,KAAOkP,QAGtB,IAAIjP,KAAKwQ,cAAe,CACtBxQ,KAAKgP,QAAQnK,QAAQuK,QAAU,eAAiB,gBAAiB6B,SAASkB,MAAO9J,SAI5E,IAAIrI,KAAKyQ,iBAAkB,CAChCzQ,KAAK4S,YAAY5S,KAAK6P,SAAUZ,SAAUpK,QAAQuK,QAClD,IAAIpP,KAAKuR,QAAWtC,WAAajP,KAAKsQ,YAAYtQ,KAAKoQ,QAAQpQ,KAAKuR,SAAW,CAI7E,IAAI1M,QAAQuK,QAASpP,KAAKuR,OAAON,SAAS4B,OAAOC,OACjD9S,MAAK4S,YAAY5S,KAAKuR,OAAO1B,SAAUZ,SAAUpK,QAAQuK,cAKtD,CACL,MAAOpP,MAAK6P,SAASkD,OAAO1K,KAE9B,GAAIxD,QAAQnC,QAAS1C,KAAKoS,QAAQnD,WAKpC2D,YAAa,SAAS/C,SAAUZ,SAAUG,SACxC,GAAIA,QAAS,CACX,GAAIiB,MAAOR,SAASQ,KAAKjB,QAAQ,qBAAsB,GACvDS,UAAST,QAAQiB,KAAO,IAAMpB,cACzB,CAELY,SAASoC,KAAO,IAAMhD,YAO5B/O,UAAS8O,QAAU,GAAIU,QAQvB,IAAIhL,QAAS,SAASsO,WAAYC,aAChC,GAAIC,QAASlT,IACb,IAAImT,MAKJ,IAAIH,YAAcvS,EAAEwF,IAAI+M,WAAY,eAAgB,CAClDG,MAAQH,WAAWtK,gBACd,CACLyK,MAAQ,WAAY,MAAOD,QAAOpR,MAAM9B,KAAM+B,YAIhDtB,EAAEiE,OAAOyO,MAAOD,OAAQD,YAIxB,IAAIG,WAAY,WAAYpT,KAAK0I,YAAcyK,MAC/CC,WAAU5N,UAAY0N,OAAO1N,SAC7B2N,OAAM3N,UAAY,GAAI4N,UAItB,IAAIJ,WAAYvS,EAAEiE,OAAOyO,MAAM3N,UAAWwN,WAI1CG,OAAME,UAAYH,OAAO1N,SAEzB,OAAO2N,OAITxO,OAAMD,OAASqE,WAAWrE,OAAS2J,OAAO3J,OAASoH,KAAKpH,OAASgL,QAAQhL,OAASA,MAGlF,IAAI6D,UAAW,WACb,KAAM,IAAI2C,OAAM,kDAIlB,IAAIxD,WAAY,SAAUH,MAAO1C,SAC/B,GAAI+D,OAAQ/D,QAAQ+D,KACpB/D,SAAQ+D,MAAQ,SAASnB,MACvB,GAAImB,MAAOA,MAAMrB,MAAOE,KAAM5C,QAC9B0C,OAAM7E,QAAQ,QAAS6E,MAAOE,KAAM5C,aAIvCjC,KAAK5C"}
\ No newline at end of file</div></li>
 <li>public/components/backbone/backbone.js<div>diff --git a/public/components/backbone/backbone.js b/public/components/backbone/backbone.js
index 9682be5..3512d42 100644
--- a/public/components/backbone/backbone.js
+++ b/public/components/backbone/backbone.js
@@ -1,6 +1,6 @@
-//     Backbone.js 0.9.10
+//     Backbone.js 1.0.0
 
-//     (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
+//     (c) 2010-2013 Jeremy Ashkenas, DocumentCloud Inc.
 //     Backbone may be freely distributed under the MIT license.
 //     For all details and documentation:
 //     http://backbonejs.org
@@ -18,14 +18,14 @@
   // restored later on, if `noConflict` is used.
   var previousBackbone = root.Backbone;
 
-  // Create a local reference to array methods.
+  // Create local references to array methods we'll want to use later.
   var array = [];
   var push = array.push;
   var slice = array.slice;
   var splice = array.splice;
 
   // The top-level namespace. All public Backbone classes and modules will
-  // be attached to this. Exported for both CommonJS and the browser.
+  // be attached to this. Exported for both the browser and the server.
   var Backbone;
   if (typeof exports !== 'undefined') {
     Backbone = exports;
@@ -34,14 +34,15 @@
   }
 
   // Current version of the library. Keep in sync with `package.json`.
-  Backbone.VERSION = '0.9.10';
+  Backbone.VERSION = '1.0.0';
 
   // Require Underscore, if we're on the server, and it's not already present.
   var _ = root._;
   if (!_ && (typeof require !== 'undefined')) _ = require('underscore');
 
-  // For Backbone's purposes, jQuery, Zepto, or Ender owns the `$` variable.
-  Backbone.$ = root.jQuery || root.Zepto || root.ender;
+  // For Backbone's purposes, jQuery, Zepto, Ender, or My Library (kidding) owns
+  // the `$` variable.
+  Backbone.$ = root.jQuery || root.Zepto || root.ender || root.$;
 
   // Runs Backbone.js in *noConflict* mode, returning the `Backbone` variable
   // to its previous owner. Returns a reference to this Backbone object.
@@ -64,45 +65,6 @@
   // Backbone.Events
   // ---------------
 
-  // Regular expression used to split event strings.
-  var eventSplitter = /\s+/;
-
-  // Implement fancy features of the Events API such as multiple event
-  // names `"change blur"` and jQuery-style event maps `{change: action}`
-  // in terms of the existing API.
-  var eventsApi = function(obj, action, name, rest) {
-    if (!name) return true;
-    if (typeof name === 'object') {
-      for (var key in name) {
-        obj[action].apply(obj, [key, name[key]].concat(rest));
-      }
-    } else if (eventSplitter.test(name)) {
-      var names = name.split(eventSplitter);
-      for (var i = 0, l = names.length; i < l; i++) {
-        obj[action].apply(obj, [names[i]].concat(rest));
-      }
-    } else {
-      return true;
-    }
-  };
-
-  // Optimized internal dispatch function for triggering events. Tries to
-  // keep the usual cases speedy (most Backbone events have 3 arguments).
-  var triggerEvents = function(events, args) {
-    var ev, i = -1, l = events.length;
-    switch (args.length) {
-    case 0: while (++i < l) (ev = events[i]).callback.call(ev.ctx);
-    return;
-    case 1: while (++i < l) (ev = events[i]).callback.call(ev.ctx, args[0]);
-    return;
-    case 2: while (++i < l) (ev = events[i]).callback.call(ev.ctx, args[0], args[1]);
-    return;
-    case 3: while (++i < l) (ev = events[i]).callback.call(ev.ctx, args[0], args[1], args[2]);
-    return;
-    default: while (++i < l) (ev = events[i]).callback.apply(ev.ctx, args);
-    }
-  };
-
   // A module that can be mixed in to *any object* in order to provide it with
   // custom events. You may bind with `on` or remove with `off` callback
   // functions to an event; `trigger`-ing an event fires all callbacks in
@@ -115,29 +77,27 @@
   //
   var Events = Backbone.Events = {
 
-    // Bind one or more space separated events, or an events map,
-    // to a `callback` function. Passing `"all"` will bind the callback to
-    // all events fired.
+    // Bind an event to a `callback` function. Passing `"all"` will bind
+    // the callback to all events fired.
     on: function(name, callback, context) {
-      if (!(eventsApi(this, 'on', name, [callback, context]) && callback)) return this;
+      if (!eventsApi(this, 'on', name, [callback, context]) || !callback) return this;
       this._events || (this._events = {});
-      var list = this._events[name] || (this._events[name] = []);
-      list.push({callback: callback, context: context, ctx: context || this});
+      var events = this._events[name] || (this._events[name] = []);
+      events.push({callback: callback, context: context, ctx: context || this});
       return this;
     },
 
-    // Bind events to only be triggered a single time. After the first time
+    // Bind an event to only be triggered a single time. After the first time
     // the callback is invoked, it will be removed.
     once: function(name, callback, context) {
-      if (!(eventsApi(this, 'once', name, [callback, context]) && callback)) return this;
+      if (!eventsApi(this, 'once', name, [callback, context]) || !callback) return this;
       var self = this;
       var once = _.once(function() {
         self.off(name, once);
         callback.apply(this, arguments);
       });
       once._callback = callback;
-      this.on(name, once, context);
-      return this;
+      return this.on(name, once, context);
     },
 
     // Remove one or many callbacks. If `context` is null, removes all
@@ -145,7 +105,7 @@
     // callbacks for the event. If `name` is null, removes all bound
     // callbacks for all events.
     off: function(name, callback, context) {
-      var list, ev, events, names, i, l, j, k;
+      var retain, ev, events, names, i, l, j, k;
       if (!this._events || !eventsApi(this, 'off', name, [callback, context])) return this;
       if (!name && !callback && !context) {
         this._events = {};
@@ -155,19 +115,18 @@
       names = name ? [name] : _.keys(this._events);
       for (i = 0, l = names.length; i < l; i++) {
         name = names[i];
-        if (list = this._events[name]) {
-          events = [];
+        if (events = this._events[name]) {
+          this._events[name] = retain = [];
           if (callback || context) {
-            for (j = 0, k = list.length; j < k; j++) {
-              ev = list[j];
-              if ((callback && callback !== ev.callback &&
-                               callback !== ev.callback._callback) ||
+            for (j = 0, k = events.length; j < k; j++) {
+              ev = events[j];
+              if ((callback && callback !== ev.callback && callback !== ev.callback._callback) ||
                   (context && context !== ev.context)) {
-                events.push(ev);
+                retain.push(ev);
               }
             }
           }
-          this._events[name] = events;
+          if (!retain.length) delete this._events[name];
         }
       }
 
@@ -189,35 +148,82 @@
       return this;
     },
 
-    // An inversion-of-control version of `on`. Tell *this* object to listen to
-    // an event in another object ... keeping track of what it's listening to.
-    listenTo: function(obj, name, callback) {
-      var listeners = this._listeners || (this._listeners = {});
-      var id = obj._listenerId || (obj._listenerId = _.uniqueId('l'));
-      listeners[id] = obj;
-      obj.on(name, typeof name === 'object' ? this : callback, this);
-      return this;
-    },
-
     // Tell this object to stop listening to either specific events ... or
     // to every object it's currently listening to.
     stopListening: function(obj, name, callback) {
       var listeners = this._listeners;
-      if (!listeners) return;
-      if (obj) {
-        obj.off(name, typeof name === 'object' ? this : callback, this);
-        if (!name && !callback) delete listeners[obj._listenerId];
-      } else {
-        if (typeof name === 'object') callback = this;
-        for (var id in listeners) {
-          listeners[id].off(name, callback, this);
-        }
-        this._listeners = {};
+      if (!listeners) return this;
+      var deleteListener = !name && !callback;
+      if (typeof name === 'object') callback = this;
+      if (obj) (listeners = {})[obj._listenerId] = obj;
+      for (var id in listeners) {
+        listeners[id].off(name, callback, this);
+        if (deleteListener) delete this._listeners[id];
       }
       return this;
     }
+
   };
 
+  // Regular expression used to split event strings.
+  var eventSplitter = /\s+/;
+
+  // Implement fancy features of the Events API such as multiple event
+  // names `"change blur"` and jQuery-style event maps `{change: action}`
+  // in terms of the existing API.
+  var eventsApi = function(obj, action, name, rest) {
+    if (!name) return true;
+
+    // Handle event maps.
+    if (typeof name === 'object') {
+      for (var key in name) {
+        obj[action].apply(obj, [key, name[key]].concat(rest));
+      }
+      return false;
+    }
+
+    // Handle space separated event names.
+    if (eventSplitter.test(name)) {
+      var names = name.split(eventSplitter);
+      for (var i = 0, l = names.length; i < l; i++) {
+        obj[action].apply(obj, [names[i]].concat(rest));
+      }
+      return false;
+    }
+
+    return true;
+  };
+
+  // A difficult-to-believe, but optimized internal dispatch function for
+  // triggering events. Tries to keep the usual cases speedy (most internal
+  // Backbone events have 3 arguments).
+  var triggerEvents = function(events, args) {
+    var ev, i = -1, l = events.length, a1 = args[0], a2 = args[1], a3 = args[2];
+    switch (args.length) {
+      case 0: while (++i < l) (ev = events[i]).callback.call(ev.ctx); return;
+      case 1: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1); return;
+      case 2: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1, a2); return;
+      case 3: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1, a2, a3); return;
+      default: while (++i < l) (ev = events[i]).callback.apply(ev.ctx, args);
+    }
+  };
+
+  var listenMethods = {listenTo: 'on', listenToOnce: 'once'};
+
+  // Inversion-of-control versions of `on` and `once`. Tell *this* object to
+  // listen to an event in another object ... keeping track of what it's
+  // listening to.
+  _.each(listenMethods, function(implementation, method) {
+    Events[method] = function(obj, name, callback) {
+      var listeners = this._listeners || (this._listeners = {});
+      var id = obj._listenerId || (obj._listenerId = _.uniqueId('l'));
+      listeners[id] = obj;
+      if (typeof name === 'object') callback = this;
+      obj[implementation](name, callback, this);
+      return this;
+    };
+  });
+
   // Aliases for backwards compatibility.
   Events.bind   = Events.on;
   Events.unbind = Events.off;
@@ -229,15 +235,21 @@
   // Backbone.Model
   // --------------
 
-  // Create a new model, with defined attributes. A client id (`cid`)
+  // Backbone **Models** are the basic data object in the framework --
+  // frequently representing a row in a table in a database on your server.
+  // A discrete chunk of data and a bunch of useful, related methods for
+  // performing computations and transformations on that data.
+
+  // Create a new model with the specified attributes. A client id (`cid`)
   // is automatically generated and assigned for you.
   var Model = Backbone.Model = function(attributes, options) {
     var defaults;
     var attrs = attributes || {};
+    options || (options = {});
     this.cid = _.uniqueId('c');
     this.attributes = {};
-    if (options && options.collection) this.collection = options.collection;
-    if (options && options.parse) attrs = this.parse(attrs, options) || {};
+    _.extend(this, _.pick(options, modelOptions));
+    if (options.parse) attrs = this.parse(attrs, options) || {};
     if (defaults = _.result(this, 'defaults')) {
       attrs = _.defaults({}, attrs, defaults);
     }
@@ -246,12 +258,18 @@
     this.initialize.apply(this, arguments);
   };
 
+  // A list of options to be attached directly to the model, if provided.
+  var modelOptions = ['url', 'urlRoot', 'collection'];
+
   // Attach all inheritable methods to the Model prototype.
   _.extend(Model.prototype, Events, {
 
     // A hash of attributes whose current and previous value differ.
     changed: null,
 
+    // The value returned during the last failed validation.
+    validationError: null,
+
     // The default name for the JSON `id` attribute is `"id"`. MongoDB and
     // CouchDB users may want to set this to `"_id"`.
     idAttribute: 'id',
@@ -265,7 +283,8 @@
       return _.clone(this.attributes);
     },
 
-    // Proxy `Backbone.sync` by default.
+    // Proxy `Backbone.sync` by default -- but override this if you need
+    // custom syncing semantics for *this* particular model.
     sync: function() {
       return Backbone.sync.apply(this, arguments);
     },
@@ -286,10 +305,9 @@
       return this.get(attr) != null;
     },
 
-    // ----------------------------------------------------------------------
-
-    // Set a hash of model attributes on the object, firing `"change"` unless
-    // you choose to silence it.
+    // Set a hash of model attributes on the object, firing `"change"`. This is
+    // the core primitive operation of a model, updating the data and notifying
+    // anyone who needs to know about the change in state. The heart of the beast.
     set: function(key, val, options) {
       var attr, attrs, unset, changes, silent, changing, prev, current;
       if (key == null) return this;
@@ -343,6 +361,8 @@
         }
       }
 
+      // You might be wondering why there's a `while` loop here. Changes can
+      // be recursively nested within `"change"` events.
       if (changing) return this;
       if (!silent) {
         while (this._pending) {
@@ -355,14 +375,13 @@
       return this;
     },
 
-    // Remove an attribute from the model, firing `"change"` unless you choose
-    // to silence it. `unset` is a noop if the attribute doesn't exist.
+    // Remove an attribute from the model, firing `"change"`. `unset` is a noop
+    // if the attribute doesn't exist.
     unset: function(attr, options) {
       return this.set(attr, void 0, _.extend({}, options, {unset: true}));
     },
 
-    // Clear all attributes on the model, firing `"change"` unless you choose
-    // to silence it.
+    // Clear all attributes on the model, firing `"change"`.
     clear: function(options) {
       var attrs = {};
       for (var key in this.attributes) attrs[key] = void 0;
@@ -406,19 +425,20 @@
       return _.clone(this._previousAttributes);
     },
 
-    // ---------------------------------------------------------------------
-
     // Fetch the model from the server. If the server's representation of the
-    // model differs from its current attributes, they will be overriden,
+    // model differs from its current attributes, they will be overridden,
     // triggering a `"change"` event.
     fetch: function(options) {
       options = options ? _.clone(options) : {};
       if (options.parse === void 0) options.parse = true;
+      var model = this;
       var success = options.success;
-      options.success = function(model, resp, options) {
+      options.success = function(resp) {
         if (!model.set(model.parse(resp, options), options)) return false;
         if (success) success(model, resp, options);
+        model.trigger('sync', model, resp, options);
       };
+      wrapError(this, options);
       return this.sync('read', this, options);
     },
 
@@ -426,7 +446,7 @@
     // If the server returns an attributes hash that differs, the model's
     // state will be `set` again.
     save: function(key, val, options) {
-      var attrs, success, method, xhr, attributes = this.attributes;
+      var attrs, method, xhr, attributes = this.attributes;
 
       // Handle both `"key", value` and `{key: value}` -style arguments.
       if (key == null || typeof key === 'object') {
@@ -452,8 +472,9 @@
       // After a successful server-side save, the client is (optionally)
       // updated with the server-side state.
       if (options.parse === void 0) options.parse = true;
-      success = options.success;
-      options.success = function(model, resp, options) {
+      var model = this;
+      var success = options.success;
+      options.success = function(resp) {
         // Ensure attributes are restored during synchronous saves.
         model.attributes = attributes;
         var serverAttrs = model.parse(resp, options);
@@ -462,9 +483,10 @@
           return false;
         }
         if (success) success(model, resp, options);
+        model.trigger('sync', model, resp, options);
       };
+      wrapError(this, options);
 
-      // Finish configuring and sending the Ajax request.
       method = this.isNew() ? 'create' : (options.patch ? 'patch' : 'update');
       if (method === 'patch') options.attrs = attrs;
       xhr = this.sync(method, this, options);
@@ -487,15 +509,17 @@
         model.trigger('destroy', model, model.collection, options);
       };
 
-      options.success = function(model, resp, options) {
+      options.success = function(resp) {
         if (options.wait || model.isNew()) destroy();
         if (success) success(model, resp, options);
+        if (!model.isNew()) model.trigger('sync', model, resp, options);
       };
 
       if (this.isNew()) {
-        options.success(this, null, options);
+        options.success();
         return false;
       }
+      wrapError(this, options);
 
       var xhr = this.sync('delete', this, options);
       if (!options.wait) destroy();
@@ -529,39 +553,61 @@
 
     // Check if the model is currently in a valid state.
     isValid: function(options) {
-      return !this.validate || !this.validate(this.attributes, options);
+      return this._validate({}, _.extend(options || {}, { validate: true }));
     },
 
     // Run validation against the next complete set of model attributes,
-    // returning `true` if all is well. Otherwise, fire a general
-    // `"error"` event and call the error callback, if specified.
+    // returning `true` if all is well. Otherwise, fire an `"invalid"` event.
     _validate: function(attrs, options) {
       if (!options.validate || !this.validate) return true;
       attrs = _.extend({}, this.attributes, attrs);
       var error = this.validationError = this.validate(attrs, options) || null;
       if (!error) return true;
-      this.trigger('invalid', this, error, options || {});
+      this.trigger('invalid', this, error, _.extend(options || {}, {validationError: error}));
       return false;
     }
 
   });
 
+  // Underscore methods that we want to implement on the Model.
+  var modelMethods = ['keys', 'values', 'pairs', 'invert', 'pick', 'omit'];
+
+  // Mix in each Underscore method as a proxy to `Model#attributes`.
+  _.each(modelMethods, function(method) {
+    Model.prototype[method] = function() {
+      var args = slice.call(arguments);
+      args.unshift(this.attributes);
+      return _[method].apply(_, args);
+    };
+  });
+
   // Backbone.Collection
   // -------------------
 
-  // Provides a standard collection class for our sets of models, ordered
-  // or unordered. If a `comparator` is specified, the Collection will maintain
+  // If models tend to represent a single row of data, a Backbone Collection is
+  // more analagous to a table full of data ... or a small slice or page of that
+  // table, or a collection of rows that belong together for a particular reason
+  // -- all of the messages in this particular folder, all of the documents
+  // belonging to this particular author, and so on. Collections maintain
+  // indexes of their models, both in order, and for lookup by `id`.
+
+  // Create a new **Collection**, perhaps to contain a specific type of `model`.
+  // If a `comparator` is specified, the Collection will maintain
   // its models in sort order, as they're added and removed.
   var Collection = Backbone.Collection = function(models, options) {
     options || (options = {});
+    if (options.url) this.url = options.url;
     if (options.model) this.model = options.model;
     if (options.comparator !== void 0) this.comparator = options.comparator;
-    this.models = [];
     this._reset();
     this.initialize.apply(this, arguments);
     if (models) this.reset(models, _.extend({silent: true}, options));
   };
 
+  // Default options for `Collection#set`.
+  var setOptions = {add: true, remove: true, merge: true};
+  var addOptions = {add: true, merge: false, remove: false};
+
   // Define the Collection's inheritable methods.
   _.extend(Collection.prototype, Events, {
 
@@ -586,88 +632,118 @@
 
     // Add a model, or list of models to the set.
     add: function(models, options) {
+      return this.set(models, _.defaults(options || {}, addOptions));
+    },
+
+    // Remove a model, or a list of models from the set.
+    remove: function(models, options) {
       models = _.isArray(models) ? models.slice() : [models];
       options || (options = {});
-      var i, l, model, attrs, existing, doSort, add, at, sort, sortAttr;
-      add = [];
-      at = options.at;
-      sort = this.comparator && (at == null) && options.sort != false;
-      sortAttr = _.isString(this.comparator) ? this.comparator : null;
+      var i, l, index, model;
+      for (i = 0, l = models.length; i < l; i++) {
+        model = this.get(models[i]);
+        if (!model) continue;
+        delete this._byId[model.id];
+        delete this._byId[model.cid];
+        index = this.indexOf(model);
+        this.models.splice(index, 1);
+        this.length--;
+        if (!options.silent) {
+          options.index = index;
+          model.trigger('remove', model, this, options);
+        }
+        this._removeReference(model);
+      }
+      return this;
+    },
+
+    // Update a collection by `set`-ing a new list of models, adding new ones,
+    // removing models that are no longer present, and merging models that
+    // already exist in the collection, as necessary. Similar to **Model#set**,
+    // the core operation for updating the data contained by the collection.
+    set: function(models, options) {
+      options = _.defaults(options || {}, setOptions);
+      if (options.parse) models = this.parse(models, options);
+      if (!_.isArray(models)) models = models ? [models] : [];
+      var i, l, model, attrs, existing, sort;
+      var at = options.at;
+      var sortable = this.comparator && (at == null) && options.sort !== false;
+      var sortAttr = _.isString(this.comparator) ? this.comparator : null;
+      var toAdd = [], toRemove = [], modelMap = {};
 
       // Turn bare objects into model references, and prevent invalid models
       // from being added.
       for (i = 0, l = models.length; i < l; i++) {
-        if (!(model = this._prepareModel(attrs = models[i], options))) {
-          this.trigger('invalid', this, attrs, options);
-          continue;
-        }
+        if (!(model = this._prepareModel(models[i], options))) continue;
 
         // If a duplicate is found, prevent it from being added and
         // optionally merge it into the existing model.
         if (existing = this.get(model)) {
+          if (options.remove) modelMap[existing.cid] = true;
           if (options.merge) {
-            existing.set(attrs === model ? model.attributes : attrs, options);
-            if (sort && !doSort && existing.hasChanged(sortAttr)) doSort = true;
+            existing.set(model.attributes, options);
+            if (sortable && !sort && existing.hasChanged(sortAttr)) sort = true;
           }
-          continue;
-        }
 
-        // This is a new model, push it to the `add` list.
-        add.push(model);
+        // This is a new model, push it to the `toAdd` list.
+        } else if (options.add) {
+          toAdd.push(model);
 
-        // Listen to added models' events, and index models for lookup by
-        // `id` and by `cid`.
-        model.on('all', this._onModelEvent, this);
-        this._byId[model.cid] = model;
-        if (model.id != null) this._byId[model.id] = model;
+          // Listen to added models' events, and index models for lookup by
+          // `id` and by `cid`.
+          model.on('all', this._onModelEvent, this);
+          this._byId[model.cid] = model;
+          if (model.id != null) this._byId[model.id] = model;
+        }
+      }
+
+      // Remove nonexistent models if appropriate.
+      if (options.remove) {
+        for (i = 0, l = this.length; i < l; ++i) {
+          if (!modelMap[(model = this.models[i]).cid]) toRemove.push(model);
+        }
+        if (toRemove.length) this.remove(toRemove, options);
       }
 
       // See if sorting is needed, update `length` and splice in new models.
-      if (add.length) {
-        if (sort) doSort = true;
-        this.length += add.length;
+      if (toAdd.length) {
+        if (sortable) sort = true;
+        this.length += toAdd.length;
         if (at != null) {
-          splice.apply(this.models, [at, 0].concat(add));
+          splice.apply(this.models, [at, 0].concat(toAdd));
         } else {
-          push.apply(this.models, add);
+          push.apply(this.models, toAdd);
         }
       }
 
       // Silently sort the collection if appropriate.
-      if (doSort) this.sort({silent: true});
+      if (sort) this.sort({silent: true});
 
       if (options.silent) return this;
 
       // Trigger `add` events.
-      for (i = 0, l = add.length; i < l; i++) {
-        (model = add[i]).trigger('add', model, this, options);
+      for (i = 0, l = toAdd.length; i < l; i++) {
+        (model = toAdd[i]).trigger('add', model, this, options);
       }
 
       // Trigger `sort` if the collection was sorted.
-      if (doSort) this.trigger('sort', this, options);
-
+      if (sort) this.trigger('sort', this, options);
       return this;
     },
 
-    // Remove a model, or a list of models from the set.
-    remove: function(models, options) {
-      models = _.isArray(models) ? models.slice() : [models];
+    // When you have more items than you want to add or remove individually,
+    // you can reset the entire set with a new list of models, without firing
+    // any granular `add` or `remove` events. Fires `reset` when finished.
+    // Useful for bulk operations and optimizations.
+    reset: function(models, options) {
       options || (options = {});
-      var i, l, index, model;
-      for (i = 0, l = models.length; i < l; i++) {
-        model = this.get(models[i]);
-        if (!model) continue;
-        delete this._byId[model.id];
-        delete this._byId[model.cid];
-        index = this.indexOf(model);
-        this.models.splice(index, 1);
-        this.length--;
-        if (!options.silent) {
-          options.index = index;
-          model.trigger('remove', model, this, options);
-        }
-        this._removeReference(model);
+      for (var i = 0, l = this.models.length; i < l; i++) {
+        this._removeReference(this.models[i]);
       }
+      options.previousModels = this.models;
+      this._reset();
+      this.add(models, _.extend({silent: true}, options));
+      if (!options.silent) this.trigger('reset', this, options);
       return this;
     },
 
@@ -707,8 +783,7 @@
     // Get a model from the set by id.
     get: function(obj) {
       if (obj == null) return void 0;
-      this._idAttr || (this._idAttr = this.model.prototype.idAttribute);
-      return this._byId[obj.id || obj.cid || obj[this._idAttr] || obj];
+      return this._byId[obj.id != null ? obj.id : obj.cid || obj];
     },
 
     // Get the model at the given index.
@@ -716,10 +791,11 @@
       return this.models[index];
     },
 
-    // Return models with matching attributes. Useful for simple cases of `filter`.
-    where: function(attrs) {
-      if (_.isEmpty(attrs)) return [];
-      return this.filter(function(model) {
+    // Return models with matching attributes. Useful for simple cases of
+    // `filter`.
+    where: function(attrs, first) {
+      if (_.isEmpty(attrs)) return first ? void 0 : [];
+      return this[first ? 'find' : 'filter'](function(model) {
         for (var key in attrs) {
           if (attrs[key] !== model.get(key)) return false;
         }
@@ -727,13 +803,17 @@
       });
     },
 
+    // Return the first model with matching attributes. Useful for simple cases
+    // of `find`.
+    findWhere: function(attrs) {
+      return this.where(attrs, true);
+    },
+
     // Force the collection to re-sort itself. You don't need to call this under
     // normal circumstances, as the set will maintain sort order as each item
     // is added.
     sort: function(options) {
-      if (!this.comparator) {
-        throw new Error('Cannot sort a set without a comparator');
-      }
+      if (!this.comparator) throw new Error('Cannot sort a set without a comparator');
       options || (options = {});
 
       // Run sort based on type of `comparator`.
@@ -747,75 +827,36 @@
       return this;
     },
 
+    // Figure out the smallest index at which a model should be inserted so as
+    // to maintain order.
+    sortedIndex: function(model, value, context) {
+      value || (value = this.comparator);
+      var iterator = _.isFunction(value) ? value : function(model) {
+        return model.get(value);
+      };
+      return _.sortedIndex(this.models, model, iterator, context);
+    },
+
     // Pluck an attribute from each model in the collection.
     pluck: function(attr) {
       return _.invoke(this.models, 'get', attr);
     },
 
-    // Smartly update a collection with a change set of models, adding,
-    // removing, and merging as necessary.
-    update: function(models, options) {
-      options = _.extend({add: true, merge: true, remove: true}, options);
-      if (options.parse) models = this.parse(models, options);
-      var model, i, l, existing;
-      var add = [], remove = [], modelMap = {};
-
-      // Allow a single model (or no argument) to be passed.
-      if (!_.isArray(models)) models = models ? [models] : [];
-
-      // Proxy to `add` for this case, no need to iterate...
-      if (options.add && !options.remove) return this.add(models, options);
-
-      // Determine which models to add and merge, and which to remove.
-      for (i = 0, l = models.length; i < l; i++) {
-        model = models[i];
-        existing = this.get(model);
-        if (options.remove && existing) modelMap[existing.cid] = true;
-        if ((options.add && !existing) || (options.merge && existing)) {
-          add.push(model);
-        }
-      }
-      if (options.remove) {
-        for (i = 0, l = this.models.length; i < l; i++) {
-          model = this.models[i];
-          if (!modelMap[model.cid]) remove.push(model);
-        }
-      }
-
-      // Remove models (if applicable) before we add and merge the rest.
-      if (remove.length) this.remove(remove, options);
-      if (add.length) this.add(add, options);
-      return this;
-    },
-
-    // When you have more items than you want to add or remove individually,
-    // you can reset the entire set with a new list of models, without firing
-    // any `add` or `remove` events. Fires `reset` when finished.
-    reset: function(models, options) {
-      options || (options = {});
-      if (options.parse) models = this.parse(models, options);
-      for (var i = 0, l = this.models.length; i < l; i++) {
-        this._removeReference(this.models[i]);
-      }
-      options.previousModels = this.models.slice();
-      this._reset();
-      if (models) this.add(models, _.extend({silent: true}, options));
-      if (!options.silent) this.trigger('reset', this, options);
-      return this;
-    },
-
     // Fetch the default set of models for this collection, resetting the
-    // collection when they arrive. If `update: true` is passed, the response
-    // data will be passed through the `update` method instead of `reset`.
+    // collection when they arrive. If `reset: true` is passed, the response
+    // data will be passed through the `reset` method instead of `set`.
     fetch: function(options) {
       options = options ? _.clone(options) : {};
       if (options.parse === void 0) options.parse = true;
       var success = options.success;
-      options.success = function(collection, resp, options) {
-        var method = options.update ? 'update' : 'reset';
+      var collection = this;
+      options.success = function(resp) {
+        var method = options.reset ? 'reset' : 'set';
         collection[method](resp, options);
         if (success) success(collection, resp, options);
+        collection.trigger('sync', collection, resp, options);
       };
+      wrapError(this, options);
       return this.sync('read', this, options);
     },
 
@@ -828,7 +869,7 @@
       if (!options.wait) this.add(model, options);
       var collection = this;
       var success = options.success;
-      options.success = function(model, resp, options) {
+      options.success = function(resp) {
         if (options.wait) collection.add(model, options);
         if (success) success(model, resp, options);
       };
@@ -847,14 +888,16 @@
       return new this.constructor(this.models);
     },
 
-    // Reset all internal state. Called when the collection is reset.
+    // Private method to reset all internal state. Called when the collection
+    // is first initialized or reset.
     _reset: function() {
       this.length = 0;
-      this.models.length = 0;
+      this.models = [];
       this._byId  = {};
     },
 
-    // Prepare a model or hash of attributes to be added to this collection.
+    // Prepare a hash of attributes (or other model) to be added to this
+    // collection.
     _prepareModel: function(attrs, options) {
       if (attrs instanceof Model) {
         if (!attrs.collection) attrs.collection = this;
@@ -863,11 +906,14 @@
       options || (options = {});
       options.collection = this;
       var model = new this.model(attrs, options);
-      if (!model._validate(attrs, options)) return false;
+      if (!model._validate(attrs, options)) {
+        this.trigger('invalid', this, attrs, options);
+        return false;
+      }
       return model;
     },
 
-    // Internal method to remove a model's ties to a collection.
+    // Internal method to sever a model's ties to a collection.
     _removeReference: function(model) {
       if (this === model.collection) delete model.collection;
       model.off('all', this._onModelEvent, this);
@@ -885,19 +931,13 @@
         if (model.id != null) this._byId[model.id] = model;
       }
       this.trigger.apply(this, arguments);
-    },
-
-    sortedIndex: function (model, value, context) {
-      value || (value = this.comparator);
-      var iterator = _.isFunction(value) ? value : function(model) {
-        return model.get(value);
-      };
-      return _.sortedIndex(this.models, model, iterator, context);
     }
 
   });
 
   // Underscore methods that we want to implement on the Collection.
+  // 90% of the core usefulness of Backbone Collections is actually implemented
+  // right here:
   var methods = ['forEach', 'each', 'map', 'collect', 'reduce', 'foldl',
     'inject', 'reduceRight', 'foldr', 'find', 'detect', 'filter', 'select',
     'reject', 'every', 'all', 'some', 'any', 'include', 'contains', 'invoke',
@@ -927,6 +967,241 @@
     };
   });
 
+  // Backbone.View
+  // -------------
+
+  // Backbone Views are almost more convention than they are actual code. A View
+  // is simply a JavaScript object that represents a logical chunk of UI in the
+  // DOM. This might be a single item, an entire list, a sidebar or panel, or
+  // even the surrounding frame which wraps your whole app. Defining a chunk of
+  // UI as a **View** allows you to define your DOM events declaratively, without
+  // having to worry about render order ... and makes it easy for the view to
+  // react to specific changes in the state of your models.
+
+  // Creating a Backbone.View creates its initial element outside of the DOM,
+  // if an existing element is not provided...
+  var View = Backbone.View = function(options) {
+    this.cid = _.uniqueId('view');
+    this._configure(options || {});
+    this._ensureElement();
+    this.initialize.apply(this, arguments);
+    this.delegateEvents();
+  };
+
+  // Cached regex to split keys for `delegate`.
+  var delegateEventSplitter = /^(\S+)\s*(.*)$/;
+
+  // List of view options to be merged as properties.
+  var viewOptions = ['model', 'collection', 'el', 'id', 'attributes', 'className', 'tagName', 'events'];
+
+  // Set up all inheritable **Backbone.View** properties and methods.
+  _.extend(View.prototype, Events, {
+
+    // The default `tagName` of a View's element is `"div"`.
+    tagName: 'div',
+
+    // jQuery delegate for element lookup, scoped to DOM elements within the
+    // current view. This should be prefered to global lookups where possible.
+    $: function(selector) {
+      return this.$el.find(selector);
+    },
+
+    // Initialize is an empty function by default. Override it with your own
+    // initialization logic.
+    initialize: function(){},
+
+    // **render** is the core function that your view should override, in order
+    // to populate its element (`this.el`), with the appropriate HTML. The
+    // convention is for **render** to always return `this`.
+    render: function() {
+      return this;
+    },
+
+    // Remove this view by taking the element out of the DOM, and removing any
+    // applicable Backbone.Events listeners.
+    remove: function() {
+      this.$el.remove();
+      this.stopListening();
+      return this;
+    },
+
+    // Change the view's element (`this.el` property), including event
+    // re-delegation.
+    setElement: function(element, delegate) {
+      if (this.$el) this.undelegateEvents();
+      this.$el = element instanceof Backbone.$ ? element : Backbone.$(element);
+      this.el = this.$el[0];
+      if (delegate !== false) this.delegateEvents();
+      return this;
+    },
+
+    // Set callbacks, where `this.events` is a hash of
+    //
+    // *{"event selector": "callback"}*
+    //
+    //     {
+    //       'mousedown .title':  'edit',
+    //       'click .button':     'save'
+    //       'click .open':       function(e) { ... }
+    //     }
+    //
+    // pairs. Callbacks will be bound to the view, with `this` set properly.
+    // Uses event delegation for efficiency.
+    // Omitting the selector binds the event to `this.el`.
+    // This only works for delegate-able events: not `focus`, `blur`, and
+    // not `change`, `submit`, and `reset` in Internet Explorer.
+    delegateEvents: function(events) {
+      if (!(events || (events = _.result(this, 'events')))) return this;
+      this.undelegateEvents();
+      for (var key in events) {
+        var method = events[key];
+        if (!_.isFunction(method)) method = this[events[key]];
+        if (!method) continue;
+
+        var match = key.match(delegateEventSplitter);
+        var eventName = match[1], selector = match[2];
+        method = _.bind(method, this);
+        eventName += '.delegateEvents' + this.cid;
+        if (selector === '') {
+          this.$el.on(eventName, method);
+        } else {
+          this.$el.on(eventName, selector, method);
+        }
+      }
+      return this;
+    },
+
+    // Clears all callbacks previously bound to the view with `delegateEvents`.
+    // You usually don't need to use this, but may wish to if you have multiple
+    // Backbone views attached to the same DOM element.
+    undelegateEvents: function() {
+      this.$el.off('.delegateEvents' + this.cid);
+      return this;
+    },
+
+    // Performs the initial configuration of a View with a set of options.
+    // Keys with special meaning *(e.g. model, collection, id, className)* are
+    // attached directly to the view.  See `viewOptions` for an exhaustive
+    // list.
+    _configure: function(options) {
+      if (this.options) options = _.extend({}, _.result(this, 'options'), options);
+      _.extend(this, _.pick(options, viewOptions));
+      this.options = options;
+    },
+
+    // Ensure that the View has a DOM element to render into.
+    // If `this.el` is a string, pass it through `$()`, take the first
+    // matching element, and re-assign it to `el`. Otherwise, create
+    // an element from the `id`, `className` and `tagName` properties.
+    _ensureElement: function() {
+      if (!this.el) {
+        var attrs = _.extend({}, _.result(this, 'attributes'));
+        if (this.id) attrs.id = _.result(this, 'id');
+        if (this.className) attrs['class'] = _.result(this, 'className');
+        var $el = Backbone.$('<' + _.result(this, 'tagName') + '>').attr(attrs);
+        this.setElement($el, false);
+      } else {
+        this.setElement(_.result(this, 'el'), false);
+      }
+    }
+
+  });
+
+  // Backbone.sync
+  // -------------
+
+  // Override this function to change the manner in which Backbone persists
+  // models to the server. You will be passed the type of request, and the
+  // model in question. By default, makes a RESTful Ajax request
+  // to the model's `url()`. Some possible customizations could be:
+  //
+  // * Use `setTimeout` to batch rapid-fire updates into a single request.
+  // * Send up the models as XML instead of JSON.
+  // * Persist models via WebSockets instead of Ajax.
+  //
+  // Turn on `Backbone.emulateHTTP` in order to send `PUT` and `DELETE` requests
+  // as `POST`, with a `_method` parameter containing the true HTTP method,
+  // as well as all requests with the body as `application/x-www-form-urlencoded`
+  // instead of `application/json` with the model in a param named `model`.
+  // Useful when interfacing with server-side languages like **PHP** that make
+  // it difficult to read the body of `PUT` requests.
+  Backbone.sync = function(method, model, options) {
+    var type = methodMap[method];
+
+    // Default options, unless specified.
+    _.defaults(options || (options = {}), {
+      emulateHTTP: Backbone.emulateHTTP,
+      emulateJSON: Backbone.emulateJSON
+    });
+
+    // Default JSON-request options.
+    var params = {type: type, dataType: 'json'};
+
+    // Ensure that we have a URL.
+    if (!options.url) {
+      params.url = _.result(model, 'url') || urlError();
+    }
+
+    // Ensure that we have the appropriate request data.
+    if (options.data == null && model && (method === 'create' || method === 'update' || method === 'patch')) {
+      params.contentType = 'application/json';
+      params.data = JSON.stringify(options.attrs || model.toJSON(options));
+    }
+
+    // For older servers, emulate JSON by encoding the request into an HTML-form.
+    if (options.emulateJSON) {
+      params.contentType = 'application/x-www-form-urlencoded';
+      params.data = params.data ? {model: params.data} : {};
+    }
+
+    // For older servers, emulate HTTP by mimicking the HTTP method with `_method`
+    // And an `X-HTTP-Method-Override` header.
+    if (options.emulateHTTP && (type === 'PUT' || type === 'DELETE' || type === 'PATCH')) {
+      params.type = 'POST';
+      if (options.emulateJSON) params.data._method = type;
+      var beforeSend = options.beforeSend;
+      options.beforeSend = function(xhr) {
+        xhr.setRequestHeader('X-HTTP-Method-Override', type);
+        if (beforeSend) return beforeSend.apply(this, arguments);
+      };
+    }
+
+    // Don't process data on a non-GET request.
+    if (params.type !== 'GET' && !options.emulateJSON) {
+      params.processData = false;
+    }
+
+    // If we're sending a `PATCH` request, and we're in an old Internet Explorer
+    // that still has ActiveX enabled by default, override jQuery to use that
+    // for XHR instead. Remove this line when jQuery supports `PATCH` on IE8.
+    if (params.type === 'PATCH' && window.ActiveXObject &&
+          !(window.external && window.external.msActiveXFilteringEnabled)) {
+      params.xhr = function() {
+        return new ActiveXObject("Microsoft.XMLHTTP");
+      };
+    }
+
+    // Make the request, allowing the user to override any Ajax options.
+    var xhr = options.xhr = Backbone.ajax(_.extend(params, options));
+    model.trigger('request', model, xhr, options);
+    return xhr;
+  };
+
+  // Map from CRUD to HTTP for our default `Backbone.sync` implementation.
+  var methodMap = {
+    'create': 'POST',
+    'update': 'PUT',
+    'patch':  'PATCH',
+    'delete': 'DELETE',
+    'read':   'GET'
+  };
+
+  // Set the default implementation of `Backbone.ajax` to proxy through to `$`.
+  // Override this if you'd like to use a different library.
+  Backbone.ajax = function() {
+    return Backbone.$.ajax.apply(Backbone.$, arguments);
+  };
+
   // Backbone.Router
   // ---------------
 
@@ -961,14 +1236,19 @@
     //
     route: function(route, name, callback) {
       if (!_.isRegExp(route)) route = this._routeToRegExp(route);
+      if (_.isFunction(name)) {
+        callback = name;
+        name = '';
+      }
       if (!callback) callback = this[name];
-      Backbone.history.route(route, _.bind(function(fragment) {
-        var args = this._extractParameters(route, fragment);
-        callback && callback.apply(this, args);
-        this.trigger.apply(this, ['route:' + name].concat(args));
-        this.trigger('route', name, args);
-        Backbone.history.trigger('route', this, name, args);
-      }, this));
+      var router = this;
+      Backbone.history.route(route, function(fragment) {
+        var args = router._extractParameters(route, fragment);
+        callback && callback.apply(router, args);
+        router.trigger.apply(router, ['route:' + name].concat(args));
+        router.trigger('route', name, args);
+        Backbone.history.trigger('route', router, name, args);
+      });
       return this;
     },
 
@@ -983,6 +1263,7 @@
     // routes can be defined at the bottom of the route map.
     _bindRoutes: function() {
       if (!this.routes) return;
+      this.routes = _.result(this, 'routes');
       var route, routes = _.keys(this.routes);
       while ((route = routes.pop()) != null) {
         this.route(route, this.routes[route]);
@@ -1002,9 +1283,13 @@
     },
 
     // Given a route, and a URL fragment that it matches, return the array of
-    // extracted parameters.
+    // extracted decoded parameters. Empty or unmatched parameters will be
+    // treated as `null` to normalize cross-browser behavior.
     _extractParameters: function(route, fragment) {
-      return route.exec(fragment).slice(1);
+      var params = route.exec(fragment).slice(1);
+      return _.map(params, function(param) {
+        return param ? decodeURIComponent(param) : null;
+      });
     }
 
   });
@@ -1012,8 +1297,11 @@
   // Backbone.History
   // ----------------
 
-  // Handles cross-browser history management, based on URL fragments. If the
-  // browser does not support `onhashchange`, falls back to polling.
+  // Handles cross-browser history management, based on either
+  // [pushState](http://diveintohtml5.info/history.html) and real URLs, or
+  // [onhashchange](https://developer.mozilla.org/en-US/docs/DOM/window.onhashchange)
+  // and URL fragments. If the browser supports neither (old IE, natch),
+  // falls back to polling.
   var History = Backbone.History = function() {
     this.handlers = [];
     _.bindAll(this, 'checkUrl');
@@ -1224,230 +1512,6 @@
   // Create the default Backbone.history.
   Backbone.history = new History;
 
-  // Backbone.View
-  // -------------
-
-  // Creating a Backbone.View creates its initial element outside of the DOM,
-  // if an existing element is not provided...
-  var View = Backbone.View = function(options) {
-    this.cid = _.uniqueId('view');
-    this._configure(options || {});
-    this._ensureElement();
-    this.initialize.apply(this, arguments);
-    this.delegateEvents();
-  };
-
-  // Cached regex to split keys for `delegate`.
-  var delegateEventSplitter = /^(\S+)\s*(.*)$/;
-
-  // List of view options to be merged as properties.
-  var viewOptions = ['model', 'collection', 'el', 'id', 'attributes', 'className', 'tagName', 'events'];
-
-  // Set up all inheritable **Backbone.View** properties and methods.
-  _.extend(View.prototype, Events, {
-
-    // The default `tagName` of a View's element is `"div"`.
-    tagName: 'div',
-
-    // jQuery delegate for element lookup, scoped to DOM elements within the
-    // current view. This should be prefered to global lookups where possible.
-    $: function(selector) {
-      return this.$el.find(selector);
-    },
-
-    // Initialize is an empty function by default. Override it with your own
-    // initialization logic.
-    initialize: function(){},
-
-    // **render** is the core function that your view should override, in order
-    // to populate its element (`this.el`), with the appropriate HTML. The
-    // convention is for **render** to always return `this`.
-    render: function() {
-      return this;
-    },
-
-    // Remove this view by taking the element out of the DOM, and removing any
-    // applicable Backbone.Events listeners.
-    remove: function() {
-      this.$el.remove();
-      this.stopListening();
-      return this;
-    },
-
-    // Change the view's element (`this.el` property), including event
-    // re-delegation.
-    setElement: function(element, delegate) {
-      if (this.$el) this.undelegateEvents();
-      this.$el = element instanceof Backbone.$ ? element : Backbone.$(element);
-      this.el = this.$el[0];
-      if (delegate !== false) this.delegateEvents();
-      return this;
-    },
-
-    // Set callbacks, where `this.events` is a hash of
-    //
-    // *{"event selector": "callback"}*
-    //
-    //     {
-    //       'mousedown .title':  'edit',
-    //       'click .button':     'save'
-    //       'click .open':       function(e) { ... }
-    //     }
-    //
-    // pairs. Callbacks will be bound to the view, with `this` set properly.
-    // Uses event delegation for efficiency.
-    // Omitting the selector binds the event to `this.el`.
-    // This only works for delegate-able events: not `focus`, `blur`, and
-    // not `change`, `submit`, and `reset` in Internet Explorer.
-    delegateEvents: function(events) {
-      if (!(events || (events = _.result(this, 'events')))) return;
-      this.undelegateEvents();
-      for (var key in events) {
-        var method = events[key];
-        if (!_.isFunction(method)) method = this[events[key]];
-        if (!method) throw new Error('Method "' + events[key] + '" does not exist');
-        var match = key.match(delegateEventSplitter);
-        var eventName = match[1], selector = match[2];
-        method = _.bind(method, this);
-        eventName += '.delegateEvents' + this.cid;
-        if (selector === '') {
-          this.$el.on(eventName, method);
-        } else {
-          this.$el.on(eventName, selector, method);
-        }
-      }
-    },
-
-    // Clears all callbacks previously bound to the view with `delegateEvents`.
-    // You usually don't need to use this, but may wish to if you have multiple
-    // Backbone views attached to the same DOM element.
-    undelegateEvents: function() {
-      this.$el.off('.delegateEvents' + this.cid);
-    },
-
-    // Performs the initial configuration of a View with a set of options.
-    // Keys with special meaning *(model, collection, id, className)*, are
-    // attached directly to the view.
-    _configure: function(options) {
-      if (this.options) options = _.extend({}, _.result(this, 'options'), options);
-      _.extend(this, _.pick(options, viewOptions));
-      this.options = options;
-    },
-
-    // Ensure that the View has a DOM element to render into.
-    // If `this.el` is a string, pass it through `$()`, take the first
-    // matching element, and re-assign it to `el`. Otherwise, create
-    // an element from the `id`, `className` and `tagName` properties.
-    _ensureElement: function() {
-      if (!this.el) {
-        var attrs = _.extend({}, _.result(this, 'attributes'));
-        if (this.id) attrs.id = _.result(this, 'id');
-        if (this.className) attrs['class'] = _.result(this, 'className');
-        var $el = Backbone.$('<' + _.result(this, 'tagName') + '>').attr(attrs);
-        this.setElement($el, false);
-      } else {
-        this.setElement(_.result(this, 'el'), false);
-      }
-    }
-
-  });
-
-  // Backbone.sync
-  // -------------
-
-  // Map from CRUD to HTTP for our default `Backbone.sync` implementation.
-  var methodMap = {
-    'create': 'POST',
-    'update': 'PUT',
-    'patch':  'PATCH',
-    'delete': 'DELETE',
-    'read':   'GET'
-  };
-
-  // Override this function to change the manner in which Backbone persists
-  // models to the server. You will be passed the type of request, and the
-  // model in question. By default, makes a RESTful Ajax request
-  // to the model's `url()`. Some possible customizations could be:
-  //
-  // * Use `setTimeout` to batch rapid-fire updates into a single request.
-  // * Send up the models as XML instead of JSON.
-  // * Persist models via WebSockets instead of Ajax.
-  //
-  // Turn on `Backbone.emulateHTTP` in order to send `PUT` and `DELETE` requests
-  // as `POST`, with a `_method` parameter containing the true HTTP method,
-  // as well as all requests with the body as `application/x-www-form-urlencoded`
-  // instead of `application/json` with the model in a param named `model`.
-  // Useful when interfacing with server-side languages like **PHP** that make
-  // it difficult to read the body of `PUT` requests.
-  Backbone.sync = function(method, model, options) {
-    var type = methodMap[method];
-
-    // Default options, unless specified.
-    _.defaults(options || (options = {}), {
-      emulateHTTP: Backbone.emulateHTTP,
-      emulateJSON: Backbone.emulateJSON
-    });
-
-    // Default JSON-request options.
-    var params = {type: type, dataType: 'json'};
-
-    // Ensure that we have a URL.
-    if (!options.url) {
-      params.url = _.result(model, 'url') || urlError();
-    }
-
-    // Ensure that we have the appropriate request data.
-    if (options.data == null && model && (method === 'create' || method === 'update' || method === 'patch')) {
-      params.contentType = 'application/json';
-      params.data = JSON.stringify(options.attrs || model.toJSON(options));
-    }
-
-    // For older servers, emulate JSON by encoding the request into an HTML-form.
-    if (options.emulateJSON) {
-      params.contentType = 'application/x-www-form-urlencoded';
-      params.data = params.data ? {model: params.data} : {};
-    }
-
-    // For older servers, emulate HTTP by mimicking the HTTP method with `_method`
-    // And an `X-HTTP-Method-Override` header.
-    if (options.emulateHTTP && (type === 'PUT' || type === 'DELETE' || type === 'PATCH')) {
-      params.type = 'POST';
-      if (options.emulateJSON) params.data._method = type;
-      var beforeSend = options.beforeSend;
-      options.beforeSend = function(xhr) {
-        xhr.setRequestHeader('X-HTTP-Method-Override', type);
-        if (beforeSend) return beforeSend.apply(this, arguments);
-      };
-    }
-
-    // Don't process data on a non-GET request.
-    if (params.type !== 'GET' && !options.emulateJSON) {
-      params.processData = false;
-    }
-
-    var success = options.success;
-    options.success = function(resp) {
-      if (success) success(model, resp, options);
-      model.trigger('sync', model, resp, options);
-    };
-
-    var error = options.error;
-    options.error = function(xhr) {
-      if (error) error(model, xhr, options);
-      model.trigger('error', model, xhr, options);
-    };
-
-    // Make the request, allowing the user to override any Ajax options.
-    var xhr = options.xhr = Backbone.ajax(_.extend(params, options));
-    model.trigger('request', model, xhr, options);
-    return xhr;
-  };
-
-  // Set the default implementation of `Backbone.ajax` to proxy through to `$`.
-  Backbone.ajax = function() {
-    return Backbone.$.ajax.apply(Backbone.$, arguments);
-  };
-
   // Helpers
   // -------
 
@@ -1495,4 +1559,13 @@
     throw new Error('A "url" property or function must be specified');
   };
 
+  // Wrap an optional error callback with a fallback error event.
+  var wrapError = function (model, options) {
+    var error = options.error;
+    options.error = function(resp) {
+      if (error) error(model, resp, options);
+      model.trigger('error', model, resp, options);
+    };
+  };
+
 }).call(this);</div></li>
 <li>public/components/backbone/component.json<div>diff --git a/public/components/backbone/component.json b/public/components/backbone/component.json
index a7bad5e..497ac4c 100644
--- a/public/components/backbone/component.json
+++ b/public/components/backbone/component.json
@@ -1,6 +1,6 @@
 {
   "name": "backbone",
-  "version": "0.9.10",
+  "version": "1.0.0",
   "repository": {
     "type": "git",
     "url": "git://github.com/documentcloud/backbone.git"</div></li>
 <li>public/components/backbone/docs/backbone-localstorage.html<div>diff --git a/public/components/backbone/docs/backbone-localstorage.html b/public/components/backbone/docs/backbone-localstorage.html
index c643ac0..55ce823 100644
--- a/public/components/backbone/docs/backbone-localstorage.html
+++ b/public/components/backbone/docs/backbone-localstorage.html
@@ -1,28 +1,138 @@
-<!DOCTYPE html>  <html> <head>   <title>backbone-localstorage.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="backbone-localstorage.html">                 backbone-localstorage.js               </a>                                           <a class="source" href="todos.html">                 todos.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               backbone-localstorage.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/**</span>
+<!DOCTYPE html>
+
+<html>
+<head>
+  <title>backbone-localstorage.js</title>
+  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
+  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
+  <link rel="stylesheet" media="all" href="public/stylesheets/normalize.css" />
+  <link rel="stylesheet" media="all" href="docco.css" />
+</head>
+<body>
+  <div class="container">
+    <div class="page">
+
+      <div class="header">
+        
+          <h1>backbone-localstorage.js</h1>
+        
+
+        
+          <div class="toc">
+            <h3>Table of Contents</h3>
+            <ol>
+              
+                
+                <li>
+                  <a class="source" href="backbone-localstorage.html">
+                    backbone-localstorage.js
+                  </a>
+                </li>
+              
+                
+                <li>
+                  <a class="source" href="todos.html">
+                    todos.js
+                  </a>
+                </li>
+              
+            </ol>
+          </div>
+        
+      </div>
+
+      
+        
+        
+        
+          <div class="highlight"><pre><span class="cm">/**</span>
 <span class="cm"> * Backbone localStorage Adapter</span>
 <span class="cm"> * https://github.com/jeromegn/Backbone.localStorage</span>
 <span class="cm"> */</span>
 
-<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>A simple module to replace <code>Backbone.sync</code> with <em>localStorage</em>-based
+<span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>
+        
+      
+        
+        
+<p>A simple module to replace <code>Backbone.sync</code> with <em>localStorage</em>-based
 persistence. Models are given GUIDS, and saved into a JSON object. Simple
-as that.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Hold reference to Underscore.js and Backbone.js in the closure in order
-to make things work even if they are removed from the global namespace</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">_</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_</span><span class="p">;</span>
-<span class="kd">var</span> <span class="nx">Backbone</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Generate four random hex digits.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">S4</span><span class="p">()</span> <span class="p">{</span>
+as that.
+
+</p>
+<p>Hold reference to Underscore.js and Backbone.js in the closure in order
+to make things work even if they are removed from the global namespace
+
+</p>
+
+        
+          <div class="highlight"><pre><span class="kd">var</span> <span class="nx">_</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_</span><span class="p">;</span>
+<span class="kd">var</span> <span class="nx">Backbone</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">;</span></pre></div>
+        
+      
+        
+        
+<p>Generate four random hex digits.
+
+</p>
+
+        
+          <div class="highlight"><pre><span class="kd">function</span> <span class="nx">S4</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(((</span><span class="mi">1</span><span class="o">+</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">())</span><span class="o">*</span><span class="mh">0x10000</span><span class="p">)</span><span class="o">|</span><span class="mi">0</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">).</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
-<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Generate a pseudo-GUID by concatenating random hexadecimal.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">function</span> <span class="nx">guid</span><span class="p">()</span> <span class="p">{</span>
+<span class="p">};</span></pre></div>
+        
+      
+        
+        
+<p>Generate a pseudo-GUID by concatenating random hexadecimal.
+
+</p>
+
+        
+          <div class="highlight"><pre><span class="kd">function</span> <span class="nx">guid</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">S4</span><span class="p">()</span><span class="o">+</span><span class="nx">S4</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="nx">S4</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="nx">S4</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="nx">S4</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="nx">S4</span><span class="p">()</span><span class="o">+</span><span class="nx">S4</span><span class="p">()</span><span class="o">+</span><span class="nx">S4</span><span class="p">());</span>
-<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Our Store is represented by a single JS object in <em>localStorage</em>. Create it
-with a meaningful name, like the name you'd give a table.
-window.Store is deprectated, use Backbone.LocalStorage instead</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Backbone</span><span class="p">.</span><span class="nx">LocalStorage</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Store</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
+<span class="p">};</span></pre></div>
+        
+      
+        
+        
+<p>Our Store is represented by a single JS object in <em>localStorage</em>. Create it
+with a meaningful name, like the name you&#39;d give a table.
+window.Store is deprectated, use Backbone.LocalStorage instead
+
+</p>
+
+        
+          <div class="highlight"><pre><span class="nx">Backbone</span><span class="p">.</span><span class="nx">LocalStorage</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Store</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
   <span class="kd">var</span> <span class="nx">store</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">().</span><span class="nx">getItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
   <span class="k">this</span><span class="p">.</span><span class="nx">records</span> <span class="o">=</span> <span class="p">(</span><span class="nx">store</span> <span class="o">&amp;&amp;</span> <span class="nx">store</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">))</span> <span class="o">||</span> <span class="p">[];</span>
 <span class="p">};</span>
 
-<span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">LocalStorage</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Save the current state of the <strong>Store</strong> to <em>localStorage</em>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">save</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
+<span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">LocalStorage</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="p">{</span></pre></div>
+        
+      
+        
+        
+<p>Save the current state of the <strong>Store</strong> to <em>localStorage</em>.
+
+</p>
+
+        
+          <div class="highlight"><pre>  <span class="nx">save</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
     <span class="k">this</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">().</span><span class="nx">setItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">records</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">));</span>
-  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Add a model, giving it a (hopefully)-unique GUID, if it doesn't already
-have an id of it's own.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">create</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
+  <span class="p">},</span></pre></div>
+        
+      
+        
+        
+<p>Add a model, giving it a (hopefully)-unique GUID, if it doesn&#39;t already
+have an id of it&#39;s own.
+
+</p>
+
+        
+          <div class="highlight"><pre>  <span class="nx">create</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">model</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">guid</span><span class="p">();</span>
         <span class="nx">model</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">idAttribute</span><span class="p">,</span> <span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
@@ -31,18 +141,58 @@ have an id of it's own.</p>             </td>             <td class="code">
     <span class="k">this</span><span class="p">.</span><span class="nx">records</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
     <span class="k">this</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
     <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">();</span>
-  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Update a model by replacing its copy in <code>this.data</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">update</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
+  <span class="p">},</span></pre></div>
+        
+      
+        
+        
+<p>Update a model by replacing its copy in <code>this.data</code>.
+
+</p>
+
+        
+          <div class="highlight"><pre>  <span class="nx">update</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">this</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">().</span><span class="nx">setItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">model</span><span class="p">));</span>
     <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">include</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">records</span><span class="p">,</span> <span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">toString</span><span class="p">()))</span> <span class="k">this</span><span class="p">.</span><span class="nx">records</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span> <span class="k">this</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
     <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">();</span>
-  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Retrieve a model from <code>this.data</code> by id.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">find</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
+  <span class="p">},</span></pre></div>
+        
+      
+        
+        
+<p>Retrieve a model from <code>this.data</code> by id.
+
+</p>
+
+        
+          <div class="highlight"><pre>  <span class="nx">find</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">().</span><span class="nx">getItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">));</span>
-  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Return the array of all models currently in storage.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">findAll</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
+  <span class="p">},</span></pre></div>
+        
+      
+        
+        
+<p>Return the array of all models currently in storage.
+
+</p>
+
+        
+          <div class="highlight"><pre>  <span class="nx">findAll</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
     <span class="k">return</span> <span class="nx">_</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">records</span><span class="p">).</span><span class="nx">chain</span><span class="p">()</span>
         <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">id</span><span class="p">){</span><span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">().</span><span class="nx">getItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="nx">id</span><span class="p">));},</span> <span class="k">this</span><span class="p">)</span>
         <span class="p">.</span><span class="nx">compact</span><span class="p">()</span>
         <span class="p">.</span><span class="nx">value</span><span class="p">();</span>
-  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Delete a model from <code>this.data</code>, returning it.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">destroy</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
+  <span class="p">},</span></pre></div>
+        
+      
+        
+        
+<p>Delete a model from <code>this.data</code>, returning it.
+
+</p>
+
+        
+          <div class="highlight"><pre>  <span class="nx">destroy</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
     <span class="k">this</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">().</span><span class="nx">removeItem</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="o">+</span><span class="s2">&quot;-&quot;</span><span class="o">+</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
     <span class="k">this</span><span class="p">.</span><span class="nx">records</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">reject</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">records</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">record_id</span><span class="p">){</span><span class="k">return</span> <span class="nx">record_id</span> <span class="o">==</span> <span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">.</span><span class="nx">toString</span><span class="p">();});</span>
     <span class="k">this</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
@@ -53,10 +203,30 @@ have an id of it's own.</p>             </td>             <td class="code">
       <span class="k">return</span> <span class="nx">localStorage</span><span class="p">;</span>
   <span class="p">}</span>
 
-<span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>localSync delegate to the model or collection's
+<span class="p">});</span></pre></div>
+        
+      
+        
+        
+<p>localSync delegate to the model or collection&#39;s
 <em>localStorage</em> property, which should be an instance of <code>Store</code>.
-window.Store.sync and Backbone.localSync is deprectated, use Backbone.LocalStorage.sync instead</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Backbone</span><span class="p">.</span><span class="nx">LocalStorage</span><span class="p">.</span><span class="nx">sync</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">sync</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">localSync</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
-  <span class="kd">var</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">localStorage</span> <span class="o">||</span> <span class="nx">model</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Backwards compatibility with Backbone &lt;= 0.3.3</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">options</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
+window.Store.sync and Backbone.localSync is deprectated, use Backbone.LocalStorage.sync instead
+
+</p>
+
+        
+          <div class="highlight"><pre><span class="nx">Backbone</span><span class="p">.</span><span class="nx">LocalStorage</span><span class="p">.</span><span class="nx">sync</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Store</span><span class="p">.</span><span class="nx">sync</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">localSync</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
+  <span class="kd">var</span> <span class="nx">store</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">localStorage</span> <span class="o">||</span> <span class="nx">model</span><span class="p">.</span><span class="nx">collection</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">;</span></pre></div>
+        
+      
+        
+        
+<p>Backwards compatibility with Backbone &lt;= 0.3.3
+
+</p>
+
+        
+          <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">options</span> <span class="o">==</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
     <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
       <span class="nx">success</span><span class="o">:</span> <span class="nx">options</span><span class="p">,</span>
       <span class="nx">error</span><span class="o">:</span> <span class="nx">error</span>
@@ -73,9 +243,9 @@ window.Store.sync and Backbone.localSync is deprectated, use Backbone.LocalStora
   <span class="p">}</span>
 
   <span class="k">if</span> <span class="p">(</span><span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
-    <span class="nx">options</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
+    <span class="nx">options</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="nx">resp</span><span class="p">);</span>
   <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-    <span class="nx">options</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="s2">&quot;Record not found&quot;</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
+    <span class="nx">options</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Record not found.&#39;</span><span class="p">);</span>
   <span class="p">}</span>
 <span class="p">};</span>
 
@@ -88,11 +258,27 @@ window.Store.sync and Backbone.localSync is deprectated, use Backbone.LocalStora
   <span class="p">}</span>
 
   <span class="k">return</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">ajaxSync</span><span class="p">;</span>
-<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Override 'Backbone.sync' to default to localSync,
-the original 'Backbone.sync' is still available in 'Backbone.ajaxSync'</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">Backbone</span><span class="p">.</span><span class="nx">sync</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
+<span class="p">};</span></pre></div>
+        
+      
+        
+        
+<p>Override &#39;Backbone.sync&#39; to default to localSync,
+the original &#39;Backbone.sync&#39; is still available in &#39;Backbone.ajaxSync&#39;
+</p>
+
+        
+          <div class="highlight"><pre><span class="nx">Backbone</span><span class="p">.</span><span class="nx">sync</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">return</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">getSyncMethod</span><span class="p">(</span><span class="nx">model</span><span class="p">).</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="nx">method</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">,</span> <span class="nx">error</span><span class="p">]);</span>
 <span class="p">};</span>
 
 <span class="p">})();</span>
 
-</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 
\ No newline at end of file
+</pre></div>
+        
+      
+      <div class="fleur">h</div>
+    </div>
+  </div>
+</body>
+</html></div></li>
 <li>public/components/backbone/docs/backbone.html<div>diff --git a/public/components/backbone/docs/backbone.html b/public/components/backbone/docs/backbone.html
index 4e2f9c3..7c38648 100644
--- a/public/components/backbone/docs/backbone.html
+++ b/public/components/backbone/docs/backbone.html
@@ -1,934 +1,4152 @@
-<!DOCTYPE html>  <html> <head>   <title>backbone.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               backbone.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <pre><code>Backbone.js 0.9.10
-</code></pre>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <pre><code>(c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.
+<!DOCTYPE html>
+
+<html>
+<head>
+  <title>backbone.js</title>
+  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
+  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
+  <link rel="stylesheet" media="all" href="docco.css" />
+</head>
+<body>
+  <div id="container">
+    <div id="background"></div>
+    
+    <ul class="sections">
+        
+          <li id="title">
+              <div class="annotation">
+                  <h1>backbone.js</h1>
+              </div>
+          </li>
+        
+        
+        
+        <li id="section-1">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-1">&#182;</a>
+              </div>
+              <pre><code>Backbone.js 1.0.0
+
+(c) 2010-2013 Jeremy Ashkenas, DocumentCloud Inc.
 Backbone may be freely distributed under the MIT license.
 For all details and documentation:
-http://backbonejs.org
-</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">(){</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <h2>Initial Setup</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Save a reference to the global object (<code>window</code> in the browser, <code>exports</code>
-on the server).</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">root</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Save the previous value of the <code>Backbone</code> variable, so that it can be
-restored later on, if <code>noConflict</code> is used.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">previousBackbone</span> <span class="o">=</span> <span class="nx">root</span><span class="p">.</span><span class="nx">Backbone</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Create a local reference to array methods.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[];</span>
-  <span class="kd">var</span> <span class="nx">push</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">push</span><span class="p">;</span>
-  <span class="kd">var</span> <span class="nx">slice</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">slice</span><span class="p">;</span>
-  <span class="kd">var</span> <span class="nx">splice</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">splice</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>The top-level namespace. All public Backbone classes and modules will
-be attached to this. Exported for both CommonJS and the browser.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">Backbone</span><span class="p">;</span>
-  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">exports</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
-    <span class="nx">Backbone</span> <span class="o">=</span> <span class="nx">exports</span><span class="p">;</span>
-  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-    <span class="nx">Backbone</span> <span class="o">=</span> <span class="nx">root</span><span class="p">.</span><span class="nx">Backbone</span> <span class="o">=</span> <span class="p">{};</span>
-  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Current version of the library. Keep in sync with <code>package.json</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Backbone</span><span class="p">.</span><span class="nx">VERSION</span> <span class="o">=</span> <span class="s1">&#39;0.9.10&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Require Underscore, if we're on the server, and it's not already present.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">_</span> <span class="o">=</span> <span class="nx">root</span><span class="p">.</span><span class="nx">_</span><span class="p">;</span>
-  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">require</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">))</span> <span class="nx">_</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;underscore&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>For Backbone's purposes, jQuery, Zepto, or Ender owns the <code>$</code> variable.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Backbone</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">root</span><span class="p">.</span><span class="nx">jQuery</span> <span class="o">||</span> <span class="nx">root</span><span class="p">.</span><span class="nx">Zepto</span> <span class="o">||</span> <span class="nx">root</span><span class="p">.</span><span class="nx">ender</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Runs Backbone.js in <em>noConflict</em> mode, returning the <code>Backbone</code> variable
-to its previous owner. Returns a reference to this Backbone object.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Backbone</span><span class="p">.</span><span class="nx">noConflict</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-    <span class="nx">root</span><span class="p">.</span><span class="nx">Backbone</span> <span class="o">=</span> <span class="nx">previousBackbone</span><span class="p">;</span>
-    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Turn on <code>emulateHTTP</code> to support legacy HTTP servers. Setting this option
-will fake <code>"PUT"</code> and <code>"DELETE"</code> requests via the <code>_method</code> parameter and
-set a <code>X-Http-Method-Override</code> header.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Backbone</span><span class="p">.</span><span class="nx">emulateHTTP</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Turn on <code>emulateJSON</code> to support legacy servers that can't deal with direct
+http://backbonejs.org</code></pre>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>(<span class="keyword">function</span>(){</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-2">
+            <div class="annotation">
+              
+              <div class="pilwrap for-h2">
+                <a class="pilcrow" href="#section-2">&#182;</a>
+              </div>
+              <h2>Initial Setup</h2>
+
+            </div>
+            
+        </li>
+        
+        
+        <li id="section-3">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-3">&#182;</a>
+              </div>
+              <p>Save a reference to the global object (<code>window</code> in the browser, <code>exports</code>
+on the server).
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> root = <span class="keyword">this</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-4">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-4">&#182;</a>
+              </div>
+              <p>Save the previous value of the <code>Backbone</code> variable, so that it can be
+restored later on, if <code>noConflict</code> is used.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> previousBackbone = root.Backbone;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-5">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-5">&#182;</a>
+              </div>
+              <p>Create local references to array methods we&#39;ll want to use later.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> array = [];
+  <span class="keyword">var</span> push = array.push;
+  <span class="keyword">var</span> slice = array.slice;
+  <span class="keyword">var</span> splice = array.splice;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-6">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-6">&#182;</a>
+              </div>
+              <p>The top-level namespace. All public Backbone classes and modules will
+be attached to this. Exported for both the browser and the server.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> Backbone;
+  <span class="keyword">if</span> (<span class="keyword">typeof</span> exports !== <span class="string">'undefined'</span>) {
+    Backbone = exports;
+  } <span class="keyword">else</span> {
+    Backbone = root.Backbone = {};
+  }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-7">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-7">&#182;</a>
+              </div>
+              <p>Current version of the library. Keep in sync with <code>package.json</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  Backbone.VERSION = <span class="string">'1.0.0'</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-8">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-8">&#182;</a>
+              </div>
+              <p>Require Underscore, if we&#39;re on the server, and it&#39;s not already present.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> _ = root._;
+  <span class="keyword">if</span> (!_ &amp;&amp; (<span class="keyword">typeof</span> require !== <span class="string">'undefined'</span>)) _ = require(<span class="string">'underscore'</span>);</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-9">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-9">&#182;</a>
+              </div>
+              <p>For Backbone&#39;s purposes, jQuery, Zepto, Ender, or My Library (kidding) owns
+the <code>$</code> variable.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  Backbone.$ = root.jQuery || root.Zepto || root.ender || root.$;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-10">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-10">&#182;</a>
+              </div>
+              <p>Runs Backbone.js in <em>noConflict</em> mode, returning the <code>Backbone</code> variable
+to its previous owner. Returns a reference to this Backbone object.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  Backbone.noConflict = <span class="keyword">function</span>() {
+    root.Backbone = previousBackbone;
+    <span class="keyword">return</span> <span class="keyword">this</span>;
+  };</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-11">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-11">&#182;</a>
+              </div>
+              <p>Turn on <code>emulateHTTP</code> to support legacy HTTP servers. Setting this option
+will fake <code>&quot;PUT&quot;</code> and <code>&quot;DELETE&quot;</code> requests via the <code>_method</code> parameter and
+set a <code>X-Http-Method-Override</code> header.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  Backbone.emulateHTTP = <span class="literal">false</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-12">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-12">&#182;</a>
+              </div>
+              <p>Turn on <code>emulateJSON</code> to support legacy servers that can&#39;t deal with direct
 <code>application/json</code> requests ... will encode the body as
 <code>application/x-www-form-urlencoded</code> instead and will send the model in a
-form param named <code>model</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Backbone</span><span class="p">.</span><span class="nx">emulateJSON</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <h2>Backbone.Events</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Regular expression used to split event strings.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">eventSplitter</span> <span class="o">=</span> <span class="sr">/\s+/</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Implement fancy features of the Events API such as multiple event
-names <code>"change blur"</code> and jQuery-style event maps <code>{change: action}</code>
-in terms of the existing API.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">eventsApi</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">action</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">rest</span><span class="p">)</span> <span class="p">{</span>
-    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">name</span><span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
-    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">name</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
-        <span class="nx">obj</span><span class="p">[</span><span class="nx">action</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="p">[</span><span class="nx">key</span><span class="p">,</span> <span class="nx">name</span><span class="p">[</span><span class="nx">key</span><span class="p">]].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">rest</span><span class="p">));</span>
-      <span class="p">}</span>
-    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">eventSplitter</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">names</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">eventSplitter</span><span class="p">);</span>
-      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">names</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
-        <span class="nx">obj</span><span class="p">[</span><span class="nx">action</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="p">[</span><span class="nx">names</span><span class="p">[</span><span class="nx">i</span><span class="p">]].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">rest</span><span class="p">));</span>
-      <span class="p">}</span>
-    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
-    <span class="p">}</span>
-  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Optimized internal dispatch function for triggering events. Tries to
-keep the usual cases speedy (most Backbone events have 3 arguments).</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">triggerEvents</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">events</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
-    <span class="kd">var</span> <span class="nx">ev</span><span class="p">,</span> <span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">events</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
-    <span class="k">switch</span> <span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
-    <span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="k">while</span> <span class="p">(</span><span class="o">++</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">)</span> <span class="p">(</span><span class="nx">ev</span> <span class="o">=</span> <span class="nx">events</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">callback</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">ctx</span><span class="p">);</span>
-    <span class="k">return</span><span class="p">;</span>
-    <span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="k">while</span> <span class="p">(</span><span class="o">++</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">)</span> <span class="p">(</span><span class="nx">ev</span> <span class="o">=</span> <span class="nx">events</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">callback</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
-    <span class="k">return</span><span class="p">;</span>
-    <span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="k">while</span> <span class="p">(</span><span class="o">++</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">)</span> <span class="p">(</span><span class="nx">ev</span> <span class="o">=</span> <span class="nx">events</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">callback</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
-    <span class="k">return</span><span class="p">;</span>
-    <span class="k">case</span> <span class="mi">3</span><span class="o">:</span> <span class="k">while</span> <span class="p">(</span><span class="o">++</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">)</span> <span class="p">(</span><span class="nx">ev</span> <span class="o">=</span> <span class="nx">events</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">callback</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
-    <span class="k">return</span><span class="p">;</span>
-    <span class="k">default</span><span class="o">:</span> <span class="k">while</span> <span class="p">(</span><span class="o">++</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">)</span> <span class="p">(</span><span class="nx">ev</span> <span class="o">=</span> <span class="nx">events</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">callback</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">ev</span><span class="p">.</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
-    <span class="p">}</span>
-  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>A module that can be mixed in to <em>any object</em> in order to provide it with
+form param named <code>model</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  Backbone.emulateJSON = <span class="literal">false</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-13">
+            <div class="annotation">
+              
+              <div class="pilwrap for-h2">
+                <a class="pilcrow" href="#section-13">&#182;</a>
+              </div>
+              <h2>Backbone.Events</h2>
+
+            </div>
+            
+        </li>
+        
+        
+        <li id="section-14">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-14">&#182;</a>
+              </div>
+              <p>A module that can be mixed in to <em>any object</em> in order to provide it with
 custom events. You may bind with <code>on</code> or remove with <code>off</code> callback
 functions to an event; <code>trigger</code>-ing an event fires all callbacks in
-succession.</p>
+succession.
 
+</p>
 <pre><code>var object = {};
 _.extend(object, Backbone.Events);
-object.on('expand', function(){ alert('expanded'); });
-object.trigger('expand');
-</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">Events</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Events</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Bind one or more space separated events, or an events map,
-to a <code>callback</code> function. Passing <code>"all"</code> will bind the callback to
-all events fired.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">on</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">eventsApi</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;on&#39;</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="p">[</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">context</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span><span class="p">))</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">_events</span> <span class="o">||</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_events</span> <span class="o">=</span> <span class="p">{});</span>
-      <span class="kd">var</span> <span class="nx">list</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">||</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]);</span>
-      <span class="nx">list</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="nx">callback</span><span class="o">:</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">context</span><span class="o">:</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">ctx</span><span class="o">:</span> <span class="nx">context</span> <span class="o">||</span> <span class="k">this</span><span class="p">});</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Bind events to only be triggered a single time. After the first time
-the callback is invoked, it will be removed.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">once</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">eventsApi</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;once&#39;</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="p">[</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">context</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span><span class="p">))</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">once</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-        <span class="nx">self</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">once</span><span class="p">);</span>
-        <span class="nx">callback</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
-      <span class="p">});</span>
-      <span class="nx">once</span><span class="p">.</span><span class="nx">_callback</span> <span class="o">=</span> <span class="nx">callback</span><span class="p">;</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">once</span><span class="p">,</span> <span class="nx">context</span><span class="p">);</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Remove one or many callbacks. If <code>context</code> is null, removes all
+object.on(&#39;expand&#39;, function(){ alert(&#39;expanded&#39;); });
+object.trigger(&#39;expand&#39;);</code></pre>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> Events = Backbone.Events = {</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-15">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-15">&#182;</a>
+              </div>
+              <p>Bind an event to a <code>callback</code> function. Passing <code>&quot;all&quot;</code> will bind
+the callback to all events fired.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    on: <span class="keyword">function</span>(name, callback, context) {
+      <span class="keyword">if</span> (!eventsApi(<span class="keyword">this</span>, <span class="string">'on'</span>, name, [callback, context]) || !callback) <span class="keyword">return</span> <span class="keyword">this</span>;
+      <span class="keyword">this</span>._events || (<span class="keyword">this</span>._events = {});
+      <span class="keyword">var</span> events = <span class="keyword">this</span>._events[name] || (<span class="keyword">this</span>._events[name] = []);
+      events.push({callback: callback, context: context, ctx: context || <span class="keyword">this</span>});
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-16">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-16">&#182;</a>
+              </div>
+              <p>Bind an event to only be triggered a single time. After the first time
+the callback is invoked, it will be removed.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    once: <span class="keyword">function</span>(name, callback, context) {
+      <span class="keyword">if</span> (!eventsApi(<span class="keyword">this</span>, <span class="string">'once'</span>, name, [callback, context]) || !callback) <span class="keyword">return</span> <span class="keyword">this</span>;
+      <span class="keyword">var</span> self = <span class="keyword">this</span>;
+      <span class="keyword">var</span> once = _.once(<span class="keyword">function</span>() {
+        self.off(name, once);
+        callback.apply(<span class="keyword">this</span>, arguments);
+      });
+      once._callback = callback;
+      <span class="keyword">return</span> <span class="keyword">this</span>.on(name, once, context);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-17">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-17">&#182;</a>
+              </div>
+              <p>Remove one or many callbacks. If <code>context</code> is null, removes all
 callbacks with that function. If <code>callback</code> is null, removes all
 callbacks for the event. If <code>name</code> is null, removes all bound
-callbacks for all events.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">off</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">list</span><span class="p">,</span> <span class="nx">ev</span><span class="p">,</span> <span class="nx">events</span><span class="p">,</span> <span class="nx">names</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">l</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">k</span><span class="p">;</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_events</span> <span class="o">||</span> <span class="o">!</span><span class="nx">eventsApi</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;off&#39;</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="p">[</span><span class="nx">callback</span><span class="p">,</span> <span class="nx">context</span><span class="p">]))</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">name</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">callback</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">_events</span> <span class="o">=</span> <span class="p">{};</span>
-        <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-      <span class="p">}</span>
-
-      <span class="nx">names</span> <span class="o">=</span> <span class="nx">name</span> <span class="o">?</span> <span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">);</span>
-      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">names</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
-        <span class="nx">name</span> <span class="o">=</span> <span class="nx">names</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">list</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span> <span class="p">{</span>
-          <span class="nx">events</span> <span class="o">=</span> <span class="p">[];</span>
-          <span class="k">if</span> <span class="p">(</span><span class="nx">callback</span> <span class="o">||</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
-            <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">k</span> <span class="o">=</span> <span class="nx">list</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">k</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
-              <span class="nx">ev</span> <span class="o">=</span> <span class="nx">list</span><span class="p">[</span><span class="nx">j</span><span class="p">];</span>
-              <span class="k">if</span> <span class="p">((</span><span class="nx">callback</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span> <span class="o">!==</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">callback</span> <span class="o">&amp;&amp;</span>
-                               <span class="nx">callback</span> <span class="o">!==</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">callback</span><span class="p">.</span><span class="nx">_callback</span><span class="p">)</span> <span class="o">||</span>
-                  <span class="p">(</span><span class="nx">context</span> <span class="o">&amp;&amp;</span> <span class="nx">context</span> <span class="o">!==</span> <span class="nx">ev</span><span class="p">.</span><span class="nx">context</span><span class="p">))</span> <span class="p">{</span>
-                <span class="nx">events</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">ev</span><span class="p">);</span>
-              <span class="p">}</span>
-            <span class="p">}</span>
-          <span class="p">}</span>
-          <span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">events</span><span class="p">;</span>
-        <span class="p">}</span>
-      <span class="p">}</span>
-
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Trigger one or many events, firing all bound callbacks. Callbacks are
+callbacks for all events.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    off: <span class="keyword">function</span>(name, callback, context) {
+      <span class="keyword">var</span> retain, ev, events, names, i, l, j, k;
+      <span class="keyword">if</span> (!<span class="keyword">this</span>._events || !eventsApi(<span class="keyword">this</span>, <span class="string">'off'</span>, name, [callback, context])) <span class="keyword">return</span> <span class="keyword">this</span>;
+      <span class="keyword">if</span> (!name &amp;&amp; !callback &amp;&amp; !context) {
+        <span class="keyword">this</span>._events = {};
+        <span class="keyword">return</span> <span class="keyword">this</span>;
+      }
+
+      names = name ? [name] : _.keys(<span class="keyword">this</span>._events);
+      <span class="keyword">for</span> (i = <span class="number">0</span>, l = names.length; i &lt; l; i++) {
+        name = names[i];
+        <span class="keyword">if</span> (events = <span class="keyword">this</span>._events[name]) {
+          <span class="keyword">this</span>._events[name] = retain = [];
+          <span class="keyword">if</span> (callback || context) {
+            <span class="keyword">for</span> (j = <span class="number">0</span>, k = events.length; j &lt; k; j++) {
+              ev = events[j];
+              <span class="keyword">if</span> ((callback &amp;&amp; callback !== ev.callback &amp;&amp; callback !== ev.callback._callback) ||
+                  (context &amp;&amp; context !== ev.context)) {
+                retain.push(ev);
+              }
+            }
+          }
+          <span class="keyword">if</span> (!retain.length) <span class="keyword">delete</span> <span class="keyword">this</span>._events[name];
+        }
+      }
+
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-18">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-18">&#182;</a>
+              </div>
+              <p>Trigger one or many events, firing all bound callbacks. Callbacks are
 passed the same arguments as <code>trigger</code> is, apart from the event name
-(unless you're listening on <code>"all"</code>, which will cause your callback to
-receive the true name of the event as the first argument).</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">trigger</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">eventsApi</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;trigger&#39;</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">args</span><span class="p">))</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">events</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
-      <span class="kd">var</span> <span class="nx">allEvents</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_events</span><span class="p">.</span><span class="nx">all</span><span class="p">;</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">events</span><span class="p">)</span> <span class="nx">triggerEvents</span><span class="p">(</span><span class="nx">events</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">allEvents</span><span class="p">)</span> <span class="nx">triggerEvents</span><span class="p">(</span><span class="nx">allEvents</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>An inversion-of-control version of <code>on</code>. Tell <em>this</em> object to listen to
-an event in another object ... keeping track of what it's listening to.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">listenTo</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">listeners</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_listeners</span> <span class="o">||</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_listeners</span> <span class="o">=</span> <span class="p">{});</span>
-      <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">_listenerId</span> <span class="o">||</span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">_listenerId</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">uniqueId</span><span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">));</span>
-      <span class="nx">listeners</span><span class="p">[</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>
-      <span class="nx">obj</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="k">typeof</span> <span class="nx">name</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span> <span class="o">?</span> <span class="k">this</span> <span class="o">:</span> <span class="nx">callback</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Tell this object to stop listening to either specific events ... or
-to every object it's currently listening to.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">stopListening</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">listeners</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_listeners</span><span class="p">;</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">listeners</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
-        <span class="nx">obj</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="k">typeof</span> <span class="nx">name</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span> <span class="o">?</span> <span class="k">this</span> <span class="o">:</span> <span class="nx">callback</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
-        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">name</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">callback</span><span class="p">)</span> <span class="k">delete</span> <span class="nx">listeners</span><span class="p">[</span><span class="nx">obj</span><span class="p">.</span><span class="nx">_listenerId</span><span class="p">];</span>
-      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-        <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">name</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="nx">callback</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
-        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">id</span> <span class="k">in</span> <span class="nx">listeners</span><span class="p">)</span> <span class="p">{</span>
-          <span class="nx">listeners</span><span class="p">[</span><span class="nx">id</span><span class="p">].</span><span class="nx">off</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
-        <span class="p">}</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">_listeners</span> <span class="o">=</span> <span class="p">{};</span>
-      <span class="p">}</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">}</span>
-  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Aliases for backwards compatibility.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Events</span><span class="p">.</span><span class="nx">bind</span>   <span class="o">=</span> <span class="nx">Events</span><span class="p">.</span><span class="nx">on</span><span class="p">;</span>
-  <span class="nx">Events</span><span class="p">.</span><span class="nx">unbind</span> <span class="o">=</span> <span class="nx">Events</span><span class="p">.</span><span class="nx">off</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>Allow the <code>Backbone</code> object to serve as a global event bus, for folks who
-want global "pubsub" in a convenient place.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Backbone</span><span class="p">,</span> <span class="nx">Events</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <h2>Backbone.Model</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Create a new model, with defined attributes. A client id (<code>cid</code>)
-is automatically generated and assigned for you.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">Model</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attributes</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-    <span class="kd">var</span> <span class="nx">defaults</span><span class="p">;</span>
-    <span class="kd">var</span> <span class="nx">attrs</span> <span class="o">=</span> <span class="nx">attributes</span> <span class="o">||</span> <span class="p">{};</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">cid</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">uniqueId</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">);</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">attributes</span> <span class="o">=</span> <span class="p">{};</span>
-    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span> <span class="o">&amp;&amp;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">collection</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">collection</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">collection</span><span class="p">;</span>
-    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span> <span class="o">&amp;&amp;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">parse</span><span class="p">)</span> <span class="nx">attrs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">attrs</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="o">||</span> <span class="p">{};</span>
-    <span class="k">if</span> <span class="p">(</span><span class="nx">defaults</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">result</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;defaults&#39;</span><span class="p">))</span> <span class="p">{</span>
-      <span class="nx">attrs</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">defaults</span><span class="p">({},</span> <span class="nx">attrs</span><span class="p">,</span> <span class="nx">defaults</span><span class="p">);</span>
-    <span class="p">}</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">attrs</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">changed</span> <span class="o">=</span> <span class="p">{};</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">initialize</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
-  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Attach all inheritable methods to the Model prototype.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">Events</span><span class="p">,</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>A hash of attributes whose current and previous value differ.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">changed</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>The default name for the JSON <code>id</code> attribute is <code>"id"</code>. MongoDB and
-CouchDB users may want to set this to <code>"_id"</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">idAttribute</span><span class="o">:</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>Initialize is an empty function by default. Override it with your own
-initialization logic.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){},</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Return a copy of the model's <code>attributes</code> object.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">toJSON</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">attributes</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>Proxy <code>Backbone.sync</code> by default.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">sync</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">sync</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>Get the value of an attribute.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">attr</span><span class="p">];</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>Get the HTML-escaped value of an attribute.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">escape</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">escape</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">attr</span><span class="p">));</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>Returns <code>true</code> if the attribute contains a value that is not null
-or undefined.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">has</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <hr />             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>Set a hash of model attributes on the object, firing <code>"change"</code> unless
-you choose to silence it.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">attr</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">,</span> <span class="nx">unset</span><span class="p">,</span> <span class="nx">changes</span><span class="p">,</span> <span class="nx">silent</span><span class="p">,</span> <span class="nx">changing</span><span class="p">,</span> <span class="nx">prev</span><span class="p">,</span> <span class="nx">current</span><span class="p">;</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">key</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>Handle both <code>"key", value</code> and <code>{key: value}</code> -style arguments.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">key</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
-        <span class="nx">attrs</span> <span class="o">=</span> <span class="nx">key</span><span class="p">;</span>
-        <span class="nx">options</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
-      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-        <span class="p">(</span><span class="nx">attrs</span> <span class="o">=</span> <span class="p">{})[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
-      <span class="p">}</span>
-
-      <span class="nx">options</span> <span class="o">||</span> <span class="p">(</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{});</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>Run validation.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_validate</span><span class="p">(</span><span class="nx">attrs</span><span class="p">,</span> <span class="nx">options</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>Extract attributes and options.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">unset</span>           <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">unset</span><span class="p">;</span>
-      <span class="nx">silent</span>          <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">silent</span><span class="p">;</span>
-      <span class="nx">changes</span>         <span class="o">=</span> <span class="p">[];</span>
-      <span class="nx">changing</span>        <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_changing</span><span class="p">;</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">_changing</span>  <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
-
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">changing</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">_previousAttributes</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">attributes</span><span class="p">);</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">changed</span> <span class="o">=</span> <span class="p">{};</span>
-      <span class="p">}</span>
-      <span class="nx">current</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">attributes</span><span class="p">,</span> <span class="nx">prev</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_previousAttributes</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>Check for changes of <code>id</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">idAttribute</span> <span class="k">in</span> <span class="nx">attrs</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">attrs</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">idAttribute</span><span class="p">];</span></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>For each <code>set</code> attribute, update or delete the current value.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">for</span> <span class="p">(</span><span class="nx">attr</span> <span class="k">in</span> <span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
-        <span class="nx">val</span> <span class="o">=</span> <span class="nx">attrs</span><span class="p">[</span><span class="nx">attr</span><span class="p">];</span>
-        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">current</span><span class="p">[</span><span class="nx">attr</span><span class="p">],</span> <span class="nx">val</span><span class="p">))</span> <span class="nx">changes</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">attr</span><span class="p">);</span>
-        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">prev</span><span class="p">[</span><span class="nx">attr</span><span class="p">],</span> <span class="nx">val</span><span class="p">))</span> <span class="p">{</span>
-          <span class="k">this</span><span class="p">.</span><span class="nx">changed</span><span class="p">[</span><span class="nx">attr</span><span class="p">]</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
-        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-          <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">changed</span><span class="p">[</span><span class="nx">attr</span><span class="p">];</span>
-        <span class="p">}</span>
-        <span class="nx">unset</span> <span class="o">?</span> <span class="k">delete</span> <span class="nx">current</span><span class="p">[</span><span class="nx">attr</span><span class="p">]</span> <span class="o">:</span> <span class="nx">current</span><span class="p">[</span><span class="nx">attr</span><span class="p">]</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
-      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p>Trigger all relevant attribute changes.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">silent</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">changes</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">_pending</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
-        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">changes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
-          <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;change:&#39;</span> <span class="o">+</span> <span class="nx">changes</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="k">this</span><span class="p">,</span> <span class="nx">current</span><span class="p">[</span><span class="nx">changes</span><span class="p">[</span><span class="nx">i</span><span class="p">]],</span> <span class="nx">options</span><span class="p">);</span>
-        <span class="p">}</span>
-      <span class="p">}</span>
-
-      <span class="k">if</span> <span class="p">(</span><span class="nx">changing</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">silent</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">while</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_pending</span><span class="p">)</span> <span class="p">{</span>
-          <span class="k">this</span><span class="p">.</span><span class="nx">_pending</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
-          <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-        <span class="p">}</span>
-      <span class="p">}</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">_pending</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">_changing</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>Remove an attribute from the model, firing <code>"change"</code> unless you choose
-to silence it. <code>unset</code> is a noop if the attribute doesn't exist.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">unset</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attr</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">attr</span><span class="p">,</span> <span class="k">void</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">options</span><span class="p">,</span> <span class="p">{</span><span class="nx">unset</span><span class="o">:</span> <span class="kc">true</span><span class="p">}));</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p>Clear all attributes on the model, firing <code>"change"</code> unless you choose
-to silence it.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">clear</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">attrs</span> <span class="o">=</span> <span class="p">{};</span>
-      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">attributes</span><span class="p">)</span> <span class="nx">attrs</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="k">void</span> <span class="mi">0</span><span class="p">;</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">attrs</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">options</span><span class="p">,</span> <span class="p">{</span><span class="nx">unset</span><span class="o">:</span> <span class="kc">true</span><span class="p">}));</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <p>Determine if the model has changed since the last <code>"change"</code> event.
-If you specify an attribute name, determine if that attribute has changed.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">hasChanged</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">attr</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">changed</span><span class="p">);</span>
-      <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">changed</span><span class="p">,</span> <span class="nx">attr</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p>Return an object containing all the attributes that have changed, or
+(unless you&#39;re listening on <code>&quot;all&quot;</code>, which will cause your callback to
+receive the true name of the event as the first argument).
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    trigger: <span class="keyword">function</span>(name) {
+      <span class="keyword">if</span> (!<span class="keyword">this</span>._events) <span class="keyword">return</span> <span class="keyword">this</span>;
+      <span class="keyword">var</span> args = slice.call(arguments, <span class="number">1</span>);
+      <span class="keyword">if</span> (!eventsApi(<span class="keyword">this</span>, <span class="string">'trigger'</span>, name, args)) <span class="keyword">return</span> <span class="keyword">this</span>;
+      <span class="keyword">var</span> events = <span class="keyword">this</span>._events[name];
+      <span class="keyword">var</span> allEvents = <span class="keyword">this</span>._events.all;
+      <span class="keyword">if</span> (events) triggerEvents(events, args);
+      <span class="keyword">if</span> (allEvents) triggerEvents(allEvents, arguments);
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-19">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-19">&#182;</a>
+              </div>
+              <p>Tell this object to stop listening to either specific events ... or
+to every object it&#39;s currently listening to.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    stopListening: <span class="keyword">function</span>(obj, name, callback) {
+      <span class="keyword">var</span> listeners = <span class="keyword">this</span>._listeners;
+      <span class="keyword">if</span> (!listeners) <span class="keyword">return</span> <span class="keyword">this</span>;
+      <span class="keyword">var</span> deleteListener = !name &amp;&amp; !callback;
+      <span class="keyword">if</span> (<span class="keyword">typeof</span> name === <span class="string">'object'</span>) callback = <span class="keyword">this</span>;
+      <span class="keyword">if</span> (obj) (listeners = {})[obj._listenerId] = obj;
+      <span class="keyword">for</span> (<span class="keyword">var</span> id <span class="keyword">in</span> listeners) {
+        listeners[id].off(name, callback, <span class="keyword">this</span>);
+        <span class="keyword">if</span> (deleteListener) <span class="keyword">delete</span> <span class="keyword">this</span>._listeners[id];
+      }
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    }
+
+  };</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-20">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-20">&#182;</a>
+              </div>
+              <p>Regular expression used to split event strings.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> eventSplitter = <span class="regexp">/\s+/</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-21">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-21">&#182;</a>
+              </div>
+              <p>Implement fancy features of the Events API such as multiple event
+names <code>&quot;change blur&quot;</code> and jQuery-style event maps <code>{change: action}</code>
+in terms of the existing API.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> eventsApi = <span class="keyword">function</span>(obj, action, name, rest) {
+    <span class="keyword">if</span> (!name) <span class="keyword">return</span> <span class="literal">true</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-22">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-22">&#182;</a>
+              </div>
+              <p>Handle event maps.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (<span class="keyword">typeof</span> name === <span class="string">'object'</span>) {
+      <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> name) {
+        obj[action].apply(obj, [key, name[key]].concat(rest));
+      }
+      <span class="keyword">return</span> <span class="literal">false</span>;
+    }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-23">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-23">&#182;</a>
+              </div>
+              <p>Handle space separated event names.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (eventSplitter.test(name)) {
+      <span class="keyword">var</span> names = name.split(eventSplitter);
+      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = names.length; i &lt; l; i++) {
+        obj[action].apply(obj, [names[i]].concat(rest));
+      }
+      <span class="keyword">return</span> <span class="literal">false</span>;
+    }
+
+    <span class="keyword">return</span> <span class="literal">true</span>;
+  };</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-24">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-24">&#182;</a>
+              </div>
+              <p>A difficult-to-believe, but optimized internal dispatch function for
+triggering events. Tries to keep the usual cases speedy (most internal
+Backbone events have 3 arguments).
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> triggerEvents = <span class="keyword">function</span>(events, args) {
+    <span class="keyword">var</span> ev, i = -<span class="number">1</span>, l = events.length, a1 = args[<span class="number">0</span>], a2 = args[<span class="number">1</span>], a3 = args[<span class="number">2</span>];
+    <span class="keyword">switch</span> (args.length) {
+      <span class="keyword">case</span> <span class="number">0</span>: <span class="keyword">while</span> (++i &lt; l) (ev = events[i]).callback.call(ev.ctx); <span class="keyword">return</span>;
+      <span class="keyword">case</span> <span class="number">1</span>: <span class="keyword">while</span> (++i &lt; l) (ev = events[i]).callback.call(ev.ctx, a1); <span class="keyword">return</span>;
+      <span class="keyword">case</span> <span class="number">2</span>: <span class="keyword">while</span> (++i &lt; l) (ev = events[i]).callback.call(ev.ctx, a1, a2); <span class="keyword">return</span>;
+      <span class="keyword">case</span> <span class="number">3</span>: <span class="keyword">while</span> (++i &lt; l) (ev = events[i]).callback.call(ev.ctx, a1, a2, a3); <span class="keyword">return</span>;
+      <span class="keyword">default</span>: <span class="keyword">while</span> (++i &lt; l) (ev = events[i]).callback.apply(ev.ctx, args);
+    }
+  };
+
+  <span class="keyword">var</span> listenMethods = {listenTo: <span class="string">'on'</span>, listenToOnce: <span class="string">'once'</span>};</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-25">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-25">&#182;</a>
+              </div>
+              <p>Inversion-of-control versions of <code>on</code> and <code>once</code>. Tell <em>this</em> object to
+listen to an event in another object ... keeping track of what it&#39;s
+listening to.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  _.each(listenMethods, <span class="keyword">function</span>(implementation, method) {
+    Events[method] = <span class="keyword">function</span>(obj, name, callback) {
+      <span class="keyword">var</span> listeners = <span class="keyword">this</span>._listeners || (<span class="keyword">this</span>._listeners = {});
+      <span class="keyword">var</span> id = obj._listenerId || (obj._listenerId = _.uniqueId(<span class="string">'l'</span>));
+      listeners[id] = obj;
+      <span class="keyword">if</span> (<span class="keyword">typeof</span> name === <span class="string">'object'</span>) callback = <span class="keyword">this</span>;
+      obj[implementation](name, callback, <span class="keyword">this</span>);
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    };
+  });</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-26">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-26">&#182;</a>
+              </div>
+              <p>Aliases for backwards compatibility.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  Events.bind   = Events.on;
+  Events.unbind = Events.off;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-27">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-27">&#182;</a>
+              </div>
+              <p>Allow the <code>Backbone</code> object to serve as a global event bus, for folks who
+want global &quot;pubsub&quot; in a convenient place.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  _.extend(Backbone, Events);</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-28">
+            <div class="annotation">
+              
+              <div class="pilwrap for-h2">
+                <a class="pilcrow" href="#section-28">&#182;</a>
+              </div>
+              <h2>Backbone.Model</h2>
+
+            </div>
+            
+        </li>
+        
+        
+        <li id="section-29">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-29">&#182;</a>
+              </div>
+              <p>Backbone <strong>Models</strong> are the basic data object in the framework --
+frequently representing a row in a table in a database on your server.
+A discrete chunk of data and a bunch of useful, related methods for
+performing computations and transformations on that data.
+
+</p>
+<p>Create a new model with the specified attributes. A client id (<code>cid</code>)
+is automatically generated and assigned for you.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> Model = Backbone.Model = <span class="keyword">function</span>(attributes, options) {
+    <span class="keyword">var</span> defaults;
+    <span class="keyword">var</span> attrs = attributes || {};
+    options || (options = {});
+    <span class="keyword">this</span>.cid = _.uniqueId(<span class="string">'c'</span>);
+    <span class="keyword">this</span>.attributes = {};
+    _.extend(<span class="keyword">this</span>, _.pick(options, modelOptions));
+    <span class="keyword">if</span> (options.parse) attrs = <span class="keyword">this</span>.parse(attrs, options) || {};
+    <span class="keyword">if</span> (defaults = _.result(<span class="keyword">this</span>, <span class="string">'defaults'</span>)) {
+      attrs = _.defaults({}, attrs, defaults);
+    }
+    <span class="keyword">this</span>.set(attrs, options);
+    <span class="keyword">this</span>.changed = {};
+    <span class="keyword">this</span>.initialize.apply(<span class="keyword">this</span>, arguments);
+  };</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-30">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-30">&#182;</a>
+              </div>
+              <p>A list of options to be attached directly to the model, if provided.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> modelOptions = [<span class="string">'url'</span>, <span class="string">'urlRoot'</span>, <span class="string">'collection'</span>];</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-31">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-31">&#182;</a>
+              </div>
+              <p>Attach all inheritable methods to the Model prototype.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  _.extend(Model.prototype, Events, {</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-32">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-32">&#182;</a>
+              </div>
+              <p>A hash of attributes whose current and previous value differ.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    changed: <span class="literal">null</span>,</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-33">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-33">&#182;</a>
+              </div>
+              <p>The value returned during the last failed validation.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    validationError: <span class="literal">null</span>,</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-34">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-34">&#182;</a>
+              </div>
+              <p>The default name for the JSON <code>id</code> attribute is <code>&quot;id&quot;</code>. MongoDB and
+CouchDB users may want to set this to <code>&quot;_id&quot;</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    idAttribute: <span class="string">'id'</span>,</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-35">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-35">&#182;</a>
+              </div>
+              <p>Initialize is an empty function by default. Override it with your own
+initialization logic.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    initialize: <span class="keyword">function</span>(){},</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-36">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-36">&#182;</a>
+              </div>
+              <p>Return a copy of the model&#39;s <code>attributes</code> object.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    toJSON: <span class="keyword">function</span>(options) {
+      <span class="keyword">return</span> _.clone(<span class="keyword">this</span>.attributes);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-37">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-37">&#182;</a>
+              </div>
+              <p>Proxy <code>Backbone.sync</code> by default -- but override this if you need
+custom syncing semantics for <em>this</em> particular model.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    sync: <span class="keyword">function</span>() {
+      <span class="keyword">return</span> Backbone.sync.apply(<span class="keyword">this</span>, arguments);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-38">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-38">&#182;</a>
+              </div>
+              <p>Get the value of an attribute.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    get: <span class="keyword">function</span>(attr) {
+      <span class="keyword">return</span> <span class="keyword">this</span>.attributes[attr];
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-39">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-39">&#182;</a>
+              </div>
+              <p>Get the HTML-escaped value of an attribute.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    escape: <span class="keyword">function</span>(attr) {
+      <span class="keyword">return</span> _.escape(<span class="keyword">this</span>.get(attr));
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-40">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-40">&#182;</a>
+              </div>
+              <p>Returns <code>true</code> if the attribute contains a value that is not null
+or undefined.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    has: <span class="keyword">function</span>(attr) {
+      <span class="keyword">return</span> <span class="keyword">this</span>.get(attr) != <span class="literal">null</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-41">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-41">&#182;</a>
+              </div>
+              <p>Set a hash of model attributes on the object, firing <code>&quot;change&quot;</code>. This is
+the core primitive operation of a model, updating the data and notifying
+anyone who needs to know about the change in state. The heart of the beast.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    set: <span class="keyword">function</span>(key, val, options) {
+      <span class="keyword">var</span> attr, attrs, unset, changes, silent, changing, prev, current;
+      <span class="keyword">if</span> (key == <span class="literal">null</span>) <span class="keyword">return</span> <span class="keyword">this</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-42">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-42">&#182;</a>
+              </div>
+              <p>Handle both <code>&quot;key&quot;, value</code> and <code>{key: value}</code> -style arguments.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (<span class="keyword">typeof</span> key === <span class="string">'object'</span>) {
+        attrs = key;
+        options = val;
+      } <span class="keyword">else</span> {
+        (attrs = {})[key] = val;
+      }
+
+      options || (options = {});</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-43">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-43">&#182;</a>
+              </div>
+              <p>Run validation.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (!<span class="keyword">this</span>._validate(attrs, options)) <span class="keyword">return</span> <span class="literal">false</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-44">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-44">&#182;</a>
+              </div>
+              <p>Extract attributes and options.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      unset           = options.unset;
+      silent          = options.silent;
+      changes         = [];
+      changing        = <span class="keyword">this</span>._changing;
+      <span class="keyword">this</span>._changing  = <span class="literal">true</span>;
+
+      <span class="keyword">if</span> (!changing) {
+        <span class="keyword">this</span>._previousAttributes = _.clone(<span class="keyword">this</span>.attributes);
+        <span class="keyword">this</span>.changed = {};
+      }
+      current = <span class="keyword">this</span>.attributes, prev = <span class="keyword">this</span>._previousAttributes;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-45">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-45">&#182;</a>
+              </div>
+              <p>Check for changes of <code>id</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (<span class="keyword">this</span>.idAttribute <span class="keyword">in</span> attrs) <span class="keyword">this</span>.id = attrs[<span class="keyword">this</span>.idAttribute];</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-46">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-46">&#182;</a>
+              </div>
+              <p>For each <code>set</code> attribute, update or delete the current value.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">for</span> (attr <span class="keyword">in</span> attrs) {
+        val = attrs[attr];
+        <span class="keyword">if</span> (!_.isEqual(current[attr], val)) changes.push(attr);
+        <span class="keyword">if</span> (!_.isEqual(prev[attr], val)) {
+          <span class="keyword">this</span>.changed[attr] = val;
+        } <span class="keyword">else</span> {
+          <span class="keyword">delete</span> <span class="keyword">this</span>.changed[attr];
+        }
+        unset ? <span class="keyword">delete</span> current[attr] : current[attr] = val;
+      }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-47">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-47">&#182;</a>
+              </div>
+              <p>Trigger all relevant attribute changes.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (!silent) {
+        <span class="keyword">if</span> (changes.length) <span class="keyword">this</span>._pending = <span class="literal">true</span>;
+        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = changes.length; i &lt; l; i++) {
+          <span class="keyword">this</span>.trigger(<span class="string">'change:'</span> + changes[i], <span class="keyword">this</span>, current[changes[i]], options);
+        }
+      }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-48">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-48">&#182;</a>
+              </div>
+              <p>You might be wondering why there&#39;s a <code>while</code> loop here. Changes can
+be recursively nested within <code>&quot;change&quot;</code> events.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (changing) <span class="keyword">return</span> <span class="keyword">this</span>;
+      <span class="keyword">if</span> (!silent) {
+        <span class="keyword">while</span> (<span class="keyword">this</span>._pending) {
+          <span class="keyword">this</span>._pending = <span class="literal">false</span>;
+          <span class="keyword">this</span>.trigger(<span class="string">'change'</span>, <span class="keyword">this</span>, options);
+        }
+      }
+      <span class="keyword">this</span>._pending = <span class="literal">false</span>;
+      <span class="keyword">this</span>._changing = <span class="literal">false</span>;
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-49">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-49">&#182;</a>
+              </div>
+              <p>Remove an attribute from the model, firing <code>&quot;change&quot;</code>. <code>unset</code> is a noop
+if the attribute doesn&#39;t exist.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    unset: <span class="keyword">function</span>(attr, options) {
+      <span class="keyword">return</span> <span class="keyword">this</span>.set(attr, <span class="keyword">void</span> <span class="number">0</span>, _.extend({}, options, {unset: <span class="literal">true</span>}));
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-50">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-50">&#182;</a>
+              </div>
+              <p>Clear all attributes on the model, firing <code>&quot;change&quot;</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    clear: <span class="keyword">function</span>(options) {
+      <span class="keyword">var</span> attrs = {};
+      <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> <span class="keyword">this</span>.attributes) attrs[key] = <span class="keyword">void</span> <span class="number">0</span>;
+      <span class="keyword">return</span> <span class="keyword">this</span>.set(attrs, _.extend({}, options, {unset: <span class="literal">true</span>}));
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-51">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-51">&#182;</a>
+              </div>
+              <p>Determine if the model has changed since the last <code>&quot;change&quot;</code> event.
+If you specify an attribute name, determine if that attribute has changed.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    hasChanged: <span class="keyword">function</span>(attr) {
+      <span class="keyword">if</span> (attr == <span class="literal">null</span>) <span class="keyword">return</span> !_.isEmpty(<span class="keyword">this</span>.changed);
+      <span class="keyword">return</span> _.has(<span class="keyword">this</span>.changed, attr);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-52">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-52">&#182;</a>
+              </div>
+              <p>Return an object containing all the attributes that have changed, or
 false if there are no changed attributes. Useful for determining what
 parts of a view need to be updated and/or what attributes need to be
 persisted to the server. Unset attributes will be set to undefined.
 You can also pass an attributes object to diff against the model,
-determining if there <em>would be</em> a change.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">changedAttributes</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">diff</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">diff</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">hasChanged</span><span class="p">()</span> <span class="o">?</span> <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">changed</span><span class="p">)</span> <span class="o">:</span> <span class="kc">false</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">changed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">old</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_changing</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">_previousAttributes</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">attributes</span><span class="p">;</span>
-      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">attr</span> <span class="k">in</span> <span class="nx">diff</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isEqual</span><span class="p">(</span><span class="nx">old</span><span class="p">[</span><span class="nx">attr</span><span class="p">],</span> <span class="p">(</span><span class="nx">val</span> <span class="o">=</span> <span class="nx">diff</span><span class="p">[</span><span class="nx">attr</span><span class="p">])))</span> <span class="k">continue</span><span class="p">;</span>
-        <span class="p">(</span><span class="nx">changed</span> <span class="o">||</span> <span class="p">(</span><span class="nx">changed</span> <span class="o">=</span> <span class="p">{}))[</span><span class="nx">attr</span><span class="p">]</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
-      <span class="p">}</span>
-      <span class="k">return</span> <span class="nx">changed</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p>Get the previous value of an attribute, recorded at the time the last
-<code>"change"</code> event was fired.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">previous</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">attr</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_previousAttributes</span><span class="p">)</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_previousAttributes</span><span class="p">[</span><span class="nx">attr</span><span class="p">];</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p>Get all of the attributes of the model at the time of the previous
-<code>"change"</code> event.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">previousAttributes</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_previousAttributes</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <hr />             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p>Fetch the model from the server. If the server's representation of the
-model differs from its current attributes, they will be overriden,
-triggering a <code>"change"</code> event.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">fetch</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">?</span> <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="o">:</span> <span class="p">{};</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">parse</span> <span class="o">===</span> <span class="k">void</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">options</span><span class="p">.</span><span class="nx">parse</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">success</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">success</span><span class="p">;</span>
-      <span class="nx">options</span><span class="p">.</span><span class="nx">success</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">model</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">),</span> <span class="nx">options</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">success</span><span class="p">)</span> <span class="nx">success</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="p">};</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">sync</span><span class="p">(</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p>Set a hash of model attributes, and sync the model to the server.
-If the server returns an attributes hash that differs, the model's
-state will be <code>set</code> again.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">save</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">attrs</span><span class="p">,</span> <span class="nx">success</span><span class="p">,</span> <span class="nx">method</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">attributes</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">attributes</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p>Handle both <code>"key", value</code> and <code>{key: value}</code> -style arguments.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">key</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">key</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
-        <span class="nx">attrs</span> <span class="o">=</span> <span class="nx">key</span><span class="p">;</span>
-        <span class="nx">options</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
-      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-        <span class="p">(</span><span class="nx">attrs</span> <span class="o">=</span> <span class="p">{})[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">val</span><span class="p">;</span>
-      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>If we're not waiting and attributes exist, save acts as <code>set(attr).save(null, opts)</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">attrs</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span> <span class="o">||</span> <span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">wait</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">attrs</span><span class="p">,</span> <span class="nx">options</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
-
-      <span class="nx">options</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">validate</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span> <span class="nx">options</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p>Do not persist invalid models.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_validate</span><span class="p">(</span><span class="nx">attrs</span><span class="p">,</span> <span class="nx">options</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p>Set temporary attributes if <code>{wait: true}</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">attrs</span> <span class="o">&amp;&amp;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">wait</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">attributes</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">attributes</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">);</span>
-      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p>After a successful server-side save, the client is (optionally)
-updated with the server-side state.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">parse</span> <span class="o">===</span> <span class="k">void</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">options</span><span class="p">.</span><span class="nx">parse</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
-      <span class="nx">success</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">success</span><span class="p">;</span>
-      <span class="nx">options</span><span class="p">.</span><span class="nx">success</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <p>Ensure attributes are restored during synchronous saves.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">model</span><span class="p">.</span><span class="nx">attributes</span> <span class="o">=</span> <span class="nx">attributes</span><span class="p">;</span>
-        <span class="kd">var</span> <span class="nx">serverAttrs</span> <span class="o">=</span> <span class="nx">model</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">wait</span><span class="p">)</span> <span class="nx">serverAttrs</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">attrs</span> <span class="o">||</span> <span class="p">{},</span> <span class="nx">serverAttrs</span><span class="p">);</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">serverAttrs</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">model</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">serverAttrs</span><span class="p">,</span> <span class="nx">options</span><span class="p">))</span> <span class="p">{</span>
-          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
-        <span class="p">}</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">success</span><span class="p">)</span> <span class="nx">success</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p>Finish configuring and sending the Ajax request.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">method</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">isNew</span><span class="p">()</span> <span class="o">?</span> <span class="s1">&#39;create&#39;</span> <span class="o">:</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">patch</span> <span class="o">?</span> <span class="s1">&#39;patch&#39;</span> <span class="o">:</span> <span class="s1">&#39;update&#39;</span><span class="p">);</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">method</span> <span class="o">===</span> <span class="s1">&#39;patch&#39;</span><span class="p">)</span> <span class="nx">options</span><span class="p">.</span><span class="nx">attrs</span> <span class="o">=</span> <span class="nx">attrs</span><span class="p">;</span>
-      <span class="nx">xhr</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sync</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-62">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-62">&#182;</a>               </div>               <p>Restore attributes.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">attrs</span> <span class="o">&amp;&amp;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">wait</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">attributes</span> <span class="o">=</span> <span class="nx">attributes</span><span class="p">;</span>
-
-      <span class="k">return</span> <span class="nx">xhr</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-63">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-63">&#182;</a>               </div>               <p>Destroy this model on the server if it was already persisted.
+determining if there <em>would be</em> a change.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    changedAttributes: <span class="keyword">function</span>(diff) {
+      <span class="keyword">if</span> (!diff) <span class="keyword">return</span> <span class="keyword">this</span>.hasChanged() ? _.clone(<span class="keyword">this</span>.changed) : <span class="literal">false</span>;
+      <span class="keyword">var</span> val, changed = <span class="literal">false</span>;
+      <span class="keyword">var</span> old = <span class="keyword">this</span>._changing ? <span class="keyword">this</span>._previousAttributes : <span class="keyword">this</span>.attributes;
+      <span class="keyword">for</span> (<span class="keyword">var</span> attr <span class="keyword">in</span> diff) {
+        <span class="keyword">if</span> (_.isEqual(old[attr], (val = diff[attr]))) <span class="keyword">continue</span>;
+        (changed || (changed = {}))[attr] = val;
+      }
+      <span class="keyword">return</span> changed;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-53">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-53">&#182;</a>
+              </div>
+              <p>Get the previous value of an attribute, recorded at the time the last
+<code>&quot;change&quot;</code> event was fired.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    previous: <span class="keyword">function</span>(attr) {
+      <span class="keyword">if</span> (attr == <span class="literal">null</span> || !<span class="keyword">this</span>._previousAttributes) <span class="keyword">return</span> <span class="literal">null</span>;
+      <span class="keyword">return</span> <span class="keyword">this</span>._previousAttributes[attr];
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-54">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-54">&#182;</a>
+              </div>
+              <p>Get all of the attributes of the model at the time of the previous
+<code>&quot;change&quot;</code> event.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    previousAttributes: <span class="keyword">function</span>() {
+      <span class="keyword">return</span> _.clone(<span class="keyword">this</span>._previousAttributes);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-55">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-55">&#182;</a>
+              </div>
+              <p>Fetch the model from the server. If the server&#39;s representation of the
+model differs from its current attributes, they will be overridden,
+triggering a <code>&quot;change&quot;</code> event.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    fetch: <span class="keyword">function</span>(options) {
+      options = options ? _.clone(options) : {};
+      <span class="keyword">if</span> (options.parse === <span class="keyword">void</span> <span class="number">0</span>) options.parse = <span class="literal">true</span>;
+      <span class="keyword">var</span> model = <span class="keyword">this</span>;
+      <span class="keyword">var</span> success = options.success;
+      options.success = <span class="keyword">function</span>(resp) {
+        <span class="keyword">if</span> (!model.set(model.parse(resp, options), options)) <span class="keyword">return</span> <span class="literal">false</span>;
+        <span class="keyword">if</span> (success) success(model, resp, options);
+        model.trigger(<span class="string">'sync'</span>, model, resp, options);
+      };
+      wrapError(<span class="keyword">this</span>, options);
+      <span class="keyword">return</span> <span class="keyword">this</span>.sync(<span class="string">'read'</span>, <span class="keyword">this</span>, options);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-56">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-56">&#182;</a>
+              </div>
+              <p>Set a hash of model attributes, and sync the model to the server.
+If the server returns an attributes hash that differs, the model&#39;s
+state will be <code>set</code> again.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    save: <span class="keyword">function</span>(key, val, options) {
+      <span class="keyword">var</span> attrs, method, xhr, attributes = <span class="keyword">this</span>.attributes;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-57">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-57">&#182;</a>
+              </div>
+              <p>Handle both <code>&quot;key&quot;, value</code> and <code>{key: value}</code> -style arguments.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (key == <span class="literal">null</span> || <span class="keyword">typeof</span> key === <span class="string">'object'</span>) {
+        attrs = key;
+        options = val;
+      } <span class="keyword">else</span> {
+        (attrs = {})[key] = val;
+      }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-58">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-58">&#182;</a>
+              </div>
+              <p>If we&#39;re not waiting and attributes exist, save acts as <code>set(attr).save(null, opts)</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (attrs &amp;&amp; (!options || !options.wait) &amp;&amp; !<span class="keyword">this</span>.set(attrs, options)) <span class="keyword">return</span> <span class="literal">false</span>;
+
+      options = _.extend({validate: <span class="literal">true</span>}, options);</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-59">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-59">&#182;</a>
+              </div>
+              <p>Do not persist invalid models.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (!<span class="keyword">this</span>._validate(attrs, options)) <span class="keyword">return</span> <span class="literal">false</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-60">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-60">&#182;</a>
+              </div>
+              <p>Set temporary attributes if <code>{wait: true}</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (attrs &amp;&amp; options.wait) {
+        <span class="keyword">this</span>.attributes = _.extend({}, attributes, attrs);
+      }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-61">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-61">&#182;</a>
+              </div>
+              <p>After a successful server-side save, the client is (optionally)
+updated with the server-side state.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (options.parse === <span class="keyword">void</span> <span class="number">0</span>) options.parse = <span class="literal">true</span>;
+      <span class="keyword">var</span> model = <span class="keyword">this</span>;
+      <span class="keyword">var</span> success = options.success;
+      options.success = <span class="keyword">function</span>(resp) {</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-62">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-62">&#182;</a>
+              </div>
+              <p>Ensure attributes are restored during synchronous saves.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>        model.attributes = attributes;
+        <span class="keyword">var</span> serverAttrs = model.parse(resp, options);
+        <span class="keyword">if</span> (options.wait) serverAttrs = _.extend(attrs || {}, serverAttrs);
+        <span class="keyword">if</span> (_.isObject(serverAttrs) &amp;&amp; !model.set(serverAttrs, options)) {
+          <span class="keyword">return</span> <span class="literal">false</span>;
+        }
+        <span class="keyword">if</span> (success) success(model, resp, options);
+        model.trigger(<span class="string">'sync'</span>, model, resp, options);
+      };
+      wrapError(<span class="keyword">this</span>, options);
+
+      method = <span class="keyword">this</span>.isNew() ? <span class="string">'create'</span> : (options.patch ? <span class="string">'patch'</span> : <span class="string">'update'</span>);
+      <span class="keyword">if</span> (method === <span class="string">'patch'</span>) options.attrs = attrs;
+      xhr = <span class="keyword">this</span>.sync(method, <span class="keyword">this</span>, options);</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-63">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-63">&#182;</a>
+              </div>
+              <p>Restore attributes.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (attrs &amp;&amp; options.wait) <span class="keyword">this</span>.attributes = attributes;
+
+      <span class="keyword">return</span> xhr;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-64">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-64">&#182;</a>
+              </div>
+              <p>Destroy this model on the server if it was already persisted.
 Optimistically removes the model from its collection, if it has one.
-If <code>wait: true</code> is passed, waits for the server to respond before removal.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">destroy</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">?</span> <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="o">:</span> <span class="p">{};</span>
-      <span class="kd">var</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">success</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">success</span><span class="p">;</span>
-
-      <span class="kd">var</span> <span class="nx">destroy</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-        <span class="nx">model</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;destroy&#39;</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">model</span><span class="p">.</span><span class="nx">collection</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="p">};</span>
-
-      <span class="nx">options</span><span class="p">.</span><span class="nx">success</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">wait</span> <span class="o">||</span> <span class="nx">model</span><span class="p">.</span><span class="nx">isNew</span><span class="p">())</span> <span class="nx">destroy</span><span class="p">();</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">success</span><span class="p">)</span> <span class="nx">success</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="p">};</span>
-
-      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isNew</span><span class="p">())</span> <span class="p">{</span>
-        <span class="nx">options</span><span class="p">.</span><span class="nx">success</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
-      <span class="p">}</span>
-
-      <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sync</span><span class="p">(</span><span class="s1">&#39;delete&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">wait</span><span class="p">)</span> <span class="nx">destroy</span><span class="p">();</span>
-      <span class="k">return</span> <span class="nx">xhr</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-64">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-64">&#182;</a>               </div>               <p>Default URL for the model's representation on the server -- if you're
-using Backbone's restful methods, override this to change the endpoint
-that will be called.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">url</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">base</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">result</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;urlRoot&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">_</span><span class="p">.</span><span class="nx">result</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">collection</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">urlError</span><span class="p">();</span>
-      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isNew</span><span class="p">())</span> <span class="k">return</span> <span class="nx">base</span><span class="p">;</span>
-      <span class="k">return</span> <span class="nx">base</span> <span class="o">+</span> <span class="p">(</span><span class="nx">base</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">base</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;/&#39;</span> <span class="o">?</span> <span class="s1">&#39;&#39;</span> <span class="o">:</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">encodeURIComponent</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-65">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-65">&#182;</a>               </div>               <p><strong>parse</strong> converts a response into the hash of attributes to be <code>set</code> on
-the model. The default implementation is just to pass the response along.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">parse</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="nx">resp</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-66">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-66">&#182;</a>               </div>               <p>Create a new model with identical attributes to this one.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">clone</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="k">new</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">attributes</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-67">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-67">&#182;</a>               </div>               <p>A model is new if it has never been saved to the server, and lacks an id.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">isNew</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">id</span> <span class="o">==</span> <span class="kc">null</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-68">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-68">&#182;</a>               </div>               <p>Check if the model is currently in a valid state.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">isValid</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">validate</span> <span class="o">||</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">validate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">attributes</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-69">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-69">&#182;</a>               </div>               <p>Run validation against the next complete set of model attributes,
-returning <code>true</code> if all is well. Otherwise, fire a general
-<code>"error"</code> event and call the error callback, if specified.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_validate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attrs</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">validate</span> <span class="o">||</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">validate</span><span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
-      <span class="nx">attrs</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="k">this</span><span class="p">.</span><span class="nx">attributes</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">);</span>
-      <span class="kd">var</span> <span class="nx">error</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">validationError</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">validate</span><span class="p">(</span><span class="nx">attrs</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="o">||</span> <span class="kc">null</span><span class="p">;</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">error</span><span class="p">)</span> <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;invalid&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">error</span><span class="p">,</span> <span class="nx">options</span> <span class="o">||</span> <span class="p">{});</span>
-      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
-    <span class="p">}</span>
-
-  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-70">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-70">&#182;</a>               </div>               <h2>Backbone.Collection</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-71">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-71">&#182;</a>               </div>               <p>Provides a standard collection class for our sets of models, ordered
-or unordered. If a <code>comparator</code> is specified, the Collection will maintain
-its models in sort order, as they're added and removed.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">Collection</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collection</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">models</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-    <span class="nx">options</span> <span class="o">||</span> <span class="p">(</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{});</span>
-    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">model</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">model</span><span class="p">;</span>
-    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">comparator</span> <span class="o">!==</span> <span class="k">void</span> <span class="mi">0</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">comparator</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">comparator</span><span class="p">;</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">models</span> <span class="o">=</span> <span class="p">[];</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">_reset</span><span class="p">();</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">initialize</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
-    <span class="k">if</span> <span class="p">(</span><span class="nx">models</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">reset</span><span class="p">(</span><span class="nx">models</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">silent</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span> <span class="nx">options</span><span class="p">));</span>
-  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-72">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-72">&#182;</a>               </div>               <p>Define the Collection's inheritable methods.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Collection</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">Events</span><span class="p">,</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-73">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-73">&#182;</a>               </div>               <p>The default model for a collection is just a <strong>Backbone.Model</strong>.
-This should be overridden in most cases.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">model</span><span class="o">:</span> <span class="nx">Model</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-74">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-74">&#182;</a>               </div>               <p>Initialize is an empty function by default. Override it with your own
-initialization logic.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){},</span></pre></div>             </td>           </tr>                               <tr id="section-75">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-75">&#182;</a>               </div>               <p>The JSON representation of a Collection is an array of the
-models' attributes.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">toJSON</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">){</span> <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span> <span class="p">});</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-76">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-76">&#182;</a>               </div>               <p>Proxy <code>Backbone.sync</code> by default.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">sync</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">sync</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-77">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-77">&#182;</a>               </div>               <p>Add a model, or list of models to the set.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">add</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">models</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">models</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">models</span><span class="p">)</span> <span class="o">?</span> <span class="nx">models</span><span class="p">.</span><span class="nx">slice</span><span class="p">()</span> <span class="o">:</span> <span class="p">[</span><span class="nx">models</span><span class="p">];</span>
-      <span class="nx">options</span> <span class="o">||</span> <span class="p">(</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{});</span>
-      <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">l</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">,</span> <span class="nx">existing</span><span class="p">,</span> <span class="nx">doSort</span><span class="p">,</span> <span class="nx">add</span><span class="p">,</span> <span class="nx">at</span><span class="p">,</span> <span class="nx">sort</span><span class="p">,</span> <span class="nx">sortAttr</span><span class="p">;</span>
-      <span class="nx">add</span> <span class="o">=</span> <span class="p">[];</span>
-      <span class="nx">at</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">at</span><span class="p">;</span>
-      <span class="nx">sort</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">comparator</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">at</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">options</span><span class="p">.</span><span class="nx">sort</span> <span class="o">!=</span> <span class="kc">false</span><span class="p">;</span>
-      <span class="nx">sortAttr</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">comparator</span><span class="p">)</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">comparator</span> <span class="o">:</span> <span class="kc">null</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-78">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-78">&#182;</a>               </div>               <p>Turn bare objects into model references, and prevent invalid models
-from being added.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">models</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_prepareModel</span><span class="p">(</span><span class="nx">attrs</span> <span class="o">=</span> <span class="nx">models</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">options</span><span class="p">)))</span> <span class="p">{</span>
-          <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;invalid&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-          <span class="k">continue</span><span class="p">;</span>
-        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-79">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-79">&#182;</a>               </div>               <p>If a duplicate is found, prevent it from being added and
-optionally merge it into the existing model.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="nx">existing</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">model</span><span class="p">))</span> <span class="p">{</span>
-          <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">merge</span><span class="p">)</span> <span class="p">{</span>
-            <span class="nx">existing</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">attrs</span> <span class="o">===</span> <span class="nx">model</span> <span class="o">?</span> <span class="nx">model</span><span class="p">.</span><span class="nx">attributes</span> <span class="o">:</span> <span class="nx">attrs</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-            <span class="k">if</span> <span class="p">(</span><span class="nx">sort</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">doSort</span> <span class="o">&amp;&amp;</span> <span class="nx">existing</span><span class="p">.</span><span class="nx">hasChanged</span><span class="p">(</span><span class="nx">sortAttr</span><span class="p">))</span> <span class="nx">doSort</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
-          <span class="p">}</span>
-          <span class="k">continue</span><span class="p">;</span>
-        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-80">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-80">&#182;</a>               </div>               <p>This is a new model, push it to the <code>add</code> list.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">add</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">model</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-81">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-81">&#182;</a>               </div>               <p>Listen to added models' events, and index models for lookup by
-<code>id</code> and by <code>cid</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">model</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_onModelEvent</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">_byId</span><span class="p">[</span><span class="nx">model</span><span class="p">.</span><span class="nx">cid</span><span class="p">]</span> <span class="o">=</span> <span class="nx">model</span><span class="p">;</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">_byId</span><span class="p">[</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="nx">model</span><span class="p">;</span>
-      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-82">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-82">&#182;</a>               </div>               <p>See if sorting is needed, update <code>length</code> and splice in new models.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">add</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">sort</span><span class="p">)</span> <span class="nx">doSort</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">+=</span> <span class="nx">add</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">at</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
-          <span class="nx">splice</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">,</span> <span class="p">[</span><span class="nx">at</span><span class="p">,</span> <span class="mi">0</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">add</span><span class="p">));</span>
-        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-          <span class="nx">push</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">,</span> <span class="nx">add</span><span class="p">);</span>
-        <span class="p">}</span>
-      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-83">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-83">&#182;</a>               </div>               <p>Silently sort the collection if appropriate.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">doSort</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">sort</span><span class="p">({</span><span class="nx">silent</span><span class="o">:</span> <span class="kc">true</span><span class="p">});</span>
-
-      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">silent</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-84">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-84">&#182;</a>               </div>               <p>Trigger <code>add</code> events.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">add</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
-        <span class="p">(</span><span class="nx">model</span> <span class="o">=</span> <span class="nx">add</span><span class="p">[</span><span class="nx">i</span><span class="p">]).</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-85">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-85">&#182;</a>               </div>               <p>Trigger <code>sort</code> if the collection was sorted.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">doSort</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;sort&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-86">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-86">&#182;</a>               </div>               <p>Remove a model, or a list of models from the set.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">remove</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">models</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">models</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">models</span><span class="p">)</span> <span class="o">?</span> <span class="nx">models</span><span class="p">.</span><span class="nx">slice</span><span class="p">()</span> <span class="o">:</span> <span class="p">[</span><span class="nx">models</span><span class="p">];</span>
-      <span class="nx">options</span> <span class="o">||</span> <span class="p">(</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{});</span>
-      <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">l</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">model</span><span class="p">;</span>
-      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">models</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
-        <span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">models</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
-        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">model</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
-        <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">_byId</span><span class="p">[</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">];</span>
-        <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">_byId</span><span class="p">[</span><span class="nx">model</span><span class="p">.</span><span class="nx">cid</span><span class="p">];</span>
-        <span class="nx">index</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">model</span><span class="p">);</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">index</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="o">--</span><span class="p">;</span>
-        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">silent</span><span class="p">)</span> <span class="p">{</span>
-          <span class="nx">options</span><span class="p">.</span><span class="nx">index</span> <span class="o">=</span> <span class="nx">index</span><span class="p">;</span>
-          <span class="nx">model</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;remove&#39;</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-        <span class="p">}</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">_removeReference</span><span class="p">(</span><span class="nx">model</span><span class="p">);</span>
-      <span class="p">}</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-87">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-87">&#182;</a>               </div>               <p>Add a model to the end of the collection.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">push</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_prepareModel</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">at</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">},</span> <span class="nx">options</span><span class="p">));</span>
-      <span class="k">return</span> <span class="nx">model</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-88">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-88">&#182;</a>               </div>               <p>Remove a model from the end of the collection.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">pop</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">at</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">return</span> <span class="nx">model</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-89">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-89">&#182;</a>               </div>               <p>Add a model to the beginning of the collection.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">unshift</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_prepareModel</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">at</span><span class="o">:</span> <span class="mi">0</span><span class="p">},</span> <span class="nx">options</span><span class="p">));</span>
-      <span class="k">return</span> <span class="nx">model</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-90">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-90">&#182;</a>               </div>               <p>Remove a model from the beginning of the collection.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">shift</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">at</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">return</span> <span class="nx">model</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-91">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-91">&#182;</a>               </div>               <p>Slice out a sub-array of models from the collection.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">slice</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">begin</span><span class="p">,</span> <span class="nx">end</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">begin</span><span class="p">,</span> <span class="nx">end</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-92">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-92">&#182;</a>               </div>               <p>Get a model from the set by id.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span> <span class="k">void</span> <span class="mi">0</span><span class="p">;</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">_idAttr</span> <span class="o">||</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_idAttr</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">idAttribute</span><span class="p">);</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_byId</span><span class="p">[</span><span class="nx">obj</span><span class="p">.</span><span class="nx">id</span> <span class="o">||</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">cid</span> <span class="o">||</span> <span class="nx">obj</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">_idAttr</span><span class="p">]</span> <span class="o">||</span> <span class="nx">obj</span><span class="p">];</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-93">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-93">&#182;</a>               </div>               <p>Get the model at the given index.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">at</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">[</span><span class="nx">index</span><span class="p">];</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-94">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-94">&#182;</a>               </div>               <p>Return models with matching attributes. Useful for simple cases of <code>filter</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">where</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">attrs</span><span class="p">))</span> <span class="k">return</span> <span class="p">[];</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
-          <span class="k">if</span> <span class="p">(</span><span class="nx">attrs</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
-        <span class="p">}</span>
-        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
-      <span class="p">});</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-95">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-95">&#182;</a>               </div>               <p>Force the collection to re-sort itself. You don't need to call this under
-normal circumstances, as the set will maintain sort order as each item
-is added.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">sort</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">comparator</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Cannot sort a set without a comparator&#39;</span><span class="p">);</span>
-      <span class="p">}</span>
-      <span class="nx">options</span> <span class="o">||</span> <span class="p">(</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{});</span></pre></div>             </td>           </tr>                               <tr id="section-96">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-96">&#182;</a>               </div>               <p>Run sort based on type of <code>comparator</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">isString</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">comparator</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">comparator</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">models</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">sortBy</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">comparator</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
-      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">comparator</span><span class="p">,</span> <span class="k">this</span><span class="p">));</span>
-      <span class="p">}</span>
-
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">silent</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;sort&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-97">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-97">&#182;</a>               </div>               <p>Pluck an attribute from each model in the collection.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">pluck</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attr</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">,</span> <span class="s1">&#39;get&#39;</span><span class="p">,</span> <span class="nx">attr</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-98">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-98">&#182;</a>               </div>               <p>Smartly update a collection with a change set of models, adding,
-removing, and merging as necessary.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">update</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">models</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">options</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">add</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">merge</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">remove</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">parse</span><span class="p">)</span> <span class="nx">models</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">models</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="kd">var</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">l</span><span class="p">,</span> <span class="nx">existing</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">add</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">remove</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">modelMap</span> <span class="o">=</span> <span class="p">{};</span></pre></div>             </td>           </tr>                               <tr id="section-99">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-99">&#182;</a>               </div>               <p>Allow a single model (or no argument) to be passed.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">models</span><span class="p">))</span> <span class="nx">models</span> <span class="o">=</span> <span class="nx">models</span> <span class="o">?</span> <span class="p">[</span><span class="nx">models</span><span class="p">]</span> <span class="o">:</span> <span class="p">[];</span></pre></div>             </td>           </tr>                               <tr id="section-100">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-100">&#182;</a>               </div>               <p>Proxy to <code>add</code> for this case, no need to iterate...</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">add</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">remove</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">models</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-101">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-101">&#182;</a>               </div>               <p>Determine which models to add and merge, and which to remove.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="nx">models</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
-        <span class="nx">model</span> <span class="o">=</span> <span class="nx">models</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
-        <span class="nx">existing</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">model</span><span class="p">);</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">remove</span> <span class="o">&amp;&amp;</span> <span class="nx">existing</span><span class="p">)</span> <span class="nx">modelMap</span><span class="p">[</span><span class="nx">existing</span><span class="p">.</span><span class="nx">cid</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
-        <span class="k">if</span> <span class="p">((</span><span class="nx">options</span><span class="p">.</span><span class="nx">add</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">existing</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">merge</span> <span class="o">&amp;&amp;</span> <span class="nx">existing</span><span class="p">))</span> <span class="p">{</span>
-          <span class="nx">add</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">model</span><span class="p">);</span>
-        <span class="p">}</span>
-      <span class="p">}</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">remove</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
-          <span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
-          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">modelMap</span><span class="p">[</span><span class="nx">model</span><span class="p">.</span><span class="nx">cid</span><span class="p">])</span> <span class="nx">remove</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">model</span><span class="p">);</span>
-        <span class="p">}</span>
-      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-102">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-102">&#182;</a>               </div>               <p>Remove models (if applicable) before we add and merge the rest.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">remove</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">remove</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">add</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">add</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-103">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-103">&#182;</a>               </div>               <p>When you have more items than you want to add or remove individually,
+If <code>wait: true</code> is passed, waits for the server to respond before removal.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    destroy: <span class="keyword">function</span>(options) {
+      options = options ? _.clone(options) : {};
+      <span class="keyword">var</span> model = <span class="keyword">this</span>;
+      <span class="keyword">var</span> success = options.success;
+
+      <span class="keyword">var</span> destroy = <span class="keyword">function</span>() {
+        model.trigger(<span class="string">'destroy'</span>, model, model.collection, options);
+      };
+
+      options.success = <span class="keyword">function</span>(resp) {
+        <span class="keyword">if</span> (options.wait || model.isNew()) destroy();
+        <span class="keyword">if</span> (success) success(model, resp, options);
+        <span class="keyword">if</span> (!model.isNew()) model.trigger(<span class="string">'sync'</span>, model, resp, options);
+      };
+
+      <span class="keyword">if</span> (<span class="keyword">this</span>.isNew()) {
+        options.success();
+        <span class="keyword">return</span> <span class="literal">false</span>;
+      }
+      wrapError(<span class="keyword">this</span>, options);
+
+      <span class="keyword">var</span> xhr = <span class="keyword">this</span>.sync(<span class="string">'delete'</span>, <span class="keyword">this</span>, options);
+      <span class="keyword">if</span> (!options.wait) destroy();
+      <span class="keyword">return</span> xhr;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-65">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-65">&#182;</a>
+              </div>
+              <p>Default URL for the model&#39;s representation on the server -- if you&#39;re
+using Backbone&#39;s restful methods, override this to change the endpoint
+that will be called.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    url: <span class="keyword">function</span>() {
+      <span class="keyword">var</span> base = _.result(<span class="keyword">this</span>, <span class="string">'urlRoot'</span>) || _.result(<span class="keyword">this</span>.collection, <span class="string">'url'</span>) || urlError();
+      <span class="keyword">if</span> (<span class="keyword">this</span>.isNew()) <span class="keyword">return</span> base;
+      <span class="keyword">return</span> base + (base.charAt(base.length - <span class="number">1</span>) === <span class="string">'/'</span> ? <span class="string">''</span> : <span class="string">'/'</span>) + encodeURIComponent(<span class="keyword">this</span>.id);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-66">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-66">&#182;</a>
+              </div>
+              <p><strong>parse</strong> converts a response into the hash of attributes to be <code>set</code> on
+the model. The default implementation is just to pass the response along.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    parse: <span class="keyword">function</span>(resp, options) {
+      <span class="keyword">return</span> resp;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-67">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-67">&#182;</a>
+              </div>
+              <p>Create a new model with identical attributes to this one.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    clone: <span class="keyword">function</span>() {
+      <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">this</span>.constructor(<span class="keyword">this</span>.attributes);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-68">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-68">&#182;</a>
+              </div>
+              <p>A model is new if it has never been saved to the server, and lacks an id.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    isNew: <span class="keyword">function</span>() {
+      <span class="keyword">return</span> <span class="keyword">this</span>.id == <span class="literal">null</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-69">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-69">&#182;</a>
+              </div>
+              <p>Check if the model is currently in a valid state.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    isValid: <span class="keyword">function</span>(options) {
+      <span class="keyword">return</span> <span class="keyword">this</span>._validate({}, _.extend(options || {}, { validate: <span class="literal">true</span> }));
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-70">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-70">&#182;</a>
+              </div>
+              <p>Run validation against the next complete set of model attributes,
+returning <code>true</code> if all is well. Otherwise, fire an <code>&quot;invalid&quot;</code> event.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    _validate: <span class="keyword">function</span>(attrs, options) {
+      <span class="keyword">if</span> (!options.validate || !<span class="keyword">this</span>.validate) <span class="keyword">return</span> <span class="literal">true</span>;
+      attrs = _.extend({}, <span class="keyword">this</span>.attributes, attrs);
+      <span class="keyword">var</span> error = <span class="keyword">this</span>.validationError = <span class="keyword">this</span>.validate(attrs, options) || <span class="literal">null</span>;
+      <span class="keyword">if</span> (!error) <span class="keyword">return</span> <span class="literal">true</span>;
+      <span class="keyword">this</span>.trigger(<span class="string">'invalid'</span>, <span class="keyword">this</span>, error, _.extend(options || {}, {validationError: error}));
+      <span class="keyword">return</span> <span class="literal">false</span>;
+    }
+
+  });</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-71">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-71">&#182;</a>
+              </div>
+              <p>Underscore methods that we want to implement on the Model.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> modelMethods = [<span class="string">'keys'</span>, <span class="string">'values'</span>, <span class="string">'pairs'</span>, <span class="string">'invert'</span>, <span class="string">'pick'</span>, <span class="string">'omit'</span>];</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-72">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-72">&#182;</a>
+              </div>
+              <p>Mix in each Underscore method as a proxy to <code>Model#attributes</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  _.each(modelMethods, <span class="keyword">function</span>(method) {
+    Model.prototype[method] = <span class="keyword">function</span>() {
+      <span class="keyword">var</span> args = slice.call(arguments);
+      args.unshift(<span class="keyword">this</span>.attributes);
+      <span class="keyword">return</span> _[method].apply(_, args);
+    };
+  });</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-73">
+            <div class="annotation">
+              
+              <div class="pilwrap for-h2">
+                <a class="pilcrow" href="#section-73">&#182;</a>
+              </div>
+              <h2>Backbone.Collection</h2>
+
+            </div>
+            
+        </li>
+        
+        
+        <li id="section-74">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-74">&#182;</a>
+              </div>
+              <p>If models tend to represent a single row of data, a Backbone Collection is
+more analagous to a table full of data ... or a small slice or page of that
+table, or a collection of rows that belong together for a particular reason
+-- all of the messages in this particular folder, all of the documents
+belonging to this particular author, and so on. Collections maintain
+indexes of their models, both in order, and for lookup by <code>id</code>.
+
+</p>
+<p>Create a new <strong>Collection</strong>, perhaps to contain a specific type of <code>model</code>.
+If a <code>comparator</code> is specified, the Collection will maintain
+its models in sort order, as they&#39;re added and removed.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> Collection = Backbone.Collection = <span class="keyword">function</span>(models, options) {
+    options || (options = {});
+    <span class="keyword">if</span> (options.url) <span class="keyword">this</span>.url = options.url;
+    <span class="keyword">if</span> (options.model) <span class="keyword">this</span>.model = options.model;
+    <span class="keyword">if</span> (options.comparator !== <span class="keyword">void</span> <span class="number">0</span>) <span class="keyword">this</span>.comparator = options.comparator;
+    <span class="keyword">this</span>._reset();
+    <span class="keyword">this</span>.initialize.apply(<span class="keyword">this</span>, arguments);
+    <span class="keyword">if</span> (models) <span class="keyword">this</span>.reset(models, _.extend({silent: <span class="literal">true</span>}, options));
+  };</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-75">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-75">&#182;</a>
+              </div>
+              <p>Default options for <code>Collection#set</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> setOptions = {add: <span class="literal">true</span>, remove: <span class="literal">true</span>, merge: <span class="literal">true</span>};
+  <span class="keyword">var</span> addOptions = {add: <span class="literal">true</span>, merge: <span class="literal">false</span>, remove: <span class="literal">false</span>};</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-76">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-76">&#182;</a>
+              </div>
+              <p>Define the Collection&#39;s inheritable methods.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  _.extend(Collection.prototype, Events, {</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-77">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-77">&#182;</a>
+              </div>
+              <p>The default model for a collection is just a <strong>Backbone.Model</strong>.
+This should be overridden in most cases.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    model: Model,</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-78">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-78">&#182;</a>
+              </div>
+              <p>Initialize is an empty function by default. Override it with your own
+initialization logic.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    initialize: <span class="keyword">function</span>(){},</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-79">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-79">&#182;</a>
+              </div>
+              <p>The JSON representation of a Collection is an array of the
+models&#39; attributes.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    toJSON: <span class="keyword">function</span>(options) {
+      <span class="keyword">return</span> <span class="keyword">this</span>.map(<span class="keyword">function</span>(model){ <span class="keyword">return</span> model.toJSON(options); });
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-80">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-80">&#182;</a>
+              </div>
+              <p>Proxy <code>Backbone.sync</code> by default.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    sync: <span class="keyword">function</span>() {
+      <span class="keyword">return</span> Backbone.sync.apply(<span class="keyword">this</span>, arguments);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-81">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-81">&#182;</a>
+              </div>
+              <p>Add a model, or list of models to the set.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    add: <span class="keyword">function</span>(models, options) {
+      <span class="keyword">return</span> <span class="keyword">this</span>.set(models, _.defaults(options || {}, addOptions));
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-82">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-82">&#182;</a>
+              </div>
+              <p>Remove a model, or a list of models from the set.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    remove: <span class="keyword">function</span>(models, options) {
+      models = _.isArray(models) ? models.slice() : [models];
+      options || (options = {});
+      <span class="keyword">var</span> i, l, index, model;
+      <span class="keyword">for</span> (i = <span class="number">0</span>, l = models.length; i &lt; l; i++) {
+        model = <span class="keyword">this</span>.get(models[i]);
+        <span class="keyword">if</span> (!model) <span class="keyword">continue</span>;
+        <span class="keyword">delete</span> <span class="keyword">this</span>._byId[model.id];
+        <span class="keyword">delete</span> <span class="keyword">this</span>._byId[model.cid];
+        index = <span class="keyword">this</span>.indexOf(model);
+        <span class="keyword">this</span>.models.splice(index, <span class="number">1</span>);
+        <span class="keyword">this</span>.length--;
+        <span class="keyword">if</span> (!options.silent) {
+          options.index = index;
+          model.trigger(<span class="string">'remove'</span>, model, <span class="keyword">this</span>, options);
+        }
+        <span class="keyword">this</span>._removeReference(model);
+      }
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-83">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-83">&#182;</a>
+              </div>
+              <p>Update a collection by <code>set</code>-ing a new list of models, adding new ones,
+removing models that are no longer present, and merging models that
+already exist in the collection, as necessary. Similar to <strong>Model#set</strong>,
+the core operation for updating the data contained by the collection.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    set: <span class="keyword">function</span>(models, options) {
+      options = _.defaults(options || {}, setOptions);
+      <span class="keyword">if</span> (options.parse) models = <span class="keyword">this</span>.parse(models, options);
+      <span class="keyword">if</span> (!_.isArray(models)) models = models ? [models] : [];
+      <span class="keyword">var</span> i, l, model, attrs, existing, sort;
+      <span class="keyword">var</span> at = options.at;
+      <span class="keyword">var</span> sortable = <span class="keyword">this</span>.comparator &amp;&amp; (at == <span class="literal">null</span>) &amp;&amp; options.sort !== <span class="literal">false</span>;
+      <span class="keyword">var</span> sortAttr = _.isString(<span class="keyword">this</span>.comparator) ? <span class="keyword">this</span>.comparator : <span class="literal">null</span>;
+      <span class="keyword">var</span> toAdd = [], toRemove = [], modelMap = {};</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-84">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-84">&#182;</a>
+              </div>
+              <p>Turn bare objects into model references, and prevent invalid models
+from being added.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">for</span> (i = <span class="number">0</span>, l = models.length; i &lt; l; i++) {
+        <span class="keyword">if</span> (!(model = <span class="keyword">this</span>._prepareModel(models[i], options))) <span class="keyword">continue</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-85">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-85">&#182;</a>
+              </div>
+              <p>If a duplicate is found, prevent it from being added and
+optionally merge it into the existing model.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span> (existing = <span class="keyword">this</span>.get(model)) {
+          <span class="keyword">if</span> (options.remove) modelMap[existing.cid] = <span class="literal">true</span>;
+          <span class="keyword">if</span> (options.merge) {
+            existing.set(model.attributes, options);
+            <span class="keyword">if</span> (sortable &amp;&amp; !sort &amp;&amp; existing.hasChanged(sortAttr)) sort = <span class="literal">true</span>;
+          }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-86">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-86">&#182;</a>
+              </div>
+              <p>This is a new model, push it to the <code>toAdd</code> list.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>        } <span class="keyword">else</span> <span class="keyword">if</span> (options.add) {
+          toAdd.push(model);</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-87">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-87">&#182;</a>
+              </div>
+              <p>Listen to added models&#39; events, and index models for lookup by
+<code>id</code> and by <code>cid</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>          model.on(<span class="string">'all'</span>, <span class="keyword">this</span>._onModelEvent, <span class="keyword">this</span>);
+          <span class="keyword">this</span>._byId[model.cid] = model;
+          <span class="keyword">if</span> (model.id != <span class="literal">null</span>) <span class="keyword">this</span>._byId[model.id] = model;
+        }
+      }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-88">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-88">&#182;</a>
+              </div>
+              <p>Remove nonexistent models if appropriate.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (options.remove) {
+        <span class="keyword">for</span> (i = <span class="number">0</span>, l = <span class="keyword">this</span>.length; i &lt; l; ++i) {
+          <span class="keyword">if</span> (!modelMap[(model = <span class="keyword">this</span>.models[i]).cid]) toRemove.push(model);
+        }
+        <span class="keyword">if</span> (toRemove.length) <span class="keyword">this</span>.remove(toRemove, options);
+      }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-89">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-89">&#182;</a>
+              </div>
+              <p>See if sorting is needed, update <code>length</code> and splice in new models.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (toAdd.length) {
+        <span class="keyword">if</span> (sortable) sort = <span class="literal">true</span>;
+        <span class="keyword">this</span>.length += toAdd.length;
+        <span class="keyword">if</span> (at != <span class="literal">null</span>) {
+          splice.apply(<span class="keyword">this</span>.models, [at, <span class="number">0</span>].concat(toAdd));
+        } <span class="keyword">else</span> {
+          push.apply(<span class="keyword">this</span>.models, toAdd);
+        }
+      }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-90">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-90">&#182;</a>
+              </div>
+              <p>Silently sort the collection if appropriate.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (sort) <span class="keyword">this</span>.sort({silent: <span class="literal">true</span>});
+
+      <span class="keyword">if</span> (options.silent) <span class="keyword">return</span> <span class="keyword">this</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-91">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-91">&#182;</a>
+              </div>
+              <p>Trigger <code>add</code> events.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">for</span> (i = <span class="number">0</span>, l = toAdd.length; i &lt; l; i++) {
+        (model = toAdd[i]).trigger(<span class="string">'add'</span>, model, <span class="keyword">this</span>, options);
+      }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-92">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-92">&#182;</a>
+              </div>
+              <p>Trigger <code>sort</code> if the collection was sorted.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (sort) <span class="keyword">this</span>.trigger(<span class="string">'sort'</span>, <span class="keyword">this</span>, options);
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-93">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-93">&#182;</a>
+              </div>
+              <p>When you have more items than you want to add or remove individually,
 you can reset the entire set with a new list of models, without firing
-any <code>add</code> or <code>remove</code> events. Fires <code>reset</code> when finished.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">reset</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">models</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">options</span> <span class="o">||</span> <span class="p">(</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{});</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">parse</span><span class="p">)</span> <span class="nx">models</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">models</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">l</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">l</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">_removeReference</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
-      <span class="p">}</span>
-      <span class="nx">options</span><span class="p">.</span><span class="nx">previousModels</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">.</span><span class="nx">slice</span><span class="p">();</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">_reset</span><span class="p">();</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">models</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">models</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">silent</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span> <span class="nx">options</span><span class="p">));</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">silent</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;reset&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-104">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-104">&#182;</a>               </div>               <p>Fetch the default set of models for this collection, resetting the
-collection when they arrive. If <code>update: true</code> is passed, the response
-data will be passed through the <code>update</code> method instead of <code>reset</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">fetch</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">?</span> <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="o">:</span> <span class="p">{};</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">parse</span> <span class="o">===</span> <span class="k">void</span> <span class="mi">0</span><span class="p">)</span> <span class="nx">options</span><span class="p">.</span><span class="nx">parse</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">success</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">success</span><span class="p">;</span>
-      <span class="nx">options</span><span class="p">.</span><span class="nx">success</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">collection</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-        <span class="kd">var</span> <span class="nx">method</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">update</span> <span class="o">?</span> <span class="s1">&#39;update&#39;</span> <span class="o">:</span> <span class="s1">&#39;reset&#39;</span><span class="p">;</span>
-        <span class="nx">collection</span><span class="p">[</span><span class="nx">method</span><span class="p">](</span><span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">success</span><span class="p">)</span> <span class="nx">success</span><span class="p">(</span><span class="nx">collection</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="p">};</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">sync</span><span class="p">(</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-105">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-105">&#182;</a>               </div>               <p>Create a new instance of a model in this collection. Add the model to the
+any granular <code>add</code> or <code>remove</code> events. Fires <code>reset</code> when finished.
+Useful for bulk operations and optimizations.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    reset: <span class="keyword">function</span>(models, options) {
+      options || (options = {});
+      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = <span class="keyword">this</span>.models.length; i &lt; l; i++) {
+        <span class="keyword">this</span>._removeReference(<span class="keyword">this</span>.models[i]);
+      }
+      options.previousModels = <span class="keyword">this</span>.models;
+      <span class="keyword">this</span>._reset();
+      <span class="keyword">this</span>.add(models, _.extend({silent: <span class="literal">true</span>}, options));
+      <span class="keyword">if</span> (!options.silent) <span class="keyword">this</span>.trigger(<span class="string">'reset'</span>, <span class="keyword">this</span>, options);
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-94">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-94">&#182;</a>
+              </div>
+              <p>Add a model to the end of the collection.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    push: <span class="keyword">function</span>(model, options) {
+      model = <span class="keyword">this</span>._prepareModel(model, options);
+      <span class="keyword">this</span>.add(model, _.extend({at: <span class="keyword">this</span>.length}, options));
+      <span class="keyword">return</span> model;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-95">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-95">&#182;</a>
+              </div>
+              <p>Remove a model from the end of the collection.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    pop: <span class="keyword">function</span>(options) {
+      <span class="keyword">var</span> model = <span class="keyword">this</span>.at(<span class="keyword">this</span>.length - <span class="number">1</span>);
+      <span class="keyword">this</span>.remove(model, options);
+      <span class="keyword">return</span> model;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-96">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-96">&#182;</a>
+              </div>
+              <p>Add a model to the beginning of the collection.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    unshift: <span class="keyword">function</span>(model, options) {
+      model = <span class="keyword">this</span>._prepareModel(model, options);
+      <span class="keyword">this</span>.add(model, _.extend({at: <span class="number">0</span>}, options));
+      <span class="keyword">return</span> model;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-97">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-97">&#182;</a>
+              </div>
+              <p>Remove a model from the beginning of the collection.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    shift: <span class="keyword">function</span>(options) {
+      <span class="keyword">var</span> model = <span class="keyword">this</span>.at(<span class="number">0</span>);
+      <span class="keyword">this</span>.remove(model, options);
+      <span class="keyword">return</span> model;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-98">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-98">&#182;</a>
+              </div>
+              <p>Slice out a sub-array of models from the collection.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    slice: <span class="keyword">function</span>(begin, end) {
+      <span class="keyword">return</span> <span class="keyword">this</span>.models.slice(begin, end);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-99">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-99">&#182;</a>
+              </div>
+              <p>Get a model from the set by id.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    get: <span class="keyword">function</span>(obj) {
+      <span class="keyword">if</span> (obj == <span class="literal">null</span>) <span class="keyword">return</span> <span class="keyword">void</span> <span class="number">0</span>;
+      <span class="keyword">return</span> <span class="keyword">this</span>._byId[obj.id != <span class="literal">null</span> ? obj.id : obj.cid || obj];
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-100">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-100">&#182;</a>
+              </div>
+              <p>Get the model at the given index.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    at: <span class="keyword">function</span>(index) {
+      <span class="keyword">return</span> <span class="keyword">this</span>.models[index];
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-101">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-101">&#182;</a>
+              </div>
+              <p>Return models with matching attributes. Useful for simple cases of
+<code>filter</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    where: <span class="keyword">function</span>(attrs, first) {
+      <span class="keyword">if</span> (_.isEmpty(attrs)) <span class="keyword">return</span> first ? <span class="keyword">void</span> <span class="number">0</span> : [];
+      <span class="keyword">return</span> <span class="keyword">this</span>[first ? <span class="string">'find'</span> : <span class="string">'filter'</span>](<span class="keyword">function</span>(model) {
+        <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> attrs) {
+          <span class="keyword">if</span> (attrs[key] !== model.get(key)) <span class="keyword">return</span> <span class="literal">false</span>;
+        }
+        <span class="keyword">return</span> <span class="literal">true</span>;
+      });
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-102">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-102">&#182;</a>
+              </div>
+              <p>Return the first model with matching attributes. Useful for simple cases
+of <code>find</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    findWhere: <span class="keyword">function</span>(attrs) {
+      <span class="keyword">return</span> <span class="keyword">this</span>.where(attrs, <span class="literal">true</span>);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-103">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-103">&#182;</a>
+              </div>
+              <p>Force the collection to re-sort itself. You don&#39;t need to call this under
+normal circumstances, as the set will maintain sort order as each item
+is added.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    sort: <span class="keyword">function</span>(options) {
+      <span class="keyword">if</span> (!<span class="keyword">this</span>.comparator) <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">'Cannot sort a set without a comparator'</span>);
+      options || (options = {});</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-104">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-104">&#182;</a>
+              </div>
+              <p>Run sort based on type of <code>comparator</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (_.isString(<span class="keyword">this</span>.comparator) || <span class="keyword">this</span>.comparator.length === <span class="number">1</span>) {
+        <span class="keyword">this</span>.models = <span class="keyword">this</span>.sortBy(<span class="keyword">this</span>.comparator, <span class="keyword">this</span>);
+      } <span class="keyword">else</span> {
+        <span class="keyword">this</span>.models.sort(_.bind(<span class="keyword">this</span>.comparator, <span class="keyword">this</span>));
+      }
+
+      <span class="keyword">if</span> (!options.silent) <span class="keyword">this</span>.trigger(<span class="string">'sort'</span>, <span class="keyword">this</span>, options);
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-105">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-105">&#182;</a>
+              </div>
+              <p>Figure out the smallest index at which a model should be inserted so as
+to maintain order.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    sortedIndex: <span class="keyword">function</span>(model, value, context) {
+      value || (value = <span class="keyword">this</span>.comparator);
+      <span class="keyword">var</span> iterator = _.isFunction(value) ? value : <span class="keyword">function</span>(model) {
+        <span class="keyword">return</span> model.get(value);
+      };
+      <span class="keyword">return</span> _.sortedIndex(<span class="keyword">this</span>.models, model, iterator, context);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-106">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-106">&#182;</a>
+              </div>
+              <p>Pluck an attribute from each model in the collection.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    pluck: <span class="keyword">function</span>(attr) {
+      <span class="keyword">return</span> _.invoke(<span class="keyword">this</span>.models, <span class="string">'get'</span>, attr);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-107">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-107">&#182;</a>
+              </div>
+              <p>Fetch the default set of models for this collection, resetting the
+collection when they arrive. If <code>reset: true</code> is passed, the response
+data will be passed through the <code>reset</code> method instead of <code>set</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    fetch: <span class="keyword">function</span>(options) {
+      options = options ? _.clone(options) : {};
+      <span class="keyword">if</span> (options.parse === <span class="keyword">void</span> <span class="number">0</span>) options.parse = <span class="literal">true</span>;
+      <span class="keyword">var</span> success = options.success;
+      <span class="keyword">var</span> collection = <span class="keyword">this</span>;
+      options.success = <span class="keyword">function</span>(resp) {
+        <span class="keyword">var</span> method = options.reset ? <span class="string">'reset'</span> : <span class="string">'set'</span>;
+        collection[method](resp, options);
+        <span class="keyword">if</span> (success) success(collection, resp, options);
+        collection.trigger(<span class="string">'sync'</span>, collection, resp, options);
+      };
+      wrapError(<span class="keyword">this</span>, options);
+      <span class="keyword">return</span> <span class="keyword">this</span>.sync(<span class="string">'read'</span>, <span class="keyword">this</span>, options);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-108">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-108">&#182;</a>
+              </div>
+              <p>Create a new instance of a model in this collection. Add the model to the
 collection immediately, unless <code>wait: true</code> is passed, in which case we
-wait for the server to agree.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">create</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span> <span class="o">?</span> <span class="nx">_</span><span class="p">.</span><span class="nx">clone</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="o">:</span> <span class="p">{};</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">model</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_prepareModel</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">)))</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">wait</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="kd">var</span> <span class="nx">collection</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">success</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">success</span><span class="p">;</span>
-      <span class="nx">options</span><span class="p">.</span><span class="nx">success</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">wait</span><span class="p">)</span> <span class="nx">collection</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">success</span><span class="p">)</span> <span class="nx">success</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="p">};</span>
-      <span class="nx">model</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">return</span> <span class="nx">model</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-106">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-106">&#182;</a>               </div>               <p><strong>parse</strong> converts a response into a list of models to be added to the
-collection. The default implementation is just to pass it through.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">parse</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="nx">resp</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-107">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-107">&#182;</a>               </div>               <p>Create a new collection with an identical list of models as this one.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">clone</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="k">new</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-108">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-108">&#182;</a>               </div>               <p>Reset all internal state. Called when the collection is reset.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_reset</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">.</span><span class="nx">length</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">_byId</span>  <span class="o">=</span> <span class="p">{};</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-109">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-109">&#182;</a>               </div>               <p>Prepare a model or hash of attributes to be added to this collection.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_prepareModel</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">attrs</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">attrs</span> <span class="k">instanceof</span> <span class="nx">Model</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">attrs</span><span class="p">.</span><span class="nx">collection</span><span class="p">)</span> <span class="nx">attrs</span><span class="p">.</span><span class="nx">collection</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
-        <span class="k">return</span> <span class="nx">attrs</span><span class="p">;</span>
-      <span class="p">}</span>
-      <span class="nx">options</span> <span class="o">||</span> <span class="p">(</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{});</span>
-      <span class="nx">options</span><span class="p">.</span><span class="nx">collection</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">new</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">(</span><span class="nx">attrs</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">model</span><span class="p">.</span><span class="nx">_validate</span><span class="p">(</span><span class="nx">attrs</span><span class="p">,</span> <span class="nx">options</span><span class="p">))</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
-      <span class="k">return</span> <span class="nx">model</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-110">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-110">&#182;</a>               </div>               <p>Internal method to remove a model's ties to a collection.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_removeReference</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="o">===</span> <span class="nx">model</span><span class="p">.</span><span class="nx">collection</span><span class="p">)</span> <span class="k">delete</span> <span class="nx">model</span><span class="p">.</span><span class="nx">collection</span><span class="p">;</span>
-      <span class="nx">model</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_onModelEvent</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-111">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-111">&#182;</a>               </div>               <p>Internal method called every time a model in the set fires an event.
+wait for the server to agree.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    create: <span class="keyword">function</span>(model, options) {
+      options = options ? _.clone(options) : {};
+      <span class="keyword">if</span> (!(model = <span class="keyword">this</span>._prepareModel(model, options))) <span class="keyword">return</span> <span class="literal">false</span>;
+      <span class="keyword">if</span> (!options.wait) <span class="keyword">this</span>.add(model, options);
+      <span class="keyword">var</span> collection = <span class="keyword">this</span>;
+      <span class="keyword">var</span> success = options.success;
+      options.success = <span class="keyword">function</span>(resp) {
+        <span class="keyword">if</span> (options.wait) collection.add(model, options);
+        <span class="keyword">if</span> (success) success(model, resp, options);
+      };
+      model.save(<span class="literal">null</span>, options);
+      <span class="keyword">return</span> model;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-109">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-109">&#182;</a>
+              </div>
+              <p><strong>parse</strong> converts a response into a list of models to be added to the
+collection. The default implementation is just to pass it through.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    parse: <span class="keyword">function</span>(resp, options) {
+      <span class="keyword">return</span> resp;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-110">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-110">&#182;</a>
+              </div>
+              <p>Create a new collection with an identical list of models as this one.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    clone: <span class="keyword">function</span>() {
+      <span class="keyword">return</span> <span class="keyword">new</span> <span class="keyword">this</span>.constructor(<span class="keyword">this</span>.models);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-111">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-111">&#182;</a>
+              </div>
+              <p>Private method to reset all internal state. Called when the collection
+is first initialized or reset.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    _reset: <span class="keyword">function</span>() {
+      <span class="keyword">this</span>.length = <span class="number">0</span>;
+      <span class="keyword">this</span>.models = [];
+      <span class="keyword">this</span>._byId  = {};
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-112">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-112">&#182;</a>
+              </div>
+              <p>Prepare a hash of attributes (or other model) to be added to this
+collection.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    _prepareModel: <span class="keyword">function</span>(attrs, options) {
+      <span class="keyword">if</span> (attrs <span class="keyword">instanceof</span> Model) {
+        <span class="keyword">if</span> (!attrs.collection) attrs.collection = <span class="keyword">this</span>;
+        <span class="keyword">return</span> attrs;
+      }
+      options || (options = {});
+      options.collection = <span class="keyword">this</span>;
+      <span class="keyword">var</span> model = <span class="keyword">new</span> <span class="keyword">this</span>.model(attrs, options);
+      <span class="keyword">if</span> (!model._validate(attrs, options)) {
+        <span class="keyword">this</span>.trigger(<span class="string">'invalid'</span>, <span class="keyword">this</span>, attrs, options);
+        <span class="keyword">return</span> <span class="literal">false</span>;
+      }
+      <span class="keyword">return</span> model;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-113">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-113">&#182;</a>
+              </div>
+              <p>Internal method to sever a model&#39;s ties to a collection.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    _removeReference: <span class="keyword">function</span>(model) {
+      <span class="keyword">if</span> (<span class="keyword">this</span> === model.collection) <span class="keyword">delete</span> model.collection;
+      model.off(<span class="string">'all'</span>, <span class="keyword">this</span>._onModelEvent, <span class="keyword">this</span>);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-114">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-114">&#182;</a>
+              </div>
+              <p>Internal method called every time a model in the set fires an event.
 Sets need to update their indexes when models change ids. All other
-events simply proxy through. "add" and "remove" events that originate
-in other collections are ignored.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_onModelEvent</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">collection</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">((</span><span class="nx">event</span> <span class="o">===</span> <span class="s1">&#39;add&#39;</span> <span class="o">||</span> <span class="nx">event</span> <span class="o">===</span> <span class="s1">&#39;remove&#39;</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">collection</span> <span class="o">!==</span> <span class="k">this</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">event</span> <span class="o">===</span> <span class="s1">&#39;destroy&#39;</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">model</span> <span class="o">&amp;&amp;</span> <span class="nx">event</span> <span class="o">===</span> <span class="s1">&#39;change:&#39;</span> <span class="o">+</span> <span class="nx">model</span><span class="p">.</span><span class="nx">idAttribute</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">_byId</span><span class="p">[</span><span class="nx">model</span><span class="p">.</span><span class="nx">previous</span><span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">idAttribute</span><span class="p">)];</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">_byId</span><span class="p">[</span><span class="nx">model</span><span class="p">.</span><span class="nx">id</span><span class="p">]</span> <span class="o">=</span> <span class="nx">model</span><span class="p">;</span>
-      <span class="p">}</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
-    <span class="p">},</span>
-
-    <span class="nx">sortedIndex</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">value</span> <span class="o">||</span> <span class="p">(</span><span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">comparator</span><span class="p">);</span>
-      <span class="kd">var</span> <span class="nx">iterator</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">?</span> <span class="nx">value</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
-      <span class="p">};</span>
-      <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">sortedIndex</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">);</span>
-    <span class="p">}</span>
-
-  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-112">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-112">&#182;</a>               </div>               <p>Underscore methods that we want to implement on the Collection.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;forEach&#39;</span><span class="p">,</span> <span class="s1">&#39;each&#39;</span><span class="p">,</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span> <span class="s1">&#39;collect&#39;</span><span class="p">,</span> <span class="s1">&#39;reduce&#39;</span><span class="p">,</span> <span class="s1">&#39;foldl&#39;</span><span class="p">,</span>
-    <span class="s1">&#39;inject&#39;</span><span class="p">,</span> <span class="s1">&#39;reduceRight&#39;</span><span class="p">,</span> <span class="s1">&#39;foldr&#39;</span><span class="p">,</span> <span class="s1">&#39;find&#39;</span><span class="p">,</span> <span class="s1">&#39;detect&#39;</span><span class="p">,</span> <span class="s1">&#39;filter&#39;</span><span class="p">,</span> <span class="s1">&#39;select&#39;</span><span class="p">,</span>
-    <span class="s1">&#39;reject&#39;</span><span class="p">,</span> <span class="s1">&#39;every&#39;</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;some&#39;</span><span class="p">,</span> <span class="s1">&#39;any&#39;</span><span class="p">,</span> <span class="s1">&#39;include&#39;</span><span class="p">,</span> <span class="s1">&#39;contains&#39;</span><span class="p">,</span> <span class="s1">&#39;invoke&#39;</span><span class="p">,</span>
-    <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;toArray&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span> <span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;head&#39;</span><span class="p">,</span> <span class="s1">&#39;take&#39;</span><span class="p">,</span> <span class="s1">&#39;initial&#39;</span><span class="p">,</span> <span class="s1">&#39;rest&#39;</span><span class="p">,</span>
-    <span class="s1">&#39;tail&#39;</span><span class="p">,</span> <span class="s1">&#39;drop&#39;</span><span class="p">,</span> <span class="s1">&#39;last&#39;</span><span class="p">,</span> <span class="s1">&#39;without&#39;</span><span class="p">,</span> <span class="s1">&#39;indexOf&#39;</span><span class="p">,</span> <span class="s1">&#39;shuffle&#39;</span><span class="p">,</span> <span class="s1">&#39;lastIndexOf&#39;</span><span class="p">,</span>
-    <span class="s1">&#39;isEmpty&#39;</span><span class="p">,</span> <span class="s1">&#39;chain&#39;</span><span class="p">];</span></pre></div>             </td>           </tr>                               <tr id="section-113">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-113">&#182;</a>               </div>               <p>Mix in each Underscore method as a proxy to <code>Collection#models</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">methods</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
-    <span class="nx">Collection</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">method</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">);</span>
-      <span class="nx">args</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">);</span>
-      <span class="k">return</span> <span class="nx">_</span><span class="p">[</span><span class="nx">method</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="nx">_</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
-    <span class="p">};</span>
-  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-114">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-114">&#182;</a>               </div>               <p>Underscore methods that take a property name as an argument.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">attributeMethods</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;groupBy&#39;</span><span class="p">,</span> <span class="s1">&#39;countBy&#39;</span><span class="p">,</span> <span class="s1">&#39;sortBy&#39;</span><span class="p">];</span></pre></div>             </td>           </tr>                               <tr id="section-115">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-115">&#182;</a>               </div>               <p>Use attributes instead of properties.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="nx">attributeMethods</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
-    <span class="nx">Collection</span><span class="p">.</span><span class="nx">prototype</span><span class="p">[</span><span class="nx">method</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">iterator</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="o">?</span> <span class="nx">value</span> <span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">model</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
-      <span class="p">};</span>
-      <span class="k">return</span> <span class="nx">_</span><span class="p">[</span><span class="nx">method</span><span class="p">](</span><span class="k">this</span><span class="p">.</span><span class="nx">models</span><span class="p">,</span> <span class="nx">iterator</span><span class="p">,</span> <span class="nx">context</span><span class="p">);</span>
-    <span class="p">};</span>
-  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-116">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-116">&#182;</a>               </div>               <h2>Backbone.Router</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-117">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-117">&#182;</a>               </div>               <p>Routers map faux-URLs to actions, and fire events when routes are
-matched. Creating a new one sets its <code>routes</code> hash, if not set statically.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">Router</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Router</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-    <span class="nx">options</span> <span class="o">||</span> <span class="p">(</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{});</span>
-    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">routes</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">routes</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">routes</span><span class="p">;</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">_bindRoutes</span><span class="p">();</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">initialize</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
-  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-118">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-118">&#182;</a>               </div>               <p>Cached regular expressions for matching named param parts and splatted
-parts of route strings.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">optionalParam</span> <span class="o">=</span> <span class="sr">/\((.*?)\)/g</span><span class="p">;</span>
-  <span class="kd">var</span> <span class="nx">namedParam</span>    <span class="o">=</span> <span class="sr">/(\(\?)?:\w+/g</span><span class="p">;</span>
-  <span class="kd">var</span> <span class="nx">splatParam</span>    <span class="o">=</span> <span class="sr">/\*\w+/g</span><span class="p">;</span>
-  <span class="kd">var</span> <span class="nx">escapeRegExp</span>  <span class="o">=</span> <span class="sr">/[\-{}\[\]+?.,\\\^$|#\s]/g</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-119">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-119">&#182;</a>               </div>               <p>Set up all inheritable <strong>Backbone.Router</strong> properties and methods.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">Router</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">Events</span><span class="p">,</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-120">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-120">&#182;</a>               </div>               <p>Initialize is an empty function by default. Override it with your own
-initialization logic.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){},</span></pre></div>             </td>           </tr>                               <tr id="section-121">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-121">&#182;</a>               </div>               <p>Manually bind a single named route to a callback. For example:</p>
-
-<pre><code>this.route('search/:query/p:num', 'search', function(query, num) {
-  ...
-});
-</code></pre>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">route</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">route</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isRegExp</span><span class="p">(</span><span class="nx">route</span><span class="p">))</span> <span class="nx">route</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_routeToRegExp</span><span class="p">(</span><span class="nx">route</span><span class="p">);</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">callback</span><span class="p">)</span> <span class="nx">callback</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
-      <span class="nx">Backbone</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="nx">route</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">fragment</span><span class="p">)</span> <span class="p">{</span>
-        <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_extractParameters</span><span class="p">(</span><span class="nx">route</span><span class="p">,</span> <span class="nx">fragment</span><span class="p">);</span>
-        <span class="nx">callback</span> <span class="o">&amp;&amp;</span> <span class="nx">callback</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;route:&#39;</span> <span class="o">+</span> <span class="nx">name</span><span class="p">].</span><span class="nx">concat</span><span class="p">(</span><span class="nx">args</span><span class="p">));</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;route&#39;</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
-        <span class="nx">Backbone</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;route&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
-      <span class="p">},</span> <span class="k">this</span><span class="p">));</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-122">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-122">&#182;</a>               </div>               <p>Simple proxy to <code>Backbone.history</code> to save a fragment into the history.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">navigate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fragment</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">Backbone</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">navigate</span><span class="p">(</span><span class="nx">fragment</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-123">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-123">&#182;</a>               </div>               <p>Bind all defined routes to <code>Backbone.history</code>. We have to reverse the
-order of the routes here to support behavior where the most general
-routes can be defined at the bottom of the route map.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_bindRoutes</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">routes</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">route</span><span class="p">,</span> <span class="nx">routes</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">routes</span><span class="p">);</span>
-      <span class="k">while</span> <span class="p">((</span><span class="nx">route</span> <span class="o">=</span> <span class="nx">routes</span><span class="p">.</span><span class="nx">pop</span><span class="p">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">route</span><span class="p">(</span><span class="nx">route</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">routes</span><span class="p">[</span><span class="nx">route</span><span class="p">]);</span>
-      <span class="p">}</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-124">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-124">&#182;</a>               </div>               <p>Convert a route string into a regular expression, suitable for matching
-against the current location hash.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_routeToRegExp</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">route</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">route</span> <span class="o">=</span> <span class="nx">route</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">escapeRegExp</span><span class="p">,</span> <span class="s1">&#39;\\$&amp;&#39;</span><span class="p">)</span>
-                   <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">optionalParam</span><span class="p">,</span> <span class="s1">&#39;(?:$1)?&#39;</span><span class="p">)</span>
-                   <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">namedParam</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="nx">optional</span><span class="p">){</span>
-                     <span class="k">return</span> <span class="nx">optional</span> <span class="o">?</span> <span class="nx">match</span> <span class="o">:</span> <span class="s1">&#39;([^\/]+)&#39;</span><span class="p">;</span>
-                   <span class="p">})</span>
-                   <span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">splatParam</span><span class="p">,</span> <span class="s1">&#39;(.*?)&#39;</span><span class="p">);</span>
-      <span class="k">return</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;^&#39;</span> <span class="o">+</span> <span class="nx">route</span> <span class="o">+</span> <span class="s1">&#39;$&#39;</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-125">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-125">&#182;</a>               </div>               <p>Given a route, and a URL fragment that it matches, return the array of
-extracted parameters.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_extractParameters</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">route</span><span class="p">,</span> <span class="nx">fragment</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="nx">route</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">fragment</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
-    <span class="p">}</span>
-
-  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-126">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-126">&#182;</a>               </div>               <h2>Backbone.History</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-127">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-127">&#182;</a>               </div>               <p>Handles cross-browser history management, based on URL fragments. If the
-browser does not support <code>onhashchange</code>, falls back to polling.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">History</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">History</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">handlers</span> <span class="o">=</span> <span class="p">[];</span>
-    <span class="nx">_</span><span class="p">.</span><span class="nx">bindAll</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;checkUrl&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-128">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-128">&#182;</a>               </div>               <p>Ensure that <code>History</code> can be used outside of the browser.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nb">window</span> <span class="o">!==</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">;</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">history</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">history</span><span class="p">;</span>
-    <span class="p">}</span>
-  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-129">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-129">&#182;</a>               </div>               <p>Cached regex for stripping a leading hash/slash and trailing space.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">routeStripper</span> <span class="o">=</span> <span class="sr">/^[#\/]|\s+$/g</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-130">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-130">&#182;</a>               </div>               <p>Cached regex for stripping leading and trailing slashes.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">rootStripper</span> <span class="o">=</span> <span class="sr">/^\/+|\/+$/g</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-131">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-131">&#182;</a>               </div>               <p>Cached regex for detecting MSIE.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">isExplorer</span> <span class="o">=</span> <span class="sr">/msie [\w.]+/</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-132">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-132">&#182;</a>               </div>               <p>Cached regex for removing a trailing slash.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">trailingSlash</span> <span class="o">=</span> <span class="sr">/\/$/</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-133">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-133">&#182;</a>               </div>               <p>Has the history handling already been started?</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">History</span><span class="p">.</span><span class="nx">started</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-134">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-134">&#182;</a>               </div>               <p>Set up all inheritable <strong>Backbone.History</strong> properties and methods.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">History</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">Events</span><span class="p">,</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-135">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-135">&#182;</a>               </div>               <p>The default interval to poll for hash changes, if necessary, is
-twenty times a second.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">interval</span><span class="o">:</span> <span class="mi">50</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-136">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-136">&#182;</a>               </div>               <p>Gets the true hash value. Cannot use location.hash directly due to bug
-in Firefox where location.hash will always be decoded.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">getHash</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nb">window</span><span class="p">)</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">match</span> <span class="o">=</span> <span class="p">(</span><span class="nb">window</span> <span class="o">||</span> <span class="k">this</span><span class="p">).</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/#(.*)$/</span><span class="p">);</span>
-      <span class="k">return</span> <span class="nx">match</span> <span class="o">?</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-137">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-137">&#182;</a>               </div>               <p>Get the cross-browser normalized URL fragment, either from the URL,
-the hash, or the override.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">getFragment</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fragment</span><span class="p">,</span> <span class="nx">forcePushState</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">fragment</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_hasPushState</span> <span class="o">||</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_wantsHashChange</span> <span class="o">||</span> <span class="nx">forcePushState</span><span class="p">)</span> <span class="p">{</span>
-          <span class="nx">fragment</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">pathname</span><span class="p">;</span>
-          <span class="kd">var</span> <span class="nx">root</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">trailingSlash</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
-          <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">fragment</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">root</span><span class="p">))</span> <span class="nx">fragment</span> <span class="o">=</span> <span class="nx">fragment</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">root</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
-        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-          <span class="nx">fragment</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getHash</span><span class="p">();</span>
-        <span class="p">}</span>
-      <span class="p">}</span>
-      <span class="k">return</span> <span class="nx">fragment</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">routeStripper</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-138">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-138">&#182;</a>               </div>               <p>Start the hash change handling, returning <code>true</code> if the current URL matches
-an existing route, and <code>false</code> otherwise.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">History</span><span class="p">.</span><span class="nx">started</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Backbone.history has already been started&quot;</span><span class="p">);</span>
-      <span class="nx">History</span><span class="p">.</span><span class="nx">started</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-139">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-139">&#182;</a>               </div>               <p>Figure out the initial configuration. Do we need an iframe?
-Is pushState desired ... is it available?</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">options</span>          <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="p">{</span><span class="nx">root</span><span class="o">:</span> <span class="s1">&#39;/&#39;</span><span class="p">},</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">root</span>             <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">_wantsHashChange</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">hashChange</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">;</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">_wantsPushState</span>  <span class="o">=</span> <span class="o">!!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">pushState</span><span class="p">;</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">_hasPushState</span>    <span class="o">=</span> <span class="o">!!</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">pushState</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">history</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">);</span>
-      <span class="kd">var</span> <span class="nx">fragment</span>          <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getFragment</span><span class="p">();</span>
-      <span class="kd">var</span> <span class="nx">docMode</span>           <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentMode</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">oldIE</span>             <span class="o">=</span> <span class="p">(</span><span class="nx">isExplorer</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">userAgent</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">())</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">docMode</span> <span class="o">||</span> <span class="nx">docMode</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-140">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-140">&#182;</a>               </div>               <p>Normalize root to always include a leading and trailing slash.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">root</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">rootStripper</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span>
-
-      <span class="k">if</span> <span class="p">(</span><span class="nx">oldIE</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_wantsHashChange</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">iframe</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;iframe src=&quot;javascript:0&quot; tabindex=&quot;-1&quot; /&gt;&#39;</span><span class="p">).</span><span class="nx">hide</span><span class="p">().</span><span class="nx">appendTo</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="nx">contentWindow</span><span class="p">;</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">navigate</span><span class="p">(</span><span class="nx">fragment</span><span class="p">);</span>
-      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-141">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-141">&#182;</a>               </div>               <p>Depending on whether we're using pushState or hashes, and whether
-'onhashchange' is supported, determine how we check the URL state.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_hasPushState</span><span class="p">)</span> <span class="p">{</span>
-        <span class="nx">Backbone</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;popstate&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">checkUrl</span><span class="p">);</span>
-      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_wantsHashChange</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="s1">&#39;onhashchange&#39;</span> <span class="k">in</span> <span class="nb">window</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">oldIE</span><span class="p">)</span> <span class="p">{</span>
-        <span class="nx">Backbone</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;hashchange&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">checkUrl</span><span class="p">);</span>
-      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_wantsHashChange</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">_checkUrlInterval</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">checkUrl</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">interval</span><span class="p">);</span>
-      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-142">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-142">&#182;</a>               </div>               <p>Determine if we need to change the base url, for a pushState link
-opened by a non-pushState browser.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">fragment</span> <span class="o">=</span> <span class="nx">fragment</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">loc</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">location</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">atRoot</span> <span class="o">=</span> <span class="nx">loc</span><span class="p">.</span><span class="nx">pathname</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[^\/]$/</span><span class="p">,</span> <span class="s1">&#39;$&amp;/&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-143">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-143">&#182;</a>               </div>               <p>If we've started off with a route from a <code>pushState</code>-enabled browser,
-but we're currently in a browser that doesn't support it...</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_wantsHashChange</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_wantsPushState</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_hasPushState</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">atRoot</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">fragment</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getFragment</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">root</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span> <span class="o">+</span> <span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">fragment</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-144">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-144">&#182;</a>               </div>               <p>Return immediately as browser will do redirect to new url</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-145">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-145">&#182;</a>               </div>               <p>Or if we've started out with a hash-based route, but we're currently
-in a browser where it could be <code>pushState</code>-based instead...</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_wantsPushState</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">_hasPushState</span> <span class="o">&amp;&amp;</span> <span class="nx">atRoot</span> <span class="o">&amp;&amp;</span> <span class="nx">loc</span><span class="p">.</span><span class="nx">hash</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">fragment</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getHash</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="nx">routeStripper</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">replaceState</span><span class="p">({},</span> <span class="nb">document</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">fragment</span> <span class="o">+</span> <span class="nx">loc</span><span class="p">.</span><span class="nx">search</span><span class="p">);</span>
-      <span class="p">}</span>
-
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">silent</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">loadUrl</span><span class="p">();</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-146">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-146">&#182;</a>               </div>               <p>Disable Backbone.history, perhaps temporarily. Not useful in a real app,
-but possibly useful for unit testing Routers.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">stop</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="nx">Backbone</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;popstate&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">checkUrl</span><span class="p">).</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;hashchange&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">checkUrl</span><span class="p">);</span>
-      <span class="nx">clearInterval</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_checkUrlInterval</span><span class="p">);</span>
-      <span class="nx">History</span><span class="p">.</span><span class="nx">started</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-147">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-147">&#182;</a>               </div>               <p>Add a route to be tested when the fragment changes. Routes added later
-may override previous routes.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">route</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">route</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">handlers</span><span class="p">.</span><span class="nx">unshift</span><span class="p">({</span><span class="nx">route</span><span class="o">:</span> <span class="nx">route</span><span class="p">,</span> <span class="nx">callback</span><span class="o">:</span> <span class="nx">callback</span><span class="p">});</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-148">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-148">&#182;</a>               </div>               <p>Checks the current URL to see if it has changed, and if it has,
-calls <code>loadUrl</code>, normalizing across the hidden iframe.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">checkUrl</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">current</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getFragment</span><span class="p">();</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">current</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">fragment</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">)</span> <span class="p">{</span>
-        <span class="nx">current</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getFragment</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getHash</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">));</span>
-      <span class="p">}</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">current</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">fragment</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
-      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">navigate</span><span class="p">(</span><span class="nx">current</span><span class="p">);</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">loadUrl</span><span class="p">()</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">loadUrl</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getHash</span><span class="p">());</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-149">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-149">&#182;</a>               </div>               <p>Attempt to load the current URL fragment. If a route succeeds with a
-match, returns <code>true</code>. If no defined routes matches the fragment,
-returns <code>false</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">loadUrl</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fragmentOverride</span><span class="p">)</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">fragment</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">fragment</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getFragment</span><span class="p">(</span><span class="nx">fragmentOverride</span><span class="p">);</span>
-      <span class="kd">var</span> <span class="nx">matched</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">any</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">handlers</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">handler</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">handler</span><span class="p">.</span><span class="nx">route</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">fragment</span><span class="p">))</span> <span class="p">{</span>
-          <span class="nx">handler</span><span class="p">.</span><span class="nx">callback</span><span class="p">(</span><span class="nx">fragment</span><span class="p">);</span>
-          <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
-        <span class="p">}</span>
-      <span class="p">});</span>
-      <span class="k">return</span> <span class="nx">matched</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-150">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-150">&#182;</a>               </div>               <p>Save a fragment into the hash history, or replace the URL state if the
-'replace' option is passed. You are responsible for properly URL-encoding
-the fragment in advance.</p>
+events simply proxy through. &quot;add&quot; and &quot;remove&quot; events that originate
+in other collections are ignored.
+</p>
 
-<p>The options object can contain <code>trigger: true</code> if you wish to have the
-route callback be fired (not usually desirable), or <code>replace: true</code>, if
-you wish to modify the current URL without adding an entry to the history.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">navigate</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">fragment</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">History</span><span class="p">.</span><span class="nx">started</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span> <span class="o">||</span> <span class="nx">options</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span><span class="nx">trigger</span><span class="o">:</span> <span class="nx">options</span><span class="p">};</span>
-      <span class="nx">fragment</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getFragment</span><span class="p">(</span><span class="nx">fragment</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
-      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">fragment</span> <span class="o">===</span> <span class="nx">fragment</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">fragment</span> <span class="o">=</span> <span class="nx">fragment</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">root</span> <span class="o">+</span> <span class="nx">fragment</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-151">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-151">&#182;</a>               </div>               <p>If pushState is available, we use it to set the fragment as a real URL.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_hasPushState</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">history</span><span class="p">[</span><span class="nx">options</span><span class="p">.</span><span class="nx">replace</span> <span class="o">?</span> <span class="s1">&#39;replaceState&#39;</span> <span class="o">:</span> <span class="s1">&#39;pushState&#39;</span><span class="p">]({},</span> <span class="nb">document</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span> <span class="nx">url</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-152">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-152">&#182;</a>               </div>               <p>If hash changes haven't been explicitly disabled, update the hash
-fragment to store history.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">_wantsHashChange</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">_updateHash</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">location</span><span class="p">,</span> <span class="nx">fragment</span><span class="p">,</span> <span class="nx">options</span><span class="p">.</span><span class="nx">replace</span><span class="p">);</span>
-        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">iframe</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">fragment</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">getFragment</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getHash</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">))))</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-153">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-153">&#182;</a>               </div>               <p>Opening and closing the iframe tricks IE7 and earlier to push a
-history entry on hash-tag change.  When replace is true, we don't
-want this.</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">replace</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">.</span><span class="nb">document</span><span class="p">.</span><span class="nx">open</span><span class="p">().</span><span class="nx">close</span><span class="p">();</span>
-          <span class="k">this</span><span class="p">.</span><span class="nx">_updateHash</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">iframe</span><span class="p">.</span><span class="nx">location</span><span class="p">,</span> <span class="nx">fragment</span><span class="p">,</span> <span class="nx">options</span><span class="p">.</span><span class="nx">replace</span><span class="p">);</span>
-        <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-154">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-154">&#182;</a>               </div>               <p>If you've told us that you explicitly don't want fallback hashchange-
-based history, then <code>navigate</code> becomes a page refresh.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">assign</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
-      <span class="p">}</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">trigger</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">loadUrl</span><span class="p">(</span><span class="nx">fragment</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-155">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-155">&#182;</a>               </div>               <p>Update the hash location, either replacing the current entry, or adding
-a new one to the browser history.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_updateHash</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">location</span><span class="p">,</span> <span class="nx">fragment</span><span class="p">,</span> <span class="nx">replace</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">replace</span><span class="p">)</span> <span class="p">{</span>
-        <span class="kd">var</span> <span class="nx">href</span> <span class="o">=</span> <span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/(javascript:|#).*$/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
-        <span class="nx">location</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">href</span> <span class="o">+</span> <span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="nx">fragment</span><span class="p">);</span>
-      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-156">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-156">&#182;</a>               </div>               <p>Some browsers require that <code>hash</code> contains a leading #.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">location</span><span class="p">.</span><span class="nx">hash</span> <span class="o">=</span> <span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="nx">fragment</span><span class="p">;</span>
-      <span class="p">}</span>
-    <span class="p">}</span>
-
-  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-157">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-157">&#182;</a>               </div>               <p>Create the default Backbone.history.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Backbone</span><span class="p">.</span><span class="nx">history</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">History</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-158">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-158">&#182;</a>               </div>               <h2>Backbone.View</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-159">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-159">&#182;</a>               </div>               <p>Creating a Backbone.View creates its initial element outside of the DOM,
-if an existing element is not provided...</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">View</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">cid</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">uniqueId</span><span class="p">(</span><span class="s1">&#39;view&#39;</span><span class="p">);</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">_configure</span><span class="p">(</span><span class="nx">options</span> <span class="o">||</span> <span class="p">{});</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">_ensureElement</span><span class="p">();</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">initialize</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
-    <span class="k">this</span><span class="p">.</span><span class="nx">delegateEvents</span><span class="p">();</span>
-  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-160">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-160">&#182;</a>               </div>               <p>Cached regex to split keys for <code>delegate</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">delegateEventSplitter</span> <span class="o">=</span> <span class="sr">/^(\S+)\s*(.*)$/</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-161">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-161">&#182;</a>               </div>               <p>List of view options to be merged as properties.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">viewOptions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="s1">&#39;collection&#39;</span><span class="p">,</span> <span class="s1">&#39;el&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;attributes&#39;</span><span class="p">,</span> <span class="s1">&#39;className&#39;</span><span class="p">,</span> <span class="s1">&#39;tagName&#39;</span><span class="p">,</span> <span class="s1">&#39;events&#39;</span><span class="p">];</span></pre></div>             </td>           </tr>                               <tr id="section-162">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-162">&#182;</a>               </div>               <p>Set up all inheritable <strong>Backbone.View</strong> properties and methods.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">View</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">Events</span><span class="p">,</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-163">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-163">&#182;</a>               </div>               <p>The default <code>tagName</code> of a View's element is <code>"div"</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">tagName</span><span class="o">:</span> <span class="s1">&#39;div&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-164">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-164">&#182;</a>               </div>               <p>jQuery delegate for element lookup, scoped to DOM elements within the
-current view. This should be prefered to global lookups where possible.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">$</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-165">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-165">&#182;</a>               </div>               <p>Initialize is an empty function by default. Override it with your own
-initialization logic.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){},</span></pre></div>             </td>           </tr>                               <tr id="section-166">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-166">&#182;</a>               </div>               <p><strong>render</strong> is the core function that your view should override, in order
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    _onModelEvent: <span class="keyword">function</span>(event, model, collection, options) {
+      <span class="keyword">if</span> ((event === <span class="string">'add'</span> || event === <span class="string">'remove'</span>) &amp;&amp; collection !== <span class="keyword">this</span>) <span class="keyword">return</span>;
+      <span class="keyword">if</span> (event === <span class="string">'destroy'</span>) <span class="keyword">this</span>.remove(model, options);
+      <span class="keyword">if</span> (model &amp;&amp; event === <span class="string">'change:'</span> + model.idAttribute) {
+        <span class="keyword">delete</span> <span class="keyword">this</span>._byId[model.previous(model.idAttribute)];
+        <span class="keyword">if</span> (model.id != <span class="literal">null</span>) <span class="keyword">this</span>._byId[model.id] = model;
+      }
+      <span class="keyword">this</span>.trigger.apply(<span class="keyword">this</span>, arguments);
+    }
+
+  });</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-115">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-115">&#182;</a>
+              </div>
+              <p>Underscore methods that we want to implement on the Collection.
+90% of the core usefulness of Backbone Collections is actually implemented
+right here:
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> methods = [<span class="string">'forEach'</span>, <span class="string">'each'</span>, <span class="string">'map'</span>, <span class="string">'collect'</span>, <span class="string">'reduce'</span>, <span class="string">'foldl'</span>,
+    <span class="string">'inject'</span>, <span class="string">'reduceRight'</span>, <span class="string">'foldr'</span>, <span class="string">'find'</span>, <span class="string">'detect'</span>, <span class="string">'filter'</span>, <span class="string">'select'</span>,
+    <span class="string">'reject'</span>, <span class="string">'every'</span>, <span class="string">'all'</span>, <span class="string">'some'</span>, <span class="string">'any'</span>, <span class="string">'include'</span>, <span class="string">'contains'</span>, <span class="string">'invoke'</span>,
+    <span class="string">'max'</span>, <span class="string">'min'</span>, <span class="string">'toArray'</span>, <span class="string">'size'</span>, <span class="string">'first'</span>, <span class="string">'head'</span>, <span class="string">'take'</span>, <span class="string">'initial'</span>, <span class="string">'rest'</span>,
+    <span class="string">'tail'</span>, <span class="string">'drop'</span>, <span class="string">'last'</span>, <span class="string">'without'</span>, <span class="string">'indexOf'</span>, <span class="string">'shuffle'</span>, <span class="string">'lastIndexOf'</span>,
+    <span class="string">'isEmpty'</span>, <span class="string">'chain'</span>];</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-116">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-116">&#182;</a>
+              </div>
+              <p>Mix in each Underscore method as a proxy to <code>Collection#models</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  _.each(methods, <span class="keyword">function</span>(method) {
+    Collection.prototype[method] = <span class="keyword">function</span>() {
+      <span class="keyword">var</span> args = slice.call(arguments);
+      args.unshift(<span class="keyword">this</span>.models);
+      <span class="keyword">return</span> _[method].apply(_, args);
+    };
+  });</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-117">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-117">&#182;</a>
+              </div>
+              <p>Underscore methods that take a property name as an argument.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> attributeMethods = [<span class="string">'groupBy'</span>, <span class="string">'countBy'</span>, <span class="string">'sortBy'</span>];</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-118">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-118">&#182;</a>
+              </div>
+              <p>Use attributes instead of properties.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  _.each(attributeMethods, <span class="keyword">function</span>(method) {
+    Collection.prototype[method] = <span class="keyword">function</span>(value, context) {
+      <span class="keyword">var</span> iterator = _.isFunction(value) ? value : <span class="keyword">function</span>(model) {
+        <span class="keyword">return</span> model.get(value);
+      };
+      <span class="keyword">return</span> _[method](<span class="keyword">this</span>.models, iterator, context);
+    };
+  });</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-119">
+            <div class="annotation">
+              
+              <div class="pilwrap for-h2">
+                <a class="pilcrow" href="#section-119">&#182;</a>
+              </div>
+              <h2>Backbone.View</h2>
+
+            </div>
+            
+        </li>
+        
+        
+        <li id="section-120">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-120">&#182;</a>
+              </div>
+              <p>Backbone Views are almost more convention than they are actual code. A View
+is simply a JavaScript object that represents a logical chunk of UI in the
+DOM. This might be a single item, an entire list, a sidebar or panel, or
+even the surrounding frame which wraps your whole app. Defining a chunk of
+UI as a <strong>View</strong> allows you to define your DOM events declaratively, without
+having to worry about render order ... and makes it easy for the view to
+react to specific changes in the state of your models.
+
+</p>
+<p>Creating a Backbone.View creates its initial element outside of the DOM,
+if an existing element is not provided...
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> View = Backbone.View = <span class="keyword">function</span>(options) {
+    <span class="keyword">this</span>.cid = _.uniqueId(<span class="string">'view'</span>);
+    <span class="keyword">this</span>._configure(options || {});
+    <span class="keyword">this</span>._ensureElement();
+    <span class="keyword">this</span>.initialize.apply(<span class="keyword">this</span>, arguments);
+    <span class="keyword">this</span>.delegateEvents();
+  };</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-121">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-121">&#182;</a>
+              </div>
+              <p>Cached regex to split keys for <code>delegate</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> delegateEventSplitter = <span class="regexp">/^(\S+)\s*(.*)$/</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-122">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-122">&#182;</a>
+              </div>
+              <p>List of view options to be merged as properties.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> viewOptions = [<span class="string">'model'</span>, <span class="string">'collection'</span>, <span class="string">'el'</span>, <span class="string">'id'</span>, <span class="string">'attributes'</span>, <span class="string">'className'</span>, <span class="string">'tagName'</span>, <span class="string">'events'</span>];</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-123">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-123">&#182;</a>
+              </div>
+              <p>Set up all inheritable <strong>Backbone.View</strong> properties and methods.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  _.extend(View.prototype, Events, {</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-124">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-124">&#182;</a>
+              </div>
+              <p>The default <code>tagName</code> of a View&#39;s element is <code>&quot;div&quot;</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    tagName: <span class="string">'div'</span>,</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-125">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-125">&#182;</a>
+              </div>
+              <p>jQuery delegate for element lookup, scoped to DOM elements within the
+current view. This should be prefered to global lookups where possible.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    $: <span class="keyword">function</span>(selector) {
+      <span class="keyword">return</span> <span class="keyword">this</span>.$el.find(selector);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-126">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-126">&#182;</a>
+              </div>
+              <p>Initialize is an empty function by default. Override it with your own
+initialization logic.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    initialize: <span class="keyword">function</span>(){},</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-127">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-127">&#182;</a>
+              </div>
+              <p><strong>render</strong> is the core function that your view should override, in order
 to populate its element (<code>this.el</code>), with the appropriate HTML. The
-convention is for <strong>render</strong> to always return <code>this</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-167">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-167">&#182;</a>               </div>               <p>Remove this view by taking the element out of the DOM, and removing any
-applicable Backbone.Events listeners.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">remove</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">stopListening</span><span class="p">();</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-168">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-168">&#182;</a>               </div>               <p>Change the view's element (<code>this.el</code> property), including event
-re-delegation.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">setElement</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">delegate</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">undelegateEvents</span><span class="p">();</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">$el</span> <span class="o">=</span> <span class="nx">element</span> <span class="k">instanceof</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">$</span> <span class="o">?</span> <span class="nx">element</span> <span class="o">:</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="nx">element</span><span class="p">);</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">delegate</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">delegateEvents</span><span class="p">();</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-169">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-169">&#182;</a>               </div>               <p>Set callbacks, where <code>this.events</code> is a hash of</p>
-
-<p><em>{"event selector": "callback"}</em></p>
+convention is for <strong>render</strong> to always return <code>this</code>.
+</p>
 
-<pre><code>{
-  'mousedown .title':  'edit',
-  'click .button':     'save'
-  'click .open':       function(e) { ... }
-}
-</code></pre>
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    render: <span class="keyword">function</span>() {
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-128">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-128">&#182;</a>
+              </div>
+              <p>Remove this view by taking the element out of the DOM, and removing any
+applicable Backbone.Events listeners.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    remove: <span class="keyword">function</span>() {
+      <span class="keyword">this</span>.$el.remove();
+      <span class="keyword">this</span>.stopListening();
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-129">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-129">&#182;</a>
+              </div>
+              <p>Change the view&#39;s element (<code>this.el</code> property), including event
+re-delegation.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    setElement: <span class="keyword">function</span>(element, delegate) {
+      <span class="keyword">if</span> (<span class="keyword">this</span>.$el) <span class="keyword">this</span>.undelegateEvents();
+      <span class="keyword">this</span>.$el = element <span class="keyword">instanceof</span> Backbone.$ ? element : Backbone.$(element);
+      <span class="keyword">this</span>.el = <span class="keyword">this</span>.$el[<span class="number">0</span>];
+      <span class="keyword">if</span> (delegate !== <span class="literal">false</span>) <span class="keyword">this</span>.delegateEvents();
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-130">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-130">&#182;</a>
+              </div>
+              <p>Set callbacks, where <code>this.events</code> is a hash of
 
+</p>
+<p><em>{&quot;event selector&quot;: &quot;callback&quot;}</em>
+
+</p>
+<pre><code>{
+  &#39;mousedown .title&#39;:  &#39;edit&#39;,
+  &#39;click .button&#39;:     &#39;save&#39;
+  &#39;click .open&#39;:       function(e) { ... }
+}</code></pre>
 <p>pairs. Callbacks will be bound to the view, with <code>this</code> set properly.
 Uses event delegation for efficiency.
 Omitting the selector binds the event to <code>this.el</code>.
 This only works for delegate-able events: not <code>focus</code>, <code>blur</code>, and
-not <code>change</code>, <code>submit</code>, and <code>reset</code> in Internet Explorer.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">delegateEvents</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">events</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">events</span> <span class="o">||</span> <span class="p">(</span><span class="nx">events</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">result</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;events&#39;</span><span class="p">))))</span> <span class="k">return</span><span class="p">;</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">undelegateEvents</span><span class="p">();</span>
-      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">events</span><span class="p">)</span> <span class="p">{</span>
-        <span class="kd">var</span> <span class="nx">method</span> <span class="o">=</span> <span class="nx">events</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
-        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">_</span><span class="p">.</span><span class="nx">isFunction</span><span class="p">(</span><span class="nx">method</span><span class="p">))</span> <span class="nx">method</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">events</span><span class="p">[</span><span class="nx">key</span><span class="p">]];</span>
-        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">method</span><span class="p">)</span> <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;Method &quot;&#39;</span> <span class="o">+</span> <span class="nx">events</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;&quot; does not exist&#39;</span><span class="p">);</span>
-        <span class="kd">var</span> <span class="nx">match</span> <span class="o">=</span> <span class="nx">key</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="nx">delegateEventSplitter</span><span class="p">);</span>
-        <span class="kd">var</span> <span class="nx">eventName</span> <span class="o">=</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nx">selector</span> <span class="o">=</span> <span class="nx">match</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
-        <span class="nx">method</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
-        <span class="nx">eventName</span> <span class="o">+=</span> <span class="s1">&#39;.delegateEvents&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">cid</span><span class="p">;</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">selector</span> <span class="o">===</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">{</span>
-          <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">eventName</span><span class="p">,</span> <span class="nx">method</span><span class="p">);</span>
-        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-          <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">eventName</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">method</span><span class="p">);</span>
-        <span class="p">}</span>
-      <span class="p">}</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-170">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-170">&#182;</a>               </div>               <p>Clears all callbacks previously bound to the view with <code>delegateEvents</code>.
-You usually don't need to use this, but may wish to if you have multiple
-Backbone views attached to the same DOM element.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">undelegateEvents</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">off</span><span class="p">(</span><span class="s1">&#39;.delegateEvents&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">cid</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-171">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-171">&#182;</a>               </div>               <p>Performs the initial configuration of a View with a set of options.
-Keys with special meaning <em>(model, collection, id, className)</em>, are
-attached directly to the view.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_configure</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">options</span><span class="p">)</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">_</span><span class="p">.</span><span class="nx">result</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;options&#39;</span><span class="p">),</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">pick</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="nx">viewOptions</span><span class="p">));</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="nx">options</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-172">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-172">&#182;</a>               </div>               <p>Ensure that the View has a DOM element to render into.
+not <code>change</code>, <code>submit</code>, and <code>reset</code> in Internet Explorer.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    delegateEvents: <span class="keyword">function</span>(events) {
+      <span class="keyword">if</span> (!(events || (events = _.result(<span class="keyword">this</span>, <span class="string">'events'</span>)))) <span class="keyword">return</span> <span class="keyword">this</span>;
+      <span class="keyword">this</span>.undelegateEvents();
+      <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> events) {
+        <span class="keyword">var</span> method = events[key];
+        <span class="keyword">if</span> (!_.isFunction(method)) method = <span class="keyword">this</span>[events[key]];
+        <span class="keyword">if</span> (!method) <span class="keyword">continue</span>;
+
+        <span class="keyword">var</span> match = key.match(delegateEventSplitter);
+        <span class="keyword">var</span> eventName = match[<span class="number">1</span>], selector = match[<span class="number">2</span>];
+        method = _.bind(method, <span class="keyword">this</span>);
+        eventName += <span class="string">'.delegateEvents'</span> + <span class="keyword">this</span>.cid;
+        <span class="keyword">if</span> (selector === <span class="string">''</span>) {
+          <span class="keyword">this</span>.$el.on(eventName, method);
+        } <span class="keyword">else</span> {
+          <span class="keyword">this</span>.$el.on(eventName, selector, method);
+        }
+      }
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-131">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-131">&#182;</a>
+              </div>
+              <p>Clears all callbacks previously bound to the view with <code>delegateEvents</code>.
+You usually don&#39;t need to use this, but may wish to if you have multiple
+Backbone views attached to the same DOM element.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    undelegateEvents: <span class="keyword">function</span>() {
+      <span class="keyword">this</span>.$el.off(<span class="string">'.delegateEvents'</span> + <span class="keyword">this</span>.cid);
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-132">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-132">&#182;</a>
+              </div>
+              <p>Performs the initial configuration of a View with a set of options.
+Keys with special meaning <em>(e.g. model, collection, id, className)</em> are
+attached directly to the view.  See <code>viewOptions</code> for an exhaustive
+list.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    _configure: <span class="keyword">function</span>(options) {
+      <span class="keyword">if</span> (<span class="keyword">this</span>.options) options = _.extend({}, _.result(<span class="keyword">this</span>, <span class="string">'options'</span>), options);
+      _.extend(<span class="keyword">this</span>, _.pick(options, viewOptions));
+      <span class="keyword">this</span>.options = options;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-133">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-133">&#182;</a>
+              </div>
+              <p>Ensure that the View has a DOM element to render into.
 If <code>this.el</code> is a string, pass it through <code>$()</code>, take the first
 matching element, and re-assign it to <code>el</code>. Otherwise, create
-an element from the <code>id</code>, <code>className</code> and <code>tagName</code> properties.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_ensureElement</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
-        <span class="kd">var</span> <span class="nx">attrs</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">({},</span> <span class="nx">_</span><span class="p">.</span><span class="nx">result</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;attributes&#39;</span><span class="p">));</span>
-        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="nx">attrs</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">result</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">);</span>
-        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">className</span><span class="p">)</span> <span class="nx">attrs</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">result</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;className&#39;</span><span class="p">);</span>
-        <span class="kd">var</span> <span class="nx">$el</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="nx">_</span><span class="p">.</span><span class="nx">result</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;tagName&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="nx">attrs</span><span class="p">);</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">setElement</span><span class="p">(</span><span class="nx">$el</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
-      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">setElement</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">result</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s1">&#39;el&#39;</span><span class="p">),</span> <span class="kc">false</span><span class="p">);</span>
-      <span class="p">}</span>
-    <span class="p">}</span>
-
-  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-173">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-173">&#182;</a>               </div>               <h2>Backbone.sync</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-174">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-174">&#182;</a>               </div>               <p>Map from CRUD to HTTP for our default <code>Backbone.sync</code> implementation.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">methodMap</span> <span class="o">=</span> <span class="p">{</span>
-    <span class="s1">&#39;create&#39;</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
-    <span class="s1">&#39;update&#39;</span><span class="o">:</span> <span class="s1">&#39;PUT&#39;</span><span class="p">,</span>
-    <span class="s1">&#39;patch&#39;</span><span class="o">:</span>  <span class="s1">&#39;PATCH&#39;</span><span class="p">,</span>
-    <span class="s1">&#39;delete&#39;</span><span class="o">:</span> <span class="s1">&#39;DELETE&#39;</span><span class="p">,</span>
-    <span class="s1">&#39;read&#39;</span><span class="o">:</span>   <span class="s1">&#39;GET&#39;</span>
-  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-175">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-175">&#182;</a>               </div>               <p>Override this function to change the manner in which Backbone persists
+an element from the <code>id</code>, <code>className</code> and <code>tagName</code> properties.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    _ensureElement: <span class="keyword">function</span>() {
+      <span class="keyword">if</span> (!<span class="keyword">this</span>.el) {
+        <span class="keyword">var</span> attrs = _.extend({}, _.result(<span class="keyword">this</span>, <span class="string">'attributes'</span>));
+        <span class="keyword">if</span> (<span class="keyword">this</span>.id) attrs.id = _.result(<span class="keyword">this</span>, <span class="string">'id'</span>);
+        <span class="keyword">if</span> (<span class="keyword">this</span>.className) attrs[<span class="string">'class'</span>] = _.result(<span class="keyword">this</span>, <span class="string">'className'</span>);
+        <span class="keyword">var</span> $el = Backbone.$(<span class="string">'&lt;'</span> + _.result(<span class="keyword">this</span>, <span class="string">'tagName'</span>) + <span class="string">'&gt;'</span>).attr(attrs);
+        <span class="keyword">this</span>.setElement($el, <span class="literal">false</span>);
+      } <span class="keyword">else</span> {
+        <span class="keyword">this</span>.setElement(_.result(<span class="keyword">this</span>, <span class="string">'el'</span>), <span class="literal">false</span>);
+      }
+    }
+
+  });</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-134">
+            <div class="annotation">
+              
+              <div class="pilwrap for-h2">
+                <a class="pilcrow" href="#section-134">&#182;</a>
+              </div>
+              <h2>Backbone.sync</h2>
+
+            </div>
+            
+        </li>
+        
+        
+        <li id="section-135">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-135">&#182;</a>
+              </div>
+              <p>Override this function to change the manner in which Backbone persists
 models to the server. You will be passed the type of request, and the
 model in question. By default, makes a RESTful Ajax request
-to the model's <code>url()</code>. Some possible customizations could be:</p>
+to the model&#39;s <code>url()</code>. Some possible customizations could be:
 
+</p>
 <ul>
 <li>Use <code>setTimeout</code> to batch rapid-fire updates into a single request.</li>
 <li>Send up the models as XML instead of JSON.</li>
 <li>Persist models via WebSockets instead of Ajax.</li>
 </ul>
-
 <p>Turn on <code>Backbone.emulateHTTP</code> in order to send <code>PUT</code> and <code>DELETE</code> requests
 as <code>POST</code>, with a <code>_method</code> parameter containing the true HTTP method,
 as well as all requests with the body as <code>application/x-www-form-urlencoded</code>
 instead of <code>application/json</code> with the model in a param named <code>model</code>.
 Useful when interfacing with server-side languages like <strong>PHP</strong> that make
-it difficult to read the body of <code>PUT</code> requests.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Backbone</span><span class="p">.</span><span class="nx">sync</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">method</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
-    <span class="kd">var</span> <span class="nx">type</span> <span class="o">=</span> <span class="nx">methodMap</span><span class="p">[</span><span class="nx">method</span><span class="p">];</span></pre></div>             </td>           </tr>                               <tr id="section-176">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-176">&#182;</a>               </div>               <p>Default options, unless specified.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_</span><span class="p">.</span><span class="nx">defaults</span><span class="p">(</span><span class="nx">options</span> <span class="o">||</span> <span class="p">(</span><span class="nx">options</span> <span class="o">=</span> <span class="p">{}),</span> <span class="p">{</span>
-      <span class="nx">emulateHTTP</span><span class="o">:</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">emulateHTTP</span><span class="p">,</span>
-      <span class="nx">emulateJSON</span><span class="o">:</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">emulateJSON</span>
-    <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-177">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-177">&#182;</a>               </div>               <p>Default JSON-request options.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span><span class="nx">type</span><span class="o">:</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">dataType</span><span class="o">:</span> <span class="s1">&#39;json&#39;</span><span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-178">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-178">&#182;</a>               </div>               <p>Ensure that we have a URL.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">params</span><span class="p">.</span><span class="nx">url</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">result</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="nx">urlError</span><span class="p">();</span>
-    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-179">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-179">&#182;</a>               </div>               <p>Ensure that we have the appropriate request data.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">data</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">model</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">method</span> <span class="o">===</span> <span class="s1">&#39;create&#39;</span> <span class="o">||</span> <span class="nx">method</span> <span class="o">===</span> <span class="s1">&#39;update&#39;</span> <span class="o">||</span> <span class="nx">method</span> <span class="o">===</span> <span class="s1">&#39;patch&#39;</span><span class="p">))</span> <span class="p">{</span>
-      <span class="nx">params</span><span class="p">.</span><span class="nx">contentType</span> <span class="o">=</span> <span class="s1">&#39;application/json&#39;</span><span class="p">;</span>
-      <span class="nx">params</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">attrs</span> <span class="o">||</span> <span class="nx">model</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">(</span><span class="nx">options</span><span class="p">));</span>
-    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-180">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-180">&#182;</a>               </div>               <p>For older servers, emulate JSON by encoding the request into an HTML-form.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">emulateJSON</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">params</span><span class="p">.</span><span class="nx">contentType</span> <span class="o">=</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">;</span>
-      <span class="nx">params</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">params</span><span class="p">.</span><span class="nx">data</span> <span class="o">?</span> <span class="p">{</span><span class="nx">model</span><span class="o">:</span> <span class="nx">params</span><span class="p">.</span><span class="nx">data</span><span class="p">}</span> <span class="o">:</span> <span class="p">{};</span>
-    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-181">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-181">&#182;</a>               </div>               <p>For older servers, emulate HTTP by mimicking the HTTP method with <code>_method</code>
-And an <code>X-HTTP-Method-Override</code> header.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">emulateHTTP</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;PUT&#39;</span> <span class="o">||</span> <span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;DELETE&#39;</span> <span class="o">||</span> <span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;PATCH&#39;</span><span class="p">))</span> <span class="p">{</span>
-      <span class="nx">params</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;POST&#39;</span><span class="p">;</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">emulateJSON</span><span class="p">)</span> <span class="nx">params</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">_method</span> <span class="o">=</span> <span class="nx">type</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">beforeSend</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">beforeSend</span><span class="p">;</span>
-      <span class="nx">options</span><span class="p">.</span><span class="nx">beforeSend</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>
-        <span class="nx">xhr</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="s1">&#39;X-HTTP-Method-Override&#39;</span><span class="p">,</span> <span class="nx">type</span><span class="p">);</span>
-        <span class="k">if</span> <span class="p">(</span><span class="nx">beforeSend</span><span class="p">)</span> <span class="k">return</span> <span class="nx">beforeSend</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
-      <span class="p">};</span>
-    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-182">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-182">&#182;</a>               </div>               <p>Don't process data on a non-GET request.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">params</span><span class="p">.</span><span class="nx">type</span> <span class="o">!==</span> <span class="s1">&#39;GET&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">emulateJSON</span><span class="p">)</span> <span class="p">{</span>
-      <span class="nx">params</span><span class="p">.</span><span class="nx">processData</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
-    <span class="p">}</span>
-
-    <span class="kd">var</span> <span class="nx">success</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">success</span><span class="p">;</span>
-    <span class="nx">options</span><span class="p">.</span><span class="nx">success</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">success</span><span class="p">)</span> <span class="nx">success</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="nx">model</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;sync&#39;</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">resp</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-    <span class="p">};</span>
-
-    <span class="kd">var</span> <span class="nx">error</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">error</span><span class="p">;</span>
-    <span class="nx">options</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="nx">error</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-      <span class="nx">model</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-183">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-183">&#182;</a>               </div>               <p>Make the request, allowing the user to override any Ajax options.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">xhr</span> <span class="o">=</span> <span class="nx">options</span><span class="p">.</span><span class="nx">xhr</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">ajax</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="nx">options</span><span class="p">));</span>
-    <span class="nx">model</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">,</span> <span class="nx">model</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
-    <span class="k">return</span> <span class="nx">xhr</span><span class="p">;</span>
-  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-184">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-184">&#182;</a>               </div>               <p>Set the default implementation of <code>Backbone.ajax</code> to proxy through to <code>$</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Backbone</span><span class="p">.</span><span class="nx">ajax</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-    <span class="k">return</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">Backbone</span><span class="p">.</span><span class="nx">$</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
-  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-185">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-185">&#182;</a>               </div>               <h2>Helpers</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-186">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-186">&#182;</a>               </div>               <p>Helper function to correctly set up the prototype chain, for subclasses.
+it difficult to read the body of <code>PUT</code> requests.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  Backbone.sync = <span class="keyword">function</span>(method, model, options) {
+    <span class="keyword">var</span> type = methodMap[method];</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-136">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-136">&#182;</a>
+              </div>
+              <p>Default options, unless specified.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    _.defaults(options || (options = {}), {
+      emulateHTTP: Backbone.emulateHTTP,
+      emulateJSON: Backbone.emulateJSON
+    });</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-137">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-137">&#182;</a>
+              </div>
+              <p>Default JSON-request options.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> params = {type: type, dataType: <span class="string">'json'</span>};</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-138">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-138">&#182;</a>
+              </div>
+              <p>Ensure that we have a URL.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (!options.url) {
+      params.url = _.result(model, <span class="string">'url'</span>) || urlError();
+    }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-139">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-139">&#182;</a>
+              </div>
+              <p>Ensure that we have the appropriate request data.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (options.data == <span class="literal">null</span> &amp;&amp; model &amp;&amp; (method === <span class="string">'create'</span> || method === <span class="string">'update'</span> || method === <span class="string">'patch'</span>)) {
+      params.contentType = <span class="string">'application/json'</span>;
+      params.data = JSON.stringify(options.attrs || model.toJSON(options));
+    }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-140">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-140">&#182;</a>
+              </div>
+              <p>For older servers, emulate JSON by encoding the request into an HTML-form.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (options.emulateJSON) {
+      params.contentType = <span class="string">'application/x-www-form-urlencoded'</span>;
+      params.data = params.data ? {model: params.data} : {};
+    }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-141">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-141">&#182;</a>
+              </div>
+              <p>For older servers, emulate HTTP by mimicking the HTTP method with <code>_method</code>
+And an <code>X-HTTP-Method-Override</code> header.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (options.emulateHTTP &amp;&amp; (type === <span class="string">'PUT'</span> || type === <span class="string">'DELETE'</span> || type === <span class="string">'PATCH'</span>)) {
+      params.type = <span class="string">'POST'</span>;
+      <span class="keyword">if</span> (options.emulateJSON) params.data._method = type;
+      <span class="keyword">var</span> beforeSend = options.beforeSend;
+      options.beforeSend = <span class="keyword">function</span>(xhr) {
+        xhr.setRequestHeader(<span class="string">'X-HTTP-Method-Override'</span>, type);
+        <span class="keyword">if</span> (beforeSend) <span class="keyword">return</span> beforeSend.apply(<span class="keyword">this</span>, arguments);
+      };
+    }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-142">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-142">&#182;</a>
+              </div>
+              <p>Don&#39;t process data on a non-GET request.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (params.type !== <span class="string">'GET'</span> &amp;&amp; !options.emulateJSON) {
+      params.processData = <span class="literal">false</span>;
+    }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-143">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-143">&#182;</a>
+              </div>
+              <p>If we&#39;re sending a <code>PATCH</code> request, and we&#39;re in an old Internet Explorer
+that still has ActiveX enabled by default, override jQuery to use that
+for XHR instead. Remove this line when jQuery supports <code>PATCH</code> on IE8.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (params.type === <span class="string">'PATCH'</span> &amp;&amp; window.ActiveXObject &amp;&amp;
+          !(window.external &amp;&amp; window.external.msActiveXFilteringEnabled)) {
+      params.xhr = <span class="keyword">function</span>() {
+        <span class="keyword">return</span> <span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);
+      };
+    }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-144">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-144">&#182;</a>
+              </div>
+              <p>Make the request, allowing the user to override any Ajax options.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> xhr = options.xhr = Backbone.ajax(_.extend(params, options));
+    model.trigger(<span class="string">'request'</span>, model, xhr, options);
+    <span class="keyword">return</span> xhr;
+  };</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-145">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-145">&#182;</a>
+              </div>
+              <p>Map from CRUD to HTTP for our default <code>Backbone.sync</code> implementation.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> methodMap = {
+    <span class="string">'create'</span>: <span class="string">'POST'</span>,
+    <span class="string">'update'</span>: <span class="string">'PUT'</span>,
+    <span class="string">'patch'</span>:  <span class="string">'PATCH'</span>,
+    <span class="string">'delete'</span>: <span class="string">'DELETE'</span>,
+    <span class="string">'read'</span>:   <span class="string">'GET'</span>
+  };</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-146">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-146">&#182;</a>
+              </div>
+              <p>Set the default implementation of <code>Backbone.ajax</code> to proxy through to <code>$</code>.
+Override this if you&#39;d like to use a different library.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  Backbone.ajax = <span class="keyword">function</span>() {
+    <span class="keyword">return</span> Backbone.$.ajax.apply(Backbone.$, arguments);
+  };</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-147">
+            <div class="annotation">
+              
+              <div class="pilwrap for-h2">
+                <a class="pilcrow" href="#section-147">&#182;</a>
+              </div>
+              <h2>Backbone.Router</h2>
+
+            </div>
+            
+        </li>
+        
+        
+        <li id="section-148">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-148">&#182;</a>
+              </div>
+              <p>Routers map faux-URLs to actions, and fire events when routes are
+matched. Creating a new one sets its <code>routes</code> hash, if not set statically.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> Router = Backbone.Router = <span class="keyword">function</span>(options) {
+    options || (options = {});
+    <span class="keyword">if</span> (options.routes) <span class="keyword">this</span>.routes = options.routes;
+    <span class="keyword">this</span>._bindRoutes();
+    <span class="keyword">this</span>.initialize.apply(<span class="keyword">this</span>, arguments);
+  };</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-149">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-149">&#182;</a>
+              </div>
+              <p>Cached regular expressions for matching named param parts and splatted
+parts of route strings.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> optionalParam = <span class="regexp">/\((.*?)\)/g</span>;
+  <span class="keyword">var</span> namedParam    = <span class="regexp">/(\(\?)?:\w+/g</span>;
+  <span class="keyword">var</span> splatParam    = <span class="regexp">/\*\w+/g</span>;
+  <span class="keyword">var</span> escapeRegExp  = <span class="regexp">/[\-{}\[\]+?.,\\\^$|#\s]/g</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-150">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-150">&#182;</a>
+              </div>
+              <p>Set up all inheritable <strong>Backbone.Router</strong> properties and methods.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  _.extend(Router.prototype, Events, {</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-151">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-151">&#182;</a>
+              </div>
+              <p>Initialize is an empty function by default. Override it with your own
+initialization logic.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    initialize: <span class="keyword">function</span>(){},</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-152">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-152">&#182;</a>
+              </div>
+              <p>Manually bind a single named route to a callback. For example:
+
+</p>
+<pre><code>this.route(&#39;search/:query/p:num&#39;, &#39;search&#39;, function(query, num) {
+  ...
+});</code></pre>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    route: <span class="keyword">function</span>(route, name, callback) {
+      <span class="keyword">if</span> (!_.isRegExp(route)) route = <span class="keyword">this</span>._routeToRegExp(route);
+      <span class="keyword">if</span> (_.isFunction(name)) {
+        callback = name;
+        name = <span class="string">''</span>;
+      }
+      <span class="keyword">if</span> (!callback) callback = <span class="keyword">this</span>[name];
+      <span class="keyword">var</span> router = <span class="keyword">this</span>;
+      Backbone.history.route(route, <span class="keyword">function</span>(fragment) {
+        <span class="keyword">var</span> args = router._extractParameters(route, fragment);
+        callback &amp;&amp; callback.apply(router, args);
+        router.trigger.apply(router, [<span class="string">'route:'</span> + name].concat(args));
+        router.trigger(<span class="string">'route'</span>, name, args);
+        Backbone.history.trigger(<span class="string">'route'</span>, router, name, args);
+      });
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-153">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-153">&#182;</a>
+              </div>
+              <p>Simple proxy to <code>Backbone.history</code> to save a fragment into the history.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    navigate: <span class="keyword">function</span>(fragment, options) {
+      Backbone.history.navigate(fragment, options);
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-154">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-154">&#182;</a>
+              </div>
+              <p>Bind all defined routes to <code>Backbone.history</code>. We have to reverse the
+order of the routes here to support behavior where the most general
+routes can be defined at the bottom of the route map.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    _bindRoutes: <span class="keyword">function</span>() {
+      <span class="keyword">if</span> (!<span class="keyword">this</span>.routes) <span class="keyword">return</span>;
+      <span class="keyword">this</span>.routes = _.result(<span class="keyword">this</span>, <span class="string">'routes'</span>);
+      <span class="keyword">var</span> route, routes = _.keys(<span class="keyword">this</span>.routes);
+      <span class="keyword">while</span> ((route = routes.pop()) != <span class="literal">null</span>) {
+        <span class="keyword">this</span>.route(route, <span class="keyword">this</span>.routes[route]);
+      }
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-155">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-155">&#182;</a>
+              </div>
+              <p>Convert a route string into a regular expression, suitable for matching
+against the current location hash.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    _routeToRegExp: <span class="keyword">function</span>(route) {
+      route = route.replace(escapeRegExp, <span class="string">'\\$&amp;'</span>)
+                   .replace(optionalParam, <span class="string">'(?:$1)?'</span>)
+                   .replace(namedParam, <span class="keyword">function</span>(match, optional){
+                     <span class="keyword">return</span> optional ? match : <span class="string">'([^\/]+)'</span>;
+                   })
+                   .replace(splatParam, <span class="string">'(.*?)'</span>);
+      <span class="keyword">return</span> <span class="keyword">new</span> RegExp(<span class="string">'^'</span> + route + <span class="string">'$'</span>);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-156">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-156">&#182;</a>
+              </div>
+              <p>Given a route, and a URL fragment that it matches, return the array of
+extracted decoded parameters. Empty or unmatched parameters will be
+treated as <code>null</code> to normalize cross-browser behavior.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    _extractParameters: <span class="keyword">function</span>(route, fragment) {
+      <span class="keyword">var</span> params = route.exec(fragment).slice(<span class="number">1</span>);
+      <span class="keyword">return</span> _.map(params, <span class="keyword">function</span>(param) {
+        <span class="keyword">return</span> param ? decodeURIComponent(param) : <span class="literal">null</span>;
+      });
+    }
+
+  });</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-157">
+            <div class="annotation">
+              
+              <div class="pilwrap for-h2">
+                <a class="pilcrow" href="#section-157">&#182;</a>
+              </div>
+              <h2>Backbone.History</h2>
+
+            </div>
+            
+        </li>
+        
+        
+        <li id="section-158">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-158">&#182;</a>
+              </div>
+              <p>Handles cross-browser history management, based on either
+<a href="http://diveintohtml5.info/history.html">pushState</a> and real URLs, or
+<a href="https://developer.mozilla.org/en-US/docs/DOM/window.onhashchange">onhashchange</a>
+and URL fragments. If the browser supports neither (old IE, natch),
+falls back to polling.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> History = Backbone.History = <span class="keyword">function</span>() {
+    <span class="keyword">this</span>.handlers = [];
+    _.bindAll(<span class="keyword">this</span>, <span class="string">'checkUrl'</span>);</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-159">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-159">&#182;</a>
+              </div>
+              <p>Ensure that <code>History</code> can be used outside of the browser.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (<span class="keyword">typeof</span> window !== <span class="string">'undefined'</span>) {
+      <span class="keyword">this</span>.location = window.location;
+      <span class="keyword">this</span>.history = window.history;
+    }
+  };</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-160">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-160">&#182;</a>
+              </div>
+              <p>Cached regex for stripping a leading hash/slash and trailing space.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> routeStripper = <span class="regexp">/^[#\/]|\s+$/g</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-161">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-161">&#182;</a>
+              </div>
+              <p>Cached regex for stripping leading and trailing slashes.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> rootStripper = <span class="regexp">/^\/+|\/+$/g</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-162">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-162">&#182;</a>
+              </div>
+              <p>Cached regex for detecting MSIE.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> isExplorer = <span class="regexp">/msie [\w.]+/</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-163">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-163">&#182;</a>
+              </div>
+              <p>Cached regex for removing a trailing slash.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> trailingSlash = <span class="regexp">/\/$/</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-164">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-164">&#182;</a>
+              </div>
+              <p>Has the history handling already been started?
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  History.started = <span class="literal">false</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-165">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-165">&#182;</a>
+              </div>
+              <p>Set up all inheritable <strong>Backbone.History</strong> properties and methods.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  _.extend(History.prototype, Events, {</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-166">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-166">&#182;</a>
+              </div>
+              <p>The default interval to poll for hash changes, if necessary, is
+twenty times a second.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    interval: <span class="number">50</span>,</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-167">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-167">&#182;</a>
+              </div>
+              <p>Gets the true hash value. Cannot use location.hash directly due to bug
+in Firefox where location.hash will always be decoded.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    getHash: <span class="keyword">function</span>(window) {
+      <span class="keyword">var</span> match = (window || <span class="keyword">this</span>).location.href.match(<span class="regexp">/#(.*)$/</span>);
+      <span class="keyword">return</span> match ? match[<span class="number">1</span>] : <span class="string">''</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-168">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-168">&#182;</a>
+              </div>
+              <p>Get the cross-browser normalized URL fragment, either from the URL,
+the hash, or the override.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    getFragment: <span class="keyword">function</span>(fragment, forcePushState) {
+      <span class="keyword">if</span> (fragment == <span class="literal">null</span>) {
+        <span class="keyword">if</span> (<span class="keyword">this</span>._hasPushState || !<span class="keyword">this</span>._wantsHashChange || forcePushState) {
+          fragment = <span class="keyword">this</span>.location.pathname;
+          <span class="keyword">var</span> root = <span class="keyword">this</span>.root.replace(trailingSlash, <span class="string">''</span>);
+          <span class="keyword">if</span> (!fragment.indexOf(root)) fragment = fragment.substr(root.length);
+        } <span class="keyword">else</span> {
+          fragment = <span class="keyword">this</span>.getHash();
+        }
+      }
+      <span class="keyword">return</span> fragment.replace(routeStripper, <span class="string">''</span>);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-169">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-169">&#182;</a>
+              </div>
+              <p>Start the hash change handling, returning <code>true</code> if the current URL matches
+an existing route, and <code>false</code> otherwise.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    start: <span class="keyword">function</span>(options) {
+      <span class="keyword">if</span> (History.started) <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">"Backbone.history has already been started"</span>);
+      History.started = <span class="literal">true</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-170">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-170">&#182;</a>
+              </div>
+              <p>Figure out the initial configuration. Do we need an iframe?
+Is pushState desired ... is it available?
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.options          = _.extend({}, {root: <span class="string">'/'</span>}, <span class="keyword">this</span>.options, options);
+      <span class="keyword">this</span>.root             = <span class="keyword">this</span>.options.root;
+      <span class="keyword">this</span>._wantsHashChange = <span class="keyword">this</span>.options.hashChange !== <span class="literal">false</span>;
+      <span class="keyword">this</span>._wantsPushState  = !!<span class="keyword">this</span>.options.pushState;
+      <span class="keyword">this</span>._hasPushState    = !!(<span class="keyword">this</span>.options.pushState &amp;&amp; <span class="keyword">this</span>.history &amp;&amp; <span class="keyword">this</span>.history.pushState);
+      <span class="keyword">var</span> fragment          = <span class="keyword">this</span>.getFragment();
+      <span class="keyword">var</span> docMode           = document.documentMode;
+      <span class="keyword">var</span> oldIE             = (isExplorer.exec(navigator.userAgent.toLowerCase()) &amp;&amp; (!docMode || docMode &lt;= <span class="number">7</span>));</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-171">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-171">&#182;</a>
+              </div>
+              <p>Normalize root to always include a leading and trailing slash.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.root = (<span class="string">'/'</span> + <span class="keyword">this</span>.root + <span class="string">'/'</span>).replace(rootStripper, <span class="string">'/'</span>);
+
+      <span class="keyword">if</span> (oldIE &amp;&amp; <span class="keyword">this</span>._wantsHashChange) {
+        <span class="keyword">this</span>.iframe = Backbone.$(<span class="string">'&lt;iframe src="javascript:0" tabindex="-1" /&gt;'</span>).hide().appendTo(<span class="string">'body'</span>)[<span class="number">0</span>].contentWindow;
+        <span class="keyword">this</span>.navigate(fragment);
+      }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-172">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-172">&#182;</a>
+              </div>
+              <p>Depending on whether we&#39;re using pushState or hashes, and whether
+&#39;onhashchange&#39; is supported, determine how we check the URL state.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (<span class="keyword">this</span>._hasPushState) {
+        Backbone.$(window).on(<span class="string">'popstate'</span>, <span class="keyword">this</span>.checkUrl);
+      } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>._wantsHashChange &amp;&amp; (<span class="string">'onhashchange'</span> <span class="keyword">in</span> window) &amp;&amp; !oldIE) {
+        Backbone.$(window).on(<span class="string">'hashchange'</span>, <span class="keyword">this</span>.checkUrl);
+      } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>._wantsHashChange) {
+        <span class="keyword">this</span>._checkUrlInterval = setInterval(<span class="keyword">this</span>.checkUrl, <span class="keyword">this</span>.interval);
+      }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-173">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-173">&#182;</a>
+              </div>
+              <p>Determine if we need to change the base url, for a pushState link
+opened by a non-pushState browser.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">this</span>.fragment = fragment;
+      <span class="keyword">var</span> loc = <span class="keyword">this</span>.location;
+      <span class="keyword">var</span> atRoot = loc.pathname.replace(<span class="regexp">/[^\/]$/</span>, <span class="string">'$&amp;/'</span>) === <span class="keyword">this</span>.root;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-174">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-174">&#182;</a>
+              </div>
+              <p>If we&#39;ve started off with a route from a <code>pushState</code>-enabled browser,
+but we&#39;re currently in a browser that doesn&#39;t support it...
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (<span class="keyword">this</span>._wantsHashChange &amp;&amp; <span class="keyword">this</span>._wantsPushState &amp;&amp; !<span class="keyword">this</span>._hasPushState &amp;&amp; !atRoot) {
+        <span class="keyword">this</span>.fragment = <span class="keyword">this</span>.getFragment(<span class="literal">null</span>, <span class="literal">true</span>);
+        <span class="keyword">this</span>.location.replace(<span class="keyword">this</span>.root + <span class="keyword">this</span>.location.search + <span class="string">'#'</span> + <span class="keyword">this</span>.fragment);</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-175">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-175">&#182;</a>
+              </div>
+              <p>Return immediately as browser will do redirect to new url
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>        <span class="keyword">return</span> <span class="literal">true</span>;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-176">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-176">&#182;</a>
+              </div>
+              <p>Or if we&#39;ve started out with a hash-based route, but we&#39;re currently
+in a browser where it could be <code>pushState</code>-based instead...
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>._wantsPushState &amp;&amp; <span class="keyword">this</span>._hasPushState &amp;&amp; atRoot &amp;&amp; loc.hash) {
+        <span class="keyword">this</span>.fragment = <span class="keyword">this</span>.getHash().replace(routeStripper, <span class="string">''</span>);
+        <span class="keyword">this</span>.history.replaceState({}, document.title, <span class="keyword">this</span>.root + <span class="keyword">this</span>.fragment + loc.search);
+      }
+
+      <span class="keyword">if</span> (!<span class="keyword">this</span>.options.silent) <span class="keyword">return</span> <span class="keyword">this</span>.loadUrl();
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-177">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-177">&#182;</a>
+              </div>
+              <p>Disable Backbone.history, perhaps temporarily. Not useful in a real app,
+but possibly useful for unit testing Routers.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    stop: <span class="keyword">function</span>() {
+      Backbone.$(window).off(<span class="string">'popstate'</span>, <span class="keyword">this</span>.checkUrl).off(<span class="string">'hashchange'</span>, <span class="keyword">this</span>.checkUrl);
+      clearInterval(<span class="keyword">this</span>._checkUrlInterval);
+      History.started = <span class="literal">false</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-178">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-178">&#182;</a>
+              </div>
+              <p>Add a route to be tested when the fragment changes. Routes added later
+may override previous routes.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    route: <span class="keyword">function</span>(route, callback) {
+      <span class="keyword">this</span>.handlers.unshift({route: route, callback: callback});
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-179">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-179">&#182;</a>
+              </div>
+              <p>Checks the current URL to see if it has changed, and if it has,
+calls <code>loadUrl</code>, normalizing across the hidden iframe.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    checkUrl: <span class="keyword">function</span>(e) {
+      <span class="keyword">var</span> current = <span class="keyword">this</span>.getFragment();
+      <span class="keyword">if</span> (current === <span class="keyword">this</span>.fragment &amp;&amp; <span class="keyword">this</span>.iframe) {
+        current = <span class="keyword">this</span>.getFragment(<span class="keyword">this</span>.getHash(<span class="keyword">this</span>.iframe));
+      }
+      <span class="keyword">if</span> (current === <span class="keyword">this</span>.fragment) <span class="keyword">return</span> <span class="literal">false</span>;
+      <span class="keyword">if</span> (<span class="keyword">this</span>.iframe) <span class="keyword">this</span>.navigate(current);
+      <span class="keyword">this</span>.loadUrl() || <span class="keyword">this</span>.loadUrl(<span class="keyword">this</span>.getHash());
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-180">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-180">&#182;</a>
+              </div>
+              <p>Attempt to load the current URL fragment. If a route succeeds with a
+match, returns <code>true</code>. If no defined routes matches the fragment,
+returns <code>false</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    loadUrl: <span class="keyword">function</span>(fragmentOverride) {
+      <span class="keyword">var</span> fragment = <span class="keyword">this</span>.fragment = <span class="keyword">this</span>.getFragment(fragmentOverride);
+      <span class="keyword">var</span> matched = _.any(<span class="keyword">this</span>.handlers, <span class="keyword">function</span>(handler) {
+        <span class="keyword">if</span> (handler.route.test(fragment)) {
+          handler.callback(fragment);
+          <span class="keyword">return</span> <span class="literal">true</span>;
+        }
+      });
+      <span class="keyword">return</span> matched;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-181">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-181">&#182;</a>
+              </div>
+              <p>Save a fragment into the hash history, or replace the URL state if the
+&#39;replace&#39; option is passed. You are responsible for properly URL-encoding
+the fragment in advance.
+
+</p>
+<p>The options object can contain <code>trigger: true</code> if you wish to have the
+route callback be fired (not usually desirable), or <code>replace: true</code>, if
+you wish to modify the current URL without adding an entry to the history.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    navigate: <span class="keyword">function</span>(fragment, options) {
+      <span class="keyword">if</span> (!History.started) <span class="keyword">return</span> <span class="literal">false</span>;
+      <span class="keyword">if</span> (!options || options === <span class="literal">true</span>) options = {trigger: options};
+      fragment = <span class="keyword">this</span>.getFragment(fragment || <span class="string">''</span>);
+      <span class="keyword">if</span> (<span class="keyword">this</span>.fragment === fragment) <span class="keyword">return</span>;
+      <span class="keyword">this</span>.fragment = fragment;
+      <span class="keyword">var</span> url = <span class="keyword">this</span>.root + fragment;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-182">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-182">&#182;</a>
+              </div>
+              <p>If pushState is available, we use it to set the fragment as a real URL.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      <span class="keyword">if</span> (<span class="keyword">this</span>._hasPushState) {
+        <span class="keyword">this</span>.history[options.replace ? <span class="string">'replaceState'</span> : <span class="string">'pushState'</span>]({}, document.title, url);</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-183">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-183">&#182;</a>
+              </div>
+              <p>If hash changes haven&#39;t been explicitly disabled, update the hash
+fragment to store history.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>._wantsHashChange) {
+        <span class="keyword">this</span>._updateHash(<span class="keyword">this</span>.location, fragment, options.replace);
+        <span class="keyword">if</span> (<span class="keyword">this</span>.iframe &amp;&amp; (fragment !== <span class="keyword">this</span>.getFragment(<span class="keyword">this</span>.getHash(<span class="keyword">this</span>.iframe)))) {</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-184">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-184">&#182;</a>
+              </div>
+              <p>Opening and closing the iframe tricks IE7 and earlier to push a
+history entry on hash-tag change.  When replace is true, we don&#39;t
+want this.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>          <span class="keyword">if</span>(!options.replace) <span class="keyword">this</span>.iframe.document.open().close();
+          <span class="keyword">this</span>._updateHash(<span class="keyword">this</span>.iframe.location, fragment, options.replace);
+        }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-185">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-185">&#182;</a>
+              </div>
+              <p>If you&#39;ve told us that you explicitly don&#39;t want fallback hashchange-
+based history, then <code>navigate</code> becomes a page refresh.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      } <span class="keyword">else</span> {
+        <span class="keyword">return</span> <span class="keyword">this</span>.location.assign(url);
+      }
+      <span class="keyword">if</span> (options.trigger) <span class="keyword">this</span>.loadUrl(fragment);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-186">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-186">&#182;</a>
+              </div>
+              <p>Update the hash location, either replacing the current entry, or adding
+a new one to the browser history.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    _updateHash: <span class="keyword">function</span>(location, fragment, replace) {
+      <span class="keyword">if</span> (replace) {
+        <span class="keyword">var</span> href = location.href.replace(<span class="regexp">/(javascript:|#).*$/</span>, <span class="string">''</span>);
+        location.replace(href + <span class="string">'#'</span> + fragment);
+      } <span class="keyword">else</span> {</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-187">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-187">&#182;</a>
+              </div>
+              <p>Some browsers require that <code>hash</code> contains a leading #.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>        location.hash = <span class="string">'#'</span> + fragment;
+      }
+    }
+
+  });</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-188">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-188">&#182;</a>
+              </div>
+              <p>Create the default Backbone.history.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  Backbone.history = <span class="keyword">new</span> History;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-189">
+            <div class="annotation">
+              
+              <div class="pilwrap for-h2">
+                <a class="pilcrow" href="#section-189">&#182;</a>
+              </div>
+              <h2>Helpers</h2>
+
+            </div>
+            
+        </li>
+        
+        
+        <li id="section-190">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-190">&#182;</a>
+              </div>
+              <p>Helper function to correctly set up the prototype chain, for subclasses.
 Similar to <code>goog.inherits</code>, but uses a hash of prototype properties and
-class properties to be extended.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">extend</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">protoProps</span><span class="p">,</span> <span class="nx">staticProps</span><span class="p">)</span> <span class="p">{</span>
-    <span class="kd">var</span> <span class="nx">parent</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
-    <span class="kd">var</span> <span class="nx">child</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-187">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-187">&#182;</a>               </div>               <p>The constructor function for the new subclass is either defined by you
-(the "constructor" property in your <code>extend</code> definition), or defaulted
-by us to simply call the parent's constructor.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">protoProps</span> <span class="o">&amp;&amp;</span> <span class="nx">_</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="nx">protoProps</span><span class="p">,</span> <span class="s1">&#39;constructor&#39;</span><span class="p">))</span> <span class="p">{</span>
-      <span class="nx">child</span> <span class="o">=</span> <span class="nx">protoProps</span><span class="p">.</span><span class="nx">constructor</span><span class="p">;</span>
-    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-      <span class="nx">child</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">return</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span> <span class="p">};</span>
-    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-188">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-188">&#182;</a>               </div>               <p>Add static properties to the constructor function, if supplied.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">child</span><span class="p">,</span> <span class="nx">parent</span><span class="p">,</span> <span class="nx">staticProps</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-189">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-189">&#182;</a>               </div>               <p>Set the prototype chain to inherit from <code>parent</code>, without calling
-<code>parent</code>'s constructor function.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">Surrogate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span> <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">child</span><span class="p">;</span> <span class="p">};</span>
-    <span class="nx">Surrogate</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
-    <span class="nx">child</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Surrogate</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-190">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-190">&#182;</a>               </div>               <p>Add prototype properties (instance properties) to the subclass,
-if supplied.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">protoProps</span><span class="p">)</span> <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">child</span><span class="p">.</span><span class="nx">prototype</span><span class="p">,</span> <span class="nx">protoProps</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-191">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-191">&#182;</a>               </div>               <p>Set a convenience property in case the parent's prototype is needed
-later.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">child</span><span class="p">.</span><span class="nx">__super__</span> <span class="o">=</span> <span class="nx">parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">;</span>
-
-    <span class="k">return</span> <span class="nx">child</span><span class="p">;</span>
-  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-192">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-192">&#182;</a>               </div>               <p>Set up inheritance for the model, collection, router, view and history.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span> <span class="o">=</span> <span class="nx">Collection</span><span class="p">.</span><span class="nx">extend</span> <span class="o">=</span> <span class="nx">Router</span><span class="p">.</span><span class="nx">extend</span> <span class="o">=</span> <span class="nx">View</span><span class="p">.</span><span class="nx">extend</span> <span class="o">=</span> <span class="nx">History</span><span class="p">.</span><span class="nx">extend</span> <span class="o">=</span> <span class="nx">extend</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-193">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-193">&#182;</a>               </div>               <p>Throw an error when a URL is needed, and none is supplied.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">urlError</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;A &quot;url&quot; property or function must be specified&#39;</span><span class="p">);</span>
-  <span class="p">};</span>
-
-<span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
-
-</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 
\ No newline at end of file
+class properties to be extended.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> extend = <span class="keyword">function</span>(protoProps, staticProps) {
+    <span class="keyword">var</span> parent = <span class="keyword">this</span>;
+    <span class="keyword">var</span> child;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-191">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-191">&#182;</a>
+              </div>
+              <p>The constructor function for the new subclass is either defined by you
+(the &quot;constructor&quot; property in your <code>extend</code> definition), or defaulted
+by us to simply call the parent&#39;s constructor.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (protoProps &amp;&amp; _.has(protoProps, <span class="string">'constructor'</span>)) {
+      child = protoProps.constructor;
+    } <span class="keyword">else</span> {
+      child = <span class="keyword">function</span>(){ <span class="keyword">return</span> parent.apply(<span class="keyword">this</span>, arguments); };
+    }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-192">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-192">&#182;</a>
+              </div>
+              <p>Add static properties to the constructor function, if supplied.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    _.extend(child, parent, staticProps);</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-193">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-193">&#182;</a>
+              </div>
+              <p>Set the prototype chain to inherit from <code>parent</code>, without calling
+<code>parent</code>&#39;s constructor function.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    <span class="keyword">var</span> Surrogate = <span class="keyword">function</span>(){ <span class="keyword">this</span>.constructor = child; };
+    Surrogate.prototype = parent.prototype;
+    child.prototype = <span class="keyword">new</span> Surrogate;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-194">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-194">&#182;</a>
+              </div>
+              <p>Add prototype properties (instance properties) to the subclass,
+if supplied.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    <span class="keyword">if</span> (protoProps) _.extend(child.prototype, protoProps);</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-195">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-195">&#182;</a>
+              </div>
+              <p>Set a convenience property in case the parent&#39;s prototype is needed
+later.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    child.__super__ = parent.prototype;
+
+    <span class="keyword">return</span> child;
+  };</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-196">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-196">&#182;</a>
+              </div>
+              <p>Set up inheritance for the model, collection, router, view and history.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  Model.extend = Collection.extend = Router.extend = View.extend = History.extend = extend;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-197">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-197">&#182;</a>
+              </div>
+              <p>Throw an error when a URL is needed, and none is supplied.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> urlError = <span class="keyword">function</span>() {
+    <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">'A "url" property or function must be specified'</span>);
+  };</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-198">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-198">&#182;</a>
+              </div>
+              <p>Wrap an optional error callback with a fallback error event.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> wrapError = <span class="function"><span class="keyword">function</span> <span class="params">(model, options)</span> {</span>
+    <span class="keyword">var</span> error = options.error;
+    options.error = <span class="keyword">function</span>(resp) {
+      <span class="keyword">if</span> (error) error(model, resp, options);
+      model.trigger(<span class="string">'error'</span>, model, resp, options);
+    };
+  };
+
+}).call(<span class="keyword">this</span>);</pre></div></div>
+            
+        </li>
+        
+    </ul>
+  </div>
+</body>
+</html></div></li>
 <li>public/components/backbone/docs/backbone.localstorage.html<div>diff --git a/public/components/backbone/docs/backbone.localstorage.html b/public/components/backbone/docs/backbone.localstorage.html
new file mode 100644
index 0000000..ed34b79
--- /dev/null
+++ b/public/components/backbone/docs/backbone.localstorage.html
@@ -0,0 +1,458 @@
+<!DOCTYPE html>
+
+<html>
+<head>
+  <title>backbone.localstorage.js</title>
+  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
+  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
+  <link rel="stylesheet" media="all" href="docco.css" />
+</head>
+<body>
+  <div id="container">
+    <div id="background"></div>
+    
+      <ul id="jump_to">
+        <li>
+          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
+          <a class="small" href="javascript:void(0);">+</a>
+          <div id="jump_wrapper">
+          <div id="jump_page">
+            
+              
+              <a class="source" href="backbone.localstorage.html">
+                backbone.localstorage.js
+              </a>
+            
+              
+              <a class="source" href="todos.html">
+                todos.js
+              </a>
+            
+          </div>
+        </li>
+      </ul>
+    
+    <ul class="sections">
+        
+          <li id="title">
+              <div class="annotation">
+                  <h1>backbone.localstorage.js</h1>
+              </div>
+          </li>
+        
+        
+        
+        <li id="section-1">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-1">&#182;</a>
+              </div>
+              
+            </div>
+            
+            <div class="content"><div class='highlight'><pre><span class="comment">/**
+ * Backbone localStorage Adapter
+ * Version 1.1.0
+ *
+ * https://github.com/jeromegn/Backbone.localStorage
+ */</span>
+(<span class="function"><span class="keyword">function</span> <span class="params">(root, factory)</span> {</span>
+   <span class="keyword">if</span> (<span class="keyword">typeof</span> define === <span class="string">"function"</span> &amp;&amp; define.amd) {</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-2">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-2">&#182;</a>
+              </div>
+              <p>AMD. Register as an anonymous module.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      define([<span class="string">"underscore"</span>,<span class="string">"backbone"</span>], <span class="keyword">function</span>(_, Backbone) {</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-3">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-3">&#182;</a>
+              </div>
+              <p>Use global variables if the locals are undefined.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>        <span class="keyword">return</span> factory(_ || root._, Backbone || root.Backbone);
+      });
+   } <span class="keyword">else</span> {</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-4">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-4">&#182;</a>
+              </div>
+              <p>RequireJS isn&#39;t being used. Assume underscore and backbone are loaded in <script> tags
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>      factory(_, Backbone);
+   }
+}(<span class="keyword">this</span>, <span class="keyword">function</span>(_, Backbone) {</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-5">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-5">&#182;</a>
+              </div>
+              <p>A simple module to replace <code>Backbone.sync</code> with <em>localStorage</em>-based
+persistence. Models are given GUIDS, and saved into a JSON object. Simple
+as that.
+
+</p>
+<p>Hold reference to Underscore.js and Backbone.js in the closure in order
+to make things work even if they are removed from the global namespace
+
+</p>
+<p>Generate four random hex digits.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre><span class="function"><span class="keyword">function</span> <span class="title">S4</span><span class="params">()</span> {</span>
+   <span class="keyword">return</span> (((<span class="number">1</span>+Math.random())*<span class="number">0x10000</span>)|<span class="number">0</span>).toString(<span class="number">16</span>).substring(<span class="number">1</span>);
+};</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-6">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-6">&#182;</a>
+              </div>
+              <p>Generate a pseudo-GUID by concatenating random hexadecimal.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre><span class="function"><span class="keyword">function</span> <span class="title">guid</span><span class="params">()</span> {</span>
+   <span class="keyword">return</span> (S4()+S4()+<span class="string">"-"</span>+S4()+<span class="string">"-"</span>+S4()+<span class="string">"-"</span>+S4()+<span class="string">"-"</span>+S4()+S4()+S4());
+};</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-7">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-7">&#182;</a>
+              </div>
+              <p>Our Store is represented by a single JS object in <em>localStorage</em>. Create it
+with a meaningful name, like the name you&#39;d give a table.
+window.Store is deprectated, use Backbone.LocalStorage instead
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>Backbone.LocalStorage = window.Store = <span class="keyword">function</span>(name) {
+  <span class="keyword">this</span>.name = name;
+  <span class="keyword">var</span> store = <span class="keyword">this</span>.localStorage().getItem(<span class="keyword">this</span>.name);
+  <span class="keyword">this</span>.records = (store &amp;&amp; store.split(<span class="string">","</span>)) || [];
+};
+
+_.extend(Backbone.LocalStorage.prototype, {</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-8">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-8">&#182;</a>
+              </div>
+              <p>Save the current state of the <strong>Store</strong> to <em>localStorage</em>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  save: <span class="keyword">function</span>() {
+    <span class="keyword">this</span>.localStorage().setItem(<span class="keyword">this</span>.name, <span class="keyword">this</span>.records.join(<span class="string">","</span>));
+  },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-9">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-9">&#182;</a>
+              </div>
+              <p>Add a model, giving it a (hopefully)-unique GUID, if it doesn&#39;t already
+have an id of it&#39;s own.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  create: <span class="keyword">function</span>(model) {
+    <span class="keyword">if</span> (!model.id) {
+      model.id = guid();
+      model.set(model.idAttribute, model.id);
+    }
+    <span class="keyword">this</span>.localStorage().setItem(<span class="keyword">this</span>.name+<span class="string">"-"</span>+model.id, JSON.stringify(model));
+    <span class="keyword">this</span>.records.push(model.id.toString());
+    <span class="keyword">this</span>.save();
+    <span class="keyword">return</span> <span class="keyword">this</span>.find(model);
+  },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-10">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-10">&#182;</a>
+              </div>
+              <p>Update a model by replacing its copy in <code>this.data</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  update: <span class="keyword">function</span>(model) {
+    <span class="keyword">this</span>.localStorage().setItem(<span class="keyword">this</span>.name+<span class="string">"-"</span>+model.id, JSON.stringify(model));
+    <span class="keyword">if</span> (!_.include(<span class="keyword">this</span>.records, model.id.toString()))
+      <span class="keyword">this</span>.records.push(model.id.toString()); <span class="keyword">this</span>.save();
+    <span class="keyword">return</span> <span class="keyword">this</span>.find(model);
+  },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-11">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-11">&#182;</a>
+              </div>
+              <p>Retrieve a model from <code>this.data</code> by id.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  find: <span class="keyword">function</span>(model) {
+    <span class="keyword">return</span> <span class="keyword">this</span>.jsonData(<span class="keyword">this</span>.localStorage().getItem(<span class="keyword">this</span>.name+<span class="string">"-"</span>+model.id));
+  },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-12">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-12">&#182;</a>
+              </div>
+              <p>Return the array of all models currently in storage.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  findAll: <span class="keyword">function</span>() {
+    <span class="keyword">return</span> _(<span class="keyword">this</span>.records).chain()
+      .map(<span class="keyword">function</span>(id){
+        <span class="keyword">return</span> <span class="keyword">this</span>.jsonData(<span class="keyword">this</span>.localStorage().getItem(<span class="keyword">this</span>.name+<span class="string">"-"</span>+id));
+      }, <span class="keyword">this</span>)
+      .compact()
+      .value();
+  },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-13">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-13">&#182;</a>
+              </div>
+              <p>Delete a model from <code>this.data</code>, returning it.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  destroy: <span class="keyword">function</span>(model) {
+    <span class="keyword">if</span> (model.isNew())
+      <span class="keyword">return</span> <span class="literal">false</span>
+    <span class="keyword">this</span>.localStorage().removeItem(<span class="keyword">this</span>.name+<span class="string">"-"</span>+model.id);
+    <span class="keyword">this</span>.records = _.reject(<span class="keyword">this</span>.records, <span class="keyword">function</span>(id){
+      <span class="keyword">return</span> id === model.id.toString();
+    });
+    <span class="keyword">this</span>.save();
+    <span class="keyword">return</span> model;
+  },
+
+  localStorage: <span class="keyword">function</span>() {
+    <span class="keyword">return</span> localStorage;
+  },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-14">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-14">&#182;</a>
+              </div>
+              <p>fix for &quot;illegal access&quot; error on Android when JSON.parse is passed null
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  jsonData: <span class="function"><span class="keyword">function</span> <span class="params">(data)</span> {</span>
+      <span class="keyword">return</span> data &amp;&amp; JSON.parse(data);
+  }
+
+});</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-15">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-15">&#182;</a>
+              </div>
+              <p>localSync delegate to the model or collection&#39;s
+<em>localStorage</em> property, which should be an instance of <code>Store</code>.
+window.Store.sync and Backbone.localSync is deprectated, use Backbone.LocalStorage.sync instead
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>Backbone.LocalStorage.sync = window.Store.sync = Backbone.localSync = <span class="keyword">function</span>(method, model, options) {
+  <span class="keyword">var</span> store = model.localStorage || model.collection.localStorage;
+
+  <span class="keyword">var</span> resp, errorMessage, syncDfd = $.Deferred &amp;&amp; $.Deferred(); <span class="comment">//If $ is having Deferred - use it.</span>
+
+  <span class="keyword">try</span> {
+
+    <span class="keyword">switch</span> (method) {
+      <span class="keyword">case</span> <span class="string">"read"</span>:
+        resp = model.id != <span class="literal">undefined</span> ? store.find(model) : store.findAll();
+        <span class="keyword">break</span>;
+      <span class="keyword">case</span> <span class="string">"create"</span>:
+        resp = store.create(model);
+        <span class="keyword">break</span>;
+      <span class="keyword">case</span> <span class="string">"update"</span>:
+        resp = store.update(model);
+        <span class="keyword">break</span>;
+      <span class="keyword">case</span> <span class="string">"delete"</span>:
+        resp = store.destroy(model);
+        <span class="keyword">break</span>;
+    }
+
+  } <span class="keyword">catch</span>(error) {
+    <span class="keyword">if</span> (error.code === DOMException.QUOTA_EXCEEDED_ERR &amp;&amp; window.localStorage.length === <span class="number">0</span>)
+      errorMessage = <span class="string">"Private browsing is unsupported"</span>;
+    <span class="keyword">else</span>
+      errorMessage = error.message;
+  }
+
+  <span class="keyword">if</span> (resp) {
+    model.trigger(<span class="string">"sync"</span>, model, resp, options);
+    <span class="keyword">if</span> (options &amp;&amp; options.success)
+      options.success(resp);
+    <span class="keyword">if</span> (syncDfd)
+      syncDfd.resolve(resp);
+
+  } <span class="keyword">else</span> {
+    errorMessage = errorMessage ? errorMessage
+                                : <span class="string">"Record Not Found"</span>;
+
+    <span class="keyword">if</span> (options &amp;&amp; options.error)
+      options.error(errorMessage);
+    <span class="keyword">if</span> (syncDfd)
+      syncDfd.reject(errorMessage);
+  }</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-16">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-16">&#182;</a>
+              </div>
+              <p>add compatibility with $.ajax
+always execute callback for success and error
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">if</span> (options &amp;&amp; options.complete) options.complete(resp);
+
+  <span class="keyword">return</span> syncDfd &amp;&amp; syncDfd.promise();
+};
+
+Backbone.ajaxSync = Backbone.sync;
+
+Backbone.getSyncMethod = <span class="keyword">function</span>(model) {
+  <span class="keyword">if</span>(model.localStorage || (model.collection &amp;&amp; model.collection.localStorage)) {
+    <span class="keyword">return</span> Backbone.localSync;
+  }
+
+  <span class="keyword">return</span> Backbone.ajaxSync;
+};</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-17">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-17">&#182;</a>
+              </div>
+              <p>Override &#39;Backbone.sync&#39; to default to localSync,
+the original &#39;Backbone.sync&#39; is still available in &#39;Backbone.ajaxSync&#39;
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>Backbone.sync = <span class="keyword">function</span>(method, model, options) {
+  <span class="keyword">return</span> Backbone.getSyncMethod(model).apply(<span class="keyword">this</span>, [method, model, options]);
+};
+
+<span class="keyword">return</span> Backbone.LocalStorage;
+}));</pre></div></div>
+            
+        </li>
+        
+    </ul>
+  </div>
+</body>
+</html></div></li>
 <li>public/components/backbone/docs/docco.css<div>diff --git a/public/components/backbone/docs/docco.css b/public/components/backbone/docs/docco.css
index 04cc7ec..6eedee3 100644
--- a/public/components/backbone/docs/docco.css
+++ b/public/components/backbone/docs/docco.css
@@ -1,192 +1,508 @@
-/*--------------------- Layout and Typography ----------------------------*/
+/*--------------------- Typography ----------------------------*/
+
+@font-face {
+    font-family: 'aller-light';
+    src: url('public/fonts/aller-light.eot');
+    src: url('public/fonts/aller-light.eot?#iefix') format('embedded-opentype'),
+         url('public/fonts/aller-light.woff') format('woff'),
+         url('public/fonts/aller-light.ttf') format('truetype');
+    font-weight: normal;
+    font-style: normal;
+}
+
+@font-face {
+    font-family: 'aller-bold';
+    src: url('public/fonts/aller-bold.eot');
+    src: url('public/fonts/aller-bold.eot?#iefix') format('embedded-opentype'),
+         url('public/fonts/aller-bold.woff') format('woff'),
+         url('public/fonts/aller-bold.ttf') format('truetype');
+    font-weight: normal;
+    font-style: normal;
+}
+
+@font-face {
+    font-family: 'novecento-bold';
+    src: url('public/fonts/novecento-bold.eot');
+    src: url('public/fonts/novecento-bold.eot?#iefix') format('embedded-opentype'),
+         url('public/fonts/novecento-bold.woff') format('woff'),
+         url('public/fonts/novecento-bold.ttf') format('truetype');
+    font-weight: normal;
+    font-style: normal;
+}
+
+/*--------------------- Layout ----------------------------*/
+html { height: 100%; }
 body {
-  font-family: 'Palatino Linotype', 'Book Antiqua', Palatino, FreeSerif, serif;
-  font-size: 15px;
-  line-height: 22px;
-  color: #252519;
+  font-family: "aller-light";
+  font-size: 14px;
+  line-height: 18px;
+  color: #30404f;
   margin: 0; padding: 0;
+  height:100%;
 }
+#container { min-height: 100%; }
+
 a {
-  color: #261a3b;
+  color: #000;
 }
-  a:visited {
-    color: #261a3b;
-  }
+
+b, strong {
+  font-weight: normal;
+  font-family: "aller-bold";
+}
+
 p {
-  margin: 0 0 15px 0;
+  margin: 15px 0 0px;
 }
+  .annotation ul, .annotation ol {
+    margin: 25px 0;
+  }
+    .annotation ul li, .annotation ol li {
+      font-size: 14px;
+      line-height: 18px;
+      margin: 10px 0;
+    }
+
 h1, h2, h3, h4, h5, h6 {
-  margin: 0px 0 15px 0;
+  color: #112233;
+  line-height: 1em;
+  font-weight: normal;
+  font-family: "novecento-bold";
+  text-transform: uppercase;
+  margin: 30px 0 15px 0;
 }
-  h1 {
-    margin-top: 40px;
-  }
+
+h1 {
+  margin-top: 40px;
+}
+
 hr {
-    border: 0 none;
-    border-top: 1px solid #e5e5ee;
-    height: 1px;
-    margin: 20px 0;
+  border: 0;
+  background: 1px solid #ddd;
+  height: 1px;
+  margin: 20px 0;
 }
-#container {
-  position: relative;
+
+pre, tt, code {
+  font-size: 12px; line-height: 16px;
+  font-family: Menlo, Monaco, Consolas, "Lucida Console", monospace;
+  margin: 0; padding: 0;
 }
-#background {
-  position: fixed;
-  top: 0; left: 525px; right: 0; bottom: 0;
-  background: #f5f5ff;
-  border-left: 1px solid #e5e5ee;
-  z-index: -1;
+  .annotation pre {
+    display: block;
+    margin: 0;
+    padding: 7px 10px;
+    background: #fcfcfc;
+    -moz-box-shadow:    inset 0 0 10px rgba(0,0,0,0.1);
+    -webkit-box-shadow: inset 0 0 10px rgba(0,0,0,0.1);
+    box-shadow:         inset 0 0 10px rgba(0,0,0,0.1);
+    overflow-x: auto;
+  }
+    .annotation pre code {
+      border: 0;
+      padding: 0;
+      background: transparent;
+    }
+
+
+blockquote {
+  border-left: 5px solid #ccc;
+  margin: 0;
+  padding: 1px 0 1px 1em;
+}
+  .sections blockquote p {
+    font-family: Menlo, Consolas, Monaco, monospace;
+    font-size: 12px; line-height: 16px;
+    color: #999;
+    margin: 10px 0 0;
+    white-space: pre-wrap;
+  }
+
+ul.sections {
+  list-style: none;
+  padding:0 0 5px 0;;
+  margin:0;
 }
+
+/*
+  Force border-box so that % widths fit the parent
+  container without overlap because of margin/padding.
+
+  More Info : http://www.quirksmode.org/css/box.html
+*/
+ul.sections > li > div {
+  -moz-box-sizing: border-box;    /* firefox */
+  -ms-box-sizing: border-box;     /* ie */
+  -webkit-box-sizing: border-box; /* webkit */
+  -khtml-box-sizing: border-box;  /* konqueror */
+  box-sizing: border-box;         /* css3 */
+}
+
+
+/*---------------------- Jump Page -----------------------------*/
 #jump_to, #jump_page {
+  margin: 0;
   background: white;
   -webkit-box-shadow: 0 0 25px #777; -moz-box-shadow: 0 0 25px #777;
   -webkit-border-bottom-left-radius: 5px; -moz-border-radius-bottomleft: 5px;
-  font: 10px Arial;
-  text-transform: uppercase;
+  font: 16px Arial;
   cursor: pointer;
   text-align: right;
+  list-style: none;
+}
+
+#jump_to a {
+  text-decoration: none;
+}
+
+#jump_to a.large {
+  display: none;
+}
+#jump_to a.small {
+  font-size: 22px;
+  font-weight: bold;
+  color: #676767;
 }
+
 #jump_to, #jump_wrapper {
   position: fixed;
   right: 0; top: 0;
-  padding: 5px 10px;
+  padding: 10px 15px;
+  margin:0;
+}
+
+#jump_wrapper {
+  display: none;
+  padding:0;
+}
+
+#jump_to:hover #jump_wrapper {
+  display: block;
+}
+
+#jump_page {
+  padding: 5px 0 3px;
+  margin: 0 0 25px 25px;
+}
+
+#jump_page .source {
+  display: block;
+  padding: 15px;
+  text-decoration: none;
+  border-top: 1px solid #eee;
 }
+
+#jump_page .source:hover {
+  background: #f5f5ff;
+}
+
+#jump_page .source:first-child {
+}
+
+/*---------------------- Low resolutions (> 320px) ---------------------*/
+@media only screen and (min-width: 320px) {
+  .pilwrap { display: none; }
+
+  ul.sections > li > div {
+    display: block;
+    padding:5px 10px 0 10px;
+  }
+
+  ul.sections > li > div.annotation ul, ul.sections > li > div.annotation ol {
+    padding-left: 30px;
+  }
+
+  ul.sections > li > div.content {
+    background: #f5f5ff;
+    overflow-x:auto;
+    -webkit-box-shadow: inset 0 0 5px #e5e5ee;
+    box-shadow: inset 0 0 5px #e5e5ee;
+    border: 1px solid #dedede;
+    margin:5px 10px 5px 10px;
+    padding-bottom: 5px;
+  }
+
+  ul.sections > li > div.annotation pre {
+    margin: 7px 0 7px;
+    padding-left: 15px;
+  }
+
+  ul.sections > li > div.annotation p tt, .annotation code {
+    background: #f8f8ff;
+    border: 1px solid #dedede;
+    font-size: 12px;
+    padding: 0 0.2em;
+  }
+}
+
+/*----------------------  (> 481px) ---------------------*/
+@media only screen and (min-width: 481px) {
+  #container {
+    position: relative;
+  }
+  body {
+    background-color: #F5F5FF;
+    font-size: 15px;
+    line-height: 21px;
+  }
+  pre, tt, code {
+    line-height: 18px;
+  }
+  p, ul, ol {
+    margin: 0 0 15px;
+  }
+
+
+  #jump_to {
+    padding: 5px 10px;
+  }
   #jump_wrapper {
     padding: 0;
+  }
+  #jump_to, #jump_page {
+    font: 10px Arial;
+    text-transform: uppercase;
+  }
+  #jump_page .source {
+    padding: 5px 10px;
+  }
+  #jump_to a.large {
+    display: inline-block;
+  }
+  #jump_to a.small {
     display: none;
   }
-    #jump_to:hover #jump_wrapper {
-      display: block;
-    }
-    #jump_page {
-      padding: 5px 0 3px;
-      margin: 0 0 25px 25px;
-    }
-      #jump_page .source {
-        display: block;
-        padding: 5px 10px;
-        text-decoration: none;
-        border-top: 1px solid #eee;
-      }
-        #jump_page .source:hover {
-          background: #f5f5ff;
-        }
-        #jump_page .source:first-child {
-        }
-table td {
-  border: 0;
-  outline: 0;
-}
-  td.docs, th.docs {
-    max-width: 450px;
-    min-width: 450px;
+
+
+
+  #background {
+    position: absolute;
+    top: 0; bottom: 0;
+    width: 350px;
+    background: #fff;
+    border-right: 1px solid #e5e5ee;
+    z-index: -1;
+  }
+
+  ul.sections > li > div.annotation ul, ul.sections > li > div.annotation ol {
+    padding-left: 40px;
+  }
+
+  ul.sections > li {
+    white-space: nowrap;
+  }
+
+  ul.sections > li > div {
+    display: inline-block;
+  }
+
+  ul.sections > li > div.annotation {
+    max-width: 350px;
+    min-width: 350px;
     min-height: 5px;
-    padding: 10px 25px 1px 50px;
+    padding: 13px;
     overflow-x: hidden;
+    white-space: normal;
     vertical-align: top;
     text-align: left;
   }
-    .docs pre {
-      margin: 15px 0 15px;
-      padding-left: 15px;
-    }
-    .docs p tt, .docs p code {
-      background: #f8f8ff;
-      border: 1px solid #dedede;
-      font-size: 12px;
-      padding: 0 0.2em;
-    }
-    .pilwrap {
-      position: relative;
-    }
-      .pilcrow {
-        font: 12px Arial;
-        text-decoration: none;
-        color: #454545;
-        position: absolute;
-        top: 3px; left: -20px;
-        padding: 1px 2px;
-        opacity: 0;
-        -webkit-transition: opacity 0.2s linear;
-      }
-        td.docs:hover .pilcrow {
-          opacity: 1;
-        }
-  td.code, th.code {
-    padding: 14px 15px 16px 25px;
-    width: 100%;
+  ul.sections > li > div.annotation pre {
+    margin: 15px 0 15px;
+    padding-left: 15px;
+  }
+
+  ul.sections > li > div.content {
+    padding: 13px;
     vertical-align: top;
     background: #f5f5ff;
-    border-left: 1px solid #e5e5ee;
+    border: none;
+    -webkit-box-shadow: none;
+    box-shadow: none;
   }
-    pre, tt, code {
-      font-size: 12px; line-height: 18px;
-      font-family: Menlo, Monaco, Consolas, "Lucida Console", monospace;
-      margin: 0; padding: 0;
+
+  .pilwrap {
+    position: relative;
+    display: inline;
+  }
+
+  .pilcrow {
+    font: 12px Arial;
+    text-decoration: none;
+    color: #454545;
+    position: absolute;
+    top: 3px; left: -20px;
+    padding: 1px 2px;
+    opacity: 0;
+    -webkit-transition: opacity 0.2s linear;
+  }
+    .for-h1 .pilcrow {
+      top: 47px;
+    }
+    .for-h2 .pilcrow, .for-h3 .pilcrow, .for-h4 .pilcrow {
+      top: 35px;
     }
 
+  ul.sections > li > div.annotation:hover .pilcrow {
+    opacity: 1;
+  }
+}
+
+/*---------------------- (> 1025px) ---------------------*/
+@media only screen and (min-width: 1025px) {
+
+  body {
+    font-size: 16px;
+    line-height: 24px;
+  }
+
+  #background {
+    width: 525px;
+  }
+  ul.sections > li > div.annotation {
+    max-width: 525px;
+    min-width: 525px;
+    padding: 10px 25px 1px 50px;
+  }
+  ul.sections > li > div.content {
+    padding: 9px 15px 16px 25px;
+  }
+}
 
 /*---------------------- Syntax Highlighting -----------------------------*/
+
 td.linenos { background-color: #f0f0f0; padding-right: 10px; }
 span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
-body .hll { background-color: #ffffcc }
-body .c { color: #408080; font-style: italic }  /* Comment */
-body .err { border: 1px solid #FF0000 }         /* Error */
-body .k { color: #954121 }                      /* Keyword */
-body .o { color: #666666 }                      /* Operator */
-body .cm { color: #408080; font-style: italic } /* Comment.Multiline */
-body .cp { color: #BC7A00 }                     /* Comment.Preproc */
-body .c1 { color: #408080; font-style: italic } /* Comment.Single */
-body .cs { color: #408080; font-style: italic } /* Comment.Special */
-body .gd { color: #A00000 }                     /* Generic.Deleted */
-body .ge { font-style: italic }                 /* Generic.Emph */
-body .gr { color: #FF0000 }                     /* Generic.Error */
-body .gh { color: #000080; font-weight: bold }  /* Generic.Heading */
-body .gi { color: #00A000 }                     /* Generic.Inserted */
-body .go { color: #808080 }                     /* Generic.Output */
-body .gp { color: #000080; font-weight: bold }  /* Generic.Prompt */
-body .gs { font-weight: bold }                  /* Generic.Strong */
-body .gu { color: #800080; font-weight: bold }  /* Generic.Subheading */
-body .gt { color: #0040D0 }                     /* Generic.Traceback */
-body .kc { color: #954121 }                     /* Keyword.Constant */
-body .kd { color: #954121; font-weight: bold }  /* Keyword.Declaration */
-body .kn { color: #954121; font-weight: bold }  /* Keyword.Namespace */
-body .kp { color: #954121 }                     /* Keyword.Pseudo */
-body .kr { color: #954121; font-weight: bold }  /* Keyword.Reserved */
-body .kt { color: #B00040 }                     /* Keyword.Type */
-body .m { color: #666666 }                      /* Literal.Number */
-body .s { color: #219161 }                      /* Literal.String */
-body .na { color: #7D9029 }                     /* Name.Attribute */
-body .nb { color: #954121 }                     /* Name.Builtin */
-body .nc { color: #0000FF; font-weight: bold }  /* Name.Class */
-body .no { color: #880000 }                     /* Name.Constant */
-body .nd { color: #AA22FF }                     /* Name.Decorator */
-body .ni { color: #999999; font-weight: bold }  /* Name.Entity */
-body .ne { color: #D2413A; font-weight: bold }  /* Name.Exception */
-body .nf { color: #0000FF }                     /* Name.Function */
-body .nl { color: #A0A000 }                     /* Name.Label */
-body .nn { color: #0000FF; font-weight: bold }  /* Name.Namespace */
-body .nt { color: #954121; font-weight: bold }  /* Name.Tag */
-body .nv { color: #19469D }                     /* Name.Variable */
-body .ow { color: #AA22FF; font-weight: bold }  /* Operator.Word */
-body .w { color: #bbbbbb }                      /* Text.Whitespace */
-body .mf { color: #666666 }                     /* Literal.Number.Float */
-body .mh { color: #666666 }                     /* Literal.Number.Hex */
-body .mi { color: #666666 }                     /* Literal.Number.Integer */
-body .mo { color: #666666 }                     /* Literal.Number.Oct */
-body .sb { color: #219161 }                     /* Literal.String.Backtick */
-body .sc { color: #219161 }                     /* Literal.String.Char */
-body .sd { color: #219161; font-style: italic } /* Literal.String.Doc */
-body .s2 { color: #219161 }                     /* Literal.String.Double */
-body .se { color: #BB6622; font-weight: bold }  /* Literal.String.Escape */
-body .sh { color: #219161 }                     /* Literal.String.Heredoc */
-body .si { color: #BB6688; font-weight: bold }  /* Literal.String.Interpol */
-body .sx { color: #954121 }                     /* Literal.String.Other */
-body .sr { color: #BB6688 }                     /* Literal.String.Regex */
-body .s1 { color: #219161 }                     /* Literal.String.Single */
-body .ss { color: #19469D }                     /* Literal.String.Symbol */
-body .bp { color: #954121 }                     /* Name.Builtin.Pseudo */
-body .vc { color: #19469D }                     /* Name.Variable.Class */
-body .vg { color: #19469D }                     /* Name.Variable.Global */
-body .vi { color: #19469D }                     /* Name.Variable.Instance */
-body .il { color: #666666 }                     /* Literal.Number.Integer.Long */
\ No newline at end of file
+/*
+
+github.com style (c) Vasily Polovnyov <vast@whiteants.net>
+
+*/
+
+pre code {
+  display: block; padding: 0.5em;
+  color: #000;
+  background: #f8f8ff
+}
+
+pre .comment,
+pre .template_comment,
+pre .diff .header,
+pre .javadoc {
+  color: #408080;
+  font-style: italic
+}
+
+pre .keyword,
+pre .assignment,
+pre .literal,
+pre .css .rule .keyword,
+pre .winutils,
+pre .javascript .title,
+pre .lisp .title,
+pre .subst {
+  color: #954121;
+  /*font-weight: bold*/
+}
+
+pre .number,
+pre .hexcolor {
+  color: #40a070
+}
+
+pre .string,
+pre .tag .value,
+pre .phpdoc,
+pre .tex .formula {
+  color: #219161;
+}
+
+pre .title,
+pre .id {
+  color: #19469D;
+}
+pre .params {
+  color: #00F;
+}
+
+pre .javascript .title,
+pre .lisp .title,
+pre .subst {
+  font-weight: normal
+}
+
+pre .class .title,
+pre .haskell .label,
+pre .tex .command {
+  color: #458;
+  font-weight: bold
+}
+
+pre .tag,
+pre .tag .title,
+pre .rules .property,
+pre .django .tag .keyword {
+  color: #000080;
+  font-weight: normal
+}
+
+pre .attribute,
+pre .variable,
+pre .instancevar,
+pre .lisp .body {
+  color: #008080
+}
+
+pre .regexp {
+  color: #B68
+}
+
+pre .class {
+  color: #458;
+  font-weight: bold
+}
+
+pre .symbol,
+pre .ruby .symbol .string,
+pre .ruby .symbol .keyword,
+pre .ruby .symbol .keymethods,
+pre .lisp .keyword,
+pre .tex .special,
+pre .input_number {
+  color: #990073
+}
+
+pre .builtin,
+pre .constructor,
+pre .built_in,
+pre .lisp .title {
+  color: #0086b3
+}
+
+pre .preprocessor,
+pre .pi,
+pre .doctype,
+pre .shebang,
+pre .cdata {
+  color: #999;
+  font-weight: bold
+}
+
+pre .deletion {
+  background: #fdd
+}
+
+pre .addition {
+  background: #dfd
+}
+
+pre .diff .change {
+  background: #0086b3
+}
+
+pre .chunk {
+  color: #aaa
+}
+
+pre .tex .formula {
+  opacity: 0.5;
+}</div></li>
 <li>public/components/backbone/docs/images/decide.png<div>diff --git a/public/components/backbone/docs/images/decide.png b/public/components/backbone/docs/images/decide.png
deleted file mode 100644
index cade9cb..0000000
Binary files a/public/components/backbone/docs/images/decide.png and /dev/null differ</div></li>
 <li>public/components/backbone/docs/images/quartz.jpg<div>diff --git a/public/components/backbone/docs/images/quartz.jpg b/public/components/backbone/docs/images/quartz.jpg
new file mode 100644
index 0000000..dfe27e9
Binary files /dev/null and b/public/components/backbone/docs/images/quartz.jpg differ</div></li>
 <li>public/components/backbone/docs/public/fonts/aller-bold.eot<div>diff --git a/public/components/backbone/docs/public/fonts/aller-bold.eot b/public/components/backbone/docs/public/fonts/aller-bold.eot
new file mode 100755
index 0000000..1b32532
Binary files /dev/null and b/public/components/backbone/docs/public/fonts/aller-bold.eot differ</div></li>
 <li>public/components/backbone/docs/public/fonts/aller-bold.ttf<div>diff --git a/public/components/backbone/docs/public/fonts/aller-bold.ttf b/public/components/backbone/docs/public/fonts/aller-bold.ttf
new file mode 100755
index 0000000..dc4cc9c
Binary files /dev/null and b/public/components/backbone/docs/public/fonts/aller-bold.ttf differ</div></li>
 <li>public/components/backbone/docs/public/fonts/aller-bold.woff<div>diff --git a/public/components/backbone/docs/public/fonts/aller-bold.woff b/public/components/backbone/docs/public/fonts/aller-bold.woff
new file mode 100755
index 0000000..fa16fd0
Binary files /dev/null and b/public/components/backbone/docs/public/fonts/aller-bold.woff differ</div></li>
 <li>public/components/backbone/docs/public/fonts/aller-light.eot<div>diff --git a/public/components/backbone/docs/public/fonts/aller-light.eot b/public/components/backbone/docs/public/fonts/aller-light.eot
new file mode 100755
index 0000000..40bd654
Binary files /dev/null and b/public/components/backbone/docs/public/fonts/aller-light.eot differ</div></li>
 <li>public/components/backbone/docs/public/fonts/aller-light.ttf<div>diff --git a/public/components/backbone/docs/public/fonts/aller-light.ttf b/public/components/backbone/docs/public/fonts/aller-light.ttf
new file mode 100755
index 0000000..c2c7290
Binary files /dev/null and b/public/components/backbone/docs/public/fonts/aller-light.ttf differ</div></li>
 <li>public/components/backbone/docs/public/fonts/aller-light.woff<div>diff --git a/public/components/backbone/docs/public/fonts/aller-light.woff b/public/components/backbone/docs/public/fonts/aller-light.woff
new file mode 100755
index 0000000..81a09d1
Binary files /dev/null and b/public/components/backbone/docs/public/fonts/aller-light.woff differ</div></li>
 <li>public/components/backbone/docs/public/fonts/fleurons.eot<div>diff --git a/public/components/backbone/docs/public/fonts/fleurons.eot b/public/components/backbone/docs/public/fonts/fleurons.eot
new file mode 100755
index 0000000..26189bb
Binary files /dev/null and b/public/components/backbone/docs/public/fonts/fleurons.eot differ</div></li>
 <li>public/components/backbone/docs/public/fonts/fleurons.ttf<div>diff --git a/public/components/backbone/docs/public/fonts/fleurons.ttf b/public/components/backbone/docs/public/fonts/fleurons.ttf
new file mode 100755
index 0000000..7b1b017
Binary files /dev/null and b/public/components/backbone/docs/public/fonts/fleurons.ttf differ</div></li>
 <li>public/components/backbone/docs/public/fonts/fleurons.woff<div>diff --git a/public/components/backbone/docs/public/fonts/fleurons.woff b/public/components/backbone/docs/public/fonts/fleurons.woff
new file mode 100755
index 0000000..10b7e1a
Binary files /dev/null and b/public/components/backbone/docs/public/fonts/fleurons.woff differ</div></li>
 <li>public/components/backbone/docs/public/fonts/novecento-bold.eot<div>diff --git a/public/components/backbone/docs/public/fonts/novecento-bold.eot b/public/components/backbone/docs/public/fonts/novecento-bold.eot
new file mode 100755
index 0000000..98a9a7f
Binary files /dev/null and b/public/components/backbone/docs/public/fonts/novecento-bold.eot differ</div></li>
 <li>public/components/backbone/docs/public/fonts/novecento-bold.ttf<div>diff --git a/public/components/backbone/docs/public/fonts/novecento-bold.ttf b/public/components/backbone/docs/public/fonts/novecento-bold.ttf
new file mode 100755
index 0000000..2af39b0
Binary files /dev/null and b/public/components/backbone/docs/public/fonts/novecento-bold.ttf differ</div></li>
 <li>public/components/backbone/docs/public/fonts/novecento-bold.woff<div>diff --git a/public/components/backbone/docs/public/fonts/novecento-bold.woff b/public/components/backbone/docs/public/fonts/novecento-bold.woff
new file mode 100755
index 0000000..de558b5
Binary files /dev/null and b/public/components/backbone/docs/public/fonts/novecento-bold.woff differ</div></li>
 <li>public/components/backbone/docs/public/images/grey_@2X.png<div>diff --git a/public/components/backbone/docs/public/images/grey_@2X.png b/public/components/backbone/docs/public/images/grey_@2X.png
new file mode 100644
index 0000000..6eb6669
Binary files /dev/null and b/public/components/backbone/docs/public/images/grey_@2X.png differ</div></li>
 <li>public/components/backbone/docs/public/stylesheets/normalize.css<div>diff --git a/public/components/backbone/docs/public/stylesheets/normalize.css b/public/components/backbone/docs/public/stylesheets/normalize.css
new file mode 100644
index 0000000..73abb76
--- /dev/null
+++ b/public/components/backbone/docs/public/stylesheets/normalize.css
@@ -0,0 +1,375 @@
+/*! normalize.css v2.0.1 | MIT License | git.io/normalize */
+
+/* ==========================================================================
+   HTML5 display definitions
+   ========================================================================== */
+
+/*
+ * Corrects `block` display not defined in IE 8/9.
+ */
+
+article,
+aside,
+details,
+figcaption,
+figure,
+footer,
+header,
+hgroup,
+nav,
+section,
+summary {
+    display: block;
+}
+
+/*
+ * Corrects `inline-block` display not defined in IE 8/9.
+ */
+
+audio,
+canvas,
+video {
+    display: inline-block;
+}
+
+/*
+ * Prevents modern browsers from displaying `audio` without controls.
+ * Remove excess height in iOS 5 devices.
+ */
+
+audio:not([controls]) {
+    display: none;
+    height: 0;
+}
+
+/*
+ * Addresses styling for `hidden` attribute not present in IE 8/9.
+ */
+
+[hidden] {
+    display: none;
+}
+
+/* ==========================================================================
+   Base
+   ========================================================================== */
+
+/*
+ * 1. Sets default font family to sans-serif.
+ * 2. Prevents iOS text size adjust after orientation change, without disabling
+ *    user zoom.
+ */
+
+html {
+    font-family: sans-serif; /* 1 */
+    -webkit-text-size-adjust: 100%; /* 2 */
+    -ms-text-size-adjust: 100%; /* 2 */
+}
+
+/*
+ * Removes default margin.
+ */
+
+body {
+    margin: 0;
+}
+
+/* ==========================================================================
+   Links
+   ========================================================================== */
+
+/*
+ * Addresses `outline` inconsistency between Chrome and other browsers.
+ */
+
+a:focus {
+    outline: thin dotted;
+}
+
+/*
+ * Improves readability when focused and also mouse hovered in all browsers.
+ */
+
+a:active,
+a:hover {
+    outline: 0;
+}
+
+/* ==========================================================================
+   Typography
+   ========================================================================== */
+
+/*
+ * Addresses `h1` font sizes within `section` and `article` in Firefox 4+,
+ * Safari 5, and Chrome.
+ */
+
+h1 {
+    font-size: 2em;
+}
+
+/*
+ * Addresses styling not present in IE 8/9, Safari 5, and Chrome.
+ */
+
+abbr[title] {
+    border-bottom: 1px dotted;
+}
+
+/*
+ * Addresses style set to `bolder` in Firefox 4+, Safari 5, and Chrome.
+ */
+
+b,
+strong {
+    font-weight: bold;
+}
+
+/*
+ * Addresses styling not present in Safari 5 and Chrome.
+ */
+
+dfn {
+    font-style: italic;
+}
+
+/*
+ * Addresses styling not present in IE 8/9.
+ */
+
+mark {
+    background: #ff0;
+    color: #000;
+}
+
+
+/*
+ * Corrects font family set oddly in Safari 5 and Chrome.
+ */
+
+code,
+kbd,
+pre,
+samp {
+    font-family: monospace, serif;
+    font-size: 1em;
+}
+
+/*
+ * Improves readability of pre-formatted text in all browsers.
+ */
+
+pre {
+    white-space: pre;
+    white-space: pre-wrap;
+    word-wrap: break-word;
+}
+
+/*
+ * Sets consistent quote types.
+ */
+
+q {
+    quotes: "\201C" "\201D" "\2018" "\2019";
+}
+
+/*
+ * Addresses inconsistent and variable font size in all browsers.
+ */
+
+small {
+    font-size: 80%;
+}
+
+/*
+ * Prevents `sub` and `sup` affecting `line-height` in all browsers.
+ */
+
+sub,
+sup {
+    font-size: 75%;
+    line-height: 0;
+    position: relative;
+    vertical-align: baseline;
+}
+
+sup {
+    top: -0.5em;
+}
+
+sub {
+    bottom: -0.25em;
+}
+
+/* ==========================================================================
+   Embedded content
+   ========================================================================== */
+
+/*
+ * Removes border when inside `a` element in IE 8/9.
+ */
+
+img {
+    border: 0;
+}
+
+/*
+ * Corrects overflow displayed oddly in IE 9.
+ */
+
+svg:not(:root) {
+    overflow: hidden;
+}
+
+/* ==========================================================================
+   Figures
+   ========================================================================== */
+
+/*
+ * Addresses margin not present in IE 8/9 and Safari 5.
+ */
+
+figure {
+    margin: 0;
+}
+
+/* ==========================================================================
+   Forms
+   ========================================================================== */
+
+/*
+ * Define consistent border, margin, and padding.
+ */
+
+fieldset {
+    border: 1px solid #c0c0c0;
+    margin: 0 2px;
+    padding: 0.35em 0.625em 0.75em;
+}
+
+/*
+ * 1. Corrects color not being inherited in IE 8/9.
+ * 2. Remove padding so people aren't caught out if they zero out fieldsets.
+ */
+
+legend {
+    border: 0; /* 1 */
+    padding: 0; /* 2 */
+}
+
+/*
+ * 1. Corrects font family not being inherited in all browsers.
+ * 2. Corrects font size not being inherited in all browsers.
+ * 3. Addresses margins set differently in Firefox 4+, Safari 5, and Chrome
+ */
+
+button,
+input,
+select,
+textarea {
+    font-family: inherit; /* 1 */
+    font-size: 100%; /* 2 */
+    margin: 0; /* 3 */
+}
+
+/*
+ * Addresses Firefox 4+ setting `line-height` on `input` using `!important` in
+ * the UA stylesheet.
+ */
+
+button,
+input {
+    line-height: normal;
+}
+
+/*
+ * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
+ *    and `video` controls.
+ * 2. Corrects inability to style clickable `input` types in iOS.
+ * 3. Improves usability and consistency of cursor style between image-type
+ *    `input` and others.
+ */
+
+button,
+html input[type="button"], /* 1 */
+input[type="reset"],
+input[type="submit"] {
+    -webkit-appearance: button; /* 2 */
+    cursor: pointer; /* 3 */
+}
+
+/*
+ * Re-set default cursor for disabled elements.
+ */
+
+button[disabled],
+input[disabled] {
+    cursor: default;
+}
+
+/*
+ * 1. Addresses box sizing set to `content-box` in IE 8/9.
+ * 2. Removes excess padding in IE 8/9.
+ */
+
+input[type="checkbox"],
+input[type="radio"] {
+    box-sizing: border-box; /* 1 */
+    padding: 0; /* 2 */
+}
+
+/*
+ * 1. Addresses `appearance` set to `searchfield` in Safari 5 and Chrome.
+ * 2. Addresses `box-sizing` set to `border-box` in Safari 5 and Chrome
+ *    (include `-moz` to future-proof).
+ */
+
+input[type="search"] {
+    -webkit-appearance: textfield; /* 1 */
+    -moz-box-sizing: content-box;
+    -webkit-box-sizing: content-box; /* 2 */
+    box-sizing: content-box;
+}
+
+/*
+ * Removes inner padding and search cancel button in Safari 5 and Chrome
+ * on OS X.
+ */
+
+input[type="search"]::-webkit-search-cancel-button,
+input[type="search"]::-webkit-search-decoration {
+    -webkit-appearance: none;
+}
+
+/*
+ * Removes inner padding and border in Firefox 4+.
+ */
+
+button::-moz-focus-inner,
+input::-moz-focus-inner {
+    border: 0;
+    padding: 0;
+}
+
+/*
+ * 1. Removes default vertical scrollbar in IE 8/9.
+ * 2. Improves readability and alignment in all browsers.
+ */
+
+textarea {
+    overflow: auto; /* 1 */
+    vertical-align: top; /* 2 */
+}
+
+/* ==========================================================================
+   Tables
+   ========================================================================== */
+
+/*
+ * Remove most spacing between table cells.
+ */
+
+table {
+    border-collapse: collapse;
+    border-spacing: 0;
+}
\ No newline at end of file</div></li>
 <li>public/components/backbone/docs/todos.html<div>diff --git a/public/components/backbone/docs/todos.html b/public/components/backbone/docs/todos.html
index f22dfa3..931a8ca 100644
--- a/public/components/backbone/docs/todos.html
+++ b/public/components/backbone/docs/todos.html
@@ -1,128 +1,765 @@
-<!DOCTYPE html>  <html> <head>   <title>todos.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="backbone-localstorage.html">                 backbone-localstorage.js               </a>                                           <a class="source" href="todos.html">                 todos.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               todos.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>An example Backbone application contributed by
+<!DOCTYPE html>
+
+<html>
+<head>
+  <title>todos.js</title>
+  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
+  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
+  <link rel="stylesheet" media="all" href="docco.css" />
+</head>
+<body>
+  <div id="container">
+    <div id="background"></div>
+    
+      <ul id="jump_to">
+        <li>
+          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
+          <a class="small" href="javascript:void(0);">+</a>
+          <div id="jump_wrapper">
+          <div id="jump_page">
+            
+              
+              <a class="source" href="backbone.localstorage.html">
+                backbone.localstorage.js
+              </a>
+            
+              
+              <a class="source" href="todos.html">
+                todos.js
+              </a>
+            
+          </div>
+        </li>
+      </ul>
+    
+    <ul class="sections">
+        
+          <li id="title">
+              <div class="annotation">
+                  <h1>todos.js</h1>
+              </div>
+          </li>
+        
+        
+        
+        <li id="section-1">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-1">&#182;</a>
+              </div>
+              <p>An example Backbone application contributed by
 <a href="http://jgn.me/">Jérôme Gravel-Niquet</a>. This demo uses a simple
 <a href="backbone-localstorage.html">LocalStorage adapter</a>
-to persist Backbone models within your browser.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Load the application once the DOM is ready, using <code>jQuery.ready</code>:</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <h2>Todo Model</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Our basic <strong>Todo</strong> model has <code>title</code>, <code>order</code>, and <code>done</code> attributes.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">Todo</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Default attributes for the todo item.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">defaults</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="p">{</span>
-        <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;empty todo...&quot;</span><span class="p">,</span>
-        <span class="nx">order</span><span class="o">:</span> <span class="nx">Todos</span><span class="p">.</span><span class="nx">nextOrder</span><span class="p">(),</span>
-        <span class="nx">done</span><span class="o">:</span> <span class="kc">false</span>
-      <span class="p">};</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Ensure that each todo created has <code>title</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">))</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">({</span><span class="s2">&quot;title&quot;</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">defaults</span><span class="p">().</span><span class="nx">title</span><span class="p">});</span>
-      <span class="p">}</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Toggle the <code>done</code> state of this todo item.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">toggle</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span><span class="nx">done</span><span class="o">:</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;done&quot;</span><span class="p">)});</span>
-    <span class="p">}</span>
-
-  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <h2>Todo Collection</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>The collection of todos is backed by <em>localStorage</em> instead of a remote
-server.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">TodoList</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collection</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Reference to this collection's model.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">model</span><span class="o">:</span> <span class="nx">Todo</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Save all of the todo items under the <code>"todos-backbone"</code> namespace.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">localStorage</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">LocalStorage</span><span class="p">(</span><span class="s2">&quot;todos-backbone&quot;</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Filter down the list of all todo items that are finished.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">done</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">){</span> <span class="k">return</span> <span class="nx">todo</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">);</span> <span class="p">});</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Filter down the list to only todo items that are still not finished.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">remaining</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">without</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">done</span><span class="p">());</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>We keep the Todos in sequential order, despite being saved by unordered
-GUID in the database. This generates the next order number for new items.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">nextOrder</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">last</span><span class="p">().</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;order&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Todos are sorted by their original insertion order.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">comparator</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">return</span> <span class="nx">todo</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;order&#39;</span><span class="p">);</span>
-    <span class="p">}</span>
-
-  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Create our global collection of <strong>Todos</strong>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">Todos</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TodoList</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <h2>Todo Item View</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>The DOM element for a todo item...</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">TodoView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>... is a list tag.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">tagName</span><span class="o">:</span>  <span class="s2">&quot;li&quot;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Cache the template function for a single item.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">template</span><span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#item-template&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">()),</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>The DOM events specific to an item.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
-      <span class="s2">&quot;click .toggle&quot;</span>   <span class="o">:</span> <span class="s2">&quot;toggleDone&quot;</span><span class="p">,</span>
-      <span class="s2">&quot;dblclick .view&quot;</span>  <span class="o">:</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span>
-      <span class="s2">&quot;click a.destroy&quot;</span> <span class="o">:</span> <span class="s2">&quot;clear&quot;</span><span class="p">,</span>
-      <span class="s2">&quot;keypress .edit&quot;</span>  <span class="o">:</span> <span class="s2">&quot;updateOnEnter&quot;</span><span class="p">,</span>
-      <span class="s2">&quot;blur .edit&quot;</span>      <span class="o">:</span> <span class="s2">&quot;close&quot;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>The TodoView listens for changes to its model, re-rendering. Since there's
+to persist Backbone models within your browser.
+
+</p>
+<p>Load the application once the DOM is ready, using <code>jQuery.ready</code>:
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>$(<span class="keyword">function</span>(){</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-2">
+            <div class="annotation">
+              
+              <div class="pilwrap for-h2">
+                <a class="pilcrow" href="#section-2">&#182;</a>
+              </div>
+              <h2>Todo Model</h2>
+
+            </div>
+            
+        </li>
+        
+        
+        <li id="section-3">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-3">&#182;</a>
+              </div>
+              <p>Our basic <strong>Todo</strong> model has <code>title</code>, <code>order</code>, and <code>done</code> attributes.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> Todo = Backbone.Model.extend({</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-4">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-4">&#182;</a>
+              </div>
+              <p>Default attributes for the todo item.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    defaults: <span class="keyword">function</span>() {
+      <span class="keyword">return</span> {
+        title: <span class="string">"empty todo..."</span>,
+        order: Todos.nextOrder(),
+        done: <span class="literal">false</span>
+      };
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-5">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-5">&#182;</a>
+              </div>
+              <p>Toggle the <code>done</code> state of this todo item.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    toggle: <span class="keyword">function</span>() {
+      <span class="keyword">this</span>.save({done: !<span class="keyword">this</span>.get(<span class="string">"done"</span>)});
+    }
+
+  });</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-6">
+            <div class="annotation">
+              
+              <div class="pilwrap for-h2">
+                <a class="pilcrow" href="#section-6">&#182;</a>
+              </div>
+              <h2>Todo Collection</h2>
+
+            </div>
+            
+        </li>
+        
+        
+        <li id="section-7">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-7">&#182;</a>
+              </div>
+              <p>The collection of todos is backed by <em>localStorage</em> instead of a remote
+server.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> TodoList = Backbone.Collection.extend({</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-8">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-8">&#182;</a>
+              </div>
+              <p>Reference to this collection&#39;s model.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    model: Todo,</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-9">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-9">&#182;</a>
+              </div>
+              <p>Save all of the todo items under the <code>&quot;todos-backbone&quot;</code> namespace.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    localStorage: <span class="keyword">new</span> Backbone.LocalStorage(<span class="string">"todos-backbone"</span>),</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-10">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-10">&#182;</a>
+              </div>
+              <p>Filter down the list of all todo items that are finished.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    done: <span class="keyword">function</span>() {
+      <span class="keyword">return</span> <span class="keyword">this</span>.where({done: <span class="literal">true</span>});
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-11">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-11">&#182;</a>
+              </div>
+              <p>Filter down the list to only todo items that are still not finished.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    remaining: <span class="keyword">function</span>() {
+      <span class="keyword">return</span> <span class="keyword">this</span>.without.apply(<span class="keyword">this</span>, <span class="keyword">this</span>.done());
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-12">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-12">&#182;</a>
+              </div>
+              <p>We keep the Todos in sequential order, despite being saved by unordered
+GUID in the database. This generates the next order number for new items.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    nextOrder: <span class="keyword">function</span>() {
+      <span class="keyword">if</span> (!<span class="keyword">this</span>.length) <span class="keyword">return</span> <span class="number">1</span>;
+      <span class="keyword">return</span> <span class="keyword">this</span>.last().get(<span class="string">'order'</span>) + <span class="number">1</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-13">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-13">&#182;</a>
+              </div>
+              <p>Todos are sorted by their original insertion order.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    comparator: <span class="string">'order'</span>
+
+  });</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-14">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-14">&#182;</a>
+              </div>
+              <p>Create our global collection of <strong>Todos</strong>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> Todos = <span class="keyword">new</span> TodoList;</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-15">
+            <div class="annotation">
+              
+              <div class="pilwrap for-h2">
+                <a class="pilcrow" href="#section-15">&#182;</a>
+              </div>
+              <h2>Todo Item View</h2>
+
+            </div>
+            
+        </li>
+        
+        
+        <li id="section-16">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-16">&#182;</a>
+              </div>
+              <p>The DOM element for a todo item...
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> TodoView = Backbone.View.extend({</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-17">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-17">&#182;</a>
+              </div>
+              <p>... is a list tag.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    tagName:  <span class="string">"li"</span>,</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-18">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-18">&#182;</a>
+              </div>
+              <p>Cache the template function for a single item.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    template: _.template($(<span class="string">'#item-template'</span>).html()),</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-19">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-19">&#182;</a>
+              </div>
+              <p>The DOM events specific to an item.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    events: {
+      <span class="string">"click .toggle"</span>   : <span class="string">"toggleDone"</span>,
+      <span class="string">"dblclick .view"</span>  : <span class="string">"edit"</span>,
+      <span class="string">"click a.destroy"</span> : <span class="string">"clear"</span>,
+      <span class="string">"keypress .edit"</span>  : <span class="string">"updateOnEnter"</span>,
+      <span class="string">"blur .edit"</span>      : <span class="string">"close"</span>
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-20">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-20">&#182;</a>
+              </div>
+              <p>The TodoView listens for changes to its model, re-rendering. Since there&#39;s
 a one-to-one correspondence between a <strong>Todo</strong> and a <strong>TodoView</strong> in this
-app, we set a direct reference on the model for convenience.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">listenTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">,</span> <span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">);</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">listenTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">,</span> <span class="s1">&#39;destroy&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">remove</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Re-render the titles of the todo item.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">()));</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">toggleClass</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">));</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;.edit&#39;</span><span class="p">);</span>
-      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Toggle the <code>"done"</code> state of the model.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">toggleDone</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">toggle</span><span class="p">();</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Switch this view into <code>"editing"</code> mode, displaying the input field.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">edit</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">addClass</span><span class="p">(</span><span class="s2">&quot;editing&quot;</span><span class="p">);</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>Close the <code>"editing"</code> mode, saving changes to the todo.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">close</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">();</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
-      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span><span class="nx">title</span><span class="o">:</span> <span class="nx">value</span><span class="p">});</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">removeClass</span><span class="p">(</span><span class="s2">&quot;editing&quot;</span><span class="p">);</span>
-      <span class="p">}</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>If you hit <code>enter</code>, we're through editing the item.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">updateOnEnter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">keyCode</span> <span class="o">==</span> <span class="mi">13</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Remove the item, destroy the model.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">clear</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
-    <span class="p">}</span>
-
-  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <h2>The Application</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>Our overall <strong>AppView</strong> is the top-level piece of UI.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">AppView</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>Instead of generating a new element, bind to the existing skeleton of
-the App already present in the HTML.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">el</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#todoapp&quot;</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>Our template for the line of statistics at the bottom of the app.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">statsTemplate</span><span class="o">:</span> <span class="nx">_</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#stats-template&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">()),</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Delegated events for creating new items, and clearing completed ones.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
-      <span class="s2">&quot;keypress #new-todo&quot;</span><span class="o">:</span>  <span class="s2">&quot;createOnEnter&quot;</span><span class="p">,</span>
-      <span class="s2">&quot;click #clear-completed&quot;</span><span class="o">:</span> <span class="s2">&quot;clearCompleted&quot;</span><span class="p">,</span>
-      <span class="s2">&quot;click #toggle-all&quot;</span><span class="o">:</span> <span class="s2">&quot;toggleAllComplete&quot;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>At initialization we bind to the relevant events on the <code>Todos</code>
+app, we set a direct reference on the model for convenience.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    initialize: <span class="keyword">function</span>() {
+      <span class="keyword">this</span>.listenTo(<span class="keyword">this</span>.model, <span class="string">'change'</span>, <span class="keyword">this</span>.render);
+      <span class="keyword">this</span>.listenTo(<span class="keyword">this</span>.model, <span class="string">'destroy'</span>, <span class="keyword">this</span>.remove);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-21">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-21">&#182;</a>
+              </div>
+              <p>Re-render the titles of the todo item.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    render: <span class="keyword">function</span>() {
+      <span class="keyword">this</span>.$el.html(<span class="keyword">this</span>.template(<span class="keyword">this</span>.model.toJSON()));
+      <span class="keyword">this</span>.$el.toggleClass(<span class="string">'done'</span>, <span class="keyword">this</span>.model.get(<span class="string">'done'</span>));
+      <span class="keyword">this</span>.input = <span class="keyword">this</span>.$(<span class="string">'.edit'</span>);
+      <span class="keyword">return</span> <span class="keyword">this</span>;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-22">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-22">&#182;</a>
+              </div>
+              <p>Toggle the <code>&quot;done&quot;</code> state of the model.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    toggleDone: <span class="keyword">function</span>() {
+      <span class="keyword">this</span>.model.toggle();
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-23">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-23">&#182;</a>
+              </div>
+              <p>Switch this view into <code>&quot;editing&quot;</code> mode, displaying the input field.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    edit: <span class="keyword">function</span>() {
+      <span class="keyword">this</span>.$el.addClass(<span class="string">"editing"</span>);
+      <span class="keyword">this</span>.input.focus();
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-24">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-24">&#182;</a>
+              </div>
+              <p>Close the <code>&quot;editing&quot;</code> mode, saving changes to the todo.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    close: <span class="keyword">function</span>() {
+      <span class="keyword">var</span> value = <span class="keyword">this</span>.input.val();
+      <span class="keyword">if</span> (!value) {
+        <span class="keyword">this</span>.clear();
+      } <span class="keyword">else</span> {
+        <span class="keyword">this</span>.model.save({title: value});
+        <span class="keyword">this</span>.$el.removeClass(<span class="string">"editing"</span>);
+      }
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-25">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-25">&#182;</a>
+              </div>
+              <p>If you hit <code>enter</code>, we&#39;re through editing the item.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    updateOnEnter: <span class="keyword">function</span>(e) {
+      <span class="keyword">if</span> (e.keyCode == <span class="number">13</span>) <span class="keyword">this</span>.close();
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-26">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-26">&#182;</a>
+              </div>
+              <p>Remove the item, destroy the model.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    clear: <span class="keyword">function</span>() {
+      <span class="keyword">this</span>.model.destroy();
+    }
+
+  });</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-27">
+            <div class="annotation">
+              
+              <div class="pilwrap for-h2">
+                <a class="pilcrow" href="#section-27">&#182;</a>
+              </div>
+              <h2>The Application</h2>
+
+            </div>
+            
+        </li>
+        
+        
+        <li id="section-28">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-28">&#182;</a>
+              </div>
+              <p>Our overall <strong>AppView</strong> is the top-level piece of UI.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> AppView = Backbone.View.extend({</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-29">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-29">&#182;</a>
+              </div>
+              <p>Instead of generating a new element, bind to the existing skeleton of
+the App already present in the HTML.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    el: $(<span class="string">"#todoapp"</span>),</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-30">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-30">&#182;</a>
+              </div>
+              <p>Our template for the line of statistics at the bottom of the app.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    statsTemplate: _.template($(<span class="string">'#stats-template'</span>).html()),</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-31">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-31">&#182;</a>
+              </div>
+              <p>Delegated events for creating new items, and clearing completed ones.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    events: {
+      <span class="string">"keypress #new-todo"</span>:  <span class="string">"createOnEnter"</span>,
+      <span class="string">"click #clear-completed"</span>: <span class="string">"clearCompleted"</span>,
+      <span class="string">"click #toggle-all"</span>: <span class="string">"toggleAllComplete"</span>
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-32">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-32">&#182;</a>
+              </div>
+              <p>At initialization we bind to the relevant events on the <code>Todos</code>
 collection, when items are added or changed. Kick things off by
-loading any preexisting todos that might be saved in <em>localStorage</em>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">initialize</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-
-      <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#new-todo&quot;</span><span class="p">);</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">allCheckbox</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#toggle-all&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
-
-      <span class="k">this</span><span class="p">.</span><span class="nx">listenTo</span><span class="p">(</span><span class="nx">Todos</span><span class="p">,</span> <span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">addOne</span><span class="p">);</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">listenTo</span><span class="p">(</span><span class="nx">Todos</span><span class="p">,</span> <span class="s1">&#39;reset&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">addAll</span><span class="p">);</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">listenTo</span><span class="p">(</span><span class="nx">Todos</span><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">);</span>
-
-      <span class="k">this</span><span class="p">.</span><span class="nx">footer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;footer&#39;</span><span class="p">);</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">main</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#main&#39;</span><span class="p">);</span>
-
-      <span class="nx">Todos</span><span class="p">.</span><span class="nx">fetch</span><span class="p">();</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>Re-rendering the App just means refreshing the statistics -- the rest
-of the app doesn't change.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">done</span> <span class="o">=</span> <span class="nx">Todos</span><span class="p">.</span><span class="nx">done</span><span class="p">().</span><span class="nx">length</span><span class="p">;</span>
-      <span class="kd">var</span> <span class="nx">remaining</span> <span class="o">=</span> <span class="nx">Todos</span><span class="p">.</span><span class="nx">remaining</span><span class="p">().</span><span class="nx">length</span><span class="p">;</span>
-
-      <span class="k">if</span> <span class="p">(</span><span class="nx">Todos</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">footer</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">footer</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">statsTemplate</span><span class="p">({</span><span class="nx">done</span><span class="o">:</span> <span class="nx">done</span><span class="p">,</span> <span class="nx">remaining</span><span class="o">:</span> <span class="nx">remaining</span><span class="p">}));</span>
-      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">main</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
-        <span class="k">this</span><span class="p">.</span><span class="nx">footer</span><span class="p">.</span><span class="nx">hide</span><span class="p">();</span>
-      <span class="p">}</span>
-
-      <span class="k">this</span><span class="p">.</span><span class="nx">allCheckbox</span><span class="p">.</span><span class="nx">checked</span> <span class="o">=</span> <span class="o">!</span><span class="nx">remaining</span><span class="p">;</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>Add a single todo item to the list by creating a view for it, and
-appending its element to the <code>&lt;ul&gt;</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">addOne</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">TodoView</span><span class="p">({</span><span class="nx">model</span><span class="o">:</span> <span class="nx">todo</span><span class="p">});</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#todo-list&quot;</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">view</span><span class="p">.</span><span class="nx">render</span><span class="p">().</span><span class="nx">el</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>Add all items in the <strong>Todos</strong> collection at once.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">addAll</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="nx">Todos</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">addOne</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>If you hit return in the main input field, create new <strong>Todo</strong> model,
-persisting it to <em>localStorage</em>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">createOnEnter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
-      <span class="k">if</span> <span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">keyCode</span> <span class="o">!=</span> <span class="mi">13</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
-      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">())</span> <span class="k">return</span><span class="p">;</span>
-
-      <span class="nx">Todos</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">title</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">()});</span>
-      <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">val</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
-    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>Clear all done todo items, destroying their models.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">clearCompleted</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
-      <span class="nx">_</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="nx">Todos</span><span class="p">.</span><span class="nx">done</span><span class="p">(),</span> <span class="s1">&#39;destroy&#39;</span><span class="p">);</span>
-      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
-    <span class="p">},</span>
-
-    <span class="nx">toggleAllComplete</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
-      <span class="kd">var</span> <span class="nx">done</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">allCheckbox</span><span class="p">.</span><span class="nx">checked</span><span class="p">;</span>
-      <span class="nx">Todos</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span> <span class="nx">todo</span><span class="p">.</span><span class="nx">save</span><span class="p">({</span><span class="s1">&#39;done&#39;</span><span class="o">:</span> <span class="nx">done</span><span class="p">});</span> <span class="p">});</span>
-    <span class="p">}</span>
-
-  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>Finally, we kick things off by creating the <strong>App</strong>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">App</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AppView</span><span class="p">;</span>
-
-<span class="p">});</span>
-
-</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 
\ No newline at end of file
+loading any preexisting todos that might be saved in <em>localStorage</em>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    initialize: <span class="keyword">function</span>() {
+
+      <span class="keyword">this</span>.input = <span class="keyword">this</span>.$(<span class="string">"#new-todo"</span>);
+      <span class="keyword">this</span>.allCheckbox = <span class="keyword">this</span>.$(<span class="string">"#toggle-all"</span>)[<span class="number">0</span>];
+
+      <span class="keyword">this</span>.listenTo(Todos, <span class="string">'add'</span>, <span class="keyword">this</span>.addOne);
+      <span class="keyword">this</span>.listenTo(Todos, <span class="string">'reset'</span>, <span class="keyword">this</span>.addAll);
+      <span class="keyword">this</span>.listenTo(Todos, <span class="string">'all'</span>, <span class="keyword">this</span>.render);
+
+      <span class="keyword">this</span>.footer = <span class="keyword">this</span>.$(<span class="string">'footer'</span>);
+      <span class="keyword">this</span>.main = $(<span class="string">'#main'</span>);
+
+      Todos.fetch();
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-33">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-33">&#182;</a>
+              </div>
+              <p>Re-rendering the App just means refreshing the statistics -- the rest
+of the app doesn&#39;t change.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    render: <span class="keyword">function</span>() {
+      <span class="keyword">var</span> done = Todos.done().length;
+      <span class="keyword">var</span> remaining = Todos.remaining().length;
+
+      <span class="keyword">if</span> (Todos.length) {
+        <span class="keyword">this</span>.main.show();
+        <span class="keyword">this</span>.footer.show();
+        <span class="keyword">this</span>.footer.html(<span class="keyword">this</span>.statsTemplate({done: done, remaining: remaining}));
+      } <span class="keyword">else</span> {
+        <span class="keyword">this</span>.main.hide();
+        <span class="keyword">this</span>.footer.hide();
+      }
+
+      <span class="keyword">this</span>.allCheckbox.checked = !remaining;
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-34">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-34">&#182;</a>
+              </div>
+              <p>Add a single todo item to the list by creating a view for it, and
+appending its element to the <code>&lt;ul&gt;</code>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    addOne: <span class="keyword">function</span>(todo) {
+      <span class="keyword">var</span> view = <span class="keyword">new</span> TodoView({model: todo});
+      <span class="keyword">this</span>.$(<span class="string">"#todo-list"</span>).append(view.render().el);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-35">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-35">&#182;</a>
+              </div>
+              <p>Add all items in the <strong>Todos</strong> collection at once.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    addAll: <span class="keyword">function</span>() {
+      Todos.each(<span class="keyword">this</span>.addOne, <span class="keyword">this</span>);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-36">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-36">&#182;</a>
+              </div>
+              <p>If you hit return in the main input field, create new <strong>Todo</strong> model,
+persisting it to <em>localStorage</em>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    createOnEnter: <span class="keyword">function</span>(e) {
+      <span class="keyword">if</span> (e.keyCode != <span class="number">13</span>) <span class="keyword">return</span>;
+      <span class="keyword">if</span> (!<span class="keyword">this</span>.input.val()) <span class="keyword">return</span>;
+
+      Todos.create({title: <span class="keyword">this</span>.input.val()});
+      <span class="keyword">this</span>.input.val(<span class="string">''</span>);
+    },</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-37">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-37">&#182;</a>
+              </div>
+              <p>Clear all done todo items, destroying their models.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>    clearCompleted: <span class="keyword">function</span>() {
+      _.invoke(Todos.done(), <span class="string">'destroy'</span>);
+      <span class="keyword">return</span> <span class="literal">false</span>;
+    },
+
+    toggleAllComplete: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
+      <span class="keyword">var</span> done = <span class="keyword">this</span>.allCheckbox.checked;
+      Todos.each(<span class="function"><span class="keyword">function</span> <span class="params">(todo)</span> {</span> todo.save({<span class="string">'done'</span>: done}); });
+    }
+
+  });</pre></div></div>
+            
+        </li>
+        
+        
+        <li id="section-38">
+            <div class="annotation">
+              
+              <div class="pilwrap ">
+                <a class="pilcrow" href="#section-38">&#182;</a>
+              </div>
+              <p>Finally, we kick things off by creating the <strong>App</strong>.
+</p>
+
+            </div>
+            
+            <div class="content"><div class='highlight'><pre>  <span class="keyword">var</span> App = <span class="keyword">new</span> AppView;
+
+});</pre></div></div>
+            
+        </li>
+        
+    </ul>
+  </div>
+</body>
+</html></div></li>
 <li>public/components/backbone/examples/backbone-localstorage.js<div>diff --git a/public/components/backbone/examples/backbone-localstorage.js b/public/components/backbone/examples/backbone-localstorage.js
deleted file mode 100644
index c71f598..0000000
--- a/public/components/backbone/examples/backbone-localstorage.js
+++ /dev/null
@@ -1,136 +0,0 @@
-/**
- * Backbone localStorage Adapter
- * https://github.com/jeromegn/Backbone.localStorage
- */
-
-(function() {
-// A simple module to replace `Backbone.sync` with *localStorage*-based
-// persistence. Models are given GUIDS, and saved into a JSON object. Simple
-// as that.
-
-// Hold reference to Underscore.js and Backbone.js in the closure in order
-// to make things work even if they are removed from the global namespace
-var _ = this._;
-var Backbone = this.Backbone;
-
-// Generate four random hex digits.
-function S4() {
-   return (((1+Math.random())*0x10000)|0).toString(16).substring(1);
-};
-
-// Generate a pseudo-GUID by concatenating random hexadecimal.
-function guid() {
-   return (S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4());
-};
-
-// Our Store is represented by a single JS object in *localStorage*. Create it
-// with a meaningful name, like the name you'd give a table.
-// window.Store is deprectated, use Backbone.LocalStorage instead
-Backbone.LocalStorage = window.Store = function(name) {
-  this.name = name;
-  var store = this.localStorage().getItem(this.name);
-  this.records = (store && store.split(",")) || [];
-};
-
-_.extend(Backbone.LocalStorage.prototype, {
-
-  // Save the current state of the **Store** to *localStorage*.
-  save: function() {
-    this.localStorage().setItem(this.name, this.records.join(","));
-  },
-
-  // Add a model, giving it a (hopefully)-unique GUID, if it doesn't already
-  // have an id of it's own.
-  create: function(model) {
-    if (!model.id) {
-        model.id = guid();
-        model.set(model.idAttribute, model.id);
-    }
-    this.localStorage().setItem(this.name+"-"+model.id, JSON.stringify(model));
-    this.records.push(model.id.toString());
-    this.save();
-    return model.toJSON();
-  },
-
-  // Update a model by replacing its copy in `this.data`.
-  update: function(model) {
-    this.localStorage().setItem(this.name+"-"+model.id, JSON.stringify(model));
-    if (!_.include(this.records, model.id.toString())) this.records.push(model.id.toString()); this.save();
-    return model.toJSON();
-  },
-
-  // Retrieve a model from `this.data` by id.
-  find: function(model) {
-    return JSON.parse(this.localStorage().getItem(this.name+"-"+model.id));
-  },
-
-  // Return the array of all models currently in storage.
-  findAll: function() {
-    return _(this.records).chain()
-        .map(function(id){return JSON.parse(this.localStorage().getItem(this.name+"-"+id));}, this)
-        .compact()
-        .value();
-  },
-
-  // Delete a model from `this.data`, returning it.
-  destroy: function(model) {
-    this.localStorage().removeItem(this.name+"-"+model.id);
-    this.records = _.reject(this.records, function(record_id){return record_id == model.id.toString();});
-    this.save();
-    return model;
-  },
-
-  localStorage: function() {
-      return localStorage;
-  }
-
-});
-
-// localSync delegate to the model or collection's
-// *localStorage* property, which should be an instance of `Store`.
-// window.Store.sync and Backbone.localSync is deprectated, use Backbone.LocalStorage.sync instead
-Backbone.LocalStorage.sync = window.Store.sync = Backbone.localSync = function(method, model, options, error) {
-  var store = model.localStorage || model.collection.localStorage;
-
-  // Backwards compatibility with Backbone <= 0.3.3
-  if (typeof options == 'function') {
-    options = {
-      success: options,
-      error: error
-    };
-  }
-
-  var resp;
-
-  switch (method) {
-    case "read":    resp = model.id != undefined ? store.find(model) : store.findAll(); break;
-    case "create":  resp = store.create(model);                            break;
-    case "update":  resp = store.update(model);                            break;
-    case "delete":  resp = store.destroy(model);                           break;
-  }
-
-  if (resp) {
-    options.success(model, resp, options);
-  } else {
-    options.error(model, "Record not found", options);
-  }
-};
-
-Backbone.ajaxSync = Backbone.sync;
-
-Backbone.getSyncMethod = function(model) {
-	if(model.localStorage || (model.collection && model.collection.localStorage))
-	{
-		return Backbone.localSync;
-	}
-
-	return Backbone.ajaxSync;
-};
-
-// Override 'Backbone.sync' to default to localSync,
-// the original 'Backbone.sync' is still available in 'Backbone.ajaxSync'
-Backbone.sync = function(method, model, options, error) {
-	return Backbone.getSyncMethod(model).apply(this, [method, model, options, error]);
-};
-
-})();</div></li>
 <li>public/components/backbone/examples/backbone.localStorage.js<div>diff --git a/public/components/backbone/examples/backbone.localStorage.js b/public/components/backbone/examples/backbone.localStorage.js
new file mode 100644
index 0000000..121399d
--- /dev/null
+++ b/public/components/backbone/examples/backbone.localStorage.js
@@ -0,0 +1,184 @@
+/**
+ * Backbone localStorage Adapter
+ * Version 1.1.0
+ *
+ * https://github.com/jeromegn/Backbone.localStorage
+ */
+(function (root, factory) {
+   if (typeof define === "function" && define.amd) {
+      // AMD. Register as an anonymous module.
+      define(["underscore","backbone"], function(_, Backbone) {
+        // Use global variables if the locals are undefined.
+        return factory(_ || root._, Backbone || root.Backbone);
+      });
+   } else {
+      // RequireJS isn't being used. Assume underscore and backbone are loaded in <script> tags
+      factory(_, Backbone);
+   }
+}(this, function(_, Backbone) {
+// A simple module to replace `Backbone.sync` with *localStorage*-based
+// persistence. Models are given GUIDS, and saved into a JSON object. Simple
+// as that.
+
+// Hold reference to Underscore.js and Backbone.js in the closure in order
+// to make things work even if they are removed from the global namespace
+
+// Generate four random hex digits.
+function S4() {
+   return (((1+Math.random())*0x10000)|0).toString(16).substring(1);
+};
+
+// Generate a pseudo-GUID by concatenating random hexadecimal.
+function guid() {
+   return (S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4());
+};
+
+// Our Store is represented by a single JS object in *localStorage*. Create it
+// with a meaningful name, like the name you'd give a table.
+// window.Store is deprectated, use Backbone.LocalStorage instead
+Backbone.LocalStorage = window.Store = function(name) {
+  this.name = name;
+  var store = this.localStorage().getItem(this.name);
+  this.records = (store && store.split(",")) || [];
+};
+
+_.extend(Backbone.LocalStorage.prototype, {
+
+  // Save the current state of the **Store** to *localStorage*.
+  save: function() {
+    this.localStorage().setItem(this.name, this.records.join(","));
+  },
+
+  // Add a model, giving it a (hopefully)-unique GUID, if it doesn't already
+  // have an id of it's own.
+  create: function(model) {
+    if (!model.id) {
+      model.id = guid();
+      model.set(model.idAttribute, model.id);
+    }
+    this.localStorage().setItem(this.name+"-"+model.id, JSON.stringify(model));
+    this.records.push(model.id.toString());
+    this.save();
+    return this.find(model);
+  },
+
+  // Update a model by replacing its copy in `this.data`.
+  update: function(model) {
+    this.localStorage().setItem(this.name+"-"+model.id, JSON.stringify(model));
+    if (!_.include(this.records, model.id.toString()))
+      this.records.push(model.id.toString()); this.save();
+    return this.find(model);
+  },
+
+  // Retrieve a model from `this.data` by id.
+  find: function(model) {
+    return this.jsonData(this.localStorage().getItem(this.name+"-"+model.id));
+  },
+
+  // Return the array of all models currently in storage.
+  findAll: function() {
+    return _(this.records).chain()
+      .map(function(id){
+        return this.jsonData(this.localStorage().getItem(this.name+"-"+id));
+      }, this)
+      .compact()
+      .value();
+  },
+
+  // Delete a model from `this.data`, returning it.
+  destroy: function(model) {
+    if (model.isNew())
+      return false
+    this.localStorage().removeItem(this.name+"-"+model.id);
+    this.records = _.reject(this.records, function(id){
+      return id === model.id.toString();
+    });
+    this.save();
+    return model;
+  },
+
+  localStorage: function() {
+    return localStorage;
+  },
+
+  // fix for "illegal access" error on Android when JSON.parse is passed null
+  jsonData: function (data) {
+      return data && JSON.parse(data);
+  }
+
+});
+
+// localSync delegate to the model or collection's
+// *localStorage* property, which should be an instance of `Store`.
+// window.Store.sync and Backbone.localSync is deprectated, use Backbone.LocalStorage.sync instead
+Backbone.LocalStorage.sync = window.Store.sync = Backbone.localSync = function(method, model, options) {
+  var store = model.localStorage || model.collection.localStorage;
+
+  var resp, errorMessage, syncDfd = $.Deferred && $.Deferred(); //If $ is having Deferred - use it.
+
+  try {
+
+    switch (method) {
+      case "read":
+        resp = model.id != undefined ? store.find(model) : store.findAll();
+        break;
+      case "create":
+        resp = store.create(model);
+        break;
+      case "update":
+        resp = store.update(model);
+        break;
+      case "delete":
+        resp = store.destroy(model);
+        break;
+    }
+
+  } catch(error) {
+    if (error.code === DOMException.QUOTA_EXCEEDED_ERR && window.localStorage.length === 0)
+      errorMessage = "Private browsing is unsupported";
+    else
+      errorMessage = error.message;
+  }
+
+  if (resp) {
+    model.trigger("sync", model, resp, options);
+    if (options && options.success)
+      options.success(resp);
+    if (syncDfd)
+      syncDfd.resolve(resp);
+
+  } else {
+    errorMessage = errorMessage ? errorMessage
+                                : "Record Not Found";
+
+    if (options && options.error)
+      options.error(errorMessage);
+    if (syncDfd)
+      syncDfd.reject(errorMessage);
+  }
+
+  // add compatibility with $.ajax
+  // always execute callback for success and error
+  if (options && options.complete) options.complete(resp);
+
+  return syncDfd && syncDfd.promise();
+};
+
+Backbone.ajaxSync = Backbone.sync;
+
+Backbone.getSyncMethod = function(model) {
+  if(model.localStorage || (model.collection && model.collection.localStorage)) {
+    return Backbone.localSync;
+  }
+
+  return Backbone.ajaxSync;
+};
+
+// Override 'Backbone.sync' to default to localSync,
+// the original 'Backbone.sync' is still available in 'Backbone.ajaxSync'
+Backbone.sync = function(method, model, options) {
+  return Backbone.getSyncMethod(model).apply(this, [method, model, options]);
+};
+
+return Backbone.LocalStorage;
+}));</div></li>
 <li>public/components/backbone/examples/todos/index.html<div>diff --git a/public/components/backbone/examples/todos/index.html b/public/components/backbone/examples/todos/index.html
index ee65310..6f77878 100644
--- a/public/components/backbone/examples/todos/index.html
+++ b/public/components/backbone/examples/todos/index.html
@@ -44,7 +44,7 @@
   <script src="../../test/vendor/jquery.js"></script>
   <script src="../../test/vendor/underscore.js"></script>
   <script src="../../backbone.js"></script>
-  <script src="../backbone-localstorage.js"></script>
+  <script src="../backbone.localStorage.js"></script>
   <script src="todos.js"></script>
 
   <!-- Templates --></div></li>
 <li>public/components/backbone/examples/todos/todos.js<div>diff --git a/public/components/backbone/examples/todos/todos.js b/public/components/backbone/examples/todos/todos.js
index fd82325..fc07c28 100644
--- a/public/components/backbone/examples/todos/todos.js
+++ b/public/components/backbone/examples/todos/todos.js
@@ -21,13 +21,6 @@ $(function(){
       };
     },
 
-    // Ensure that each todo created has `title`.
-    initialize: function() {
-      if (!this.get("title")) {
-        this.set({"title": this.defaults().title});
-      }
-    },
-
     // Toggle the `done` state of this todo item.
     toggle: function() {
       this.save({done: !this.get("done")});
@@ -50,7 +43,7 @@ $(function(){
 
     // Filter down the list of all todo items that are finished.
     done: function() {
-      return this.filter(function(todo){ return todo.get('done'); });
+      return this.where({done: true});
     },
 
     // Filter down the list to only todo items that are still not finished.
@@ -66,9 +59,7 @@ $(function(){
     },
 
     // Todos are sorted by their original insertion order.
-    comparator: function(todo) {
-      return todo.get('order');
-    }
+    comparator: 'order'
 
   });
 </div></li>
 <li>public/components/backbone/index.html<div>diff --git a/public/components/backbone/index.html b/public/components/backbone/index.html
index ef20545..086792b 100644
--- a/public/components/backbone/index.html
+++ b/public/components/backbone/index.html
@@ -151,6 +151,9 @@
     a img {
       border: 0;
     }
+    a.travis-badge {
+      display: block;
+    }
     h1, h2, h3, h4, h5, h6 {
       padding-top: 20px;
     }
@@ -263,6 +266,7 @@
           padding-bottom: 25px;
         }
         td.text {
+          line-height: 12px;
           padding: 0;
           position: absolute;
           left: 0;
@@ -282,7 +286,7 @@
   <div id="sidebar" class="interface">
 
     <a class="toc_title" href="#">
-      Backbone.js <span class="version">(0.9.10)</span>
+      Backbone.js <span class="version">(1.0.0)</span>
     </a>
     <ul class="toc_section">
       <li>&raquo; <a href="http://github.com/documentcloud/backbone">GitHub Repository</a></li>
@@ -307,6 +311,7 @@
       <li>– <a href="#Events-once">once</a></li>
       <li>– <a href="#Events-listenTo">listenTo</a></li>
       <li>– <a href="#Events-stopListening">stopListening</a></li>
+      <li>– <a href="#Events-listenToOnce">listenToOnce</a></li>
       <li>- <a href="#Events-catalog"><b>Catalog of Built-in Events</b></a></li>
     </ul>
 
@@ -333,7 +338,10 @@
       <li>– <a href="#Model-fetch">fetch</a></li>
       <li>– <a href="#Model-save">save</a></li>
       <li>– <a href="#Model-destroy">destroy</a></li>
+      <li>– <a href="#Model-Underscore-Methods"><b>Underscore Methods (6)</b></a></li>
       <li>– <a href="#Model-validate">validate</a></li>
+      <li>– <a href="#Model-validationError">validationError</a></li>
+      <li>– <a href="#Model-isValid">isValid</a></li>
       <li>– <a href="#Model-url">url</a></li>
       <li>– <a href="#Model-urlRoot">urlRoot</a></li>
       <li>– <a href="#Model-parse">parse</a></li>
@@ -359,18 +367,20 @@
       <li>– <a href="#Collection-add">add</a></li>
       <li>– <a href="#Collection-remove">remove</a></li>
       <li>– <a href="#Collection-reset">reset</a></li>
-      <li>– <a href="#Collection-update">update</a></li>
+      <li>– <a href="#Collection-set">set</a></li>
       <li>– <a href="#Collection-get">get</a></li>
       <li>– <a href="#Collection-at">at</a></li>
       <li>– <a href="#Collection-push">push</a></li>
       <li>– <a href="#Collection-pop">pop</a></li>
       <li>– <a href="#Collection-unshift">unshift</a></li>
       <li>– <a href="#Collection-shift">shift</a></li>
+      <li>– <a href="#Collection-slice">slice</a></li>
       <li>– <a href="#Collection-length">length</a></li>
       <li>– <a href="#Collection-comparator">comparator</a></li>
       <li>– <a href="#Collection-sort">sort</a></li>
       <li>– <a href="#Collection-pluck">pluck</a></li>
       <li>– <a href="#Collection-where">where</a></li>
+      <li>– <a href="#Collection-findWhere">findWhere</a></li>
       <li>– <a href="#Collection-url">url</a></li>
       <li>– <a href="#Collection-parse">parse</a></li>
       <li>– <a href="#Collection-clone">clone</a></li>
@@ -416,7 +426,7 @@
       <li>– <a href="#View-$el">$el</a></li>
       <li>– <a href="#View-setElement">setElement</a></li>
       <li>– <a href="#View-attributes">attributes</a></li>
-      <li>– <a href="#View-dollar">$ (jQuery or Zepto)</a></li>
+      <li>– <a href="#View-dollar">$ (jQuery)</a></li>
       <li>– <a href="#View-render">render</a></li>
       <li>– <a href="#View-remove">remove</a></li>
       <li>– <a href="#View-delegateEvents">delegateEvents</a></li>
@@ -441,6 +451,7 @@
       <li>– <a href="#examples-rdio">Rdio</a></li>
       <li>– <a href="#examples-linkedin">LinkedIn Mobile</a></li>
       <li>– <a href="#examples-hulu">Hulu</a></li>
+      <li>– <a href="#examples-quartz">Quartz</a></li>
       <li>– <a href="#examples-flow">Flow</a></li>
       <li>– <a href="#examples-gilt">Gilt Groupe</a></li>
       <li>– <a href="#examples-newsblur">NewsBlur</a></li>
@@ -475,7 +486,6 @@
       <li>– <a href="#examples-salon">Salon.io</a></li>
       <li>– <a href="#examples-tilemill">TileMill</a></li>
       <li>– <a href="#examples-blossom">Blossom</a></li>
-      <li>– <a href="#examples-decide">Decide</a></li>
       <li>– <a href="#examples-trello">Trello</a></li>
       <li>– <a href="#examples-tzigla">Tzigla</a></li>
     </ul>
@@ -547,28 +557,30 @@
 
     <table>
       <tr>
-        <td><a class="punch" href="backbone.js">Development Version (0.9.10)</a></td>
-        <td class="text"><i>56kb, Full source, lots of comments</i></td>
+        <td><a class="punch" href="backbone.js">Development Version (1.0.0)</a></td>
+        <td class="text"><i>58kb, Full source, tons of comments</i></td>
       </tr>
       <tr>
-        <td><a class="punch" href="backbone-min.js">Production Version (0.9.10)</a></td>
-        <td class="text"><i>6.3kb, Packed and gzipped</i></td>
+        <td><a class="punch" href="backbone-min.js">Production Version (1.0.0)</a></td>
+        <td class="text" style="line-height: 16px;">
+          <i>7.1kb, Packed and gzipped</i><br />
+          <small>(<a href="backbone-min.map">Source Map</a>)</small>
+        </td>
       </tr>
       <tr>
         <td><a class="punch" href="https://raw.github.com/documentcloud/backbone/master/backbone.js">Edge Version (master)</a></td>
         <td>
           <i>Unreleased, use at your own risk</i>
-          <a href="https://travis-ci.org/documentcloud/backbone">
-            <img width="89" height="13" src="https://travis-ci.org/documentcloud/backbone.png" />
+          <a class="travis-badge" href="https://travis-ci.org/documentcloud/backbone">
+            <img src="https://travis-ci.org/documentcloud/backbone.png" />
           </a>
         </td>
       </tr>
     </table>
 
     <p>
-      Backbone's only hard dependency is either
-      <a href="http://underscorejs.org/">Underscore.js</a> <small>( >= 1.4.3)</small> or
-      <a href="http://lodash.com">Lo-Dash</a>.
+      Backbone's only hard dependency is
+      <a href="http://underscorejs.org/">Underscore.js</a> <small>( >= 1.4.3)</small>.
       For RESTful persistence, history support via <a href="#Router">Backbone.Router</a>
       and DOM manipulation with <a href="#View">Backbone.View</a>, include
       <a href="https://github.com/douglascrockford/JSON-js">json2.js</a>, and either
@@ -611,58 +623,42 @@
       to execute them.
     </p>
 
-    <h2 id="upgrading">Upgrading to 0.9.10</h2>
-
-    <h2>Upgrading to 0.9.10</h2>
+    <h2 id="upgrading">Upgrading to 1.0</h2>
 
     <p>
-      Backbone <b>0.9.10</b> should be considered as a release candidate
-      for an upcoming <b>1.0</b>. If you're upgrading from a previous version,
-      be sure to check the
-      <a href="#changelog">change log</a>. In brief, a few of the larger changes
-      are:
+      Backbone <b>1.0</b> should be a fairly painless upgrade from the <b>0.9</b>
+      series. If you're upgrading from an older version, be sure to check out the
+      <a href="#changelog">change log</a>. In brief, a few of the larger breaking
+      changes are:
     </p>
 
     <ul>
       <li>
-        Most importantly, Backbone events have two new methods:
-        <a href="#Events-listenTo">listenTo</a> and
-        <a href="#Events-stopListening">stopListening</a>. These are an
-        inversion-of-control flavor of the usual <tt>on</tt> and <tt>off</tt>,
-        and make it a little easier to clean up <i>all</i> events
-        that an object is listening to on other objects. When you destroy Views
-        with <a href="#View-remove">view.remove()</a>, this will now be done
-        automatically. Note that the usual rules about programming in a garbage
-        collected language still apply.
-      </li>
-      <li>
-        HTTP <tt>PATCH</tt> support, via <tt>model.save(attrs, {patch: true})</tt>,
-        if you'd like to send only partial updates to the server.
+        If you want to smartly update the contents of a Collection,
+        adding new models, removing missing ones, and merging those already present,
+        you now call <a href="#Collection-set">set</a> (previously named "update"),
+        a similar operation to calling <tt>set</tt> on a Model. This is now the
+        default when you call <a href="#Collection-fetch">fetch</a> on a collection.
+        To get the old behavior, pass <tt>{reset: true}</tt>.
       </li>
       <li>
-        An <a href="#Collection-update">update</a> method was added to Collection,
-        which should make it easier to perform "smart" syncing updates with the
-        server, where models are added or removed, and updated attributes are merged
-        as appropriate. If you were previously using <br />
-        <tt>collection.fetch({add: true})</tt>,
-        try <a href="#Collection-update">update</a> instead.
+        If you have characters in your URL segments that require URL encoding,
+        Backbone will now decode them for you (normalizing the behavior
+        cross-browser) before your route handlers receive them as arguments.
       </li>
       <li>
-        Backbone events now support <a href="#Events-once"</a>once</a>.
+        In <b>0.9.x</b>, Backbone events gained two new methods:
+        <a href="#Events-listenTo">listenTo</a> and
+        <a href="#Events-stopListening">stopListening</a>, which make it easier
+        to create Views that have all of their observers unbound when you
+        want to <a href="#View-remove">remove</a> the view.
       </li>
       <li>
         Model validation is now only enforced by default in
-        <tt>Model#save</tt> and no longer enforced by default upon
-        construction or in <tt>Model#set</tt>, unless the <tt>{validate:true}</tt>
-        option is passed.
-      </li>
-      <li>
-        Passing <tt>{silent:true}</tt> on change will no longer delay individual
-        <tt>"change:attr"</tt> events, instead they are silenced entirely.
-      </li>
-      <li>
-        The <tt>Model#change</tt> method has been removed, as delayed attribute
-        changes as no longer available.
+        <a href="#Model-save">save</a> &mdash; not in
+        <a href="#Model-set">set</a> unless the <tt>{validate:true}</tt>
+        option is passed. Model validation now fires an <tt>"invalid"</tt> event instead of
+        <tt>"error"</tt>.
       </li>
     </ul>
 
@@ -814,6 +810,13 @@ view.stopListening();
 view.stopListening(model);
 </pre>
 
+    <p id="Events-listenToOnce">
+      <b class="header">listenToOnce</b><code>object.listenToOnce(other, event, callback)</code>
+      <br />
+      Just like <a href="#Events-listenTo">listenTo</a>, but causes the bound
+      callback to only fire once before being removed.
+    </p>
+
     <p id="Events-catalog">
       <b class="header">Catalog of Events</b>
       <br />
@@ -953,6 +956,19 @@ new Book({
       you to replace the actual constructor function for your model.
     </p>
 
+<pre>
+var Library = Backbone.Model.extend({
+  constructor: function() {
+    this.books = new Books();
+    Backbone.Model.apply(this, arguments);
+  },
+  parse: function(data, options) {
+    this.books.reset(data.books);
+    return data.library;
+  }
+});
+</pre>
+
     <p>
       If you pass a <tt>{collection: ...}</tt> as the <b>options</b>, the model
       gains a <tt>collection</tt> property that will be used to indicate which
@@ -961,6 +977,12 @@ new Book({
       otherwise added automatically when you first add a model to a collection.
     </p>
 
+    <p>
+      If <tt>{parse: true}</tt> is passed as an <b>option</b>, the <b>attributes</b>
+      will first be converted by <a href="#Model-parse">parse</a> before being
+      <a href="#Model-set">set</a> on the model.
+    </p>
+
     <p id="Model-get">
       <b class="header">get</b><code>model.get(attribute)</code>
       <br />
@@ -985,16 +1007,6 @@ note.set({title: "March 20", content: "In his eyes she eclipses..."});
 book.set("title", "A Scandal in Bohemia");
 </pre>
 
-    <p>
-      If the model has a <a href="#Model-validate">validate</a> method,
-      it will be validated before the attributes are set, no changes will
-      occur if the validation fails, and <b>set</b> will return <tt>false</tt>.
-      Otherwise, <b>set</b> returns a reference to the model.
-      You may also pass an <tt>error</tt>
-      callback in the options, which will be invoked alongside the
-      <tt>"error"</tt> event, should validation fail.
-    </p>
-
     <p id="Model-escape">
       <b class="header">escape</b><code>model.escape(attribute)</code>
       <br />
@@ -1103,9 +1115,8 @@ alert("Cake id: " + cake.id);
       <br />
       The <b>changed</b> property is the internal hash containing all the attributes
       that have changed since the last <tt>"change"</tt> event was triggered.
-      Please do not update <b>changed</b> directly.  Its state is maintained internally
-      by <a href="#Model-set">set</a> and <a href="#Model-change">change</a>.
-      A copy of <b>changed</b> can be acquired from
+      Please do not update <b>changed</b> directly since its state is internally maintained
+      by <a href="#Model-set">set</a>.  A copy of <b>changed</b> can be acquired from
       <a href="#Model-changedAttributes">changedAttributes</a>.
     </p>
 
@@ -1246,10 +1257,8 @@ book.save({author: "Teddy"});
       <b>save</b> accepts <tt>success</tt> and <tt>error</tt> callbacks in the
       options hash, which are passed <tt>(model, response, options)</tt> and
       <tt>(model, xhr, options)</tt> as arguments, respectively.
-      The <tt>error</tt> callback will also be invoked if the model has a
-      <tt>validate</tt> method, and validation fails. If a server-side
-      validation fails, return a non-<tt>200</tt> HTTP response code, along with
-      an error response in text or JSON.
+      If a server-side validation fails, return a non-<tt>200</tt>
+      HTTP response code, along with an error response in text or JSON.
     </p>
 
 <pre>
@@ -1280,6 +1289,29 @@ book.destroy({success: function(model, response) {
 }});
 </pre>
 
+    <p id="Model-Underscore-Methods">
+      <b class="header">Underscore Methods (6)</b>
+      <br />
+      Backbone proxies to <b>Underscore.js</b> to provide 6 object functions
+      on <b>Backbone.Model</b>. They aren't all documented here, but
+      you can take a look at the Underscore documentation for the full details&hellip;
+    </p>
+
+    <ul class="small">
+      <li><a href="http://underscorejs.org/#keys">keys</a></li>
+      <li><a href="http://underscorejs.org/#values">values</a></li>
+      <li><a href="http://underscorejs.org/#pairs">pairs</a></li>
+      <li><a href="http://underscorejs.org/#invert">invert</a></li>
+      <li><a href="http://underscorejs.org/#pick">pick</a></li>
+      <li><a href="http://underscorejs.org/#omit">omit</a></li>
+    </ul>
+
+<pre>
+user.pick('first_name', 'last_name', 'email');
+
+chapters.keys().join(', ');
+</pre>
+
     <p id="Model-validate">
       <b class="header">validate</b><code>model.validate(attributes, options)</code>
       <br />
@@ -1293,9 +1325,11 @@ book.destroy({success: function(model, response) {
       if they are invalid, return an error of your choosing. It
       can be as simple as a string error message to be displayed, or a complete
       error object that describes the error programmatically. If <b>validate</b>
-      returns an error, <tt>set</tt> and <tt>save</tt> will not continue, and the
-      model attributes will not be modified.
-      Failed validations trigger an <tt>"error"</tt> event.
+      returns an error, <tt>save</tt> will not continue, and the
+      model attributes will not be modified on the server.
+      Failed validations trigger an <tt>"invalid"</tt> event, and set the
+      <tt>validationError</tt> property on the model with the value returned by
+      this method.
     </p>
 
 <pre class="runnable">
@@ -1311,28 +1345,54 @@ var one = new Chapter({
   title : "Chapter One: The Beginning"
 });
 
-one.on("error", function(model, error) {
+one.on("invalid", function(model, error) {
   alert(model.get("title") + " " + error);
 });
 
-one.set({
+one.save({
   start: 15,
   end:   10
 });
 </pre>
 
     <p>
-      <tt>"error"</tt> events are useful for providing coarse-grained error
-      messages at the model or collection level. An <tt>error</tt> callback can
-      can also be specified in the options, to be called alongside the error event:
+      <tt>"invalid"</tt> events are useful for providing coarse-grained error
+      messages at the model or collection level.
     </p>
 
-<pre>
-account.set({access: "unlimited"}, {
-  error: function(model, error) {
-    alert(error);
+    <p id="Model-validationError">
+      <b class="header">validationError</b><code>model.validationError</code>
+      <br />
+      The value returned by <a href="#Model-validate">validate</a> during the last failed validation.
+    </p>
+
+    <p id="Model-isValid">
+      <b class="header">isValid</b><code>model.isValid</code>
+      <br />
+      Run <a href="#Model-validate">validate</a> to check the model state.
+    </p>
+
+<pre class="runnable">
+var Chapter = Backbone.Model.extend({
+  validate: function(attrs, options) {
+    if (attrs.end &lt; attrs.start) {
+      return "can't end before it starts";
+    }
   }
 });
+
+var one = new Chapter({
+  title : "Chapter One: The Beginning"
+});
+
+one.set({
+  start: 15,
+  end:   10
+});
+
+if (!one.isValid()) {
+  alert(one.get("title") + " " + one.validationError);
+}
 </pre>
 
     <p id="Model-url">
@@ -1342,7 +1402,8 @@ account.set({access: "unlimited"}, {
       the server. If your models are located somewhere else, override this method
       with the correct logic. Generates URLs of the form: <tt>"[collection.url]/[id]"</tt>
       by default, but you may override by specifying an explicit <tt>urlRoot</tt>
-      if the model's collection shouldn't be taken into account.
+      if the model's collection shouldn't be taken into account. You can also
+      pass in the model's <tt>url</tt> as an option when instantiating it.
     </p>
 
     <p>
@@ -1373,7 +1434,7 @@ alert(solaris.url());
 </pre>
 
     <p id="Model-parse">
-      <b class="header">parse</b><code>model.parse(response)</code>
+      <b class="header">parse</b><code>model.parse(response, options)</code>
       <br />
       <b>parse</b> is called whenever a model's data is returned by the
       server, in <a href="#Model-fetch">fetch</a>, and <a href="#Model-save">save</a>.
@@ -1431,10 +1492,11 @@ book.on("change", function() {
     <p id="Model-changedAttributes">
       <b class="header">changedAttributes</b><code>model.changedAttributes([attributes])</code>
       <br />
-      Retrieve a hash of only the model's attributes that have changed. Optionally,
-      an external <b>attributes</b> hash can be passed in, returning
-      the attributes in that hash which differ from the model. This can be used
-      to figure out which portions of a view should be updated, or what calls
+      Retrieve a hash of only the model's attributes that have changed, or
+      <tt>false</tt> if there are none. Optionally, an external
+      <b>attributes</b> hash can be passed in, returning the attributes in that
+      hash which differ from the model. This can be used to figure out which
+      portions of a view should be updated, or what calls
       need to be made to sync the changes to the server.
     </p>
 
@@ -1507,6 +1569,25 @@ var Library = Backbone.Collection.extend({
 });
 </pre>
 
+    <p>
+      A collection can also contain polymorphic models by overriding this property
+      with a function that returns a model.
+    </p>
+
+<pre>
+var Library = Backbone.Collection.extend({
+
+  model: function(attrs, options) {
+    if (condition) {
+      return new PublicDocument(attrs, options);
+    } else {
+      return new PrivateDocument(attrs, options);
+    }
+  }
+
+});
+</pre>
+
     <p id="Collection-constructor">
       <b class="header">constructor / initialize</b><code>new Collection([models], [options])</code>
       <br />
@@ -1515,11 +1596,16 @@ var Library = Backbone.Collection.extend({
       may be included as an option. Passing <tt>false</tt> as the
       comparator option will prevent sorting. If you define an
       <b>initialize</b> function, it will be invoked when the collection is
-      created.
+      created. There are several options that, if provided, are attached to the
+      collection directly: <tt>url</tt>, <tt>model</tt> and <tt>comparator</tt>.
     </p>
 
 <pre>
 var tabs = new TabSet([tab1, tab2, tab3]);
+var spaces = new Backbone.Collection([], {
+  model: Space,
+  url: '/spaces'
+});
 </pre>
 
     <p id="Collection-models">
@@ -1574,9 +1660,9 @@ alert(JSON.stringify(collection));
       <li><a href="http://underscorejs.org/#find">find (detect)</a></li>
       <li><a href="http://underscorejs.org/#filter">filter (select)</a></li>
       <li><a href="http://underscorejs.org/#reject">reject</a></li>
-      <li><a href="http://underscorejs.org/#all">every (all)</a></li>
-      <li><a href="http://underscorejs.org/#any">some (any)</a></li>
-      <li><a href="http://underscorejs.org/#include">include (contains)</a></li>
+      <li><a href="http://underscorejs.org/#every">every (all)</a></li>
+      <li><a href="http://underscorejs.org/#some">some (any)</a></li>
+      <li><a href="http://underscorejs.org/#contains">contains (include)</a></li>
       <li><a href="http://underscorejs.org/#invoke">invoke</a></li>
       <li><a href="http://underscorejs.org/#max">max</a></li>
       <li><a href="http://underscorejs.org/#min">min</a></li>
@@ -1598,19 +1684,19 @@ alert(JSON.stringify(collection));
     </ul>
 
 <pre>
-Books.each(function(book) {
+books.each(function(book) {
   book.publish();
 });
 
-var titles = Books.map(function(book) {
+var titles = books.map(function(book) {
   return book.get("title");
 });
 
-var publishedBooks = Books.filter(function(book) {
+var publishedBooks = books.filter(function(book) {
   return book.get("published") === true;
 });
 
-var alphabetical = Books.sortBy(function(book) {
+var alphabetical = books.sortBy(function(book) {
   return book.author.get("name").toLowerCase();
 });
 </pre>
@@ -1651,10 +1737,9 @@ ships.add([
       <b class="header">remove</b><code>collection.remove(models, [options])</code>
       <br />
       Remove a model (or an array of models) from the collection. Fires a
-      <tt>"remove"</tt> event, which you can use <tt>silent</tt>
-      to suppress. If you're a callback listening to the <tt>"remove"</tt> event,
-      the index at which the model is being removed from the collection is available
-      as <tt>options.index</tt>.
+      <tt>"remove"</tt> event, which you can use <tt>silent</tt> to suppress.
+      The model's index before removal is available to listeners as
+      <tt>options.index</tt>.
     </p>
 
     <p id="Collection-reset">
@@ -1676,8 +1761,8 @@ ships.add([
 
 <pre>
 &lt;script&gt;
-  var Accounts = new Backbone.Collection;
-  Accounts.reset(&lt;%= @accounts.to_json %&gt;);
+  var accounts = new Backbone.Collection;
+  accounts.reset(&lt;%= @accounts.to_json %&gt;);
 &lt;/script&gt;
 </pre>
 
@@ -1686,10 +1771,10 @@ ships.add([
       will empty the entire collection.
     </p>
 
-    <p id="Collection-update">
-      <b class="header">update</b><code>collection.update(models, [options])</code>
+    <p id="Collection-set">
+      <b class="header">set</b><code>collection.set(models, [options])</code>
       <br />
-      The <b>update</b> method tries to peform a "smart" update of the collection
+      The <b>set</b> method tries to peform a "smart" update of the collection
       with the passed list of models. If a model in the list isn't yet in the
       collection it will be added; if the model is already in the collection
       its attributes will be merged; and if the collection contains any models that
@@ -1756,6 +1841,14 @@ var book = Library.get(110);
       <a href="#Collection-remove">remove</a>.
     </p>
 
+    <p id="Collection-slice">
+      <b class="header">slice</b><code>collection.slice(begin, end)</code>
+      <br />
+      Return a shallow copy of this collection's models, using the same options as
+      native
+      <a href="https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/slice">Array#slice</a>.
+    </p>
+
     <p id="Collection-length">
       <b class="header">length</b><code>collection.length</code>
       <br />
@@ -1864,6 +1957,13 @@ var musketeers = friends.where({job: "Musketeer"});
 alert(musketeers.length);
 </pre>
 
+    <p id="Collection-findWhere">
+      <b class="header">findWhere</b><code>collection.findWhere(attributes)</code>
+      <br />
+      Just like <a href="#Collection-where">where</a>, but directly returns only
+      the first model in the collection that matches the passed <b>attributes</b>.
+    </p>
+
     <p id="Collection-url">
       <b class="header">url</b><code>collection.url or collection.url()</code>
       <br />
@@ -1887,7 +1987,7 @@ var Notes = Backbone.Collection.extend({
 </pre>
 
     <p id="Collection-parse">
-      <b class="header">parse</b><code>collection.parse(response)</code>
+      <b class="header">parse</b><code>collection.parse(response, options)</code>
       <br />
       <b>parse</b> is called by Backbone whenever a collection's models are
       returned by the server, in <a href="#Collection-fetch">fetch</a>.
@@ -1937,10 +2037,10 @@ Backbone.sync = function(method, model) {
   alert(method + ": " + model.url);
 };
 
-var Accounts = new Backbone.Collection;
-Accounts.url = '/accounts';
+var accounts = new Backbone.Collection;
+accounts.url = '/accounts';
 
-Accounts.fetch();
+accounts.fetch();
 </pre>
 
     <p>
@@ -1972,9 +2072,9 @@ Accounts.fetch();
       Convenience to create a new instance of a model within a collection.
       Equivalent to instantiating a model with a hash of attributes,
       saving the model to the server, and adding the model to the set after being
-      successfully created. Returns
-      the model, or <tt>false</tt> if a validation error prevented the
-      model from being created. In order for this to work, you should set the
+      successfully created. Returns the new model. If client-side validation
+      failed, the model will be unsaved, with validation errors.
+      In order for this to work, you should set the
       <a href="#Collection-model">model</a> property of the collection.
       The <b>create</b> method can accept either an attributes hash or an
       existing, unsaved model object.
@@ -1993,9 +2093,9 @@ var Library = Backbone.Collection.extend({
   model: Book
 });
 
-var NYPL = new Library;
+var nypl = new Library;
 
-var othello = NYPL.create({
+var othello = nypl.create({
   title: "Othello",
   author: "William Shakespeare"
 });
@@ -2053,7 +2153,8 @@ var Workspace = Backbone.Router.extend({
     <p id="Router-routes">
       <b class="header">routes</b><code>router.routes</code>
       <br />
-      The routes hash maps URLs with parameters to functions on your router,
+      The routes hash maps URLs with parameters to functions on your router
+      (or just direct function definitions, if you prefer),
       similar to the <a href="#View">View</a>'s <a href="#View-delegateEvents">events hash</a>.
       Routes can contain parameter parts, <tt>:param</tt>, which match a single URL
       component between slashes; and splat parts <tt>*splat</tt>, which can match
@@ -2168,10 +2269,9 @@ app.navigate("help/troubleshooting", {trigger: true, replace: true});
 
     <p>
       <b>History</b> serves as a global router (per frame) to handle <tt>hashchange</tt>
-      events or <tt>pushState</tt>, match the appropriate route, and trigger callbacks. You shouldn't
-      ever have to create one of these yourself &mdash; you should use the reference
-      to <tt>Backbone.history</tt> that will be created for you automatically if you make use
-      of <a href="#Router">Routers</a> with <a href="#Router-routes">routes</a>.
+      events or <tt>pushState</tt>, match the appropriate route, and trigger callbacks.
+      You shouldn't ever have to create one of these yourself since <tt>Backbone.history</tt>
+      already contains one.
     </p>
 
     <p>
@@ -2241,7 +2341,7 @@ $(function(){
     <p>
       <b>Backbone.sync</b> is the function that Backbone calls every time it
       attempts to read or save a model to the server. By default, it uses
-      <tt>(jQuery/Zepto).ajax</tt> to make a RESTful JSON request and returns a
+      <tt>jQuery.ajax</tt> to make a RESTful JSON request and returns a
       <a href="http://api.jquery.com/jQuery.ajax/#jqXHR">jqXHR</a>. You can override
       it in order to use a different persistence strategy, such as WebSockets,
       XML transport, or Local Storage.
@@ -2456,7 +2556,7 @@ alert(item.el + ' ' + body.el);
     <p id="View-$el">
       <b class="header">$el</b><code>view.$el</code>
       <br />
-      A cached jQuery (or Zepto) object for the view's element. A handy
+      A cached jQuery object for the view's element. A handy
       reference instead of re-wrapping the DOM element all the time.
     </p>
 
@@ -2483,9 +2583,9 @@ listView.$el.append(itemView.el);
     </p>
 
     <p id="View-dollar">
-      <b class="header">$ (jQuery or Zepto)</b><code>view.$(selector)</code>
+      <b class="header">$ (jQuery)</b><code>view.$(selector)</code>
       <br />
-      If jQuery or Zepto is included on the page, each view has a
+      If jQuery is included on the page, each view has a
       <b>$</b> function that runs queries scoped within the view's element. If you use this
       scoped jQuery function, you don't have to use model ids as part of your query
       to pull out specific elements in a list, and can rely much more on HTML class
@@ -2666,12 +2766,10 @@ var model = localBackbone.Model.extend(...);
       that is bundled in the repository as Backbone example. If you're wondering
       where to get started with Backbone in general, take a moment to
       <a href="docs/todos.html">read through the annotated source</a>. The app uses a
-      <a href="docs/backbone-localstorage.html">LocalStorage adapter</a>
+      <a href="http://github.com/jeromegn/Backbone.localStorage">LocalStorage adapter</a>
       to transparently save all of your todos within your browser, instead of
       sending them to a server. Jérôme also has a version hosted at
-      <a href="http://localtodos.com/">localtodos.com</a> that uses a
-      <a href="http://github.com/jeromegn/backbone-mootools">MooTools-backed version of Backbone</a>
-      instead of jQuery.
+      <a href="http://localtodos.com/">localtodos.com</a>.
     </p>
 
     <div style="text-align: center;">
@@ -2776,6 +2874,26 @@ var model = localBackbone.Model.extend(...);
       </a>
     </div>
 
+    <h2 id="examples-quartz">Quartz</h2>
+
+    <p>
+      <a href="http://qz.com">Quartz</a> sees itself as a digitally native news
+      outlet for the new
+      global economy. Because Quartz believes in the future of open,
+      cross-platform web applications, they selected Backbone and Underscore
+      to fetch, sort, store, and display content from a custom WordPress
+      API. Although <a href="http://qz.com">qz.com</a> uses responsive design
+      for phone, tablet, and
+      desktop browsers, it also takes advantage of Backbone events and views
+      to render device-specific templates in some cases.
+    </p>
+
+    <div style="text-align: center;">
+      <a href="http://qz.com">
+        <img width="510" height="360" data-original="docs/images/quartz.jpg" alt="Quartz" class="example_retina" />
+      </a>
+    </div>
+
     <h2 id="examples-flow">Flow</h2>
 
     <p>
@@ -3157,17 +3275,17 @@ var model = localBackbone.Model.extend(...);
     <h2 id="examples-artsy">Art.sy</h2>
 
     <p>
-      <a href="http://art.sy">Art.sy</a> is a place to discover art you'll
+      <a href="http://artsy.net">Art.sy</a> is a place to discover art you'll
       love. Art.sy is built on Rails, using
       <a href="https://github.com/intridea/grape">Grape</a> to serve a robust
-      <a href="http://art.sy/api">JSON API</a>. The main site is a single page
+      <a href="http://artsy.net/api">JSON API</a>. The main site is a single page
       app written in Coffeescript and uses Backbone to provide structure around
       this API. An admin panel and partner CMS have also been extracted into
       their own API-consuming Backbone projects.
     </p>
 
     <div style="text-align: center;">
-      <a href="http://art.sy">
+      <a href="http://artsy.net">
         <img width="550" height="550" data-original="docs/images/artsy.png" alt="Art.sy" class="example_image" />
       </a>
     </div>
@@ -3417,25 +3535,6 @@ var model = localBackbone.Model.extend(...);
       </a>
     </div>
 
-    <h2 id="examples-decide">Decide</h2>
-
-    <p>
-      <a href="http://decide.com">Decide.com</a> helps people decide when to buy
-      consumer electronics. It relies heavily on Backbone.js to render and
-      update its Search Results Page. An "infinite scroll" feature takes
-      advantage of a SearchResults model containing a collection of
-      Product models to fetch more results and render them on the fly
-      with <a href="http://mustache.github.com">Mustache</a>. A SearchController keeps everything in sync and
-      maintains page state in the URL. Backbone also powers the user
-      accounts and settings management.
-    </p>
-
-    <div style="text-align: center;">
-      <a href="http://decide.com">
-        <img width="550" height="449" data-original="docs/images/decide.png" alt="Decide" class="example_image" />
-      </a>
-    </div>
-
     <h2 id="examples-trello">Trello</h2>
 
     <p>
@@ -3628,11 +3727,11 @@ var Mailbox = Backbone.Model.extend({
 
 });
 
-var Inbox = new Mailbox;
+var inbox = new Mailbox;
 
 // And then, when the Inbox is opened:
 
-Inbox.messages.fetch();
+inbox.messages.fetch();
 </pre>
 
     <p>
@@ -3686,10 +3785,10 @@ Inbox.messages.fetch();
 
 <pre>
 &lt;script&gt;
-  var Accounts = new Backbone.Collection;
-  Accounts.reset(&lt;%= @accounts.to_json %&gt;);
-  var Projects = new Backbone.Collection;
-  Projects.reset(&lt;%= @projects.to_json(:collaborators => true) %&gt;);
+  var accounts = new Backbone.Collection;
+  accounts.reset(&lt;%= @accounts.to_json %&gt;);
+  var projects = new Backbone.Collection;
+  projects.reset(&lt;%= @projects.to_json(:collaborators => true) %&gt;);
 &lt;/script&gt;
 </pre>
 
@@ -3823,6 +3922,40 @@ ActiveRecord::Base.include_root_in_json = false
 
     <h2 id="changelog">Change Log</h2>
 
+    <b class="header">1.0.0</b> &mdash; <small><i>March 20, 2013</i></small> &mdash; <a href="https://github.com/documentcloud/backbone/compare/0.9.10...1.0.0">Diff</a><br />
+    <ul style="margin-top: 5px;">
+      <li>
+        Renamed Collection's "update" to <a href="#Collection-set">set</a>, for
+        parallelism with the similar <tt>model.set()</tt>, and contrast with
+        <a href="#Collection-reset">reset</a>. It's now the default
+        updating mechanism after a <a href="#Collection-fetch">fetch</a>. If you'd
+        like to continue using "reset", pass <tt>{reset: true}</tt>.
+      </li>
+      <li>
+        Your route handlers will now receive their URL parameters pre-decoded.
+      </li>
+      <li>
+        Added <a href="#Events-listenToOnce">listenToOnce</a> as the analogue of
+        <a href="#Events-once">once</a>.
+      </li>
+      <li>
+        Added the <a href="#Collection-findWhere">findWhere</a> method to Collections,
+        similar to <a href="#Collection-where">where</a>.
+      </li>
+      <li>
+        Added the <tt>keys</tt>, <tt>values</tt>, <tt>pairs</tt>, <tt>invert</tt>,
+        <tt>pick</tt>, and <tt>omit</tt> Underscore.js methods to Backbone Models.
+      </li>
+      <li>
+        The routes in a Router's route map may now be function literals,
+        instead of references to methods, if you like.
+      </li>
+      <li>
+        <tt>url</tt> and <tt>urlRoot</tt> properties may now be passed as options
+        when instantiating a new Model.
+      </li>
+    </ul>
+
     <b class="header">0.9.10</b> &mdash; <small><i>Jan. 15, 2013</i></small> &mdash; <a href="https://github.com/documentcloud/backbone/compare/0.9.9...0.9.10">Diff</a><br />
     <ul style="margin-top: 5px;">
       <li>
@@ -3855,6 +3988,13 @@ ActiveRecord::Base.include_root_in_json = false
         Bug fix where an empty response from the server on save would not call
         the success function.
       </li>
+      <li>
+        <tt>parse</tt> now receives <tt>options</tt> as its second argument.
+      </li>
+      <li>
+        Model validation now fires <tt>invalid</tt> event instead of
+        <tt>error</tt>.
+      </li>
     </ul>
 
     <b class="header">0.9.9</b> &mdash; <small><i>Dec. 13, 2012</i></small> &mdash; <a href="https://github.com/documentcloud/backbone/compare/0.9.2...0.9.9">Diff</a> &mdash; <a href="http://htmlpreview.github.com/?https://raw.github.com/documentcloud/backbone/0.9.9/index.html">Docs</a><br /></div></li>
 <li>public/components/backbone/package.json<div>diff --git a/public/components/backbone/package.json b/public/components/backbone/package.json
index dbcde38..c379cd3 100644
--- a/public/components/backbone/package.json
+++ b/public/components/backbone/package.json
@@ -8,11 +8,13 @@
     "underscore"  : ">=1.4.3"
   },
   "devDependencies": {
-    "phantomjs": "0.2.2"
+    "phantomjs": "1.8.1-3",
+    "docco": "0.6.1",
+    "coffee-script": "1.6.1"
   },
   "scripts": {
-    "test": "phantomjs test/vendor/runner.js test/index.html?noglobals=true"
+    "test": "phantomjs test/vendor/runner.js test/index.html?noglobals=true && coffee test/model.coffee"
   },
   "main"          : "backbone.js",
-  "version"       : "0.9.10"
+  "version"       : "1.0.0"
 }</div></li>
 <li>public/components/backbone/test/collection.js<div>diff --git a/public/components/backbone/test/collection.js b/public/components/backbone/test/collection.js
index 64193fd..d068b39 100644
--- a/public/components/backbone/test/collection.js
+++ b/public/components/backbone/test/collection.js
@@ -62,30 +62,29 @@ $(document).ready(function() {
     strictEqual(collection.last().get('a'), 4);
   });
 
-  test("get", 5, function() {
+  test("get", 6, function() {
     equal(col.get(0), d);
+    equal(col.get(d.clone()), d);
     equal(col.get(2), b);
     equal(col.get({id: 1}), c);
     equal(col.get(c.clone()), c);
     equal(col.get(col.first().cid), col.first());
   });
 
-  test("get with non-default ids", 4, function() {
+  test("get with non-default ids", 5, function() {
     var col = new Backbone.Collection();
-    var MongoModel = Backbone.Model.extend({
-      idAttribute: '_id'
-    });
+    var MongoModel = Backbone.Model.extend({idAttribute: '_id'});
     var model = new MongoModel({_id: 100});
-    col.push(model);
+    col.add(model);
     equal(col.get(100), model);
-    model.set({_id: 101});
-    equal(col.get(101), model);
+    equal(col.get(model.cid), model);
+    equal(col.get(model), model);
+    equal(col.get(101), void 0);
 
-    var Col2 = Backbone.Collection.extend({ model: MongoModel });
-    var col2 = new Col2();
-    col2.push(model);
-    equal(col2.get({_id: 101}), model);
-    equal(col2.get(model.clone()), model);
+    var col2 = new Backbone.Collection();
+    col2.model = MongoModel;
+    col2.add(model.attributes);
+    equal(col2.get(model.clone()), col2.first());
   });
 
   test("update index when id changes", 3, function() {
@@ -226,6 +225,19 @@ $(document).ready(function() {
     equal(col.at(0).get('value'), 2);
   });
 
+  test("add with parse and merge", function() {
+    var Model = Backbone.Model.extend({
+      parse: function (data) {
+        return data.model;
+      }
+    });
+    var collection = new Backbone.Collection();
+    collection.model = Model;
+    collection.add({id: 1});
+    collection.add({model: {id: 1, name: 'Alf'}}, {parse: true, merge: true});
+    equal(collection.first().get('name'), 'Alf');
+  });
+
   test("add model to collection with sort()-style comparator", 3, function() {
     var col = new Backbone.Collection;
     col.comparator = function(a, b) {
@@ -362,9 +374,7 @@ $(document).ready(function() {
 
   test("model destroy removes from all collections", 3, function() {
     var e = new Backbone.Model({id: 5, title: 'Othello'});
-    e.sync = function(method, model, options) {
-      options.success(model, [], options);
-    };
+    e.sync = function(method, model, options) { options.success(); };
     var colE = new Backbone.Collection([e]);
     var colF = new Backbone.Collection([e]);
     e.destroy();
@@ -396,6 +406,15 @@ $(document).ready(function() {
     equal(this.syncArgs.options.parse, false);
   });
 
+  test("fetch with an error response triggers an error event", 1, function () {
+    var collection = new Backbone.Collection();
+    collection.on('error', function () {
+      ok(true);
+    });
+    collection.sync = function (method, model, options) { options.error(); };
+    collection.fetch();
+  });
+
   test("ensure fetch only parses once", 1, function() {
     var collection = new Backbone.Collection;
     var counter = 0;
@@ -405,7 +424,7 @@ $(document).ready(function() {
     };
     collection.url = '/test';
     collection.fetch();
-    this.syncArgs.options.success([]);
+    this.syncArgs.options.success();
     equal(counter, 1);
   });
 
@@ -419,7 +438,7 @@ $(document).ready(function() {
     equal(model.collection, collection);
   });
 
-  test("create with validate:true enforces validation", 1, function() {
+  test("create with validate:true enforces validation", 2, function() {
     var ValidatingModel = Backbone.Model.extend({
       validate: function(attrs) {
         return "fail";
@@ -429,6 +448,9 @@ $(document).ready(function() {
       model: ValidatingModel
     });
     var col = new ValidatingCollection();
+    col.on('invalid', function (collection, attrs, options) {
+      equal(options.validationError, 'fail');
+    });
     equal(col.create({"foo":"bar"}, {validate:true}), false);
   });
 
@@ -461,9 +483,10 @@ $(document).ready(function() {
     equal(JSON.stringify(col), '[{"id":3,"label":"a"},{"id":2,"label":"b"},{"id":1,"label":"c"},{"id":0,"label":"d"}]');
   });
 
-  test("where", 6, function() {
+  test("where and findWhere", 8, function() {
+    var model = new Backbone.Model({a: 1});
     var coll = new Backbone.Collection([
-      {a: 1},
+      model,
       {a: 1},
       {a: 1, b: 2},
       {a: 2, b: 2},
@@ -475,6 +498,8 @@ $(document).ready(function() {
     equal(coll.where({b: 1}).length, 0);
     equal(coll.where({b: 2}).length, 2);
     equal(coll.where({a: 1, b: 2}).length, 1);
+    equal(coll.findWhere({a: 1}), model);
+    equal(coll.findWhere({a: 4}), void 0);
   });
 
   test("Underscore methods", 13, function() {
@@ -484,10 +509,10 @@ $(document).ready(function() {
     equal(col.indexOf(b), 1);
     equal(col.size(), 4);
     equal(col.rest().length, 3);
-    ok(!_.include(col.rest()), a);
-    ok(!_.include(col.rest()), d);
+    ok(!_.include(col.rest(), a));
+    ok(_.include(col.rest(), d));
     ok(!col.isEmpty());
-    ok(!_.include(col.without(d)), d);
+    ok(!_.include(col.without(d), d));
     equal(col.max(function(model){ return model.id; }).id, 3);
     equal(col.min(function(model){ return model.id; }).id, 0);
     deepEqual(col.chain()
@@ -509,9 +534,9 @@ $(document).ready(function() {
     }), 1);
   });
 
-  test("reset", 10, function() {
+  test("reset", 12, function() {
     var resetCount = 0;
-    var models = col.models.slice();
+    var models = col.models;
     col.on('reset', function() { resetCount += 1; });
     col.reset([]);
     equal(resetCount, 1);
@@ -526,6 +551,22 @@ $(document).ready(function() {
     equal(col.length, 4);
     ok(col.last() !== d);
     ok(_.isEqual(col.last().attributes, d.attributes));
+    col.reset();
+    equal(col.length, 0);
+    equal(resetCount, 4);
+  });
+
+  test ("reset with different values", function(){
+    var col = new Backbone.Collection({id: 1});
+    col.reset({id: 1, a: 1});
+    equal(col.get(1).get('a'), 1);
+  });
+
+  test("same references in reset", function() {
+    var model = new Backbone.Model({id: 1});
+    var collection = new Backbone.Collection({id: 1});
+    collection.reset(model);
+    equal(collection.get(1), model);
   });
 
   test("reset passes caller options", 3, function() {
@@ -702,9 +743,7 @@ $(document).ready(function() {
   test("#1447 - create with wait adds model.", 1, function() {
     var collection = new Backbone.Collection;
     var model = new Backbone.Model;
-    model.sync = function(method, model, options){
-      options.success(model, [], options);
-    };
+    model.sync = function(method, model, options){ options.success(); };
     collection.on('add', function(){ ok(true); });
     collection.create(model, {wait: true});
   });
@@ -834,7 +873,7 @@ $(document).ready(function() {
     collection.reset([]);
   });
 
-  test("update", function() {
+  test("set", function() {
     var m1 = new Backbone.Model();
     var m2 = new Backbone.Model({id: 2});
     var m3 = new Backbone.Model();
@@ -852,24 +891,24 @@ $(document).ready(function() {
     });
 
     // remove: false doesn't remove any models
-    c.update([], {remove: false});
+    c.set([], {remove: false});
     strictEqual(c.length, 2);
 
     // add: false doesn't add any models
-    c.update([m1, m2, m3], {add: false});
+    c.set([m1, m2, m3], {add: false});
     strictEqual(c.length, 2);
 
     // merge: false doesn't change any models
-    c.update([m1, {id: 2, a: 1}], {merge: false});
+    c.set([m1, {id: 2, a: 1}], {merge: false});
     strictEqual(m2.get('a'), void 0);
 
     // add: false, remove: false only merges existing models
-    c.update([m1, {id: 2, a: 0}, m3, {id: 4}], {add: false, remove: false});
+    c.set([m1, {id: 2, a: 0}, m3, {id: 4}], {add: false, remove: false});
     strictEqual(c.length, 2);
     strictEqual(m2.get('a'), 0);
 
     // default options add/remove/merge as appropriate
-    c.update([{id: 2, a: 1}, m3]);
+    c.set([{id: 2, a: 1}, m3]);
     strictEqual(c.length, 2);
     strictEqual(m2.get('a'), 1);
 
@@ -877,23 +916,23 @@ $(document).ready(function() {
     c.off('remove').on('remove', function(model) {
       ok(model === m2 || model === m3);
     });
-    c.update([]);
+    c.set([]);
     strictEqual(c.length, 0);
   });
 
-  test("update with only cids", 3, function() {
+  test("set with only cids", 3, function() {
     var m1 = new Backbone.Model;
     var m2 = new Backbone.Model;
     var c = new Backbone.Collection;
-    c.update([m1, m2]);
+    c.set([m1, m2]);
     equal(c.length, 2);
-    c.update([m1]);
+    c.set([m1]);
     equal(c.length, 1);
-    c.update([m1, m1, m1, m2, m2], {remove: false});
+    c.set([m1, m1, m1, m2, m2], {remove: false});
     equal(c.length, 2);
   });
 
-  test("update with only idAttribute", 3, function() {
+  test("set with only idAttribute", 3, function() {
     var m1 = { _id: 1 };
     var m2 = { _id: 2 };
     var col = Backbone.Collection.extend({
@@ -902,15 +941,15 @@ $(document).ready(function() {
       })
     });
     var c = new col;
-    c.update([m1, m2]);
+    c.set([m1, m2]);
     equal(c.length, 2);
-    c.update([m1]);
+    c.set([m1]);
     equal(c.length, 1);
-    c.update([m1, m1, m1, m2, m2], {remove: false});
+    c.set([m1, m1, m1, m2, m2], {remove: false});
     equal(c.length, 2);
   });
 
-  test("update + merge with default values defined", function() {
+  test("set + merge with default values defined", function() {
     var Model = Backbone.Model.extend({
       defaults: {
         key: 'value'
@@ -920,14 +959,43 @@ $(document).ready(function() {
     var col = new Backbone.Collection([m], {model: Model});
     equal(col.first().get('key'), 'value');
 
-    col.update({id: 1, key: 'other'});
+    col.set({id: 1, key: 'other'});
     equal(col.first().get('key'), 'other');
 
-    col.update({id: 1, other: 'value'});
-    equal(col.first().get('key'), 'other');
+    col.set({id: 1, other: 'value'});
+    equal(col.first().get('key'), 'value');
     equal(col.length, 1);
   });
 
+  test("`set` and model level `parse`", function() {
+    var Model = Backbone.Model.extend({
+      parse: function (res) { return res.model; }
+    });
+    var Collection = Backbone.Collection.extend({
+      model: Model,
+      parse: function (res) { return res.models; }
+    });
+    var model = new Model({id: 1});
+    var collection = new Collection(model);
+    collection.set({models: [
+      {model: {id: 1}},
+      {model: {id: 2}}
+    ]}, {parse: true});
+    equal(collection.first(), model);
+  });
+
+  test("`set` data is only parsed once", function() {
+    var collection = new Backbone.Collection();
+    collection.model = Backbone.Model.extend({
+      parse: function (data) {
+        equal(data.parsed, void 0);
+        data.parsed = true;
+        return data;
+      }
+    });
+    collection.set({}, {parse: true});
+  });
+
   test("#1894 - Push should not trigger a sort", 0, function() {
     var Collection = Backbone.Collection.extend({
       comparator: 'id',
@@ -938,12 +1006,12 @@ $(document).ready(function() {
     new Collection().push({id: 1});
   });
 
-  test("`update` with non-normal id", function() {
+  test("`set` with non-normal id", function() {
     var Collection = Backbone.Collection.extend({
       model: Backbone.Model.extend({idAttribute: '_id'})
     });
     var collection = new Collection({_id: 1});
-    collection.update([{_id: 1, a: 1}], {add: false});
+    collection.set([{_id: 1, a: 1}], {add: false});
     equal(collection.first().get('a'), 1);
   });
 
@@ -955,7 +1023,7 @@ $(document).ready(function() {
     new Collection().add({id: 1}, {sort: false});
   });
 
-  test("#1915 - `parse` data in the right order in `update`", function() {
+  test("#1915 - `parse` data in the right order in `set`", function() {
     var collection = new (Backbone.Collection.extend({
       parse: function (data) {
         strictEqual(data.status, 'ok');
@@ -963,7 +1031,7 @@ $(document).ready(function() {
       }
     }));
     var res = {status: 'ok', data:[{id: 1}]};
-    collection.update(res, {parse: true});
+    collection.set(res, {parse: true});
   });
 
   asyncTest("#1939 - `parse` is passed `options`", 1, function () {
@@ -1001,7 +1069,7 @@ $(document).ready(function() {
   test("`add` only `sort`s when necessary with comparator function", 3, function () {
     var collection = new (Backbone.Collection.extend({
       comparator: function(a, b) {
-        a.get('a') > b.get('a') ? 1 : (a.get('a') < b.get('a') ? -1 : 0);
+        return a.get('a') > b.get('a') ? 1 : (a.get('a') < b.get('a') ? -1 : 0);
       }
     }))([{id: 1}, {id: 2}, {id: 3}]);
     collection.on('sort', function () { ok(true); });
@@ -1013,4 +1081,20 @@ $(document).ready(function() {
     collection.add(collection.models, {merge: true}); // don't sort
   });
 
+  test("Attach options to collection.", 3, function() {
+      var url = '/somewhere';
+      var model = new Backbone.Model;
+      var comparator = function(){};
+
+      var collection = new Backbone.Collection([], {
+        url: url,
+        model: model,
+        comparator: comparator
+      });
+
+      strictEqual(collection.url, url);
+      ok(collection.model === model);
+      ok(collection.comparator === comparator);
+  });
+
 });</div></li>
 <li>public/components/backbone/test/events.js<div>diff --git a/public/components/backbone/test/events.js b/public/components/backbone/test/events.js
index f94d32c..1aa746c 100644
--- a/public/components/backbone/test/events.js
+++ b/public/components/backbone/test/events.js
@@ -99,6 +99,43 @@ $(document).ready(function() {
     a.listenTo(b, 'event2', cb);
     a.stopListening(null, {event: cb});
     b.trigger('event event2');
+    b.off();
+    a.listenTo(b, 'event event2', cb);
+    a.stopListening(null, 'event');
+    a.stopListening();
+    b.trigger('event2');
+  });
+
+  test("listenToOnce and stopListening", 1, function() {
+    var a = _.extend({}, Backbone.Events);
+    var b = _.extend({}, Backbone.Events);
+    a.listenToOnce(b, 'all', function() { ok(true); });
+    b.trigger('anything');
+    b.trigger('anything');
+    a.listenToOnce(b, 'all', function() { ok(false); });
+    a.stopListening();
+    b.trigger('anything');
+  });
+
+  test("listenTo, listenToOnce and stopListening", 1, function() {
+    var a = _.extend({}, Backbone.Events);
+    var b = _.extend({}, Backbone.Events);
+    a.listenToOnce(b, 'all', function() { ok(true); });
+    b.trigger('anything');
+    b.trigger('anything');
+    a.listenTo(b, 'all', function() { ok(false); });
+    a.stopListening();
+    b.trigger('anything');
+  });
+
+  test("listenTo and stopListening with event maps", 1, function() {
+    var a = _.extend({}, Backbone.Events);
+    var b = _.extend({}, Backbone.Events);
+    a.listenTo(b, {change: function(){ ok(true); }});
+    b.trigger('change');
+    a.listenTo(b, {change: function(){ ok(false); }});
+    a.stopListening();
+    b.trigger('change');
   });
 
   test("listenTo yourself", 1, function(){
@@ -241,6 +278,13 @@ $(document).ready(function() {
     _.extend({}, Backbone.Events).on('test').trigger('test');
   });
 
+  test("if callback is truthy but not a function, `on` should throw an error just like jQuery", 1, function() {
+    var view = _.extend({}, Backbone.Events).on('test', 'noop');
+    throws(function() {
+      view.trigger('test');
+    });
+  });
+
   test("remove all events for a specific context", 4, function() {
     var obj = _.extend({}, Backbone.Events);
     obj.on('x y all', function() { ok(true); });
@@ -259,18 +303,6 @@ $(document).ready(function() {
     obj.trigger('x y');
   });
 
-  test("off is chainable", 3, function() {
-    var obj = _.extend({}, Backbone.Events);
-    // With no events
-    ok(obj.off() === obj);
-    // When removing all events
-    obj.on('event', function(){}, obj);
-    ok(obj.off() === obj);
-    // When removing some events
-    obj.on('event', function(){}, obj);
-    ok(obj.off('event') === obj);
-  });
-
   test("#1310 - off does not skip consecutive events", 0, function() {
     var obj = _.extend({}, Backbone.Events);
     obj.on('event', function() { ok(false); }, obj);
@@ -400,4 +432,21 @@ $(document).ready(function() {
     _.extend({}, Backbone.Events).once('event').trigger('event');
   });
 
+  test("event functions are chainable", function() {
+    var obj = _.extend({}, Backbone.Events);
+    var obj2 = _.extend({}, Backbone.Events);
+    var fn = function() {};
+    equal(obj, obj.trigger('noeventssetyet'));
+    equal(obj, obj.off('noeventssetyet'));
+    equal(obj, obj.stopListening('noeventssetyet'));
+    equal(obj, obj.on('a', fn));
+    equal(obj, obj.once('c', fn));
+    equal(obj, obj.trigger('a'));
+    equal(obj, obj.listenTo(obj2, 'a', fn));
+    equal(obj, obj.listenToOnce(obj2, 'b', fn));
+    equal(obj, obj.off('a c'));
+    equal(obj, obj.stopListening(obj2, 'a'));
+    equal(obj, obj.stopListening());
+  });
+
 });</div></li>
 <li>public/components/backbone/test/model.js<div>diff --git a/public/components/backbone/test/model.js b/public/components/backbone/test/model.js
index 7bbb833..3b196c4 100644
--- a/public/components/backbone/test/model.js
+++ b/public/components/backbone/test/model.js
@@ -46,9 +46,9 @@ $(document).ready(function() {
 
   test("initialize with parsed attributes", 1, function() {
     var Model = Backbone.Model.extend({
-      parse: function(obj) {
-        obj.value += 1;
-        return obj;
+      parse: function(attrs) {
+        attrs.value += 1;
+        return attrs;
       }
     });
     var model = new Model({value: 1}, {parse: true});
@@ -69,8 +69,8 @@ $(document).ready(function() {
 
   test("parse can return null", 1, function() {
     var Model = Backbone.Model.extend({
-      parse: function(obj) {
-        obj.value += 1;
+      parse: function(attrs) {
+        attrs.value += 1;
         return null;
       }
     });
@@ -111,6 +111,23 @@ $(document).ready(function() {
     equal(model.url(), '/nested/1/collection/2');
   });
 
+  test('url and urlRoot are directly attached if passed in the options', 2, function () {
+    var model = new Backbone.Model({a: 1}, {url: '/test'});
+    var model2 = new Backbone.Model({a: 2}, {urlRoot: '/test2'});
+    equal(model.url, '/test');
+    equal(model2.urlRoot, '/test2');
+  });
+
+  test("underscore methods", 5, function() {
+    var model = new Backbone.Model({ 'foo': 'a', 'bar': 'b', 'baz': 'c' });
+    var model2 = model.clone();
+    deepEqual(model.keys(), ['foo', 'bar', 'baz']);
+    deepEqual(model.values(), ['a', 'b', 'c']);
+    deepEqual(model.invert(), { 'a': 'foo', 'b': 'bar', 'c': 'baz' });
+    deepEqual(model.pick('foo', 'baz'), {'foo': 'a', 'baz': 'c'});
+    deepEqual(model.omit('foo', 'bar'), {'baz': 'c'});
+  });
+
   test("clone", 10, function() {
     var a = new Backbone.Model({ 'foo': 1, 'bar': 2, 'baz': 3});
     var b = a.clone();
@@ -324,7 +341,7 @@ $(document).ready(function() {
         "two": 2
       }
     });
-    var model = new Defaulted({two: null});
+    var model = new Defaulted({two: undefined});
     equal(model.get('one'), 1);
     equal(model.get('two'), 2);
     Defaulted = Backbone.Model.extend({
@@ -335,7 +352,7 @@ $(document).ready(function() {
         };
       }
     });
-    model = new Defaulted({two: null});
+    model = new Defaulted({two: undefined});
     equal(model.get('one'), 3);
     equal(model.get('two'), 4);
   });
@@ -401,7 +418,7 @@ $(document).ready(function() {
       if (attrs.admin) return "Can't change admin status.";
     };
     model.sync = function(method, model, options) {
-      options.success.call(this, this, {admin: true}, options);
+      options.success.call(this, {admin: true});
     };
     model.on('invalid', function(model, error) {
       lastError = error;
@@ -418,6 +435,19 @@ $(document).ready(function() {
     ok(_.isEqual(this.syncArgs.model, doc));
   });
 
+  test("save, fetch, destroy triggers error event when an error occurs", 3, function () {
+    var model = new Backbone.Model();
+    model.on('error', function () {
+      ok(true);
+    });
+    model.sync = function (method, model, options) {
+      options.error();
+    };
+    model.save({data: 2, id: 1});
+    model.fetch();
+    model.destroy();
+  });
+
   test("save with PATCH", function() {
     doc.clear().set({id: 1, a: 1, b: 2, c: 3, d: 4});
     doc.save();
@@ -435,7 +465,7 @@ $(document).ready(function() {
   test("save in positional style", 1, function() {
     var model = new Backbone.Model();
     model.sync = function(method, model, options) {
-      options.success(model, {}, options);
+      options.success();
     };
     model.save('title', 'Twelfth Night');
     equal(model.get('title'), 'Twelfth Night');
@@ -444,8 +474,8 @@ $(document).ready(function() {
   test("save with non-object success response", 2, function () {
     var model = new Backbone.Model();
     model.sync = function(method, model, options) {
-      options.success(model, '', options);
-      options.success(model, null, options);
+      options.success('', options);
+      options.success(null, options);
     };
     model.save({testing:'empty'}, {
       success: function (model) {
@@ -720,7 +750,7 @@ $(document).ready(function() {
   test("#1030 - `save` with `wait` results in correct attributes if success is called during sync", 2, function() {
     var model = new Backbone.Model({x: 1, y: 2});
     model.sync = function(method, model, options) {
-      options.success(model, {}, options);
+      options.success();
     };
     model.on("change:x", function() { ok(true); });
     model.save({x: 3}, {wait: true});
@@ -893,7 +923,7 @@ $(document).ready(function() {
       }
     };
     model.sync = function(method, model, options) {
-      options.success(model, {}, options);
+      options.success();
     };
     model.save({id: 1}, opts);
     model.fetch(opts);
@@ -902,9 +932,8 @@ $(document).ready(function() {
 
   test("#1412 - Trigger 'sync' event.", 3, function() {
     var model = new Backbone.Model({id: 1});
-    model.url = '/test';
+    model.sync = function (method, model, options) { options.success(); };
     model.on('sync', function(){ ok(true); });
-    Backbone.ajax = function(settings){ settings.success(); };
     model.fetch();
     model.save();
     model.destroy();
@@ -950,7 +979,7 @@ $(document).ready(function() {
     var Model = Backbone.Model.extend({
       sync: function(method, model, options) {
         setTimeout(function(){
-          options.success(model, {}, options);
+          options.success();
           start();
         }, 0);
       }</div></li>
 <li>public/components/backbone/test/router.js<div>diff --git a/public/components/backbone/test/router.js b/public/components/backbone/test/router.js
index 26d3800..e6e1b3d 100644
--- a/public/components/backbone/test/router.js
+++ b/public/components/backbone/test/router.js
@@ -57,6 +57,15 @@ $(document).ready(function() {
 
   });
 
+  var ExternalObject = {
+    value: 'unset',
+
+    routingFunction: function(value) {
+      this.value = value;
+    }
+  };
+  _.bindAll(ExternalObject);
+
   var Router = Backbone.Router.extend({
 
     count: 0,
@@ -73,8 +82,11 @@ $(document).ready(function() {
       "optional(/:item)":           "optionalItem",
       "named/optional/(y:z)":       "namedOptional",
       "splat/*args/end":            "splat",
-      "*first/complex-:part/*rest": "complex",
+      ":repo/compare/*from...*to":  "github",
+      "decode/:named/*splat":       "decode",
+      "*first/complex-*part/*rest": "complex",
       ":entity?*args":              "query",
+      "function/:value":            ExternalObject.routingFunction,
       "*anything":                  "anything"
     },
 
@@ -116,6 +128,12 @@ $(document).ready(function() {
       this.args = args;
     },
 
+    github: function(repo, from, to) {
+      this.repo = repo;
+      this.from = from;
+      this.to = to;
+    },
+
     complex: function(first, part, rest) {
       this.first = first;
       this.part = part;
@@ -135,6 +153,11 @@ $(document).ready(function() {
       this.z = z;
     },
 
+    decode: function(named, path) {
+      this.named = named;
+      this.path = path;
+    },
+
     routeEvent: function(arg) {
     }
 
@@ -153,6 +176,15 @@ $(document).ready(function() {
     equal(lastArgs[0], 'news');
   });
 
+  test("routes (simple, but unicode)", 4, function() {
+    location.replace('http://example.com#search/тест');
+    Backbone.history.checkUrl();
+    equal(router.query, "тест");
+    equal(router.page, void 0);
+    equal(lastRoute, 'search');
+    equal(lastArgs[0], "тест");
+  });
+
   test("routes (two part)", 2, function() {
     location.replace('http://example.com#search/nyc/p10');
     Backbone.history.checkUrl();
@@ -213,6 +245,14 @@ $(document).ready(function() {
     equal(router.args, 'long-list/of/splatted_99args');
   });
 
+  test("routes (github)", 3, function() {
+    location.replace('http://example.com#backbone/compare/1.0...braddunbar:with/slash');
+    Backbone.history.checkUrl();
+    equal(router.repo, 'backbone');
+    equal(router.from, '1.0');
+    equal(router.to, 'braddunbar:with/slash');
+  });
+
   test("routes (optional)", 2, function() {
     location.replace('http://example.com#optional');
     Backbone.history.checkUrl();
@@ -246,6 +286,23 @@ $(document).ready(function() {
     equal(router.anything, 'doesnt-match-a-route');
   });
 
+  test("routes (function)", 3, function() {
+    router.on('route', function(name) {
+      ok(name === '');
+    });
+    equal(ExternalObject.value, 'unset');
+    location.replace('http://example.com#function/set');
+    Backbone.history.checkUrl();
+    equal(ExternalObject.value, 'set');
+  });
+
+  test("Decode named parameters, not splats.", 2, function() {
+    location.replace('http://example.com#decode/a%2Fb/c%2Fd/e');
+    Backbone.history.checkUrl();
+    strictEqual(router.named, 'a/b');
+    strictEqual(router.path, 'c/d/e');
+  });
+
   test("fires event when router doesn't have callback on it", 1, function() {
     router.on("route:noCallback", function(){ ok(true); });
     location.replace('http://example.com#noCallback');
@@ -277,9 +334,9 @@ $(document).ready(function() {
   test("#967 - Route callback gets passed encoded values.", 3, function() {
     var route = 'has%2Fslash/complex-has%23hash/has%20space';
     Backbone.history.navigate(route, {trigger: true});
-    strictEqual(router.first, 'has%2Fslash');
-    strictEqual(router.part, 'has%23hash');
-    strictEqual(router.rest, 'has%20space');
+    strictEqual(router.first, 'has/slash');
+    strictEqual(router.part, 'has#hash');
+    strictEqual(router.rest, 'has space');
   });
 
   test("correctly handles URLs with % (#868)", 3, function() {
@@ -529,4 +586,27 @@ $(document).ready(function() {
     Backbone.history.checkUrl();
   });
 
+  test("#2255 - Extend routes by making routes a function.", 1, function() {
+    var RouterBase = Backbone.Router.extend({
+      routes: function() {
+        return {
+          home:  "root",
+          index: "index.html"
+        };
+      }
+    });
+
+    var RouterExtended = RouterBase.extend({
+      routes: function() {
+        var _super = RouterExtended.__super__.routes;
+        return _.extend(_super(),
+          { show:   "show",
+            search: "search" });
+      }
+    });
+
+    var router = new RouterExtended();
+    deepEqual({home: "root", index: "index.html", show: "show", search: "search"}, router.routes);
+  });
+
 });</div></li>
 <li>public/components/backbone/test/test-zepto.html<div>diff --git a/public/components/backbone/test/test-zepto.html b/public/components/backbone/test/test-zepto.html
deleted file mode 100644
index 9f0f51f..0000000
--- a/public/components/backbone/test/test-zepto.html
+++ /dev/null
@@ -1,29 +0,0 @@
-<!doctype html>
-<html>
-<head>
-  <meta charset='utf8'>
-  <title>Backbone Test Suite</title>
-  <link rel="stylesheet" href="vendor/qunit.css" type="text/css" media="screen" />
-  <script src="vendor/json2.js"></script>
-  <script src="vendor/zepto.js"></script>
-  <script src="vendor/qunit.js"></script>
-  <script src="vendor/underscore.js"></script>
-  <script src="../backbone.js"></script>
-  <script src="environment.js"></script>
-  <script src="noconflict.js"></script>
-  <script src="events.js"></script>
-  <script src="model.js"></script>
-  <script src="collection.js"></script>
-  <script src="router.js"></script>
-  <script src="view.js"></script>
-  <script src="sync.js"></script>
-</head>
-<body>
-  <div id="qunit"></div>
-  <div id="qunit-fixture">
-    <div id='testElement'>
-      <h1>Test</h1>
-    </div>
-  </div>
-</body>
-</html></div></li>
 <li>public/components/backbone/test/vendor/qunit.css<div>diff --git a/public/components/backbone/test/vendor/qunit.css b/public/components/backbone/test/vendor/qunit.css
index 55970e0..d7fc0c8 100755
--- a/public/components/backbone/test/vendor/qunit.css
+++ b/public/components/backbone/test/vendor/qunit.css
@@ -1,5 +1,5 @@
 /**
- * QUnit v1.10.0 - A JavaScript Unit Testing Framework
+ * QUnit v1.11.0 - A JavaScript Unit Testing Framework
  *
  * http://qunitjs.com
  *
@@ -20,7 +20,7 @@
 
 /** Resets */
 
-#qunit-tests, #qunit-tests ol, #qunit-header, #qunit-banner, #qunit-userAgent, #qunit-testresult, #qunit-modulefilter {
+#qunit-tests, #qunit-header, #qunit-banner, #qunit-userAgent, #qunit-testresult, #qunit-modulefilter {
 	margin: 0;
 	padding: 0;
 }
@@ -111,7 +111,12 @@
 	color: #000;
 }
 
-#qunit-tests ol {
+#qunit-tests li .runtime {
+	float: right;
+	font-size: smaller;
+}
+
+.qunit-assert-list {
 	margin-top: 0.5em;
 	padding: 0.5em;
 
@@ -122,6 +127,10 @@
 	-webkit-border-radius: 5px;
 }
 
+.qunit-collapsed {
+	display: none;
+}
+
 #qunit-tests table {
 	border-collapse: collapse;
 	margin-top: .2em;</div></li>
 <li>public/components/backbone/test/vendor/qunit.js<div>diff --git a/public/components/backbone/test/vendor/qunit.js b/public/components/backbone/test/vendor/qunit.js
index d4f17b5..302545f 100755
--- a/public/components/backbone/test/vendor/qunit.js
+++ b/public/components/backbone/test/vendor/qunit.js
@@ -1,5 +1,5 @@
 /**
- * QUnit v1.10.0 - A JavaScript Unit Testing Framework
+ * QUnit v1.11.0 - A JavaScript Unit Testing Framework
  *
  * http://qunitjs.com
  *
@@ -11,6 +11,7 @@
 (function( window ) {
 
 var QUnit,
+	assert,
 	config,
 	onErrorFnPrev,
 	testId = 0,
@@ -20,18 +21,67 @@ var QUnit,
 	// Keep a local reference to Date (GH-283)
 	Date = window.Date,
 	defined = {
-	setTimeout: typeof window.setTimeout !== "undefined",
-	sessionStorage: (function() {
-		var x = "qunit-test-string";
-		try {
-			sessionStorage.setItem( x, x );
-			sessionStorage.removeItem( x );
-			return true;
-		} catch( e ) {
-			return false;
+		setTimeout: typeof window.setTimeout !== "undefined",
+		sessionStorage: (function() {
+			var x = "qunit-test-string";
+			try {
+				sessionStorage.setItem( x, x );
+				sessionStorage.removeItem( x );
+				return true;
+			} catch( e ) {
+				return false;
+			}
+		}())
+	},
+	/**
+	 * Provides a normalized error string, correcting an issue
+	 * with IE 7 (and prior) where Error.prototype.toString is
+	 * not properly implemented
+	 *
+	 * Based on http://es5.github.com/#x15.11.4.4
+	 *
+	 * @param {String|Error} error
+	 * @return {String} error message
+	 */
+	errorString = function( error ) {
+		var name, message,
+			errorString = error.toString();
+		if ( errorString.substring( 0, 7 ) === "[object" ) {
+			name = error.name ? error.name.toString() : "Error";
+			message = error.message ? error.message.toString() : "";
+			if ( name && message ) {
+				return name + ": " + message;
+			} else if ( name ) {
+				return name;
+			} else if ( message ) {
+				return message;
+			} else {
+				return "Error";
+			}
+		} else {
+			return errorString;
 		}
-	}())
-};
+	},
+	/**
+	 * Makes a clone of an object using only Array or Object as base,
+	 * and copies over the own enumerable properties.
+	 *
+	 * @param {Object} obj
+	 * @return {Object} New object with only the own properties (recursively).
+	 */
+	objectValues = function( obj ) {
+		// Grunt 0.3.x uses an older version of jshint that still has jshint/jshint#392.
+		/*jshint newcap: false */
+		var key, val,
+			vals = QUnit.is( "array", obj ) ? [] : {};
+		for ( key in obj ) {
+			if ( hasOwn.call( obj, key ) ) {
+				val = obj[key];
+				vals[key] = val === Object(val) ? objectValues(val) : val;
+			}
+		}
+		return vals;
+	};
 
 function Test( settings ) {
 	extend( this, settings );
@@ -44,11 +94,11 @@ Test.count = 0;
 Test.prototype = {
 	init: function() {
 		var a, b, li,
-        tests = id( "qunit-tests" );
+			tests = id( "qunit-tests" );
 
 		if ( tests ) {
 			b = document.createElement( "strong" );
-			b.innerHTML = this.name;
+			b.innerHTML = this.nameHtml;
 
 			// `a` initialized at top of scope
 			a = document.createElement( "a" );
@@ -92,6 +142,7 @@ Test.prototype = {
 			teardown: function() {}
 		}, this.moduleTestEnvironment );
 
+		this.started = +new Date();
 		runLoggingCallbacks( "testStart", QUnit, {
 			name: this.testName,
 			module: this.module
@@ -111,7 +162,7 @@ Test.prototype = {
 		try {
 			this.testEnvironment.setup.call( this.testEnvironment );
 		} catch( e ) {
-			QUnit.pushFailure( "Setup failed on " + this.testName + ": " + e.message, extractStacktrace( e, 1 ) );
+			QUnit.pushFailure( "Setup failed on " + this.testName + ": " + ( e.message || e ), extractStacktrace( e, 1 ) );
 		}
 	},
 	run: function() {
@@ -120,22 +171,28 @@ Test.prototype = {
 		var running = id( "qunit-testresult" );
 
 		if ( running ) {
-			running.innerHTML = "Running: <br/>" + this.name;
+			running.innerHTML = "Running: <br/>" + this.nameHtml;
 		}
 
 		if ( this.async ) {
 			QUnit.stop();
 		}
 
+		this.callbackStarted = +new Date();
+
 		if ( config.notrycatch ) {
 			this.callback.call( this.testEnvironment, QUnit.assert );
+			this.callbackRuntime = +new Date() - this.callbackStarted;
 			return;
 		}
 
 		try {
 			this.callback.call( this.testEnvironment, QUnit.assert );
+			this.callbackRuntime = +new Date() - this.callbackStarted;
 		} catch( e ) {
-			QUnit.pushFailure( "Died on test #" + (this.assertions.length + 1) + " " + this.stack + ": " + e.message, extractStacktrace( e, 0 ) );
+			this.callbackRuntime = +new Date() - this.callbackStarted;
+
+			QUnit.pushFailure( "Died on test #" + (this.assertions.length + 1) + " " + this.stack + ": " + ( e.message || e ), extractStacktrace( e, 0 ) );
 			// else next test will carry the responsibility
 			saveGlobal();
 
@@ -148,38 +205,43 @@ Test.prototype = {
 	teardown: function() {
 		config.current = this;
 		if ( config.notrycatch ) {
+			if ( typeof this.callbackRuntime === "undefined" ) {
+				this.callbackRuntime = +new Date() - this.callbackStarted;
+			}
 			this.testEnvironment.teardown.call( this.testEnvironment );
 			return;
 		} else {
 			try {
 				this.testEnvironment.teardown.call( this.testEnvironment );
 			} catch( e ) {
-				QUnit.pushFailure( "Teardown failed on " + this.testName + ": " + e.message, extractStacktrace( e, 1 ) );
+				QUnit.pushFailure( "Teardown failed on " + this.testName + ": " + ( e.message || e ), extractStacktrace( e, 1 ) );
 			}
 		}
 		checkPollution();
 	},
 	finish: function() {
 		config.current = this;
-		if ( config.requireExpects && this.expected == null ) {
+		if ( config.requireExpects && this.expected === null ) {
 			QUnit.pushFailure( "Expected number of assertions to be defined, but expect() was not called.", this.stack );
-		} else if ( this.expected != null && this.expected != this.assertions.length ) {
+		} else if ( this.expected !== null && this.expected !== this.assertions.length ) {
 			QUnit.pushFailure( "Expected " + this.expected + " assertions, but " + this.assertions.length + " were run", this.stack );
-		} else if ( this.expected == null && !this.assertions.length ) {
+		} else if ( this.expected === null && !this.assertions.length ) {
 			QUnit.pushFailure( "Expected at least one assertion, but none were run - call expect(0) to accept zero assertions.", this.stack );
 		}
 
-		var assertion, a, b, i, li, ol,
+		var i, assertion, a, b, time, li, ol,
 			test = this,
 			good = 0,
 			bad = 0,
 			tests = id( "qunit-tests" );
 
+		this.runtime = +new Date() - this.started;
 		config.stats.all += this.assertions.length;
 		config.moduleStats.all += this.assertions.length;
 
 		if ( tests ) {
 			ol = document.createElement( "ol" );
+			ol.className = "qunit-assert-list";
 
 			for ( i = 0; i < this.assertions.length; i++ ) {
 				assertion = this.assertions[i];
@@ -208,22 +270,22 @@ Test.prototype = {
 			}
 
 			if ( bad === 0 ) {
-				ol.style.display = "none";
+				addClass( ol, "qunit-collapsed" );
 			}
 
 			// `b` initialized at top of scope
 			b = document.createElement( "strong" );
-			b.innerHTML = this.name + " <b class='counts'>(<b class='failed'>" + bad + "</b>, <b class='passed'>" + good + "</b>, " + this.assertions.length + ")</b>";
+			b.innerHTML = this.nameHtml + " <b class='counts'>(<b class='failed'>" + bad + "</b>, <b class='passed'>" + good + "</b>, " + this.assertions.length + ")</b>";
 
 			addEvent(b, "click", function() {
-				var next = b.nextSibling.nextSibling,
-					display = next.style.display;
-				next.style.display = display === "none" ? "block" : "none";
+				var next = b.parentNode.lastChild,
+					collapsed = hasClass( next, "qunit-collapsed" );
+				( collapsed ? removeClass : addClass )( next, "qunit-collapsed" );
 			});
 
 			addEvent(b, "dblclick", function( e ) {
 				var target = e && e.target ? e.target : window.event.srcElement;
-				if ( target.nodeName.toLowerCase() == "span" || target.nodeName.toLowerCase() == "b" ) {
+				if ( target.nodeName.toLowerCase() === "span" || target.nodeName.toLowerCase() === "b" ) {
 					target = target.parentNode;
 				}
 				if ( window.location && target.nodeName.toLowerCase() === "strong" ) {
@@ -231,13 +293,19 @@ Test.prototype = {
 				}
 			});
 
+			// `time` initialized at top of scope
+			time = document.createElement( "span" );
+			time.className = "runtime";
+			time.innerHTML = this.runtime + " ms";
+
 			// `li` initialized at top of scope
 			li = id( this.id );
 			li.className = bad ? "fail" : "pass";
 			li.removeChild( li.firstChild );
 			a = li.firstChild;
 			li.appendChild( b );
-			li.appendChild ( a );
+			li.appendChild( a );
+			li.appendChild( time );
 			li.appendChild( ol );
 
 		} else {
@@ -255,7 +323,8 @@ Test.prototype = {
 			module: this.module,
 			failed: bad,
 			passed: this.assertions.length - bad,
-			total: this.assertions.length
+			total: this.assertions.length,
+			duration: this.runtime
 		});
 
 		QUnit.reset();
@@ -321,7 +390,7 @@ QUnit = {
 
 	test: function( testName, expected, callback, async ) {
 		var test,
-			name = "<span class='test-name'>" + escapeInnerText( testName ) + "</span>";
+			nameHtml = "<span class='test-name'>" + escapeText( testName ) + "</span>";
 
 		if ( arguments.length === 2 ) {
 			callback = expected;
@@ -329,11 +398,11 @@ QUnit = {
 		}
 
 		if ( config.currentModule ) {
-			name = "<span class='module-name'>" + config.currentModule + "</span>: " + name;
+			nameHtml = "<span class='module-name'>" + escapeText( config.currentModule ) + "</span>: " + nameHtml;
 		}
 
 		test = new Test({
-			name: name,
+			nameHtml: nameHtml,
 			testName: testName,
 			expected: expected,
 			async: async,
@@ -360,6 +429,18 @@ QUnit = {
 	},
 
 	start: function( count ) {
+		// QUnit hasn't been initialized yet.
+		// Note: RequireJS (et al) may delay onLoad
+		if ( config.semaphore === undefined ) {
+			QUnit.begin(function() {
+				// This is triggered at the top of QUnit.load, push start() to the event loop, to allow QUnit.load to finish first
+				setTimeout(function() {
+					QUnit.start( count );
+				});
+			});
+			return;
+		}
+
 		config.semaphore -= count || 1;
 		// don't start until equal number of stop-calls
 		if ( config.semaphore > 0 ) {
@@ -368,6 +449,8 @@ QUnit = {
 		// ignore if start is called more often then stop
 		if ( config.semaphore < 0 ) {
 			config.semaphore = 0;
+			QUnit.pushFailure( "Called start() while already started (QUnit.config.semaphore was 0 already)", null, sourceFromStacktrace(2) );
+			return;
 		}
 		// A slight delay, to avoid any current callbacks
 		if ( defined.setTimeout ) {
@@ -403,11 +486,14 @@ QUnit = {
 	}
 };
 
+// `assert` initialized at top of scope
 // Asssert helpers
-// All of these must call either QUnit.push() or manually do:
+// All of these must either call QUnit.push() or manually do:
 // - runLoggingCallbacks( "log", .. );
 // - config.current.assertions.push({ .. });
-QUnit.assert = {
+// We attach it to the QUnit object *after* we expose the public API,
+// otherwise `assert` will become a global variable in browsers (#341).
+assert = {
 	/**
 	 * Asserts rough true-ish result.
 	 * @name ok
@@ -428,14 +514,14 @@ QUnit.assert = {
 				message: msg
 			};
 
-		msg = escapeInnerText( msg || (result ? "okay" : "failed" ) );
+		msg = escapeText( msg || (result ? "okay" : "failed" ) );
 		msg = "<span class='test-message'>" + msg + "</span>";
 
 		if ( !result ) {
 			source = sourceFromStacktrace( 2 );
 			if ( source ) {
 				details.source = source;
-				msg += "<table><tr class='test-source'><th>Source: </th><td><pre>" + escapeInnerText( source ) + "</pre></td></tr></table>";
+				msg += "<table><tr class='test-source'><th>Source: </th><td><pre>" + escapeText( source ) + "</pre></td></tr></table>";
 			}
 		}
 		runLoggingCallbacks( "log", QUnit, details );
@@ -453,6 +539,7 @@ QUnit.assert = {
 	 * @example equal( format( "Received {0} bytes.", 2), "Received 2 bytes.", "format() replaces {0} with next argument" );
 	 */
 	equal: function( actual, expected, message ) {
+		/*jshint eqeqeq:false */
 		QUnit.push( expected == actual, actual, expected, message );
 	},
 
@@ -461,10 +548,31 @@ QUnit.assert = {
 	 * @function
 	 */
 	notEqual: function( actual, expected, message ) {
+		/*jshint eqeqeq:false */
 		QUnit.push( expected != actual, actual, expected, message );
 	},
 
 	/**
+	 * @name propEqual
+	 * @function
+	 */
+	propEqual: function( actual, expected, message ) {
+		actual = objectValues(actual);
+		expected = objectValues(expected);
+		QUnit.push( QUnit.equiv(actual, expected), actual, expected, message );
+	},
+
+	/**
+	 * @name notPropEqual
+	 * @function
+	 */
+	notPropEqual: function( actual, expected, message ) {
+		actual = objectValues(actual);
+		expected = objectValues(expected);
+		QUnit.push( !QUnit.equiv(actual, expected), actual, expected, message );
+	},
+
+	/**
 	 * @name deepEqual
 	 * @function
 	 */
@@ -496,8 +604,9 @@ QUnit.assert = {
 		QUnit.push( expected !== actual, actual, expected, message );
 	},
 
-	throws: function( block, expected, message ) {
+	"throws": function( block, expected, message ) {
 		var actual,
+			expectedOutput = expected,
 			ok = false;
 
 		// 'expected' is optional
@@ -518,18 +627,20 @@ QUnit.assert = {
 			// we don't want to validate thrown error
 			if ( !expected ) {
 				ok = true;
+				expectedOutput = null;
 			// expected is a regexp
 			} else if ( QUnit.objectType( expected ) === "regexp" ) {
-				ok = expected.test( actual );
+				ok = expected.test( errorString( actual ) );
 			// expected is a constructor
 			} else if ( actual instanceof expected ) {
 				ok = true;
 			// expected is a validation function which returns true is validation passed
 			} else if ( expected.call( {}, actual ) === true ) {
+				expectedOutput = null;
 				ok = true;
 			}
 
-			QUnit.push( ok, actual, null, message );
+			QUnit.push( ok, actual, expectedOutput, message );
 		} else {
 			QUnit.pushFailure( message, null, 'No exception was thrown.' );
 		}
@@ -538,15 +649,16 @@ QUnit.assert = {
 
 /**
  * @deprecate since 1.8.0
- * Kept assertion helpers in root for backwards compatibility
+ * Kept assertion helpers in root for backwards compatibility.
  */
-extend( QUnit, QUnit.assert );
+extend( QUnit, assert );
 
 /**
  * @deprecated since 1.9.0
- * Kept global "raises()" for backwards compatibility
+ * Kept root "raises()" for backwards compatibility.
+ * (Note that we don't introduce assert.raises).
  */
-QUnit.raises = QUnit.assert.throws;
+QUnit.raises = assert[ "throws" ];
 
 /**
  * @deprecated since 1.0.0, replaced with error pushes since 1.3.0
@@ -622,6 +734,15 @@ config = {
 	moduleDone: []
 };
 
+// Export global variables, unless an 'exports' object exists,
+// in that case we assume we're in CommonJS (dealt with on the bottom of the script)
+if ( typeof exports === "undefined" ) {
+	extend( window, QUnit );
+
+	// Expose QUnit object
+	window.QUnit = QUnit;
+}
+
 // Initialize more QUnit.config and QUnit.urlParams
 (function() {
 	var i,
@@ -655,18 +776,11 @@ config = {
 	QUnit.isLocal = location.protocol === "file:";
 }());
 
-// Export global variables, unless an 'exports' object exists,
-// in that case we assume we're in CommonJS (dealt with on the bottom of the script)
-if ( typeof exports === "undefined" ) {
-	extend( window, QUnit );
-
-	// Expose QUnit object
-	window.QUnit = QUnit;
-}
-
 // Extend QUnit object,
 // these after set here because they should not be exposed as global functions
 extend( QUnit, {
+	assert: assert,
+
 	config: config,
 
 	// Initialize the configuration options
@@ -681,7 +795,7 @@ extend( QUnit, {
 			autorun: false,
 			filter: "",
 			queue: [],
-			semaphore: 0
+			semaphore: 1
 		});
 
 		var tests, banner, result,
@@ -689,7 +803,7 @@ extend( QUnit, {
 
 		if ( qunit ) {
 			qunit.innerHTML =
-				"<h1 id='qunit-header'>" + escapeInnerText( document.title ) + "</h1>" +
+				"<h1 id='qunit-header'>" + escapeText( document.title ) + "</h1>" +
 				"<h2 id='qunit-banner'></h2>" +
 				"<div id='qunit-testrunner-toolbar'></div>" +
 				"<h2 id='qunit-userAgent'></h2>" +
@@ -745,7 +859,7 @@ extend( QUnit, {
 
 	// Safe object type checking
 	is: function( type, obj ) {
-		return QUnit.objectType( obj ) == type;
+		return QUnit.objectType( obj ) === type;
 	},
 
 	objectType: function( obj ) {
@@ -757,7 +871,8 @@ extend( QUnit, {
 				return "null";
 		}
 
-		var type = toString.call( obj ).match(/^\[object\s(.*)\]$/)[1] || "";
+		var match = toString.call( obj ).match(/^\[object\s(.*)\]$/),
+			type = match && match[1] || "";
 
 		switch ( type ) {
 			case "Number":
@@ -794,16 +909,16 @@ extend( QUnit, {
 				expected: expected
 			};
 
-		message = escapeInnerText( message ) || ( result ? "okay" : "failed" );
+		message = escapeText( message ) || ( result ? "okay" : "failed" );
 		message = "<span class='test-message'>" + message + "</span>";
 		output = message;
 
 		if ( !result ) {
-			expected = escapeInnerText( QUnit.jsDump.parse(expected) );
-			actual = escapeInnerText( QUnit.jsDump.parse(actual) );
+			expected = escapeText( QUnit.jsDump.parse(expected) );
+			actual = escapeText( QUnit.jsDump.parse(actual) );
 			output += "<table><tr class='test-expected'><th>Expected: </th><td><pre>" + expected + "</pre></td></tr>";
 
-			if ( actual != expected ) {
+			if ( actual !== expected ) {
 				output += "<tr class='test-actual'><th>Result: </th><td><pre>" + actual + "</pre></td></tr>";
 				output += "<tr class='test-diff'><th>Diff: </th><td><pre>" + QUnit.diff( expected, actual ) + "</pre></td></tr>";
 			}
@@ -812,7 +927,7 @@ extend( QUnit, {
 
 			if ( source ) {
 				details.source = source;
-				output += "<tr class='test-source'><th>Source: </th><td><pre>" + escapeInnerText( source ) + "</pre></td></tr>";
+				output += "<tr class='test-source'><th>Source: </th><td><pre>" + escapeText( source ) + "</pre></td></tr>";
 			}
 
 			output += "</table>";
@@ -839,19 +954,19 @@ extend( QUnit, {
 				message: message
 			};
 
-		message = escapeInnerText( message ) || "error";
+		message = escapeText( message ) || "error";
 		message = "<span class='test-message'>" + message + "</span>";
 		output = message;
 
 		output += "<table>";
 
 		if ( actual ) {
-			output += "<tr class='test-actual'><th>Result: </th><td><pre>" + escapeInnerText( actual ) + "</pre></td></tr>";
+			output += "<tr class='test-actual'><th>Result: </th><td><pre>" + escapeText( actual ) + "</pre></td></tr>";
 		}
 
 		if ( source ) {
 			details.source = source;
-			output += "<tr class='test-source'><th>Source: </th><td><pre>" + escapeInnerText( source ) + "</pre></td></tr>";
+			output += "<tr class='test-source'><th>Source: </th><td><pre>" + escapeText( source ) + "</pre></td></tr>";
 		}
 
 		output += "</table>";
@@ -876,7 +991,8 @@ extend( QUnit, {
 			querystring += encodeURIComponent( key ) + "=" +
 				encodeURIComponent( params[ key ] ) + "&";
 		}
-		return window.location.pathname + querystring.slice( 0, -1 );
+		return window.location.protocol + "//" + window.location.host +
+			window.location.pathname + querystring.slice( 0, -1 );
 	},
 
 	extend: extend,
@@ -907,7 +1023,7 @@ extend( QUnit.constructor.prototype, {
 	// testStart: { name }
 	testStart: registerLoggingCallback( "testStart" ),
 
-	// testDone: { name, failed, passed, total }
+	// testDone: { name, failed, passed, total, duration }
 	testDone: registerLoggingCallback( "testDone" ),
 
 	// moduleStart: { name }
@@ -925,9 +1041,10 @@ QUnit.load = function() {
 	runLoggingCallbacks( "begin", QUnit, {} );
 
 	// Initialize the config, saving the execution queue
-	var banner, filter, i, label, len, main, ol, toolbar, userAgent, val, urlConfigCheckboxes, moduleFilter,
-	    numModules = 0,
-	    moduleFilterHtml = "",
+	var banner, filter, i, label, len, main, ol, toolbar, userAgent, val,
+		urlConfigCheckboxesContainer, urlConfigCheckboxes, moduleFilter,
+		numModules = 0,
+		moduleFilterHtml = "",
 		urlConfigHtml = "",
 		oldconfig = extend( {}, config );
 
@@ -948,14 +1065,24 @@ QUnit.load = function() {
 			};
 		}
 		config[ val.id ] = QUnit.urlParams[ val.id ];
-		urlConfigHtml += "<input id='qunit-urlconfig-" + val.id + "' name='" + val.id + "' type='checkbox'" + ( config[ val.id ] ? " checked='checked'" : "" ) + " title='" + val.tooltip + "'><label for='qunit-urlconfig-" + val.id + "' title='" + val.tooltip + "'>" + val.label + "</label>";
+		urlConfigHtml += "<input id='qunit-urlconfig-" + escapeText( val.id ) +
+			"' name='" + escapeText( val.id ) +
+			"' type='checkbox'" + ( config[ val.id ] ? " checked='checked'" : "" ) +
+			" title='" + escapeText( val.tooltip ) +
+			"'><label for='qunit-urlconfig-" + escapeText( val.id ) +
+			"' title='" + escapeText( val.tooltip ) + "'>" + val.label + "</label>";
 	}
 
-	moduleFilterHtml += "<label for='qunit-modulefilter'>Module: </label><select id='qunit-modulefilter' name='modulefilter'><option value='' " + ( config.module === undefined  ? "selected" : "" ) + ">< All Modules ></option>";
+	moduleFilterHtml += "<label for='qunit-modulefilter'>Module: </label><select id='qunit-modulefilter' name='modulefilter'><option value='' " +
+		( config.module === undefined  ? "selected='selected'" : "" ) +
+		">< All Modules ></option>";
+
 	for ( i in config.modules ) {
 		if ( config.modules.hasOwnProperty( i ) ) {
 			numModules += 1;
-			moduleFilterHtml += "<option value='" + encodeURIComponent(i) + "' " + ( config.module === i ? "selected" : "" ) + ">" + i + "</option>";
+			moduleFilterHtml += "<option value='" + escapeText( encodeURIComponent(i) ) + "' " +
+				( config.module === i ? "selected='selected'" : "" ) +
+				">" + escapeText(i) + "</option>";
 		}
 	}
 	moduleFilterHtml += "</select>";
@@ -1014,22 +1141,28 @@ QUnit.load = function() {
 		label.innerHTML = "Hide passed tests";
 		toolbar.appendChild( label );
 
-		urlConfigCheckboxes = document.createElement( 'span' );
-		urlConfigCheckboxes.innerHTML = urlConfigHtml;
-		addEvent( urlConfigCheckboxes, "change", function( event ) {
-			var params = {};
-			params[ event.target.name ] = event.target.checked ? true : undefined;
+		urlConfigCheckboxesContainer = document.createElement("span");
+		urlConfigCheckboxesContainer.innerHTML = urlConfigHtml;
+		urlConfigCheckboxes = urlConfigCheckboxesContainer.getElementsByTagName("input");
+		// For oldIE support:
+		// * Add handlers to the individual elements instead of the container
+		// * Use "click" instead of "change"
+		// * Fallback from event.target to event.srcElement
+		addEvents( urlConfigCheckboxes, "click", function( event ) {
+			var params = {},
+				target = event.target || event.srcElement;
+			params[ target.name ] = target.checked ? true : undefined;
 			window.location = QUnit.url( params );
 		});
-		toolbar.appendChild( urlConfigCheckboxes );
+		toolbar.appendChild( urlConfigCheckboxesContainer );
 
 		if (numModules > 1) {
 			moduleFilter = document.createElement( 'span' );
 			moduleFilter.setAttribute( 'id', 'qunit-modulefilter-container' );
 			moduleFilter.innerHTML = moduleFilterHtml;
-			addEvent( moduleFilter, "change", function() {
+			addEvent( moduleFilter.lastChild, "change", function() {
 				var selectBox = moduleFilter.getElementsByTagName("select")[0],
-				    selectedModule = decodeURIComponent(selectBox.options[selectBox.selectedIndex].value);
+					selectedModule = decodeURIComponent(selectBox.options[selectBox.selectedIndex].value);
 
 				window.location = QUnit.url( { module: ( selectedModule === "" ) ? undefined : selectedModule } );
 			});
@@ -1106,7 +1239,7 @@ function done() {
 			" milliseconds.<br/>",
 			"<span class='passed'>",
 			passed,
-			"</span> tests of <span class='total'>",
+			"</span> assertions of <span class='total'>",
 			config.stats.all,
 			"</span> passed, <span class='failed'>",
 			config.stats.bad,
@@ -1199,7 +1332,7 @@ function validTest( test ) {
 function extractStacktrace( e, offset ) {
 	offset = offset === undefined ? 3 : offset;
 
-	var stack, include, i, regex;
+	var stack, include, i;
 
 	if ( e.stacktrace ) {
 		// Opera
@@ -1213,7 +1346,7 @@ function extractStacktrace( e, offset ) {
 		if ( fileName ) {
 			include = [];
 			for ( i = offset; i < stack.length; i++ ) {
-				if ( stack[ i ].indexOf( fileName ) != -1 ) {
+				if ( stack[ i ].indexOf( fileName ) !== -1 ) {
 					break;
 				}
 				include.push( stack[ i ] );
@@ -1242,17 +1375,27 @@ function sourceFromStacktrace( offset ) {
 	}
 }
 
-function escapeInnerText( s ) {
+/**
+ * Escape text for attribute or text content.
+ */
+function escapeText( s ) {
 	if ( !s ) {
 		return "";
 	}
 	s = s + "";
-	return s.replace( /[\&<>]/g, function( s ) {
+	// Both single quotes and double quotes (for attributes)
+	return s.replace( /['"<>&]/g, function( s ) {
 		switch( s ) {
-			case "&": return "&amp;";
-			case "<": return "&lt;";
-			case ">": return "&gt;";
-			default: return s;
+			case '\'':
+				return '&#039;';
+			case '"':
+				return '&quot;';
+			case '<':
+				return '&lt;';
+			case '>':
+				return '&gt;';
+			case '&':
+				return '&amp;';
 		}
 	});
 }
@@ -1300,7 +1443,7 @@ function saveGlobal() {
 	}
 }
 
-function checkPollution( name ) {
+function checkPollution() {
 	var newGlobals,
 		deletedGlobals,
 		old = config.pollution;
@@ -1349,16 +1492,53 @@ function extend( a, b ) {
 	return a;
 }
 
+/**
+ * @param {HTMLElement} elem
+ * @param {string} type
+ * @param {Function} fn
+ */
 function addEvent( elem, type, fn ) {
+	// Standards-based browsers
 	if ( elem.addEventListener ) {
 		elem.addEventListener( type, fn, false );
-	} else if ( elem.attachEvent ) {
-		elem.attachEvent( "on" + type, fn );
+	// IE
 	} else {
-		fn();
+		elem.attachEvent( "on" + type, fn );
 	}
 }
 
+/**
+ * @param {Array|NodeList} elems
+ * @param {string} type
+ * @param {Function} fn
+ */
+function addEvents( elems, type, fn ) {
+	var i = elems.length;
+	while ( i-- ) {
+		addEvent( elems[i], type, fn );
+	}
+}
+
+function hasClass( elem, name ) {
+	return (" " + elem.className + " ").indexOf(" " + name + " ") > -1;
+}
+
+function addClass( elem, name ) {
+	if ( !hasClass( elem, name ) ) {
+		elem.className += (elem.className ? " " : "") + name;
+	}
+}
+
+function removeClass( elem, name ) {
+	var set = " " + elem.className + " ";
+	// Class name may appear multiple times
+	while ( set.indexOf(" " + name + " ") > -1 ) {
+		set = set.replace(" " + name + " " , " ");
+	}
+	// If possible, trim it for prettiness, but not neccecarily
+	elem.className = window.jQuery ? jQuery.trim( set ) : ( set.trim ? set.trim() : set );
+}
+
 function id( name ) {
 	return !!( typeof document !== "undefined" && document && document.getElementById ) &&
 		document.getElementById( name );
@@ -1372,7 +1552,6 @@ function registerLoggingCallback( key ) {
 
 // Supports deprecated method of completely overwriting logging callbacks
 function runLoggingCallbacks( key, scope, args ) {
-	//debugger;
 	var i, callbacks;
 	if ( QUnit.hasOwnProperty( key ) ) {
 		QUnit[ key ].call(scope, args );
@@ -1414,6 +1593,7 @@ QUnit.equiv = (function() {
 
 			// for string, boolean, number and null
 			function useStrictEquality( b, a ) {
+				/*jshint eqeqeq:false */
 				if ( b instanceof a.constructor || a instanceof b.constructor ) {
 					// to catch short annotaion VS 'new' annotation of a
 					// declaration
@@ -1610,7 +1790,8 @@ QUnit.jsDump = (function() {
 
 	var reName = /^function (\w+)/,
 		jsDump = {
-			parse: function( obj, type, stack ) { //type is used mostly internally, you can fix a (custom)type in advance
+			// type is used mostly internally, you can fix a (custom)type in advance
+			parse: function( obj, type, stack ) {
 				stack = stack || [ ];
 				var inStack, res,
 					parser = this.parsers[ type || this.typeOf(obj) ];
@@ -1618,18 +1799,16 @@ QUnit.jsDump = (function() {
 				type = typeof parser;
 				inStack = inArray( obj, stack );
 
-				if ( inStack != -1 ) {
+				if ( inStack !== -1 ) {
 					return "recursion(" + (inStack - stack.length) + ")";
 				}
-				//else
-				if ( type == "function" )  {
+				if ( type === "function" )  {
 					stack.push( obj );
 					res = parser.call( this, obj, stack );
 					stack.pop();
 					return res;
 				}
-				// else
-				return ( type == "string" ) ? parser : this.parsers.error;
+				return ( type === "string" ) ? parser : this.parsers.error;
 			},
 			typeOf: function( obj ) {
 				var type;
@@ -1656,6 +1835,8 @@ QUnit.jsDump = (function() {
 					( typeof obj.length === "number" && typeof obj.item !== "undefined" && ( obj.length ? obj.item(0) === obj[0] : ( obj.item( 0 ) === null && typeof obj[0] === "undefined" ) ) )
 				) {
 					type = "array";
+				} else if ( obj.constructor === Error.prototype.constructor ) {
+					type = "error";
 				} else {
 					type = typeof obj;
 				}
@@ -1664,7 +1845,8 @@ QUnit.jsDump = (function() {
 			separator: function() {
 				return this.multiline ?	this.HTML ? "<br />" : "\n" : this.HTML ? "&nbsp;" : " ";
 			},
-			indent: function( extra ) {// extra can be a number, shortcut for increasing-calling-decreasing
+			// extra can be a number, shortcut for increasing-calling-decreasing
+			indent: function( extra ) {
 				if ( !this.multiline ) {
 					return "";
 				}
@@ -1693,13 +1875,16 @@ QUnit.jsDump = (function() {
 			parsers: {
 				window: "[Window]",
 				document: "[Document]",
-				error: "[ERROR]", //when no parser is found, shouldn"t happen
+				error: function(error) {
+					return "Error(\"" + error.message + "\")";
+				},
 				unknown: "[Unknown]",
 				"null": "null",
 				"undefined": "undefined",
 				"function": function( fn ) {
 					var ret = "function",
-						name = "name" in fn ? fn.name : (reName.exec(fn) || [])[1];//functions never have name in IE
+						// functions never have name in IE
+						name = "name" in fn ? fn.name : (reName.exec(fn) || [])[1];
 
 					if ( name ) {
 						ret += " " + name;
@@ -1715,13 +1900,9 @@ QUnit.jsDump = (function() {
 				object: function( map, stack ) {
 					var ret = [ ], keys, key, val, i;
 					QUnit.jsDump.up();
-					if ( Object.keys ) {
-						keys = Object.keys( map );
-					} else {
-						keys = [];
-						for ( key in map ) {
-							keys.push( key );
-						}
+					keys = [];
+					for ( key in map ) {
+						keys.push( key );
 					}
 					keys.sort();
 					for ( i = 0; i < keys.length; i++ ) {
@@ -1733,21 +1914,34 @@ QUnit.jsDump = (function() {
 					return join( "{", ret, "}" );
 				},
 				node: function( node ) {
-					var a, val,
+					var len, i, val,
 						open = QUnit.jsDump.HTML ? "&lt;" : "<",
 						close = QUnit.jsDump.HTML ? "&gt;" : ">",
 						tag = node.nodeName.toLowerCase(),
-						ret = open + tag;
-
-					for ( a in QUnit.jsDump.DOMAttrs ) {
-						val = node[ QUnit.jsDump.DOMAttrs[a] ];
-						if ( val ) {
-							ret += " " + a + "=" + QUnit.jsDump.parse( val, "attribute" );
+						ret = open + tag,
+						attrs = node.attributes;
+
+					if ( attrs ) {
+						for ( i = 0, len = attrs.length; i < len; i++ ) {
+							val = attrs[i].nodeValue;
+							// IE6 includes all attributes in .attributes, even ones not explicitly set.
+							// Those have values like undefined, null, 0, false, "" or "inherit".
+							if ( val && val !== "inherit" ) {
+								ret += " " + attrs[i].nodeName + "=" + QUnit.jsDump.parse( val, "attribute" );
+							}
 						}
 					}
-					return ret + close + open + "/" + tag + close;
+					ret += close;
+
+					// Show content of TextNode or CDATASection
+					if ( node.nodeType === 3 || node.nodeType === 4 ) {
+						ret += node.nodeValue;
+					}
+
+					return ret + open + "/" + tag + close;
 				},
-				functionArgs: function( fn ) {//function calls it internally, it's the arguments part of the function
+				// function calls it internally, it's the arguments part of the function
+				functionArgs: function( fn ) {
 					var args,
 						l = fn.length;
 
@@ -1757,54 +1951,34 @@ QUnit.jsDump = (function() {
 
 					args = new Array(l);
 					while ( l-- ) {
-						args[l] = String.fromCharCode(97+l);//97 is 'a'
+						// 97 is 'a'
+						args[l] = String.fromCharCode(97+l);
 					}
 					return " " + args.join( ", " ) + " ";
 				},
-				key: quote, //object calls it internally, the key part of an item in a map
-				functionCode: "[code]", //function calls it internally, it's the content of the function
-				attribute: quote, //node calls it internally, it's an html attribute value
+				// object calls it internally, the key part of an item in a map
+				key: quote,
+				// function calls it internally, it's the content of the function
+				functionCode: "[code]",
+				// node calls it internally, it's an html attribute value
+				attribute: quote,
 				string: quote,
 				date: quote,
-				regexp: literal, //regex
+				regexp: literal,
 				number: literal,
 				"boolean": literal
 			},
-			DOMAttrs: {
-				//attributes to dump from nodes, name=>realName
-				id: "id",
-				name: "name",
-				"class": "className"
-			},
-			HTML: false,//if true, entities are escaped ( <, >, \t, space and \n )
-			indentChar: "  ",//indentation unit
-			multiline: true //if true, items in a collection, are separated by a \n, else just a space.
+			// if true, entities are escaped ( <, >, \t, space and \n )
+			HTML: false,
+			// indentation unit
+			indentChar: "  ",
+			// if true, items in a collection, are separated by a \n, else just a space.
+			multiline: true
 		};
 
 	return jsDump;
 }());
 
-// from Sizzle.js
-function getText( elems ) {
-	var i, elem,
-		ret = "";
-
-	for ( i = 0; elems[i]; i++ ) {
-		elem = elems[i];
-
-		// Get the text from text nodes and CDATA nodes
-		if ( elem.nodeType === 3 || elem.nodeType === 4 ) {
-			ret += elem.nodeValue;
-
-		// Traverse everything else, except comment nodes
-		} else if ( elem.nodeType !== 8 ) {
-			ret += getText( elem.childNodes );
-		}
-	}
-
-	return ret;
-}
-
 // from jquery.js
 function inArray( elem, array ) {
 	if ( array.indexOf ) {
@@ -1835,13 +2009,14 @@ function inArray( elem, array ) {
  * QUnit.diff( "the quick brown fox jumped over", "the quick fox jumps over" ) == "the  quick <del>brown </del> fox <del>jumped </del><ins>jumps </ins> over"
  */
 QUnit.diff = (function() {
+	/*jshint eqeqeq:false, eqnull:true */
 	function diff( o, n ) {
 		var i,
 			ns = {},
 			os = {};
 
 		for ( i = 0; i < n.length; i++ ) {
-			if ( ns[ n[i] ] == null ) {
+			if ( !hasOwn.call( ns, n[i] ) ) {
 				ns[ n[i] ] = {
 					rows: [],
 					o: null
@@ -1851,7 +2026,7 @@ QUnit.diff = (function() {
 		}
 
 		for ( i = 0; i < o.length; i++ ) {
-			if ( os[ o[i] ] == null ) {
+			if ( !hasOwn.call( os, o[i] ) ) {
 				os[ o[i] ] = {
 					rows: [],
 					n: null
@@ -1864,7 +2039,7 @@ QUnit.diff = (function() {
 			if ( !hasOwn.call( ns, i ) ) {
 				continue;
 			}
-			if ( ns[i].rows.length == 1 && typeof os[i] != "undefined" && os[i].rows.length == 1 ) {
+			if ( ns[i].rows.length === 1 && hasOwn.call( os, i ) && os[i].rows.length === 1 ) {
 				n[ ns[i].rows[0] ] = {
 					text: n[ ns[i].rows[0] ],
 					row: os[i].rows[0]
@@ -1970,7 +2145,7 @@ QUnit.diff = (function() {
 
 // for CommonJS enviroments, export everything
 if ( typeof exports !== "undefined" ) {
-	extend(exports, QUnit);
+	extend( exports, QUnit );
 }
 
 // get at whatever the global object is, like window in browsers</div></li>
 <li>public/components/backbone/test/vendor/runner.js<div>diff --git a/public/components/backbone/test/vendor/runner.js b/public/components/backbone/test/vendor/runner.js
index 3fa676b..4b1d38b 100644
--- a/public/components/backbone/test/vendor/runner.js
+++ b/public/components/backbone/test/vendor/runner.js
@@ -1,98 +1,127 @@
 /*
- * Qt+WebKit powered headless test runner using Phantomjs
+ * QtWebKit-powered headless test runner using PhantomJS
  *
- * Phantomjs installation: http://code.google.com/p/phantomjs/wiki/BuildInstructions
+ * PhantomJS binaries: http://phantomjs.org/download.html
+ * Requires PhantomJS 1.6+ (1.7+ recommended)
  *
  * Run with:
- *  phantomjs runner.js [url-of-your-qunit-testsuite]
+ *   phantomjs runner.js [url-of-your-qunit-testsuite]
  *
- * E.g.
- *      phantomjs runner.js http://localhost/qunit/test
+ * e.g.
+ *   phantomjs runner.js http://localhost/qunit/test/index.html
  */
 
 /*jshint latedef:false */
-/*global phantom:true require:true console:true */
-var url = phantom.args[0],
-	page = require('webpage').create();
-
-// Route "console.log()" calls from within the Page context to the main Phantom context (i.e. current "this")
-page.onConsoleMessage = function(msg) {
-	console.log(msg);
-};
-
-page.onInitialized = function() {
-	page.evaluate(addLogging);
-};
-page.open(url, function(status){
-	if (status !== "success") {
-		console.log("Unable to access network: " + status);
+/*global phantom:false, require:false, console:false, window:false, QUnit:false */
+
+(function() {
+	'use strict';
+
+	var args = require('system').args;
+
+	// arg[0]: scriptName, args[1...]: arguments
+	if (args.length !== 2) {
+		console.error('Usage:\n  phantomjs runner.js [url-of-your-qunit-testsuite]');
 		phantom.exit(1);
-	} else {
-		// page.evaluate(addLogging);
-		var interval = setInterval(function() {
-			if (finished()) {
-				clearInterval(interval);
-				onfinishedTests();
-			}
-		}, 500);
 	}
-});
 
-function finished() {
-	return page.evaluate(function(){
-		return !!window.qunitDone;
-	});
-}
+	var url = args[1],
+		page = require('webpage').create();
 
-function onfinishedTests() {
-	var output = page.evaluate(function() {
-			return JSON.stringify(window.qunitDone);
-	});
-	phantom.exit(JSON.parse(output).failed > 0 ? 1 : 0);
-}
+	// Route `console.log()` calls from within the Page context to the main Phantom context (i.e. current `this`)
+	page.onConsoleMessage = function(msg) {
+		console.log(msg);
+	};
 
-function addLogging() {
-	window.document.addEventListener( "DOMContentLoaded", function() {
-		var current_test_assertions = [];
+	page.onInitialized = function() {
+		page.evaluate(addLogging);
+	};
 
-		QUnit.testDone(function(result) {
-			var i,
-				name = result.module + ': ' + result.name;
+	page.onCallback = function(message) {
+		var result,
+			failed;
 
-			if (result.failed) {
-				console.log('Assertion Failed: ' + name);
+		if (message) {
+			if (message.name === 'QUnit.done') {
+				result = message.data;
+				failed = !result || result.failed;
 
-				for (i = 0; i < current_test_assertions.length; i++) {
-					console.log('    ' + current_test_assertions[i]);
-				}
+				phantom.exit(failed ? 1 : 0);
+			}
+		}
+	};
+
+	page.open(url, function(status) {
+		if (status !== 'success') {
+			console.error('Unable to access network: ' + status);
+			phantom.exit(1);
+		} else {
+			// Cannot do this verification with the 'DOMContentLoaded' handler because it
+			// will be too late to attach it if a page does not have any script tags.
+			var qunitMissing = page.evaluate(function() { return (typeof QUnit === 'undefined' || !QUnit); });
+			if (qunitMissing) {
+				console.error('The `QUnit` object is not present on this page.');
+				phantom.exit(1);
 			}
 
-			current_test_assertions = [];
-		});
+			// Do nothing... the callback mechanism will handle everything!
+		}
+	});
 
-		QUnit.log(function(details) {
-			var response;
+	function addLogging() {
+		window.document.addEventListener('DOMContentLoaded', function() {
+			var current_test_assertions = [];
 
-			if (details.result) {
-				return;
-			}
+			QUnit.log(function(details) {
+				var response;
 
-			response = details.message || '';
+				// Ignore passing assertions
+				if (details.result) {
+					return;
+				}
 
-			if (typeof details.expected !== 'undefined') {
-				if (response) {
-					response += ', ';
+				response = details.message || '';
+
+				if (typeof details.expected !== 'undefined') {
+					if (response) {
+						response += ', ';
+					}
+
+					response += 'expected: ' + details.expected + ', but was: ' + details.actual;
+					if (details.source) {
+						response += "\n" + details.source;
+					}
 				}
 
-				response += 'expected: ' + details.expected + ', but was: ' + details.actual;
-			}
+				current_test_assertions.push('Failed assertion: ' + response);
+			});
+
+			QUnit.testDone(function(result) {
+				var i,
+					len,
+					name = result.module + ': ' + result.name;
+
+				if (result.failed) {
+					console.log('Test failed: ' + name);
 
-			current_test_assertions.push('Failed assertion: ' + response);
-		});
+					for (i = 0, len = current_test_assertions.length; i < len; i++) {
+						console.log('    ' + current_test_assertions[i]);
+					}
+				}
+
+				current_test_assertions.length = 0;
+			});
+
+			QUnit.done(function(result) {
+				console.log('Took ' + result.runtime +  'ms to run ' + result.total + ' tests. ' + result.passed + ' passed, ' + result.failed + ' failed.');
 
-		QUnit.done(function(result){
-			console.log('Took ' + result.runtime +  'ms to run ' + result.total + ' tests. ' + result.passed + ' passed, ' + result.failed + ' failed.');
-			window.qunitDone = result;
-		});
-	}, false );
-}
+				if (typeof window.callPhantom === 'function') {
+					window.callPhantom({
+						'name': 'QUnit.done',
+						'data': result
+					});
+				}
+			});
+		}, false);
+	}
+})();</div></li>
 <li>public/components/backbone/test/vendor/zepto.js<div>diff --git a/public/components/backbone/test/vendor/zepto.js b/public/components/backbone/test/vendor/zepto.js
deleted file mode 100644
index fdb7393..0000000
--- a/public/components/backbone/test/vendor/zepto.js
+++ /dev/null
@@ -1,1355 +0,0 @@
-/* Zepto v1.0rc1 - polyfill zepto event detect fx ajax form touch - zeptojs.com/license */
-;(function(undefined){
-  if (String.prototype.trim === undefined) // fix for iOS 3.2
-    String.prototype.trim = function(){ return this.replace(/^\s+/, '').replace(/\s+$/, '') }
-
-  // For iOS 3.x
-  // from https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/reduce
-  if (Array.prototype.reduce === undefined)
-    Array.prototype.reduce = function(fun){
-      if(this === void 0 || this === null) throw new TypeError()
-      var t = Object(this), len = t.length >>> 0, k = 0, accumulator
-      if(typeof fun != 'function') throw new TypeError()
-      if(len == 0 && arguments.length == 1) throw new TypeError()
-
-      if(arguments.length >= 2)
-       accumulator = arguments[1]
-      else
-        do{
-          if(k in t){
-            accumulator = t[k++]
-            break
-          }
-          if(++k >= len) throw new TypeError()
-        } while (true)
-
-      while (k < len){
-        if(k in t) accumulator = fun.call(undefined, accumulator, t[k], k, t)
-        k++
-      }
-      return accumulator
-    }
-
-})()
-var Zepto = (function() {
-  var undefined, key, $, classList, emptyArray = [], slice = emptyArray.slice,
-    document = window.document,
-    elementDisplay = {}, classCache = {},
-    getComputedStyle = document.defaultView.getComputedStyle,
-    cssNumber = { 'column-count': 1, 'columns': 1, 'font-weight': 1, 'line-height': 1,'opacity': 1, 'z-index': 1, 'zoom': 1 },
-    fragmentRE = /^\s*<(\w+|!)[^>]*>/,
-
-    // Used by `$.zepto.init` to wrap elements, text/comment nodes, document,
-    // and document fragment node types.
-    elementTypes = [1, 3, 8, 9, 11],
-
-    adjacencyOperators = [ 'after', 'prepend', 'before', 'append' ],
-    table = document.createElement('table'),
-    tableRow = document.createElement('tr'),
-    containers = {
-      'tr': document.createElement('tbody'),
-      'tbody': table, 'thead': table, 'tfoot': table,
-      'td': tableRow, 'th': tableRow,
-      '*': document.createElement('div')
-    },
-    readyRE = /complete|loaded|interactive/,
-    classSelectorRE = /^\.([\w-]+)$/,
-    idSelectorRE = /^#([\w-]+)$/,
-    tagSelectorRE = /^[\w-]+$/,
-    toString = ({}).toString,
-    zepto = {},
-    camelize, uniq,
-    tempParent = document.createElement('div')
-
-  zepto.matches = function(element, selector) {
-    if (!element || element.nodeType !== 1) return false
-    var matchesSelector = element.webkitMatchesSelector || element.mozMatchesSelector ||
-                          element.oMatchesSelector || element.matchesSelector
-    if (matchesSelector) return matchesSelector.call(element, selector)
-    // fall back to performing a selector:
-    var match, parent = element.parentNode, temp = !parent
-    if (temp) (parent = tempParent).appendChild(element)
-    match = ~zepto.qsa(parent, selector).indexOf(element)
-    temp && tempParent.removeChild(element)
-    return match
-  }
-
-  function isFunction(value) { return toString.call(value) == "[object Function]" }
-  function isObject(value) { return value instanceof Object }
-  function isPlainObject(value) {
-    var key, ctor
-    if (toString.call(value) !== "[object Object]") return false
-    ctor = (isFunction(value.constructor) && value.constructor.prototype)
-    if (!ctor || !hasOwnProperty.call(ctor, 'isPrototypeOf')) return false
-    for (key in value);
-    return key === undefined || hasOwnProperty.call(value, key)
-  }
-  function isArray(value) { return value instanceof Array }
-  function likeArray(obj) { return typeof obj.length == 'number' }
-
-  function compact(array) { return array.filter(function(item){ return item !== undefined && item !== null }) }
-  function flatten(array) { return array.length > 0 ? [].concat.apply([], array) : array }
-  camelize = function(str){ return str.replace(/-+(.)?/g, function(match, chr){ return chr ? chr.toUpperCase() : '' }) }
-  function dasherize(str) {
-    return str.replace(/::/g, '/')
-           .replace(/([A-Z]+)([A-Z][a-z])/g, '$1_$2')
-           .replace(/([a-z\d])([A-Z])/g, '$1_$2')
-           .replace(/_/g, '-')
-           .toLowerCase()
-  }
-  uniq = function(array){ return array.filter(function(item, idx){ return array.indexOf(item) == idx }) }
-
-  function classRE(name) {
-    return name in classCache ?
-      classCache[name] : (classCache[name] = new RegExp('(^|\\s)' + name + '(\\s|$)'))
-  }
-
-  function maybeAddPx(name, value) {
-    return (typeof value == "number" && !cssNumber[dasherize(name)]) ? value + "px" : value
-  }
-
-  function defaultDisplay(nodeName) {
-    var element, display
-    if (!elementDisplay[nodeName]) {
-      element = document.createElement(nodeName)
-      document.body.appendChild(element)
-      display = getComputedStyle(element, '').getPropertyValue("display")
-      element.parentNode.removeChild(element)
-      display == "none" && (display = "block")
-      elementDisplay[nodeName] = display
-    }
-    return elementDisplay[nodeName]
-  }
-
-  // `$.zepto.fragment` takes a html string and an optional tag name
-  // to generate DOM nodes nodes from the given html string.
-  // The generated DOM nodes are returned as an array.
-  // This function can be overriden in plugins for example to make
-  // it compatible with browsers that don't support the DOM fully.
-  zepto.fragment = function(html, name) {
-    if (name === undefined) name = fragmentRE.test(html) && RegExp.$1
-    if (!(name in containers)) name = '*'
-    var container = containers[name]
-    container.innerHTML = '' + html
-    return $.each(slice.call(container.childNodes), function(){
-      container.removeChild(this)
-    })
-  }
-
-  // `$.zepto.Z` swaps out the prototype of the given `dom` array
-  // of nodes with `$.fn` and thus supplying all the Zepto functions
-  // to the array. Note that `__proto__` is not supported on Internet
-  // Explorer. This method can be overriden in plugins.
-  zepto.Z = function(dom, selector) {
-    dom = dom || []
-    dom.__proto__ = arguments.callee.prototype
-    dom.selector = selector || ''
-    return dom
-  }
-
-  // `$.zepto.isZ` should return `true` if the given object is a Zepto
-  // collection. This method can be overriden in plugins.
-  zepto.isZ = function(object) {
-    return object instanceof zepto.Z
-  }
-
-  // `$.zepto.init` is Zepto's counterpart to jQuery's `$.fn.init` and
-  // takes a CSS selector and an optional context (and handles various
-  // special cases).
-  // This method can be overriden in plugins.
-  zepto.init = function(selector, context) {
-    // If nothing given, return an empty Zepto collection
-    if (!selector) return zepto.Z()
-    // If a function is given, call it when the DOM is ready
-    else if (isFunction(selector)) return $(document).ready(selector)
-    // If a Zepto collection is given, juts return it
-    else if (zepto.isZ(selector)) return selector
-    else {
-      var dom
-      // normalize array if an array of nodes is given
-      if (isArray(selector)) dom = compact(selector)
-      // if a JavaScript object is given, return a copy of it
-      // this is a somewhat peculiar option, but supported by
-      // jQuery so we'll do it, too
-      else if (isPlainObject(selector))
-        dom = [$.extend({}, selector)], selector = null
-      // wrap stuff like `document` or `window`
-      else if (elementTypes.indexOf(selector.nodeType) >= 0 || selector === window)
-        dom = [selector], selector = null
-      // If it's a html fragment, create nodes from it
-      else if (fragmentRE.test(selector))
-        dom = zepto.fragment(selector.trim(), RegExp.$1), selector = null
-      // If there's a context, create a collection on that context first, and select
-      // nodes from there
-      else if (context !== undefined) return $(context).find(selector)
-      // And last but no least, if it's a CSS selector, use it to select nodes.
-      else dom = zepto.qsa(document, selector)
-      // create a new Zepto collection from the nodes found
-      return zepto.Z(dom, selector)
-    }
-  }
-
-  // `$` will be the base `Zepto` object. When calling this
-  // function just call `$.zepto.init, whichs makes the implementation
-  // details of selecting nodes and creating Zepto collections
-  // patchable in plugins.
-  $ = function(selector, context){
-    return zepto.init(selector, context)
-  }
-
-  // Copy all but undefined properties from one or more
-  // objects to the `target` object.
-  $.extend = function(target){
-    slice.call(arguments, 1).forEach(function(source) {
-      for (key in source)
-        if (source[key] !== undefined)
-          target[key] = source[key]
-    })
-    return target
-  }
-
-  // `$.zepto.qsa` is Zepto's CSS selector implementation which
-  // uses `document.querySelectorAll` and optimizes for some special cases, like `#id`.
-  // This method can be overriden in plugins.
-  zepto.qsa = function(element, selector){
-    var found
-    return (element === document && idSelectorRE.test(selector)) ?
-      ( (found = element.getElementById(RegExp.$1)) ? [found] : emptyArray ) :
-      (element.nodeType !== 1 && element.nodeType !== 9) ? emptyArray :
-      slice.call(
-        classSelectorRE.test(selector) ? element.getElementsByClassName(RegExp.$1) :
-        tagSelectorRE.test(selector) ? element.getElementsByTagName(selector) :
-        element.querySelectorAll(selector)
-      )
-  }
-
-  function filtered(nodes, selector) {
-    return selector === undefined ? $(nodes) : $(nodes).filter(selector)
-  }
-
-  function funcArg(context, arg, idx, payload) {
-   return isFunction(arg) ? arg.call(context, idx, payload) : arg
-  }
-
-  $.isFunction = isFunction
-  $.isObject = isObject
-  $.isArray = isArray
-  $.isPlainObject = isPlainObject
-
-  $.inArray = function(elem, array, i){
-    return emptyArray.indexOf.call(array, elem, i)
-  }
-
-  $.trim = function(str) { return str.trim() }
-
-  // plugin compatibility
-  $.uuid = 0
-
-  $.map = function(elements, callback){
-    var value, values = [], i, key
-    if (likeArray(elements))
-      for (i = 0; i < elements.length; i++) {
-        value = callback(elements[i], i)
-        if (value != null) values.push(value)
-      }
-    else
-      for (key in elements) {
-        value = callback(elements[key], key)
-        if (value != null) values.push(value)
-      }
-    return flatten(values)
-  }
-
-  $.each = function(elements, callback){
-    var i, key
-    if (likeArray(elements)) {
-      for (i = 0; i < elements.length; i++)
-        if (callback.call(elements[i], i, elements[i]) === false) return elements
-    } else {
-      for (key in elements)
-        if (callback.call(elements[key], key, elements[key]) === false) return elements
-    }
-
-    return elements
-  }
-
-  // Define methods that will be available on all
-  // Zepto collections
-  $.fn = {
-    // Because a collection acts like an array
-    // copy over these useful array functions.
-    forEach: emptyArray.forEach,
-    reduce: emptyArray.reduce,
-    push: emptyArray.push,
-    indexOf: emptyArray.indexOf,
-    concat: emptyArray.concat,
-
-    // `map` and `slice` in the jQuery API work differently
-    // from their array counterparts
-    map: function(fn){
-      return $.map(this, function(el, i){ return fn.call(el, i, el) })
-    },
-    slice: function(){
-      return $(slice.apply(this, arguments))
-    },
-
-    ready: function(callback){
-      if (readyRE.test(document.readyState)) callback($)
-      else document.addEventListener('DOMContentLoaded', function(){ callback($) }, false)
-      return this
-    },
-    get: function(idx){
-      return idx === undefined ? slice.call(this) : this[idx]
-    },
-    toArray: function(){ return this.get() },
-    size: function(){
-      return this.length
-    },
-    remove: function(){
-      return this.each(function(){
-        if (this.parentNode != null)
-          this.parentNode.removeChild(this)
-      })
-    },
-    each: function(callback){
-      this.forEach(function(el, idx){ callback.call(el, idx, el) })
-      return this
-    },
-    filter: function(selector){
-      return $([].filter.call(this, function(element){
-        return zepto.matches(element, selector)
-      }))
-    },
-    add: function(selector,context){
-      return $(uniq(this.concat($(selector,context))))
-    },
-    is: function(selector){
-      return this.length > 0 && zepto.matches(this[0], selector)
-    },
-    not: function(selector){
-      var nodes=[]
-      if (isFunction(selector) && selector.call !== undefined)
-        this.each(function(idx){
-          if (!selector.call(this,idx)) nodes.push(this)
-        })
-      else {
-        var excludes = typeof selector == 'string' ? this.filter(selector) :
-          (likeArray(selector) && isFunction(selector.item)) ? slice.call(selector) : $(selector)
-        this.forEach(function(el){
-          if (excludes.indexOf(el) < 0) nodes.push(el)
-        })
-      }
-      return $(nodes)
-    },
-    eq: function(idx){
-      return idx === -1 ? this.slice(idx) : this.slice(idx, + idx + 1)
-    },
-    first: function(){
-      var el = this[0]
-      return el && !isObject(el) ? el : $(el)
-    },
-    last: function(){
-      var el = this[this.length - 1]
-      return el && !isObject(el) ? el : $(el)
-    },
-    find: function(selector){
-      var result
-      if (this.length == 1) result = zepto.qsa(this[0], selector)
-      else result = this.map(function(){ return zepto.qsa(this, selector) })
-      return $(result)
-    },
-    closest: function(selector, context){
-      var node = this[0]
-      while (node && !zepto.matches(node, selector))
-        node = node !== context && node !== document && node.parentNode
-      return $(node)
-    },
-    parents: function(selector){
-      var ancestors = [], nodes = this
-      while (nodes.length > 0)
-        nodes = $.map(nodes, function(node){
-          if ((node = node.parentNode) && node !== document && ancestors.indexOf(node) < 0) {
-            ancestors.push(node)
-            return node
-          }
-        })
-      return filtered(ancestors, selector)
-    },
-    parent: function(selector){
-      return filtered(uniq(this.pluck('parentNode')), selector)
-    },
-    children: function(selector){
-      return filtered(this.map(function(){ return slice.call(this.children) }), selector)
-    },
-    siblings: function(selector){
-      return filtered(this.map(function(i, el){
-        return slice.call(el.parentNode.children).filter(function(child){ return child!==el })
-      }), selector)
-    },
-    empty: function(){
-      return this.each(function(){ this.innerHTML = '' })
-    },
-    // `pluck` is borrowed from Prototype.js
-    pluck: function(property){
-      return this.map(function(){ return this[property] })
-    },
-    show: function(){
-      return this.each(function(){
-        this.style.display == "none" && (this.style.display = null)
-        if (getComputedStyle(this, '').getPropertyValue("display") == "none")
-          this.style.display = defaultDisplay(this.nodeName)
-      })
-    },
-    replaceWith: function(newContent){
-      return this.before(newContent).remove()
-    },
-    wrap: function(newContent){
-      return this.each(function(){
-        $(this).wrapAll($(newContent)[0].cloneNode(false))
-      })
-    },
-    wrapAll: function(newContent){
-      if (this[0]) {
-        $(this[0]).before(newContent = $(newContent))
-        newContent.append(this)
-      }
-      return this
-    },
-    unwrap: function(){
-      this.parent().each(function(){
-        $(this).replaceWith($(this).children())
-      })
-      return this
-    },
-    clone: function(){
-      return $(this.map(function(){ return this.cloneNode(true) }))
-    },
-    hide: function(){
-      return this.css("display", "none")
-    },
-    toggle: function(setting){
-      return (setting === undefined ? this.css("display") == "none" : setting) ? this.show() : this.hide()
-    },
-    prev: function(){ return $(this.pluck('previousElementSibling')) },
-    next: function(){ return $(this.pluck('nextElementSibling')) },
-    html: function(html){
-      return html === undefined ?
-        (this.length > 0 ? this[0].innerHTML : null) :
-        this.each(function(idx){
-          var originHtml = this.innerHTML
-          $(this).empty().append( funcArg(this, html, idx, originHtml) )
-        })
-    },
-    text: function(text){
-      return text === undefined ?
-        (this.length > 0 ? this[0].textContent : null) :
-        this.each(function(){ this.textContent = text })
-    },
-    attr: function(name, value){
-      var result
-      return (typeof name == 'string' && value === undefined) ?
-        (this.length == 0 || this[0].nodeType !== 1 ? undefined :
-          (name == 'value' && this[0].nodeName == 'INPUT') ? this.val() :
-          (!(result = this[0].getAttribute(name)) && name in this[0]) ? this[0][name] : result
-        ) :
-        this.each(function(idx){
-          if (this.nodeType !== 1) return
-          if (isObject(name)) for (key in name) this.setAttribute(key, name[key])
-          else this.setAttribute(name, funcArg(this, value, idx, this.getAttribute(name)))
-        })
-    },
-    removeAttr: function(name){
-      return this.each(function(){ if (this.nodeType === 1) this.removeAttribute(name) })
-    },
-    prop: function(name, value){
-      return (value === undefined) ?
-        (this[0] ? this[0][name] : undefined) :
-        this.each(function(idx){
-          this[name] = funcArg(this, value, idx, this[name])
-        })
-    },
-    data: function(name, value){
-      var data = this.attr('data-' + dasherize(name), value)
-      return data !== null ? data : undefined
-    },
-    val: function(value){
-      return (value === undefined) ?
-        (this.length > 0 ? this[0].value : undefined) :
-        this.each(function(idx){
-          this.value = funcArg(this, value, idx, this.value)
-        })
-    },
-    offset: function(){
-      if (this.length==0) return null
-      var obj = this[0].getBoundingClientRect()
-      return {
-        left: obj.left + window.pageXOffset,
-        top: obj.top + window.pageYOffset,
-        width: obj.width,
-        height: obj.height
-      }
-    },
-    css: function(property, value){
-      if (value === undefined && typeof property == 'string')
-        return (
-          this.length == 0
-            ? undefined
-            : this[0].style[camelize(property)] || getComputedStyle(this[0], '').getPropertyValue(property))
-
-      var css = ''
-      for (key in property)
-        if(typeof property[key] == 'string' && property[key] == '')
-          this.each(function(){ this.style.removeProperty(dasherize(key)) })
-        else
-          css += dasherize(key) + ':' + maybeAddPx(key, property[key]) + ';'
-
-      if (typeof property == 'string')
-        if (value == '')
-          this.each(function(){ this.style.removeProperty(dasherize(property)) })
-        else
-          css = dasherize(property) + ":" + maybeAddPx(property, value)
-
-      return this.each(function(){ this.style.cssText += ';' + css })
-    },
-    index: function(element){
-      return element ? this.indexOf($(element)[0]) : this.parent().children().indexOf(this[0])
-    },
-    hasClass: function(name){
-      if (this.length < 1) return false
-      else return classRE(name).test(this[0].className)
-    },
-    addClass: function(name){
-      return this.each(function(idx){
-        classList = []
-        var cls = this.className, newName = funcArg(this, name, idx, cls)
-        newName.split(/\s+/g).forEach(function(klass){
-          if (!$(this).hasClass(klass)) classList.push(klass)
-        }, this)
-        classList.length && (this.className += (cls ? " " : "") + classList.join(" "))
-      })
-    },
-    removeClass: function(name){
-      return this.each(function(idx){
-        if (name === undefined)
-          return this.className = ''
-        classList = this.className
-        funcArg(this, name, idx, classList).split(/\s+/g).forEach(function(klass){
-          classList = classList.replace(classRE(klass), " ")
-        })
-        this.className = classList.trim()
-      })
-    },
-    toggleClass: function(name, when){
-      return this.each(function(idx){
-        var newName = funcArg(this, name, idx, this.className)
-        ;(when === undefined ? !$(this).hasClass(newName) : when) ?
-          $(this).addClass(newName) : $(this).removeClass(newName)
-      })
-    }
-  }
-
-  // Generate the `width` and `height` functions
-  ;['width', 'height'].forEach(function(dimension){
-    $.fn[dimension] = function(value){
-      var offset, Dimension = dimension.replace(/./, function(m){ return m[0].toUpperCase() })
-      if (value === undefined) return this[0] == window ? window['inner' + Dimension] :
-        this[0] == document ? document.documentElement['offset' + Dimension] :
-        (offset = this.offset()) && offset[dimension]
-      else return this.each(function(idx){
-        var el = $(this)
-        el.css(dimension, funcArg(this, value, idx, el[dimension]()))
-      })
-    }
-  })
-
-  function insert(operator, target, node) {
-    var parent = (operator % 2) ? target : target.parentNode
-    parent ? parent.insertBefore(node,
-      !operator ? target.nextSibling :      // after
-      operator == 1 ? parent.firstChild :   // prepend
-      operator == 2 ? target :              // before
-      null) :                               // append
-      $(node).remove()
-  }
-
-  function traverseNode(node, fun) {
-    fun(node)
-    for (var key in node.childNodes) traverseNode(node.childNodes[key], fun)
-  }
-
-  // Generate the `after`, `prepend`, `before`, `append`,
-  // `insertAfter`, `insertBefore`, `appendTo`, and `prependTo` methods.
-  adjacencyOperators.forEach(function(key, operator) {
-    $.fn[key] = function(){
-      // arguments can be nodes, arrays of nodes, Zepto objects and HTML strings
-      var nodes = $.map(arguments, function(n){ return isObject(n) ? n : zepto.fragment(n) })
-      if (nodes.length < 1) return this
-      var size = this.length, copyByClone = size > 1, inReverse = operator < 2
-
-      return this.each(function(index, target){
-        for (var i = 0; i < nodes.length; i++) {
-          var node = nodes[inReverse ? nodes.length-i-1 : i]
-          traverseNode(node, function(node){
-            if (node.nodeName != null && node.nodeName.toUpperCase() === 'SCRIPT' && (!node.type || node.type === 'text/javascript'))
-              window['eval'].call(window, node.innerHTML)
-          })
-          if (copyByClone && index < size - 1) node = node.cloneNode(true)
-          insert(operator, target, node)
-        }
-      })
-    }
-
-    $.fn[(operator % 2) ? key+'To' : 'insert'+(operator ? 'Before' : 'After')] = function(html){
-      $(html)[key](this)
-      return this
-    }
-  })
-
-  zepto.Z.prototype = $.fn
-
-  // Export internal API functions in the `$.zepto` namespace
-  zepto.camelize = camelize
-  zepto.uniq = uniq
-  $.zepto = zepto
-
-  return $
-})()
-
-// If `$` is not yet defined, point it to `Zepto`
-window.Zepto = Zepto
-'$' in window || (window.$ = Zepto)
-;(function($){
-  var $$ = $.zepto.qsa, handlers = {}, _zid = 1, specialEvents={}
-
-  specialEvents.click = specialEvents.mousedown = specialEvents.mouseup = specialEvents.mousemove = 'MouseEvents'
-
-  function zid(element) {
-    return element._zid || (element._zid = _zid++)
-  }
-  function findHandlers(element, event, fn, selector) {
-    event = parse(event)
-    if (event.ns) var matcher = matcherFor(event.ns)
-    return (handlers[zid(element)] || []).filter(function(handler) {
-      return handler
-        && (!event.e  || handler.e == event.e)
-        && (!event.ns || matcher.test(handler.ns))
-        && (!fn       || zid(handler.fn) === zid(fn))
-        && (!selector || handler.sel == selector)
-    })
-  }
-  function parse(event) {
-    var parts = ('' + event).split('.')
-    return {e: parts[0], ns: parts.slice(1).sort().join(' ')}
-  }
-  function matcherFor(ns) {
-    return new RegExp('(?:^| )' + ns.replace(' ', ' .* ?') + '(?: |$)')
-  }
-
-  function eachEvent(events, fn, iterator){
-    if ($.isObject(events)) $.each(events, iterator)
-    else events.split(/\s/).forEach(function(type){ iterator(type, fn) })
-  }
-
-  function add(element, events, fn, selector, getDelegate, capture){
-    capture = !!capture
-    var id = zid(element), set = (handlers[id] || (handlers[id] = []))
-    eachEvent(events, fn, function(event, fn){
-      var delegate = getDelegate && getDelegate(fn, event),
-        callback = delegate || fn
-      var proxyfn = function (event) {
-        var result = callback.apply(element, [event].concat(event.data))
-        if (result === false) event.preventDefault()
-        return result
-      }
-      var handler = $.extend(parse(event), {fn: fn, proxy: proxyfn, sel: selector, del: delegate, i: set.length})
-      set.push(handler)
-      element.addEventListener(handler.e, proxyfn, capture)
-    })
-  }
-  function remove(element, events, fn, selector){
-    var id = zid(element)
-    eachEvent(events || '', fn, function(event, fn){
-      findHandlers(element, event, fn, selector).forEach(function(handler){
-        delete handlers[id][handler.i]
-        element.removeEventListener(handler.e, handler.proxy, false)
-      })
-    })
-  }
-
-  $.event = { add: add, remove: remove }
-
-  $.proxy = function(fn, context) {
-    if ($.isFunction(fn)) {
-      var proxyFn = function(){ return fn.apply(context, arguments) }
-      proxyFn._zid = zid(fn)
-      return proxyFn
-    } else if (typeof context == 'string') {
-      return $.proxy(fn[context], fn)
-    } else {
-      throw new TypeError("expected function")
-    }
-  }
-
-  $.fn.bind = function(event, callback){
-    return this.each(function(){
-      add(this, event, callback)
-    })
-  }
-  $.fn.unbind = function(event, callback){
-    return this.each(function(){
-      remove(this, event, callback)
-    })
-  }
-  $.fn.one = function(event, callback){
-    return this.each(function(i, element){
-      add(this, event, callback, null, function(fn, type){
-        return function(){
-          var result = fn.apply(element, arguments)
-          remove(element, type, fn)
-          return result
-        }
-      })
-    })
-  }
-
-  var returnTrue = function(){return true},
-      returnFalse = function(){return false},
-      eventMethods = {
-        preventDefault: 'isDefaultPrevented',
-        stopImmediatePropagation: 'isImmediatePropagationStopped',
-        stopPropagation: 'isPropagationStopped'
-      }
-  function createProxy(event) {
-    var proxy = $.extend({originalEvent: event}, event)
-    $.each(eventMethods, function(name, predicate) {
-      proxy[name] = function(){
-        this[predicate] = returnTrue
-        return event[name].apply(event, arguments)
-      }
-      proxy[predicate] = returnFalse
-    })
-    return proxy
-  }
-
-  // emulates the 'defaultPrevented' property for browsers that have none
-  function fix(event) {
-    if (!('defaultPrevented' in event)) {
-      event.defaultPrevented = false
-      var prevent = event.preventDefault
-      event.preventDefault = function() {
-        this.defaultPrevented = true
-        prevent.call(this)
-      }
-    }
-  }
-
-  $.fn.delegate = function(selector, event, callback){
-    var capture = false
-    if(event == 'blur' || event == 'focus'){
-      if($.iswebkit)
-        event = event == 'blur' ? 'focusout' : event == 'focus' ? 'focusin' : event
-      else
-        capture = true
-    }
-
-    return this.each(function(i, element){
-      add(element, event, callback, selector, function(fn){
-        return function(e){
-          var evt, match = $(e.target).closest(selector, element).get(0)
-          if (match) {
-            evt = $.extend(createProxy(e), {currentTarget: match, liveFired: element})
-            return fn.apply(match, [evt].concat([].slice.call(arguments, 1)))
-          }
-        }
-      }, capture)
-    })
-  }
-  $.fn.undelegate = function(selector, event, callback){
-    return this.each(function(){
-      remove(this, event, callback, selector)
-    })
-  }
-
-  $.fn.live = function(event, callback){
-    $(document.body).delegate(this.selector, event, callback)
-    return this
-  }
-  $.fn.die = function(event, callback){
-    $(document.body).undelegate(this.selector, event, callback)
-    return this
-  }
-
-  $.fn.on = function(event, selector, callback){
-    return selector == undefined || $.isFunction(selector) ?
-      this.bind(event, selector) : this.delegate(selector, event, callback)
-  }
-  $.fn.off = function(event, selector, callback){
-    return selector == undefined || $.isFunction(selector) ?
-      this.unbind(event, selector) : this.undelegate(selector, event, callback)
-  }
-
-  $.fn.trigger = function(event, data){
-    if (typeof event == 'string') event = $.Event(event)
-    fix(event)
-    event.data = data
-    return this.each(function(){
-      // items in the collection might not be DOM elements
-      // (todo: possibly support events on plain old objects)
-      if('dispatchEvent' in this) this.dispatchEvent(event)
-    })
-  }
-
-  // triggers event handlers on current element just as if an event occurred,
-  // doesn't trigger an actual event, doesn't bubble
-  $.fn.triggerHandler = function(event, data){
-    var e, result
-    this.each(function(i, element){
-      e = createProxy(typeof event == 'string' ? $.Event(event) : event)
-      e.data = data
-      e.target = element
-      $.each(findHandlers(element, event.type || event), function(i, handler){
-        result = handler.proxy(e)
-        if (e.isImmediatePropagationStopped()) return false
-      })
-    })
-    return result
-  }
-
-  // shortcut methods for `.bind(event, fn)` for each event type
-  ;('focusin focusout load resize scroll unload click dblclick '+
-  'mousedown mouseup mousemove mouseover mouseout '+
-  'change select keydown keypress keyup error').split(' ').forEach(function(event) {
-    $.fn[event] = function(callback){ return this.bind(event, callback) }
-  })
-
-  ;['focus', 'blur'].forEach(function(name) {
-    $.fn[name] = function(callback) {
-      if (callback) this.bind(name, callback)
-      else if (this.length) try { this.get(0)[name]() } catch(e){}
-      return this
-    }
-  })
-
-  $.Event = function(type, props) {
-    var event = document.createEvent(specialEvents[type] || 'Events'), bubbles = true
-    if (props) for (var name in props) (name == 'bubbles') ? (bubbles = !!props[name]) : (event[name] = props[name])
-    event.initEvent(type, bubbles, true, null, null, null, null, null, null, null, null, null, null, null, null)
-    return event
-  }
-
-})(Zepto)
-;(function($){
-  function detect(ua){
-    var os = this.os = {}, browser = this.browser = {},
-      webkit = ua.match(/WebKit\/([\d.]+)/),
-      android = ua.match(/(Android)\s+([\d.]+)/),
-      ipad = ua.match(/(iPad).*OS\s([\d_]+)/),
-      iphone = !ipad && ua.match(/(iPhone\sOS)\s([\d_]+)/),
-      webos = ua.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),
-      touchpad = webos && ua.match(/TouchPad/),
-      kindle = ua.match(/Kindle\/([\d.]+)/),
-      silk = ua.match(/Silk\/([\d._]+)/),
-      blackberry = ua.match(/(BlackBerry).*Version\/([\d.]+)/)
-
-    // todo clean this up with a better OS/browser
-    // separation. we need to discern between multiple
-    // browsers on android, and decide if kindle fire in
-    // silk mode is android or not
-
-    if (browser.webkit = !!webkit) browser.version = webkit[1]
-
-    if (android) os.android = true, os.version = android[2]
-    if (iphone) os.ios = os.iphone = true, os.version = iphone[2].replace(/_/g, '.')
-    if (ipad) os.ios = os.ipad = true, os.version = ipad[2].replace(/_/g, '.')
-    if (webos) os.webos = true, os.version = webos[2]
-    if (touchpad) os.touchpad = true
-    if (blackberry) os.blackberry = true, os.version = blackberry[2]
-    if (kindle) os.kindle = true, os.version = kindle[1]
-    if (silk) browser.silk = true, browser.version = silk[1]
-    if (!silk && os.android && ua.match(/Kindle Fire/)) browser.silk = true
-  }
-
-  detect.call($, navigator.userAgent)
-  // make available to unit tests
-  $.__detect = detect
-
-})(Zepto)
-;(function($, undefined){
-  var prefix = '', eventPrefix, endEventName, endAnimationName,
-    vendors = { Webkit: 'webkit', Moz: '', O: 'o', ms: 'MS' },
-    document = window.document, testEl = document.createElement('div'),
-    supportedTransforms = /^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,
-    clearProperties = {}
-
-  function downcase(str) { return str.toLowerCase() }
-  function normalizeEvent(name) { return eventPrefix ? eventPrefix + name : downcase(name) }
-
-  $.each(vendors, function(vendor, event){
-    if (testEl.style[vendor + 'TransitionProperty'] !== undefined) {
-      prefix = '-' + downcase(vendor) + '-'
-      eventPrefix = event
-      return false
-    }
-  })
-
-  clearProperties[prefix + 'transition-property'] =
-  clearProperties[prefix + 'transition-duration'] =
-  clearProperties[prefix + 'transition-timing-function'] =
-  clearProperties[prefix + 'animation-name'] =
-  clearProperties[prefix + 'animation-duration'] = ''
-
-  $.fx = {
-    off: (eventPrefix === undefined && testEl.style.transitionProperty === undefined),
-    cssPrefix: prefix,
-    transitionEnd: normalizeEvent('TransitionEnd'),
-    animationEnd: normalizeEvent('AnimationEnd')
-  }
-
-  $.fn.animate = function(properties, duration, ease, callback){
-    if ($.isObject(duration))
-      ease = duration.easing, callback = duration.complete, duration = duration.duration
-    if (duration) duration = duration / 1000
-    return this.anim(properties, duration, ease, callback)
-  }
-
-  $.fn.anim = function(properties, duration, ease, callback){
-    var transforms, cssProperties = {}, key, that = this, wrappedCallback, endEvent = $.fx.transitionEnd
-    if (duration === undefined) duration = 0.4
-    if ($.fx.off) duration = 0
-
-    if (typeof properties == 'string') {
-      // keyframe animation
-      cssProperties[prefix + 'animation-name'] = properties
-      cssProperties[prefix + 'animation-duration'] = duration + 's'
-      endEvent = $.fx.animationEnd
-    } else {
-      // CSS transitions
-      for (key in properties)
-        if (supportedTransforms.test(key)) {
-          transforms || (transforms = [])
-          transforms.push(key + '(' + properties[key] + ')')
-        }
-        else cssProperties[key] = properties[key]
-
-      if (transforms) cssProperties[prefix + 'transform'] = transforms.join(' ')
-      if (!$.fx.off && typeof properties === 'object') {
-        cssProperties[prefix + 'transition-property'] = Object.keys(properties).join(', ')
-        cssProperties[prefix + 'transition-duration'] = duration + 's'
-        cssProperties[prefix + 'transition-timing-function'] = (ease || 'linear')
-      }
-    }
-
-    wrappedCallback = function(event){
-      if (typeof event !== 'undefined') {
-        if (event.target !== event.currentTarget) return // makes sure the event didn't bubble from "below"
-        $(event.target).unbind(endEvent, arguments.callee)
-      }
-      $(this).css(clearProperties)
-      callback && callback.call(this)
-    }
-    if (duration > 0) this.bind(endEvent, wrappedCallback)
-
-    setTimeout(function() {
-      that.css(cssProperties)
-      if (duration <= 0) setTimeout(function() {
-        that.each(function(){ wrappedCallback.call(this) })
-      }, 0)
-    }, 0)
-
-    return this
-  }
-
-  testEl = null
-})(Zepto)
-;(function($){
-  var jsonpID = 0,
-      isObject = $.isObject,
-      document = window.document,
-      key,
-      name,
-      rscript = /<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,
-      scriptTypeRE = /^(?:text|application)\/javascript/i,
-      xmlTypeRE = /^(?:text|application)\/xml/i,
-      jsonType = 'application/json',
-      htmlType = 'text/html',
-      blankRE = /^\s*$/
-
-  // trigger a custom event and return false if it was cancelled
-  function triggerAndReturn(context, eventName, data) {
-    var event = $.Event(eventName)
-    $(context).trigger(event, data)
-    return !event.defaultPrevented
-  }
-
-  // trigger an Ajax "global" event
-  function triggerGlobal(settings, context, eventName, data) {
-    if (settings.global) return triggerAndReturn(context || document, eventName, data)
-  }
-
-  // Number of active Ajax requests
-  $.active = 0
-
-  function ajaxStart(settings) {
-    if (settings.global && $.active++ === 0) triggerGlobal(settings, null, 'ajaxStart')
-  }
-  function ajaxStop(settings) {
-    if (settings.global && !(--$.active)) triggerGlobal(settings, null, 'ajaxStop')
-  }
-
-  // triggers an extra global event "ajaxBeforeSend" that's like "ajaxSend" but cancelable
-  function ajaxBeforeSend(xhr, settings) {
-    var context = settings.context
-    if (settings.beforeSend.call(context, xhr, settings) === false ||
-        triggerGlobal(settings, context, 'ajaxBeforeSend', [xhr, settings]) === false)
-      return false
-
-    triggerGlobal(settings, context, 'ajaxSend', [xhr, settings])
-  }
-  function ajaxSuccess(data, xhr, settings) {
-    var context = settings.context, status = 'success'
-    settings.success.call(context, data, status, xhr)
-    triggerGlobal(settings, context, 'ajaxSuccess', [xhr, settings, data])
-    ajaxComplete(status, xhr, settings)
-  }
-  // type: "timeout", "error", "abort", "parsererror"
-  function ajaxError(error, type, xhr, settings) {
-    var context = settings.context
-    settings.error.call(context, xhr, type, error)
-    triggerGlobal(settings, context, 'ajaxError', [xhr, settings, error])
-    ajaxComplete(type, xhr, settings)
-  }
-  // status: "success", "notmodified", "error", "timeout", "abort", "parsererror"
-  function ajaxComplete(status, xhr, settings) {
-    var context = settings.context
-    settings.complete.call(context, xhr, status)
-    triggerGlobal(settings, context, 'ajaxComplete', [xhr, settings])
-    ajaxStop(settings)
-  }
-
-  // Empty function, used as default callback
-  function empty() {}
-
-  $.ajaxJSONP = function(options){
-    var callbackName = 'jsonp' + (++jsonpID),
-      script = document.createElement('script'),
-      abort = function(){
-        $(script).remove()
-        if (callbackName in window) window[callbackName] = empty
-        ajaxComplete('abort', xhr, options)
-      },
-      xhr = { abort: abort }, abortTimeout
-
-    if (options.error) script.onerror = function() {
-      xhr.abort()
-      options.error()
-    }
-
-    window[callbackName] = function(data){
-      clearTimeout(abortTimeout)
-      $(script).remove()
-      delete window[callbackName]
-      ajaxSuccess(data, xhr, options)
-    }
-
-    serializeData(options)
-    script.src = options.url.replace(/=\?/, '=' + callbackName)
-    $('head').append(script)
-
-    if (options.timeout > 0) abortTimeout = setTimeout(function(){
-        xhr.abort()
-        ajaxComplete('timeout', xhr, options)
-      }, options.timeout)
-
-    return xhr
-  }
-
-  $.ajaxSettings = {
-    // Default type of request
-    type: 'GET',
-    // Callback that is executed before request
-    beforeSend: empty,
-    // Callback that is executed if the request succeeds
-    success: empty,
-    // Callback that is executed the the server drops error
-    error: empty,
-    // Callback that is executed on request complete (both: error and success)
-    complete: empty,
-    // The context for the callbacks
-    context: null,
-    // Whether to trigger "global" Ajax events
-    global: true,
-    // Transport
-    xhr: function () {
-      return new window.XMLHttpRequest()
-    },
-    // MIME types mapping
-    accepts: {
-      script: 'text/javascript, application/javascript',
-      json:   jsonType,
-      xml:    'application/xml, text/xml',
-      html:   htmlType,
-      text:   'text/plain'
-    },
-    // Whether the request is to another domain
-    crossDomain: false,
-    // Default timeout
-    timeout: 0
-  }
-
-  function mimeToDataType(mime) {
-    return mime && ( mime == htmlType ? 'html' :
-      mime == jsonType ? 'json' :
-      scriptTypeRE.test(mime) ? 'script' :
-      xmlTypeRE.test(mime) && 'xml' ) || 'text'
-  }
-
-  function appendQuery(url, query) {
-    return (url + '&' + query).replace(/[&?]{1,2}/, '?')
-  }
-
-  // serialize payload and append it to the URL for GET requests
-  function serializeData(options) {
-    if (isObject(options.data)) options.data = $.param(options.data)
-    if (options.data && (!options.type || options.type.toUpperCase() == 'GET'))
-      options.url = appendQuery(options.url, options.data)
-  }
-
-  $.ajax = function(options){
-    var settings = $.extend({}, options || {})
-    for (key in $.ajaxSettings) if (settings[key] === undefined) settings[key] = $.ajaxSettings[key]
-
-    ajaxStart(settings)
-
-    if (!settings.crossDomain) settings.crossDomain = /^([\w-]+:)?\/\/([^\/]+)/.test(settings.url) &&
-      RegExp.$2 != window.location.host
-
-    var dataType = settings.dataType, hasPlaceholder = /=\?/.test(settings.url)
-    if (dataType == 'jsonp' || hasPlaceholder) {
-      if (!hasPlaceholder) settings.url = appendQuery(settings.url, 'callback=?')
-      return $.ajaxJSONP(settings)
-    }
-
-    if (!settings.url) settings.url = window.location.toString()
-    serializeData(settings)
-
-    var mime = settings.accepts[dataType],
-        baseHeaders = { },
-        protocol = /^([\w-]+:)\/\//.test(settings.url) ? RegExp.$1 : window.location.protocol,
-        xhr = $.ajaxSettings.xhr(), abortTimeout
-
-    if (!settings.crossDomain) baseHeaders['X-Requested-With'] = 'XMLHttpRequest'
-    if (mime) {
-      baseHeaders['Accept'] = mime
-      if (mime.indexOf(',') > -1) mime = mime.split(',', 2)[0]
-      xhr.overrideMimeType && xhr.overrideMimeType(mime)
-    }
-    if (settings.contentType || (settings.data && settings.type.toUpperCase() != 'GET'))
-      baseHeaders['Content-Type'] = (settings.contentType || 'application/x-www-form-urlencoded')
-    settings.headers = $.extend(baseHeaders, settings.headers || {})
-
-    xhr.onreadystatechange = function(){
-      if (xhr.readyState == 4) {
-        clearTimeout(abortTimeout)
-        var result, error = false
-        if ((xhr.status >= 200 && xhr.status < 300) || xhr.status == 304 || (xhr.status == 0 && protocol == 'file:')) {
-          dataType = dataType || mimeToDataType(xhr.getResponseHeader('content-type'))
-          result = xhr.responseText
-
-          try {
-            if (dataType == 'script')    (1,eval)(result)
-            else if (dataType == 'xml')  result = xhr.responseXML
-            else if (dataType == 'json') result = blankRE.test(result) ? null : JSON.parse(result)
-          } catch (e) { error = e }
-
-          if (error) ajaxError(error, 'parsererror', xhr, settings)
-          else ajaxSuccess(result, xhr, settings)
-        } else {
-          ajaxError(null, 'error', xhr, settings)
-        }
-      }
-    }
-
-    var async = 'async' in settings ? settings.async : true
-    xhr.open(settings.type, settings.url, async)
-
-    for (name in settings.headers) xhr.setRequestHeader(name, settings.headers[name])
-
-    if (ajaxBeforeSend(xhr, settings) === false) {
-      xhr.abort()
-      return false
-    }
-
-    if (settings.timeout > 0) abortTimeout = setTimeout(function(){
-        xhr.onreadystatechange = empty
-        xhr.abort()
-        ajaxError(null, 'timeout', xhr, settings)
-      }, settings.timeout)
-
-    // avoid sending empty string (#319)
-    xhr.send(settings.data ? settings.data : null)
-    return xhr
-  }
-
-  $.get = function(url, success){ return $.ajax({ url: url, success: success }) }
-
-  $.post = function(url, data, success, dataType){
-    if ($.isFunction(data)) dataType = dataType || success, success = data, data = null
-    return $.ajax({ type: 'POST', url: url, data: data, success: success, dataType: dataType })
-  }
-
-  $.getJSON = function(url, success){
-    return $.ajax({ url: url, success: success, dataType: 'json' })
-  }
-
-  $.fn.load = function(url, success){
-    if (!this.length) return this
-    var self = this, parts = url.split(/\s/), selector
-    if (parts.length > 1) url = parts[0], selector = parts[1]
-    $.get(url, function(response){
-      self.html(selector ?
-        $(document.createElement('div')).html(response.replace(rscript, "")).find(selector).html()
-        : response)
-      success && success.call(self)
-    })
-    return this
-  }
-
-  var escape = encodeURIComponent
-
-  function serialize(params, obj, traditional, scope){
-    var array = $.isArray(obj)
-    $.each(obj, function(key, value) {
-      if (scope) key = traditional ? scope : scope + '[' + (array ? '' : key) + ']'
-      // handle data in serializeArray() format
-      if (!scope && array) params.add(value.name, value.value)
-      // recurse into nested objects
-      else if (traditional ? $.isArray(value) : isObject(value))
-        serialize(params, value, traditional, key)
-      else params.add(key, value)
-    })
-  }
-
-  $.param = function(obj, traditional){
-    var params = []
-    params.add = function(k, v){ this.push(escape(k) + '=' + escape(v)) }
-    serialize(params, obj, traditional)
-    return params.join('&').replace('%20', '+')
-  }
-})(Zepto)
-;(function ($) {
-  $.fn.serializeArray = function () {
-    var result = [], el
-    $( Array.prototype.slice.call(this.get(0).elements) ).each(function () {
-      el = $(this)
-      var type = el.attr('type')
-      if (this.nodeName.toLowerCase() != 'fieldset' &&
-        !this.disabled && type != 'submit' && type != 'reset' && type != 'button' &&
-        ((type != 'radio' && type != 'checkbox') || this.checked))
-        result.push({
-          name: el.attr('name'),
-          value: el.val()
-        })
-    })
-    return result
-  }
-
-  $.fn.serialize = function () {
-    var result = []
-    this.serializeArray().forEach(function (elm) {
-      result.push( encodeURIComponent(elm.name) + '=' + encodeURIComponent(elm.value) )
-    })
-    return result.join('&')
-  }
-
-  $.fn.submit = function (callback) {
-    if (callback) this.bind('submit', callback)
-    else if (this.length) {
-      var event = $.Event('submit')
-      this.eq(0).trigger(event)
-      if (!event.defaultPrevented) this.get(0).submit()
-    }
-    return this
-  }
-
-})(Zepto)
-;(function($){
-  var touch = {}, touchTimeout
-
-  function parentIfText(node){
-    return 'tagName' in node ? node : node.parentNode
-  }
-
-  function swipeDirection(x1, x2, y1, y2){
-    var xDelta = Math.abs(x1 - x2), yDelta = Math.abs(y1 - y2)
-    return xDelta >= yDelta ? (x1 - x2 > 0 ? 'Left' : 'Right') : (y1 - y2 > 0 ? 'Up' : 'Down')
-  }
-
-  var longTapDelay = 750, longTapTimeout
-
-  function longTap(){
-    longTapTimeout = null
-    if (touch.last) {
-      touch.el.trigger('longTap')
-      touch = {}
-    }
-  }
-
-  function cancelLongTap(){
-    if (longTapTimeout) clearTimeout(longTapTimeout)
-    longTapTimeout = null
-  }
-
-  $(document).ready(function(){
-    var now, delta
-
-    $(document.body).bind('touchstart', function(e){
-      now = Date.now()
-      delta = now - (touch.last || now)
-      touch.el = $(parentIfText(e.touches[0].target))
-      touchTimeout && clearTimeout(touchTimeout)
-      touch.x1 = e.touches[0].pageX
-      touch.y1 = e.touches[0].pageY
-      if (delta > 0 && delta <= 250) touch.isDoubleTap = true
-      touch.last = now
-      longTapTimeout = setTimeout(longTap, longTapDelay)
-    }).bind('touchmove', function(e){
-      cancelLongTap()
-      touch.x2 = e.touches[0].pageX
-      touch.y2 = e.touches[0].pageY
-    }).bind('touchend', function(e){
-       cancelLongTap()
-
-      // double tap (tapped twice within 250ms)
-      if (touch.isDoubleTap) {
-        touch.el.trigger('doubleTap')
-        touch = {}
-
-      // swipe
-      } else if ((touch.x2 && Math.abs(touch.x1 - touch.x2) > 30) ||
-                 (touch.y2 && Math.abs(touch.y1 - touch.y2) > 30)) {
-        touch.el.trigger('swipe') &&
-          touch.el.trigger('swipe' + (swipeDirection(touch.x1, touch.x2, touch.y1, touch.y2)))
-        touch = {}
-
-      // normal tap
-      } else if ('last' in touch) {
-        touch.el.trigger('tap')
-
-        touchTimeout = setTimeout(function(){
-          touchTimeout = null
-          touch.el.trigger('singleTap')
-          touch = {}
-        }, 250)
-      }
-    }).bind('touchcancel', function(){
-      if (touchTimeout) clearTimeout(touchTimeout)
-      if (longTapTimeout) clearTimeout(longTapTimeout)
-      longTapTimeout = touchTimeout = null
-      touch = {}
-    })
-  })
-
-  ;['swipe', 'swipeLeft', 'swipeRight', 'swipeUp', 'swipeDown', 'doubleTap', 'tap', 'singleTap', 'longTap'].forEach(function(m){
-    $.fn[m] = function(callback){ return this.bind(m, callback) }
-  })
-})(Zepto)</div></li>
 <li>public/components/backbone/test/view.js<div>diff --git a/public/components/backbone/test/view.js b/public/components/backbone/test/view.js
index 7496c9d..58a8771 100644
--- a/public/components/backbone/test/view.js
+++ b/public/components/backbone/test/view.js
@@ -85,6 +85,13 @@ $(document).ready(function() {
     equal(view.counter, 3);
   });
 
+
+  test("delegateEvents ignore undefined methods", 0, function() {
+    var view = new Backbone.View({el: '<p></p>'});
+    view.delegateEvents({'click': 'undefinedMethod'});
+    view.$el.trigger('click');
+  });
+
   test("undelegateEvents", 6, function() {
     var counter1 = 0, counter2 = 0;
 </div></li>
 <li>public/components/requirejs-text/LICENSE<div>diff --git a/public/components/requirejs-text/LICENSE b/public/components/requirejs-text/LICENSE
new file mode 100644
index 0000000..ffaf317
--- /dev/null
+++ b/public/components/requirejs-text/LICENSE
@@ -0,0 +1,58 @@
+RequireJS is released under two licenses: new BSD, and MIT. You may pick the
+license that best suits your development needs. The text of both licenses are
+provided below.
+
+
+The "New" BSD License:
+----------------------
+
+Copyright (c) 2010-2011, The Dojo Foundation
+All rights reserved.
+
+Redistribution and use in source and binary forms, with or without
+modification, are permitted provided that the following conditions are met:
+
+  * Redistributions of source code must retain the above copyright notice, this
+    list of conditions and the following disclaimer.
+  * Redistributions in binary form must reproduce the above copyright notice,
+    this list of conditions and the following disclaimer in the documentation
+    and/or other materials provided with the distribution.
+  * Neither the name of the Dojo Foundation nor the names of its contributors
+    may be used to endorse or promote products derived from this software
+    without specific prior written permission.
+
+THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
+ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
+WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
+FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
+SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
+CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
+OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+
+
+
+MIT License
+-----------
+
+Copyright (c) 2010-2011, The Dojo Foundation
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in
+all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.</div></li>
 <li>public/components/requirejs-text/README.md<div>diff --git a/public/components/requirejs-text/README.md b/public/components/requirejs-text/README.md
new file mode 100644
index 0000000..a7650ef
--- /dev/null
+++ b/public/components/requirejs-text/README.md
@@ -0,0 +1,194 @@
+# text
+
+A [RequireJS](http://requirejs.org)/AMD loader plugin for loading text
+resources.
+
+Known to work in RequireJS, but should work in other AMD loaders that support
+the same loader plugin API.
+
+## Docs
+
+See the [RequireJS API text section](http://requirejs.org/docs/api.html#text).
+
+## Latest release
+
+The latest release is always available from [the "latest" tag](https://raw.github.com/requirejs/text/latest/text.js).
+
+It can also be installed using [volo](https://github.com/volojs/volo):
+
+    volo add requirejs/text
+
+## Usage
+
+It is nice to build HTML using regular HTML tags, instead of building up DOM
+structures in script. However, there is no good way to embed HTML in a
+JavaScript file. The best that can be done is using a string of HTML, but that
+can be hard to manage, particularly for multi-line HTML.
+
+The text.js AMD loader plugin can help with this issue. It will automatically be
+loaded if the text! prefix is used for a dependency. Download the plugin and put
+it in the app's [baseUrl](http://requirejs.org/docs/api.html#config-baseUrl)
+directory.
+
+You can specify a text file resource as a dependency like so:
+
+```javascript
+require(["some/module", "text!some/module.html", "text!some/module.css"],
+    function(module, html, css) {
+        //the html variable will be the text
+        //of the some/module.html file
+        //the css variable will be the text
+        //of the some/module.css file.
+    }
+);
+```
+
+Notice the .html and .css suffixes to specify the extension of the file. The
+"some/module" part of the path will be resolved according to normal module name
+resolution: it will use the **baseUrl** and **paths** [configuration
+options](http://requirejs.org/docs/api.html#config) to map that name to a path.
+
+For HTML/XML/SVG files, there is another option. You can pass !strip, which
+strips XML declarations so that external SVG and XML documents can be added to a
+document without worry. Also, if the string is an HTML document, only the part
+inside the body tag is returned. Example:
+
+```javascript
+require(["text!some/module.html!strip"],
+    function(html) {
+        //the html variable will be the text of the
+        //some/module.html file, but only the part
+        //inside the body tag.
+    }
+);
+```
+
+The text files are loaded via asynchronous XMLHttpRequest (XHR) calls, so you
+can only fetch files from the same domain as the web page (see **XHR
+restrictions** below).
+
+However, [the RequireJS optimizer](http://requirejs.org/docs/optimization.html)
+will inline any text! references with the actual text file contents into the
+modules, so after a build, the modules that have text! dependencies can be used
+from other domains.
+
+## Configuration
+
+### XHR restrictions
+
+The text plugin works by using XMLHttpRequest (XHR) to fetch the text for the
+resources it handles.
+
+However, XHR calls have some restrictions, due to browser/web security policies:
+
+1) Many browsers do not allow file:// access to just any file. You are better
+off serving the application from a local web server than using local file://
+URLs. You will likely run into trouble otherwise.
+
+2) There are restrictions for using XHR to access files on another web domain.
+While CORS can help enable the server for cross-domain access, doing so must
+be done with care (in particular if you also host an API from that domain),
+and not all browsers support CORS.
+
+So if the text plugin determines that the request for the resource is on another
+domain, it will try to access a ".js" version of the resource by using a
+script tag. Script tag GET requests are allowed across domains. The .js version
+of the resource should just be a script with a define() call in it that returns
+a string for the module value.
+
+Example: if the resource is 'text!example.html' and that resolves to a path
+on another web domain, the text plugin will do a script tag load for
+'example.html.js'.
+
+The [requirejs optimizer](http://requirejs.org/docs/optimization.html) will
+generate these '.js' versions of the text resources if you set this in the
+build profile:
+
+    optimizeAllPluginResources: true
+
+In some cases, you may want the text plugin to not try the .js resource, maybe
+because you have configured CORS on the other server, and you know that only
+browsers that support CORS will be used. In that case you can use the
+[module config](http://requirejs.org/docs/api.html#config-moduleconfig)
+(requires RequireJS 2+) to override some of the basic logic the plugin uses to
+determine if the .js file should be requested:
+
+```javascript
+requirejs.config({
+    config: {
+        text: {
+            useXhr: function (url, protocol, hostname, port) {
+                //Override function for determining if XHR should be used.
+                //url: the URL being requested
+                //protocol: protocol of page text.js is running on
+                //hostname: hostname of page text.js is running on
+                //port: port of page text.js is running on
+                //Use protocol, hostname, and port to compare against the url
+                //being requested.
+                //Return true of false. true means "use xhr", false means
+                //"fetch the .js version of this resource".
+            }
+        }
+    }
+});
+```
+
+### Custom XHR hooks
+
+There may be cases where you might want to provide the XHR object to use
+in the request, or you may just want to add some custom headers to the
+XHR object used to make the request. You can use the following hooks:
+
+```javascript
+requirejs.config({
+    config: {
+        text: {
+            onXhr: function (xhr, url) {
+                //Called after the XHR has been created and after the
+                //xhr.open() call, but before the xhr.send() call.
+                //Useful time to set headers.
+                //xhr: the xhr object
+                //url: the url that is being used with the xhr object.
+            },
+            createXhr: function () {
+                //Overrides the creation of the XHR object. Return an XHR
+                //object from this function.
+                //Available in text.js 2.0.1 or later.
+            }
+        }
+    }
+});
+```
+
+### Forcing the environment implemention
+
+The text plugin tries to detect what environment it is available for loading
+text resources, Node, XMLHttpRequest (XHR) or Rhino, but sometimes the
+Node or Rhino environment may have loaded a library that introduces an XHR
+implementation. You can foce the environment implementation to use by passing
+an "env" module config to the plugin:
+
+```javascript
+requirejs.config({
+    config: {
+        text: {
+            //Valid values are 'node', 'xhr', or 'rhino'
+            env: 'rhino'
+        }
+    }
+});
+```
+
+## License
+
+Dual-licensed -- new BSD or MIT.
+
+## Where are the tests?
+
+They are in the [requirejs](https://github.com/jrburke/requirejs) and
+[r.js](https://github.com/jrburke/r.js) repos.
+
+## History
+
+This plugin was in the [requirejs repo](https://github.com/jrburke/requirejs)
+up until the requirejs 2.0 release.</div></li>
 <li>public/components/requirejs-text/component.json<div>diff --git a/public/components/requirejs-text/component.json b/public/components/requirejs-text/component.json
new file mode 100644
index 0000000..2a3a997
--- /dev/null
+++ b/public/components/requirejs-text/component.json
@@ -0,0 +1,8 @@
+{
+  "name": "requirejs-text",
+  "version": "2.0.5",
+  "repository": {
+    "type": "git",
+    "url": "git://github.com/requirejs/text"
+  }
+}
\ No newline at end of file</div></li>
 <li>public/components/requirejs-text/package.json<div>diff --git a/public/components/requirejs-text/package.json b/public/components/requirejs-text/package.json
new file mode 100644
index 0000000..c4314e5
--- /dev/null
+++ b/public/components/requirejs-text/package.json
@@ -0,0 +1,32 @@
+{
+    "name": "text",
+    "version": "2.0.5",
+    "description": "An AMD loader plugin for loading text resources.",
+    "categories": [
+        "Loader plugins"
+    ],
+    "main": "text.js",
+    "github": "https://github.com/requirejs/text",
+    "bugs": {
+        "web": "https://github.com/requirejs/text/issues"
+    },
+    "repositories": [
+        {
+            "type": "git",
+            "url": "https://github.com/requirejs/text.git"
+        }
+    ],
+    "licenses": [
+        {
+            "type": "MIT",
+            "url": "http://www.opensource.org/licenses/mit-license.php"
+        },
+        {
+            "type": "BSD New",
+            "url": "http://opensource.org/licenses/BSD-3-Clause"
+        }
+    ],
+    "volo": {
+        "url": "https://raw.github.com/requirejs/text/{version}/text.js"
+    }
+}</div></li>
 <li>public/components/requirejs-text/text.js<div>diff --git a/public/components/requirejs-text/text.js b/public/components/requirejs-text/text.js
new file mode 100644
index 0000000..9223e65
--- /dev/null
+++ b/public/components/requirejs-text/text.js
@@ -0,0 +1,332 @@
+/**
+ * @license RequireJS text 2.0.5 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
+ * Available via the MIT or new BSD license.
+ * see: http://github.com/requirejs/text for details
+ */
+/*jslint regexp: true */
+/*global require: false, XMLHttpRequest: false, ActiveXObject: false,
+  define: false, window: false, process: false, Packages: false,
+  java: false, location: false */
+
+define(['module'], function (module) {
+    'use strict';
+
+    var text, fs,
+        progIds = ['Msxml2.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.4.0'],
+        xmlRegExp = /^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,
+        bodyRegExp = /<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,
+        hasLocation = typeof location !== 'undefined' && location.href,
+        defaultProtocol = hasLocation && location.protocol && location.protocol.replace(/\:/, ''),
+        defaultHostName = hasLocation && location.hostname,
+        defaultPort = hasLocation && (location.port || undefined),
+        buildMap = [],
+        masterConfig = (module.config && module.config()) || {};
+
+    text = {
+        version: '2.0.5',
+
+        strip: function (content) {
+            //Strips <?xml ...?> declarations so that external SVG and XML
+            //documents can be added to a document without worry. Also, if the string
+            //is an HTML document, only the part inside the body tag is returned.
+            if (content) {
+                content = content.replace(xmlRegExp, "");
+                var matches = content.match(bodyRegExp);
+                if (matches) {
+                    content = matches[1];
+                }
+            } else {
+                content = "";
+            }
+            return content;
+        },
+
+        jsEscape: function (content) {
+            return content.replace(/(['\\])/g, '\\$1')
+                .replace(/[\f]/g, "\\f")
+                .replace(/[\b]/g, "\\b")
+                .replace(/[\n]/g, "\\n")
+                .replace(/[\t]/g, "\\t")
+                .replace(/[\r]/g, "\\r")
+                .replace(/[\u2028]/g, "\\u2028")
+                .replace(/[\u2029]/g, "\\u2029");
+        },
+
+        createXhr: masterConfig.createXhr || function () {
+            //Would love to dump the ActiveX crap in here. Need IE 6 to die first.
+            var xhr, i, progId;
+            if (typeof XMLHttpRequest !== "undefined") {
+                return new XMLHttpRequest();
+            } else if (typeof ActiveXObject !== "undefined") {
+                for (i = 0; i < 3; i += 1) {
+                    progId = progIds[i];
+                    try {
+                        xhr = new ActiveXObject(progId);
+                    } catch (e) {}
+
+                    if (xhr) {
+                        progIds = [progId];  // so faster next time
+                        break;
+                    }
+                }
+            }
+
+            return xhr;
+        },
+
+        /**
+         * Parses a resource name into its component parts. Resource names
+         * look like: module/name.ext!strip, where the !strip part is
+         * optional.
+         * @param {String} name the resource name
+         * @returns {Object} with properties "moduleName", "ext" and "strip"
+         * where strip is a boolean.
+         */
+        parseName: function (name) {
+            var modName, ext, temp,
+                strip = false,
+                index = name.indexOf("."),
+                isRelative = name.indexOf('./') === 0 ||
+                             name.indexOf('../') === 0;
+
+            if (index !== -1 && (!isRelative || index > 1)) {
+                modName = name.substring(0, index);
+                ext = name.substring(index + 1, name.length);
+            } else {
+                modName = name;
+            }
+
+            temp = ext || modName;
+            index = temp.indexOf("!");
+            if (index !== -1) {
+                //Pull off the strip arg.
+                strip = temp.substring(index + 1) === "strip";
+                temp = temp.substring(0, index);
+                if (ext) {
+                    ext = temp;
+                } else {
+                    modName = temp;
+                }
+            }
+
+            return {
+                moduleName: modName,
+                ext: ext,
+                strip: strip
+            };
+        },
+
+        xdRegExp: /^((\w+)\:)?\/\/([^\/\\]+)/,
+
+        /**
+         * Is an URL on another domain. Only works for browser use, returns
+         * false in non-browser environments. Only used to know if an
+         * optimized .js version of a text resource should be loaded
+         * instead.
+         * @param {String} url
+         * @returns Boolean
+         */
+        useXhr: function (url, protocol, hostname, port) {
+            var uProtocol, uHostName, uPort,
+                match = text.xdRegExp.exec(url);
+            if (!match) {
+                return true;
+            }
+            uProtocol = match[2];
+            uHostName = match[3];
+
+            uHostName = uHostName.split(':');
+            uPort = uHostName[1];
+            uHostName = uHostName[0];
+
+            return (!uProtocol || uProtocol === protocol) &&
+                   (!uHostName || uHostName.toLowerCase() === hostname.toLowerCase()) &&
+                   ((!uPort && !uHostName) || uPort === port);
+        },
+
+        finishLoad: function (name, strip, content, onLoad) {
+            content = strip ? text.strip(content) : content;
+            if (masterConfig.isBuild) {
+                buildMap[name] = content;
+            }
+            onLoad(content);
+        },
+
+        load: function (name, req, onLoad, config) {
+            //Name has format: some.module.filext!strip
+            //The strip part is optional.
+            //if strip is present, then that means only get the string contents
+            //inside a body tag in an HTML string. For XML/SVG content it means
+            //removing the <?xml ...?> declarations so the content can be inserted
+            //into the current doc without problems.
+
+            // Do not bother with the work if a build and text will
+            // not be inlined.
+            if (config.isBuild && !config.inlineText) {
+                onLoad();
+                return;
+            }
+
+            masterConfig.isBuild = config.isBuild;
+
+            var parsed = text.parseName(name),
+                nonStripName = parsed.moduleName +
+                    (parsed.ext ? '.' + parsed.ext : ''),
+                url = req.toUrl(nonStripName),
+                useXhr = (masterConfig.useXhr) ||
+                         text.useXhr;
+
+            //Load the text. Use XHR if possible and in a browser.
+            if (!hasLocation || useXhr(url, defaultProtocol, defaultHostName, defaultPort)) {
+                text.get(url, function (content) {
+                    text.finishLoad(name, parsed.strip, content, onLoad);
+                }, function (err) {
+                    if (onLoad.error) {
+                        onLoad.error(err);
+                    }
+                });
+            } else {
+                //Need to fetch the resource across domains. Assume
+                //the resource has been optimized into a JS module. Fetch
+                //by the module name + extension, but do not include the
+                //!strip part to avoid file system issues.
+                req([nonStripName], function (content) {
+                    text.finishLoad(parsed.moduleName + '.' + parsed.ext,
+                                    parsed.strip, content, onLoad);
+                });
+            }
+        },
+
+        write: function (pluginName, moduleName, write, config) {
+            if (buildMap.hasOwnProperty(moduleName)) {
+                var content = text.jsEscape(buildMap[moduleName]);
+                write.asModule(pluginName + "!" + moduleName,
+                               "define(function () { return '" +
+                                   content +
+                               "';});\n");
+            }
+        },
+
+        writeFile: function (pluginName, moduleName, req, write, config) {
+            var parsed = text.parseName(moduleName),
+                extPart = parsed.ext ? '.' + parsed.ext : '',
+                nonStripName = parsed.moduleName + extPart,
+                //Use a '.js' file name so that it indicates it is a
+                //script that can be loaded across domains.
+                fileName = req.toUrl(parsed.moduleName + extPart) + '.js';
+
+            //Leverage own load() method to load plugin value, but only
+            //write out values that do not have the strip argument,
+            //to avoid any potential issues with ! in file names.
+            text.load(nonStripName, req, function (value) {
+                //Use own write() method to construct full module value.
+                //But need to create shell that translates writeFile's
+                //write() to the right interface.
+                var textWrite = function (contents) {
+                    return write(fileName, contents);
+                };
+                textWrite.asModule = function (moduleName, contents) {
+                    return write.asModule(moduleName, fileName, contents);
+                };
+
+                text.write(pluginName, nonStripName, textWrite, config);
+            }, config);
+        }
+    };
+
+    if (masterConfig.env === 'node' || (!masterConfig.env &&
+            typeof process !== "undefined" &&
+            process.versions &&
+            !!process.versions.node)) {
+        //Using special require.nodeRequire, something added by r.js.
+        fs = require.nodeRequire('fs');
+
+        text.get = function (url, callback) {
+            var file = fs.readFileSync(url, 'utf8');
+            //Remove BOM (Byte Mark Order) from utf8 files if it is there.
+            if (file.indexOf('\uFEFF') === 0) {
+                file = file.substring(1);
+            }
+            callback(file);
+        };
+    } else if (masterConfig.env === 'xhr' || (!masterConfig.env &&
+            text.createXhr())) {
+        text.get = function (url, callback, errback, headers) {
+            var xhr = text.createXhr(), header;
+            xhr.open('GET', url, true);
+
+            //Allow plugins direct access to xhr headers
+            if (headers) {
+                for (header in headers) {
+                    if (headers.hasOwnProperty(header)) {
+                        xhr.setRequestHeader(header.toLowerCase(), headers[header]);
+                    }
+                }
+            }
+
+            //Allow overrides specified in config
+            if (masterConfig.onXhr) {
+                masterConfig.onXhr(xhr, url);
+            }
+
+            xhr.onreadystatechange = function (evt) {
+                var status, err;
+                //Do not explicitly handle errors, those should be
+                //visible via console output in the browser.
+                if (xhr.readyState === 4) {
+                    status = xhr.status;
+                    if (status > 399 && status < 600) {
+                        //An http 4xx or 5xx error. Signal an error.
+                        err = new Error(url + ' HTTP status: ' + status);
+                        err.xhr = xhr;
+                        errback(err);
+                    } else {
+                        callback(xhr.responseText);
+                    }
+                }
+            };
+            xhr.send(null);
+        };
+    } else if (masterConfig.env === 'rhino' || (!masterConfig.env &&
+            typeof Packages !== 'undefined' && typeof java !== 'undefined')) {
+        //Why Java, why is this so awkward?
+        text.get = function (url, callback) {
+            var stringBuffer, line,
+                encoding = "utf-8",
+                file = new java.io.File(url),
+                lineSeparator = java.lang.System.getProperty("line.separator"),
+                input = new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file), encoding)),
+                content = '';
+            try {
+                stringBuffer = new java.lang.StringBuffer();
+                line = input.readLine();
+
+                // Byte Order Mark (BOM) - The Unicode Standard, version 3.0, page 324
+                // http://www.unicode.org/faq/utf_bom.html
+
+                // Note that when we use utf-8, the BOM should appear as "EF BB BF", but it doesn't due to this bug in the JDK:
+                // http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4508058
+                if (line && line.length() && line.charAt(0) === 0xfeff) {
+                    // Eat the BOM, since we've already found the encoding on this file,
+                    // and we plan to concatenating this buffer with others; the BOM should
+                    // only appear at the top of a file.
+                    line = line.substring(1);
+                }
+
+                stringBuffer.append(line);
+
+                while ((line = input.readLine()) !== null) {
+                    stringBuffer.append(lineSeparator);
+                    stringBuffer.append(line);
+                }
+                //Make sure we return a JavaScript string and not a Java string.
+                content = String(stringBuffer.toString()); //String
+            } finally {
+                input.close();
+            }
+            callback(content);
+        };
+    }
+
+    return text;
+});</div></li>
 <li>public/components/requirejs/.gitignore<div>diff --git a/public/components/requirejs/.gitignore b/public/components/requirejs/.gitignore
index 6b9dabf..de0a7bf 100644
--- a/public/components/requirejs/.gitignore
+++ b/public/components/requirejs/.gitignore
@@ -3,5 +3,6 @@ docs/jquery-require-sample/webapp-build/
 docs/jquery-require-sample/dist
 dist/dist-site/
 dist/dist-build/
+shrinktest.sh
 tests/layers/allplugins-require.js
 tests/packages/optimizing/built/</div></li>
 <li>public/components/requirejs/component.json<div>diff --git a/public/components/requirejs/component.json b/public/components/requirejs/component.json
index 56193c3..afa8cca 100644
--- a/public/components/requirejs/component.json
+++ b/public/components/requirejs/component.json
@@ -1,6 +1,6 @@
 {
   "name": "requirejs",
-  "version": "2.1.2",
+  "version": "2.1.5",
   "repository": {
     "type": "git",
     "url": "git://github.com/jrburke/requirejs"</div></li>
 <li>public/components/requirejs/dist/post.html<div>diff --git a/public/components/requirejs/dist/post.html b/public/components/requirejs/dist/post.html
index b48b171..310dc94 100644
--- a/public/components/requirejs/dist/post.html
+++ b/public/components/requirejs/dist/post.html
@@ -1,6 +1,6 @@
     </div>
     <div id="footer" class="mono">
-        <span class="line">Latest Release: <a href="http://requirejs.org/docs/download.html">2.1.2</a></span>
+        <span class="line">Latest Release: <a href="http://requirejs.org/docs/download.html">2.1.5</a></span>
         <span class="line">Open source: <a href="https://github.com/jrburke/requirejs/blob/master/LICENSE">new BSD or MIT licensed</a></span>
         <span class="line">web design by <a href="http://andychung.ca">Andy Chung</a> &copy; 2011</span>
     </div></div></li>
 <li>public/components/requirejs/dist/pre.html<div>diff --git a/public/components/requirejs/dist/pre.html b/public/components/requirejs/dist/pre.html
index 4c8f4d1..aa236e7 100644
--- a/public/components/requirejs/dist/pre.html
+++ b/public/components/requirejs/dist/pre.html
@@ -142,7 +142,7 @@
                 <span class="icon help"></span>
             </li>
             <li class="hbox">
-                <a href="http://tagneto.blogspot.com">Blog</a>
+                <a href="http://jrburke.com/">Blog</a>
                 <span class="spacer boxFlex"></span>
                 <span class="icon blog"></span>
             </li>
@@ -168,7 +168,7 @@
 
 
         <ul>
-            <li class="version">2.1.2 Docs (<a href="https://github.com/jrburke/requirejs/wiki/Upgrading-to-RequireJS-2.1">upgrade info</a>)</li>
+            <li class="version">2.1.5 Docs (<a href="https://github.com/jrburke/requirejs/wiki/Upgrading-to-RequireJS-2.1">upgrade info</a>)</li>
             <li class="version"><a class="local" href="1.0/">1.0 Doc Link</a></li>
         </ul>
 </div></li>
 <li>public/components/requirejs/docs/api.html<div>diff --git a/public/components/requirejs/docs/api.html b/public/components/requirejs/docs/api.html
index 5f23195..b08b48e 100644
--- a/public/components/requirejs/docs/api.html
+++ b/public/components/requirejs/docs/api.html
@@ -389,7 +389,7 @@ define(['a', 'exports'], function(a, exports) {
 
 <pre><code>require(["http://example.com/api/data.json?callback=define"],
     function (data) {
-        //The dta object will be the API response for the
+        //The data object will be the API response for the
         //JSONP data call.
         console.log(data);
     }
@@ -491,16 +491,21 @@ This example specifies some dependencies to load as soon as require.js defines r
 
 <p>Supported configuration options:</p>
 
-<p id="config-baseUrl"><strong><a href="#config-baseUrl">baseUrl</a></strong>: the root path to use for all module lookups. So in the above example, "my/module"'s script tag will have a src="/another/path/my/module.js". baseUrl is <strong>not</strong> used when loading plain .js files, those strings are used as-is, so a.js and b.js will be loaded from the same directory as the HTML page that contains the above snippet.</p>
+<p id="config-baseUrl"><strong><a href="#config-baseUrl">baseUrl</a></strong>: the root path to use for all module lookups. So in the above example, "my/module"'s script tag will have a src="/another/path/my/module.js". baseUrl is <strong>not</strong> used when loading plain .js files (indicated by a dependency string <a href="#jsfiles">starting with a slash, has a protocol, or ends in .js</a>), those strings are used as-is, so a.js and b.js will be loaded from the same directory as the HTML page that contains the above snippet.</p>
 
 <p>If no baseUrl is explicitly set in the configuration, the default value will be the location of the HTML page that loads require.js. If a <strong>data-main</strong> attribute is used, that path will become the baseUrl.</p>
 
 <p>The baseUrl can be a URL on a different domain as the page that will load require.js. RequireJS script loading works across domains. The only restriction is on text content loaded by text! plugins: those paths should be on the same domain as the page, at least during development. The optimization tool will inline text! plugin resources so after using the optimization tool, you can use resources that reference text! plugin resources from another domain.</p>
 
-<p id="config-paths"><strong><a href="#config-paths">paths</a></strong>: path mappings for module names not found directly under baseUrl. The path settings are assumed to be relative to baseUrl, unless the paths setting starts with a "/" or has a URL protocol in it ("like http:"). In those cases, the path is determined relative to baseUrl. Using the above sample config, "some/module"'s script tag will be src="/another/path/some/v1.0/module.js". The path that is used for a module name should <strong>not</strong> include the .js extension, since the path mapping could be for a directory. The path mapping code will automatically add the .js extension when mapping the module name to a path.</p>
+<p id="config-paths"><strong><a href="#config-paths">paths</a></strong>: path mappings for module names not found directly under baseUrl. The path settings are assumed to be relative to baseUrl, unless the paths setting starts with a "/" or has a URL protocol in it ("like http:"). Using the above sample config, "some/module"'s script tag will be src="/another/path/some/v1.0/module.js".</p>
 
-<p id="config-shim"><strong><a href="#config-shim">shim</a></strong>: Configure the dependencies and exports for older, traditional "browser globals" scripts that do not use define() to declare the dependencies and set a module value. Example (RequireJS 2.1.0+):</p>
+<p>The path that is used for a module name should <strong>not</strong> include an extension, since the path mapping could be for a directory. The path mapping code will automatically add the .js extension when mapping the module name to a path. If <a href="#modulenotes-urls">require.toUrl()</a> is used, it will add the appropriate extension, if it is for something like a text template.</p>
 
+<p>When run in a browser, <a href="#pathsfallbacks">paths fallbacks</a> can be specified, to allow trying a load from a CDN location, but falling back to a local location if the CDN location fails to load.</p>
+
+<p id="config-shim"><strong><a href="#config-shim">shim</a></strong>: Configure the dependencies and exports for older, traditional "browser globals" scripts that do not use define() to declare the dependencies and set a module value.</p>
+
+<p>Here is an example. It requires RequireJS 2.1.0+, and assumes backbone.js, underscore.js and jquery.js have been installed in the baseUrl directory. If not, then you may need to set a paths config for them:</p>
 
 <pre><code>requirejs.config({
     shim: {
@@ -512,6 +517,9 @@ This example specifies some dependencies to load as soon as require.js defines r
             //module value.
             exports: 'Backbone'
         },
+        'underscore': {
+            exports: '_'
+        },
         'foo': {
             deps: ['bar'],
             exports: 'Foo',
@@ -644,7 +652,7 @@ still need to cooperate with each other.</p>
 and when 'some/oldmodule' does `require('foo')` it will get the foo1.0.js file.</p>
 
 <p>This feature only works well for scripts that are real AMD modules that call
-define() and register as anonymous modules.</p>
+define() and register as anonymous modules. Also, <strong>only use absolute module IDs</strong> for map config. Relative IDs (like <code>'../some/thing'</code>) do not work.</p>
 
 <p>There is also support for a "*" map value which means "for all modules loaded, use this map config". If there is a more specific map config, that one will take precedence over the star config. Example:</p>
 
@@ -694,13 +702,13 @@ define(['module'], function (module) {
 
 <p id="config-packages"><strong><a href="#config-packages">packages</a></strong>: configures loading modules from CommonJS packages. See the <a href="#packages">packages topic</a> for more information.</p>
 
-<p id="config-waitSeconds"><strong><a href="#config-waitSeconds">waitSeconds</a></strong>: The number of seconds to wait before giving up on loading a script. The default is 7 seconds.</p>
+<p id="config-waitSeconds"><strong><a href="#config-waitSeconds">waitSeconds</a></strong>: The number of seconds to wait before giving up on loading a script. Setting it to 0 disables the timeout. The default is 7 seconds.</p>
 
 <p id="config-context"><strong><a href="#config-context">context</a></strong>: A name to give to a loading context. This allows require.js to load multiple versions of modules in a page, as long as each top-level require call specifies a unique context string. To use it correctly, see the <a href="#multiversion">Multiversion Support</a> section.</p>
 
 <p id="config-deps"><strong><a href="#config-deps">deps</a></strong>: An array of dependencies to load. Useful when require is defined as a config object before require.js is loaded, and you want to specify dependencies to load as soon as require() is defined.</p>
 
-<p id="config-callback"><strong><a href="#config-callback">callback</a></strong>: A function to pass to require that should be require after <strong>deps</strong> have been loaded. Useful when require is defined as a config object before require.js is loaded, and you want to specify a function to require after the configuration's <strong>deps</strong> array has been loaded.</p>
+<p id="config-callback"><strong><a href="#config-callback">callback</a></strong>: A function to execute after <strong>deps</strong> have been loaded. Useful when require is defined as a config object before require.js is loaded, and you want to specify a function to require after the configuration's <strong>deps</strong> array has been loaded.</p>
 
 <p id="config-enforceDefine"><strong><a href="#config-enforceDefine">enforceDefine</a></strong>: If set to true, an error will be thrown if a script loads that does not call define() or have a shim exports string value that can be checked. See <a href="#ieloadfail">Catching load failures in IE</a> for more information.</p>
 
@@ -763,13 +771,6 @@ define(['module'], function (module) {
 <li>project-directory/
 <ul>
 <li>project.html</li>
-<li>scripts/
-<ul>
-<li>omega/
-<ul>
-<li>main.js</li>
-</ul></li>
-</ul></li>
 <li>cart/
 <ul>
 <li>main.js</li>
@@ -1094,7 +1095,6 @@ the current document when used as a loader plugin:</p>
     //This function is called once the DOM is ready,
     //notice the value for 'domReady!' is the current
     //document.
-  });
 });
 </code></pre>
 </div></li>
 <li>public/components/requirejs/docs/commonjs.html<div>diff --git a/public/components/requirejs/docs/commonjs.html b/public/components/requirejs/docs/commonjs.html
index 45f9f7e..93d6610 100644
--- a/public/components/requirejs/docs/commonjs.html
+++ b/public/components/requirejs/docs/commonjs.html
@@ -77,11 +77,12 @@ information.</p>
 
 <p>Instead of using require() to get dependencies inside the function passed to define(), you can also specify them via a dependency array argument to define(). The order of the names in the dependency array match the order of arguments passed to the definition function passed to define(). So the above example that uses the module <strong>foo</strong>:</p>
 
-<p>define(['foo'], function (foo) {
+<pre><code>define(['foo'], function (foo) {
     return function () {
         foo.doSomething();
     };
-});</p>
+});
+</code></pre>
 
 <p>See the <a href="api.html">API docs</a> for more information on that syntax.</p>
 </div></div></li>
 <li>public/components/requirejs/docs/download.html<div>diff --git a/public/components/requirejs/docs/download.html b/public/components/requirejs/docs/download.html
index 49f29b6..f6e11c7 100644
--- a/public/components/requirejs/docs/download.html
+++ b/public/components/requirejs/docs/download.html
@@ -4,8 +4,8 @@
     <li class="hbox"><a href="#latest">Latest Release</a><span class="spacer boxFlex"></span><span class="sect">&sect; 1</span></li>
     <ul>
         <li class="hbox"><a href="#requirejs">require.js</a><span class="spacer boxFlex"></span><span class="sect">&sect; 1.1</span></li>
-        <li class="hbox"><a href="#samplejquery">Sample RequireJS + jQuery 1.8.2 project</a><span class="spacer boxFlex"></span><span class="sect">&sect; 1.2</span></li>
-        <li class="hbox"><a href="#rjs">r.js: Optimizer and Node and Rhino adapter</a><span class="spacer boxFlex"></span><span class="sect">&sect; 1.3</span></li>
+        <li class="hbox"><a href="#samplejquery">Sample RequireJS + jQuery 1.9.1 project</a><span class="spacer boxFlex"></span><span class="sect">&sect; 1.2</span></li>
+        <li class="hbox"><a href="#rjs">r.js: Optimizer and Node/Rhino/xpcshell adapter</a><span class="spacer boxFlex"></span><span class="sect">&sect; 1.3</span></li>
     </ul>
     <li class="hbox"><a href="#plugins">Plugins</a><span class="spacer boxFlex"></span><span class="sect">&sect; 2</span></li>
     <ul>
@@ -26,10 +26,10 @@
 
 <div class="subSection">
 <h4 class="hbox">
-<a name="requirejs">require.js 2.1.2</a>
+<a name="requirejs">require.js 2.1.5</a>
 <span class="boxFlex"></span>
-<a class="download" href="http://requirejs.org/docs/release/2.1.2/minified/require.js">Minified</a>
-<a class="download" href="http://requirejs.org/docs/release/2.1.2/comments/require.js">With Comments</a>
+<a class="download" href="http://requirejs.org/docs/release/2.1.5/minified/require.js">Minified</a>
+<a class="download" href="http://requirejs.org/docs/release/2.1.5/comments/require.js">With Comments</a>
 </h4>
 
 <p>All you need to start using require.js in the browser.</p>
@@ -37,9 +37,9 @@
 
 <div class="subSection">
 <h4 class="hbox">
-<a name="samplejquery">Sample RequireJS 2.1.2 + jQuery 1.8.2 project</a>
+<a name="samplejquery">Sample RequireJS 2.1.5 + jQuery 1.9.1 project</a>
 <span class="boxFlex"></span>
-<a class="download" href="http://requirejs.org/docs/release/jquery-require/jquery1.8.2-requirejs2.1.2/jquery-require-sample.zip">Download</a>
+<a class="download" href="http://requirejs.org/docs/release/jquery-require/jquery1.9.1-requirejs2.1.5/jquery-require-sample.zip">Download</a>
 </h4>
 
 <p>A zip file containing a sample project that uses jQuery and RequireJS.</p>
@@ -48,12 +48,12 @@
 
 <div class="subSection">
 <h4 class="hbox">
-<a name="rjs">r.js: Optimizer and Node and Rhino adapter</a>
+<a name="rjs">r.js: Optimizer and Node/Rhino/xpcshell adapter</a>
 <span class="boxFlex"></span>
-<a class="download" href="http://requirejs.org/docs/release/2.1.2/r.js">Download</a>
+<a class="download" href="http://requirejs.org/docs/release/2.1.5/r.js">Download</a>
 </h4>
 
-<p>The r.js file allows you to run the optimizer as well as run modules in Node or Rhino.</p>
+<p>The r.js file allows you to run the optimizer as well as run modules in Node, Rhino or xpcshell.</p>
 
 <p>If you are running in Node, and want to use npm to install this file via npm, see the <a href="node.html">Use with Node</a> page for more information.</p>
 
@@ -109,6 +109,59 @@ logic until the DOM is ready for querying/modification.</p>
 <div class="section">
 <h2><a name="releasenotes">Release Notes</a><span class="sectionMark">&sect; 3</span></h2>
 
+<h3 id="2-1-5">2.1.5</h3>
+
+<p>Biggest change is support for running the optimizer and loading AMD modules in
+<a href="https://developer.mozilla.org/en-US/docs/XPConnect/xpcshell">xpcshell</a>. Other than that,
+just a maintenance release.</p>
+
+<p>Full list of changes:</p>
+
+<ul>
+    <li><a href="https://github.com/jrburke/requirejs/issues?direction=desc&milestone=26&sort=created&state=closed">Fixed require.js issues</a></li>
+    <li><a href="https://github.com/jrburke/r.js/issues?milestone=23&state=closed">Fixed r.js optimizer issues</a></li>
+</ul>
+
+
+<h3 id="2-1-4">2.1.4</h3>
+
+<p>Quick release for a bug that slipped in the 2.1.3 release in the r.js optimizer.
+So even though require.js now has a 2.1.4 version, it is the same as 2.1.3,
+and the optimizer is the same as 2.1.3 except for this one fix:</p>
+
+<ul>
+    <li><a href="https://github.com/jrburke/r.js/issues/356">Bug 356</a>: cssPrefix normalization always needs to happen</li>
+</ul>
+
+<p>Without this fix, in some cases 2.1.3 would insert "undefined" in some
+    optimized CSS files, making them unusable.</p>
+
+<h3 id="2-1-3">2.1.3</h3>
+
+<p>Maintenance release. A change that may be noticeable:</p>
+
+<p><a href="http://requirejs.org/docs/api.html#modulenotes-urls">require.toUrl()</a>
+    now correctly generates URLs for string values passed to it without an
+    extension. Previous versions of toUrl() would append a
+    ".js" extension automatically. If you relied on that behavior, when you
+    update to 2.1.3, then you may need to do a code change to append the .js
+    extension yourself:</p>
+
+    <pre><code>require.toUrl('some/value') + '.js'</code></pre>
+
+<p>The text plugin has been updated to also work with this change, so if you want
+    to generate non-extension paths for text resources, be sure to upgrade to
+    to the <a href="https://raw.github.com/requirejs/text/latest/text.js">2.0.4 version of text.js</a>.</p>
+
+<p>Normal use of toUrl with a value that has an extension continues to work the same.</p>
+
+<p>Full list of changes:</p>
+
+<ul>
+    <li><a href="https://github.com/jrburke/requirejs/issues?direction=desc&milestone=24&page=1&sort=created&state=closed">Fixed require.js issues</a></li>
+    <li><a href="https://github.com/jrburke/r.js/issues?sort=created&direction=desc&state=closed&page=1&milestone=21">Fixed r.js optimizer issues</a></li>
+</ul>
+
 <h3 id="2-1-2">2.1.2</h3>
 
 <p>The big changes for this release are in the optimizer:</p></div></li>
 <li>public/components/requirejs/docs/errors.html<div>diff --git a/public/components/requirejs/docs/errors.html b/public/components/requirejs/docs/errors.html
index c2fab19..0e4e1ed 100644
--- a/public/components/requirejs/docs/errors.html
+++ b/public/components/requirejs/docs/errors.html
@@ -12,6 +12,7 @@
 <li class="hbox"><a href="#interactive">No matching script interactive for ...</a><span class="spacer boxFlex"></span><span class="sect">&sect; 8</span></li>
 <li class="hbox"><a href="#pathnotsupported">Path is not supported: ...</a><span class="spacer boxFlex"></span><span class="sect">&sect; 9</span></li>
 <li class="hbox"><a href="#sourcemapcomments">Cannot use preserveLicenseComments and generateSourceMaps together</a><span class="spacer boxFlex"></span><span class="sect">&sect; 10</span></li>
+<li class="hbox"><a href="#importscripts">importScripts failed for ...</a><span class="spacer boxFlex"></span><span class="sect">&sect; 11</span></li>
 </ul>
 
 <p>This page lists errors that are generated by RequireJS. If the following information does not fix the problem, you can ask on the <a href="https://groups.google.com/group/requirejs">RequireJS list</a> or <a href="https://github.com/jrburke/requirejs/issues">open an issue</a>. In either case it is best to have an example or detailed explanation of the problem, hopefully with steps to reproduce.</p>
@@ -242,3 +243,10 @@ for the build (otherwise it will not build), then use the special "empty:" paths
 <p>The default for the optimizer is for <strong>preserveLicenseComments</strong> to be true. So if using <strong>generateSourceMaps</strong>, then explicitly set <strong>preserveLicenseComments</strong> to false. If you want to preserve some license comments, you can manually modify the license comments in the JS source to use the JSDoc-style <code>@license</code> comment. See "<a href="https://developers.google.com/closure/compiler/docs/js-for-compiler#tag-license">Annotating JavaScript for the Closure Compiler</a>" for more information. That same format works for UglifyJS2.</p>
 
 </div>
+
+<div class="section">
+<h2><a name="importscripts">importScripts failed for ...</a><span class="sectionMark">&sect; 11</span></h2>
+
+<p>When RequireJS is used in a <a href="https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers">Web Worker</a>, <a href="https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers#Importing_scripts_and_libraries">importScripts</a> is used to load modules. If that call failed for some reason, this error is generated.</p>
+
+</div></div></li>
 <li>public/components/requirejs/docs/faq-advanced.html<div>diff --git a/public/components/requirejs/docs/faq-advanced.html b/public/components/requirejs/docs/faq-advanced.html
index 4d9f2ad..f271709 100644
--- a/public/components/requirejs/docs/faq-advanced.html
+++ b/public/components/requirejs/docs/faq-advanced.html
@@ -121,7 +121,7 @@ with the "namespace" optimization demonstrated above.</p>
 
 <p>Knowing when the file is loaded  is important because you may only want to grab the dimensions of a DOM element once the style sheet has loaded.</p>
 
-<p>Some people have implemented an approach where they look for a well known style to be applied to a specific HTML element to know if a style sheet is loaded. Due to the specificity of that solution, it is not something that would fit will with RequireJS. Knowing when the link element has loaded the referenced file would be the most robust solution.</p>
+<p>Some people have implemented an approach where they look for a well known style to be applied to a specific HTML element to know if a style sheet is loaded. Due to the specificity of that solution, it is not something that would fit well with RequireJS. Knowing when the link element has loaded the referenced file would be the most robust solution.</p>
 
 <p>Since knowing when the file has loaded is not reliable, it does not make sense to explicitly support CSS files in RequireJS loading, since it will lead to bug reports due to browser behavior. If you do not care when the file is loaded, you can easily write your own function to load CSS on demand by doing the following:</p>
 </div></li>
 <li>public/components/requirejs/docs/faq-optimization.html<div>diff --git a/public/components/requirejs/docs/faq-optimization.html b/public/components/requirejs/docs/faq-optimization.html
index a52cc82..305d833 100644
--- a/public/components/requirejs/docs/faq-optimization.html
+++ b/public/components/requirejs/docs/faq-optimization.html
@@ -39,7 +39,7 @@ load code. Instead, you may want to namespace your use of require/define. See ne
 doing a simple <a href="#wrap">one file build with a wrapper</a> is not enough. You also may want isolate your loading needs from
 the page's AMD loader.</p>
 
-<p>There is a <a href="https://github.com/jrburke/r.js/blob/master/build/example.build.js#L159">namespace</a> build option that
+<p>There is a <a href="https://github.com/jrburke/r.js/blob/master/build/example.build.js#L276">namespace</a> build option that
 does the following:</p>
 
 <ul></div></li>
 <li>public/components/requirejs/docs/node.html<div>diff --git a/public/components/requirejs/docs/node.html b/public/components/requirejs/docs/node.html
index e0545ae..418ab93 100644
--- a/public/components/requirejs/docs/node.html
+++ b/public/components/requirejs/docs/node.html
@@ -171,6 +171,8 @@ requirejs.optimize(config, function (buildResponse) {
     //included. Load the built file for the contents.
     //Use config.out to get the optimized file contents.
     var contents = fs.readFileSync(config.out, 'utf8');
+}, function(err) {
+    //optimization err callback
 });
 </code></pre>
 </div></li>
 <li>public/components/requirejs/docs/optimization.html<div>diff --git a/public/components/requirejs/docs/optimization.html b/public/components/requirejs/docs/optimization.html
index 1dda069..8e9a467 100644
--- a/public/components/requirejs/docs/optimization.html
+++ b/public/components/requirejs/docs/optimization.html
@@ -165,7 +165,7 @@ require(mods);</code></pre>
     baseUrl: ".",
     paths: {
         jquery: "some/other/jquery"
-    }
+    },
     name: "main",
     out: "main-built.js"
 })
@@ -193,6 +193,7 @@ require(mods);</code></pre>
 <pre><code>paths: {
     'core/jquery': {
         tabs: 'empty:'
+    }
 }
 </code></pre>
 
@@ -239,14 +240,14 @@ require(mods);</code></pre>
 
 <p>Normally you should <strong>not</strong> save optimized files with your pristine project source. Normally you would save them to a copy of your project, but to make this example easier it is saved with the source. Change the <strong>out=</strong> option to any directory you like, that has a copy of your source. Then, you can change the main-built.js file name to just main.js so the HTML page will load the optimized version of the file.</p>
 
-<p>It is not recommended that you bundle require.js with your main.js file. Ideally require.js should be the same file contents wherever it is used. However, if you do need to include require.js with the main.js source, you can use this command:</p>
+<p>If you want to include require.js with the main.js source, you can use this kind of command:</p>
 
 <pre><code>node ../../r.js -o baseUrl=. paths.requireLib=../../require name=main include=requireLib out=main-built.js
 </code></pre>
 
 <p>Since "require" is a reserved dependency name, you create a "requireLib" dependency and map it to the require.js file.</p>
 
-<p>Once that optimization is done, you can then rename the main-built.js file to require.js and your optimized project will only need to make one script request.</p>
+<p>Once that optimization is done, you can change the script tag to reference "main-built.js" instead of "require.js", and your optimized project will only need to make one script request.</p>
 
 <p>If you want to wrap your built file so it can be used in pages that do not have an AMD loader like RequireJS, see the <a href="faq-optimization.html">Optimization FAQ</a>.</p>
 </div></div></li>
 <li>public/components/requirejs/docs/plugins.html<div>diff --git a/public/components/requirejs/docs/plugins.html b/public/components/requirejs/docs/plugins.html
index 6d3f291..c3daf5c 100644
--- a/public/components/requirejs/docs/plugins.html
+++ b/public/components/requirejs/docs/plugins.html
@@ -84,7 +84,7 @@ API
 </ul>
 
 <h3>
-<a name="apiload">load: function (name, parentRequire, load, config)</a>
+<a name="apiload">load: function (name, parentRequire, onload, config)</a>
 <span class="sectionMark">&sect; 3.1</span>
 </h3>
 
@@ -98,7 +98,7 @@ API
         <li><b>parentRequire.defined(moduleName)</b>: Returns true if the module has already been loaded and defined. Used to be called require.isDefined before RequireJS 0.25.0.</li>
         <li><b>parentRequire.specified(moduleName)</b>: Returns true if the module has already been requested or is in the process of loading and should be available at some point.</li>
     </ul></li>
-    <li><b>load</b>: Function. A function to call with the value for name. This tells the loader that the plugin is done loading the resource. <b>load.error()</b> can be called, passing an error object to it, if the plugin detects an error condition that means the resource will fail to load correctly.</li>
+    <li><b>onload</b>: Function. A function to call with the value for name. This tells the loader that the plugin is done loading the resource. <b>onload.error()</b> can be called, passing an error object to it, if the plugin detects an error condition that means the resource will fail to load correctly.</li>
     <li><b>config</b>: Object. A configuration object. This is a way for the optimizer and the web app to pass configuration information to the plugin. The i18n! plugin uses this to get the current current locale, if the web app wants to force a specific locale. The optimizer will set an <b>isBuild</b> property in the config to true if this plugin (or pluginBuilder) is being called as part of an optimizer build.</li>
 </ul>
 
@@ -106,29 +106,29 @@ API
 
 <pre><code>
 define({
-    load: function (name, req, load, config) {
+    load: function (name, req, onload, config) {
         //req has the same API as require().
         req([name], function (value) {
-            load(value);
+            onload(value);
         });
     }
 });
 </code></pre>
 
 <p>Some plugins may need to evaluate some JavaScript that was retrieved as text, and use that
-evaluated JavaScript as the value for the resource. There is a function off the load() argument, <strong>load.fromText()</strong>, that can be used to evaluate the JavaScript. eval() is used by RequireJS to evaluate that JavaScript, and RequireJS will do the right work for any anonymous define() call in the evaluated text, and use that define() module as the value for the resource.</p>
+evaluated JavaScript as the value for the resource. There is a function off the onload() argument, <strong>onload.fromText()</strong>, that can be used to evaluate the JavaScript. eval() is used by RequireJS to evaluate that JavaScript, and RequireJS will do the right work for any anonymous define() call in the evaluated text, and use that define() module as the value for the resource.</p>
 
-<p>Arguments for load.fromText() (RequireJS 2.1.0 and later):</p>
+<p>Arguments for onload.fromText() (RequireJS 2.1.0 and later):</p>
 
 <ul>
     <li><b>text</b>: String. The string of JavaScript to evaluate.</li>
 </ul>
 
-<p>An example plugin's load function that uses load.fromText():</p>
+<p>An example plugin's load function that uses onload.fromText():</p>
 
 <pre><code>
 define({
-    load: function (name, req, load, config) {
+    load: function (name, req, onload, config) {
         var url = req.toUrl(name + '.customFileExtension'),
             text;
 
@@ -143,16 +143,16 @@ define({
             //Have RequireJS execute the JavaScript within
             //the correct environment/context, and trigger the load
             //call for this resource.
-            load.fromText(text);
+            onload.fromText(text);
         });
     }
 });
 </code></pre>
 
-<p>Before RequireJS 2.1.0, load.fromText accepted a moduleName as the first
-    argument: <code>load.fromText(moduleName, text)</code>, and the loader
-    plugin had to manually call <code>require([moduleName], load)</code>
-    after the load.fromText() call.</p>
+<p>Before RequireJS 2.1.0, onload.fromText accepted a moduleName as the first
+    argument: <code>onload.fromText(moduleName, text)</code>, and the loader
+    plugin had to manually call <code>require([moduleName], onload)</code>
+    after the onload.fromText() call.</p>
 
 <p><b id="loadBuildInfo">Build considerations</b>: The optimizer traces
 dependencies <b>synchronously</b> to simplify the optimization logic. This is
@@ -164,13 +164,13 @@ is true:</p>
 
 <pre><code>
 define({
-    load: function (name, req, load, config) {
+    load: function (name, req, onload, config) {
         if (config.isBuild) {
             //Indicate that the optimizer should not wait
             //for this resource any more and complete optimization.
             //This resource will be resolved dynamically during
             //run time in the web browser.
-            load();
+            onload();
         } else {
             //Do something else that can be async.
         }
@@ -245,9 +245,9 @@ define(['index!2?./a:./b:./c'], function (indexResource) {
             return parsed.index + '?' + choices.join(':');
         },
 
-        load: function (name, req, load, config) {
+        load: function (name, req, onload, config) {
             req([parse(name).choice], function (value) {
-                load(value);
+                onload(value);
             });
         }
     });
@@ -311,7 +311,7 @@ write: function (pluginName, moduleName, write) {
 
 
 <h3>
-<a name="apiwritefile">writeFile: function (pluginName, moduleName, write)</a>
+<a name="apiwritefile">writeFile: function (pluginName, name, write)</a>
 <span class="sectionMark">&sect; 3.5</span>
 </h3>
 
@@ -327,7 +327,6 @@ write: function (pluginName, moduleName, write) {
             <li><b>text</b>: String. The contents of the file. Must be UTF-8 encoded.</li>
         </ul>
         This function also contains a property function, <b>write.asModule(moduleName, fileName, text)</b>. asModule can be used to write out a module that may have an anonymous define call in there that needs name insertion or/and contains implicit require("") dependencies that need to be pulled out for the optimized file.</li>
-        <li><b>config</b>: Object. A configuration object. This is a way for the optimizer to pass configuration information to the plugin.</li>
 </ul>
 
 <p>See the <a href="https://github.com/jrburke/requirejs/blob/master/text.js">text! plugin</a> for an example of writeFile.</p></div></li>
 <li>public/components/requirejs/docs/whyamd.html<div>diff --git a/public/components/requirejs/docs/whyamd.html b/public/components/requirejs/docs/whyamd.html
index 37ba060..7a6b660 100644
--- a/public/components/requirejs/docs/whyamd.html
+++ b/public/components/requirejs/docs/whyamd.html
@@ -124,7 +124,7 @@ exports.myExample = function () {};
 });
 </code></pre>
 
-<p>The AMD format comes from wanting a module format that was better than today's "write a bunch of script tags with implicit dependencies that you have to manually order" and something that was easy to use directly in the browser. Something with good debugging characteristics that did not require server-specific tooling to get started. It grew out of Dojo's real world experience with using XHR+eval and and wanting to avoid its weaknesses for the future.</p>
+<p>The AMD format comes from wanting a module format that was better than today's "write a bunch of script tags with implicit dependencies that you have to manually order" and something that was easy to use directly in the browser. Something with good debugging characteristics that did not require server-specific tooling to get started. It grew out of Dojo's real world experience with using XHR+eval and wanting to avoid its weaknesses for the future.</p>
 
 <p>It is an improvement over the web's current "globals and script tags" because:</p>
 
@@ -185,7 +185,7 @@ define(['dep1', 'dep2'], function (dep1, dep2) {
 <span class="sectionMark">&sect; 6</span>
 </h2>
 
-<p>Notice that the above module does not declare a name for itself. This is makes the module very portable. It allows a developer to place the module in a different path to give it a different ID/name. The AMD loader will give the module an ID based on how it is referenced by other scripts.</p>
+<p>Notice that the above module does not declare a name for itself. This is what makes the module very portable. It allows a developer to place the module in a different path to give it a different ID/name. The AMD loader will give the module an ID based on how it is referenced by other scripts.</p>
 
 <p>However, tools that combine multiple modules together for performance need a way to give names to each module in the optimized file. For that, AMD allows a string as the first argument to define():</p>
 
@@ -332,7 +332,6 @@ if (someCondition) {
 <ul>
 <li><a href="http://jquery.com/">jQuery</a> 1.7</li>
 <li><a href="http://dojotoolkit.org/">Dojo</a> 1.7</li>
-<li><a href="http://mootools.net/">MooTools</a> 2.0</li>
 <li><a href="http://uxebu.github.com/embedjs/">EmbedJS</a></li>
 <li><a href="http://ender.no.de/">Ender</a>-associated modules like <a href="https://github.com/ded/bonzo">bonzo</a>, <a href="https://github.com/ded/qwery">qwery</a>, <a href="https://github.com/fat/bean">bean</a> and <a href="https://github.com/ded/domready">domready</a></li>
 <li>Used by <a href="http://getfirebug.com/">Firebug</a> 1.8+</li>
@@ -356,7 +355,7 @@ if (someCondition) {
 <li><a href="http://requirejs.org">RequireJS</a></li>
 <li><a href="https://github.com/unscriptable/curl">curl</a></li>
 <li><a href="https://github.com/zazl/lsjs">lsjs</a></li>
-<li><a href="http://dojotoolkit.org/">Dojo</a> 1.7 and <a href="http://mootools.net/">MooTools</a> 2.0 each have their own</li>
+<li><a href="http://dojotoolkit.org/">Dojo</a> 1.7+</li>
 </ul></li>
 <li>If you want to use AMD but still use the <strong>load one script at the bottom of the HTML page</strong> approach:
 <ul></div></li>
 <li>public/components/requirejs/package.json<div>diff --git a/public/components/requirejs/package.json b/public/components/requirejs/package.json
index 2096333..501f59c 100644
--- a/public/components/requirejs/package.json
+++ b/public/components/requirejs/package.json
@@ -1,5 +1,6 @@
 {
     "volo": {
         "url": "https://raw.github.com/jrburke/requirejs/{version}/require.js"
-    }
+    },
+    "main": "require.js"
 }</div></li>
 <li>public/components/requirejs/require.js<div>diff --git a/public/components/requirejs/require.js b/public/components/requirejs/require.js
index 0e7b81b..062516a 100644
--- a/public/components/requirejs/require.js
+++ b/public/components/requirejs/require.js
@@ -1,18 +1,18 @@
 /** vim: et:ts=4:sw=4:sts=4
- * @license RequireJS 2.1.2 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
+ * @license RequireJS 2.1.5 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
  * Available via the MIT or new BSD license.
  * see: http://github.com/jrburke/requirejs for details
  */
 //Not using strict: uneven strict support in browsers, #392, and causes
 //problems with requirejs.exec()/transpiler plugins that may not be strict.
 /*jslint regexp: true, nomen: true, sloppy: true */
-/*global window, navigator, document, importScripts, jQuery, setTimeout, opera */
+/*global window, navigator, document, importScripts, setTimeout, opera */
 
 var requirejs, require, define;
 (function (global) {
     var req, s, head, baseElement, dataMain, src,
         interactiveScript, currentlyAddingScript, mainScript, subPath,
-        version = '2.1.2',
+        version = '2.1.5',
         commentRegExp = /(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,
         cjsRequireRegExp = /[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,
         jsSuffixRegExp = /\.js$/,
@@ -21,7 +21,6 @@ var requirejs, require, define;
         ostring = op.toString,
         hasOwn = op.hasOwnProperty,
         ap = Array.prototype,
-        aps = ap.slice,
         apsp = ap.splice,
         isBrowser = !!(typeof window !== 'undefined' && navigator && document),
         isWebWorker = !isBrowser && typeof importScripts !== 'undefined',
@@ -192,15 +191,21 @@ var requirejs, require, define;
         var inCheckLoaded, Module, context, handlers,
             checkLoadedTimeoutId,
             config = {
+                //Defaults. Do not set a default for map
+                //config to speed up normalize(), which
+                //will run faster if there is no default.
                 waitSeconds: 7,
                 baseUrl: './',
                 paths: {},
                 pkgs: {},
                 shim: {},
-                map: {},
                 config: {}
             },
             registry = {},
+            //registry of just enabled modules, to speed
+            //cycle breaking code when lots of modules
+            //are registered, but not activated.
+            enabledRegistry = {},
             undefEvents = {},
             defQueue = [],
             defined = {},
@@ -296,7 +301,7 @@ var requirejs, require, define;
             }
 
             //Apply map config if available.
-            if (applyMap && (baseParts || starMap) && map) {
+            if (applyMap && map && (baseParts || starMap)) {
                 nameParts = name.split('/');
 
                 for (i = nameParts.length; i > 0; i -= 1) {
@@ -577,6 +582,7 @@ var requirejs, require, define;
         function cleanRegistry(id) {
             //Clean up machinery used for waiting modules.
             delete registry[id];
+            delete enabledRegistry[id];
         }
 
         function breakCycle(mod, traced, processed) {
@@ -625,7 +631,7 @@ var requirejs, require, define;
             inCheckLoaded = true;
 
             //Figure out the state of all the modules.
-            eachProp(registry, function (mod) {
+            eachProp(enabledRegistry, function (mod) {
                 map = mod.map;
                 modId = map.id;
 
@@ -806,7 +812,7 @@ var requirejs, require, define;
             },
 
             /**
-             * Checks is the module is ready to define itself, and if so,
+             * Checks if the module is ready to define itself, and if so,
              * define it.
              */
             check: function () {
@@ -884,7 +890,7 @@ var requirejs, require, define;
                         }
 
                         //Clean up
-                        delete registry[id];
+                        cleanRegistry(id);
 
                         this.defined = true;
                     }
@@ -918,8 +924,7 @@ var requirejs, require, define;
                         name = this.map.name,
                         parentName = this.map.parentMap ? this.map.parentMap.name : null,
                         localRequire = context.makeRequire(map.parentMap, {
-                            enableBuildCallback: true,
-                            skipMap: true
+                            enableBuildCallback: true
                         });
 
                     //If current map is not normalized, wait for that
@@ -1017,8 +1022,11 @@ var requirejs, require, define;
                         try {
                             req.exec(text);
                         } catch (e) {
-                            throw new Error('fromText eval for ' + moduleName +
-                                            ' failed: ' + e);
+                            return onError(makeError('fromtexteval',
+                                             'fromText eval for ' + id +
+                                            ' failed: ' + e,
+                                             e,
+                                             [id]));
                         }
 
                         if (hasInteractive) {
@@ -1048,6 +1056,7 @@ var requirejs, require, define;
             },
 
             enable: function () {
+                enabledRegistry[this.map.id] = this;
                 this.enabled = true;
 
                 //Set flag mentioning that the module is enabling,
@@ -1207,6 +1216,7 @@ var requirejs, require, define;
             Module: Module,
             makeModuleMap: makeModuleMap,
             nextTick: req.nextTick,
+            onError: onError,
 
             /**
              * Set a configuration for the context.
@@ -1233,6 +1243,9 @@ var requirejs, require, define;
                 eachProp(cfg, function (value, prop) {
                     if (objs[prop]) {
                         if (prop === 'map') {
+                            if (!config.map) {
+                                config.map = {};
+                            }
                             mixin(config[prop], value, true, true);
                         } else {
                             mixin(config[prop], value, true);
@@ -1344,7 +1357,7 @@ var requirejs, require, define;
                         //Synchronous access to one module. If require.get is
                         //available (as in the Node adapter), prefer that.
                         if (req.get) {
-                            return req.get(context, deps, relMap);
+                            return req.get(context, deps, relMap, localRequire);
                         }
 
                         //Normalize module name, if it contains . or ..
@@ -1395,16 +1408,20 @@ var requirejs, require, define;
                      * plain URLs like nameToUrl.
                      */
                     toUrl: function (moduleNamePlusExt) {
-                        var index = moduleNamePlusExt.lastIndexOf('.'),
-                            ext = null;
-
-                        if (index !== -1) {
+                        var ext,
+                            index = moduleNamePlusExt.lastIndexOf('.'),
+                            segment = moduleNamePlusExt.split('/')[0],
+                            isRelative = segment === '.' || segment === '..';
+
+                        //Have a file extension alias, and it is not the
+                        //dots from a relative path.
+                        if (index !== -1 && (!isRelative || index > 1)) {
                             ext = moduleNamePlusExt.substring(index, moduleNamePlusExt.length);
                             moduleNamePlusExt = moduleNamePlusExt.substring(0, index);
                         }
 
                         return context.nameToUrl(normalize(moduleNamePlusExt,
-                                                relMap && relMap.id, true), ext);
+                                                relMap && relMap.id, true), ext,  true);
                     },
 
                     defined: function (id) {
@@ -1449,10 +1466,11 @@ var requirejs, require, define;
 
             /**
              * Called to enable a module if it is still in the registry
-             * awaiting enablement. parent module is passed in for context,
-             * used by the optimizer.
+             * awaiting enablement. A second arg, parent, the parent module,
+             * is passed in for context, when this method is overriden by
+             * the optimizer. Not shown here to keep code compact.
              */
-            enable: function (depMap, parent) {
+            enable: function (depMap) {
                 var mod = getOwn(registry, depMap.id);
                 if (mod) {
                     getModule(depMap).enable();
@@ -1522,7 +1540,7 @@ var requirejs, require, define;
              * it is assumed to have already been normalized. This is an
              * internal API, not a public one. Use toUrl for the public API.
              */
-            nameToUrl: function (moduleName, ext) {
+            nameToUrl: function (moduleName, ext, skipExt) {
                 var paths, pkgs, pkg, pkgPath, syms, i, parentModule, url,
                     parentPath;
 
@@ -1571,7 +1589,7 @@ var requirejs, require, define;
 
                     //Join the path parts together, then figure out if baseUrl is needed.
                     url = syms.join('/');
-                    url += (ext || (/\?/.test(url) ? '' : '.js'));
+                    url += (ext || (/\?/.test(url) || skipExt ? '' : '.js'));
                     url = (url.charAt(0) === '/' || url.match(/^[\w\+\.\-]+:/) ? '' : config.baseUrl) + url;
                 }
 
@@ -1810,7 +1828,7 @@ var requirejs, require, define;
                 node.attachEvent('onreadystatechange', context.onScriptLoad);
                 //It would be great to add an error handler here to catch
                 //404s in IE9+. However, onreadystatechange will fire before
-                //the error handler, so that does not help. If addEvenListener
+                //the error handler, so that does not help. If addEventListener
                 //is used, then IE will fire error before load, but we cannot
                 //use that pathway given the connect.microsoft.com issue
                 //mentioned above about not doing the 'script execute,
@@ -1839,16 +1857,24 @@ var requirejs, require, define;
 
             return node;
         } else if (isWebWorker) {
-            //In a web worker, use importScripts. This is not a very
-            //efficient use of importScripts, importScripts will block until
-            //its script is downloaded and evaluated. However, if web workers
-            //are in play, the expectation that a build has been done so that
-            //only one script needs to be loaded anyway. This may need to be
-            //reevaluated if other use cases become common.
-            importScripts(url);
-
-            //Account for anonymous modules
-            context.completeLoad(moduleName);
+            try {
+                //In a web worker, use importScripts. This is not a very
+                //efficient use of importScripts, importScripts will block until
+                //its script is downloaded and evaluated. However, if web workers
+                //are in play, the expectation that a build has been done so that
+                //only one script needs to be loaded anyway. This may need to be
+                //reevaluated if other use cases become common.
+                importScripts(url);
+
+                //Account for anonymous modules
+                context.completeLoad(moduleName);
+            } catch (e) {
+                context.onError(makeError('importscripts',
+                                'importScripts failed for ' +
+                                    moduleName + ' at ' + url,
+                                e,
+                                [moduleName]));
+            }
         }
     };
 </div></li>
 <li>public/components/requirejs/tests/all.js<div>diff --git a/public/components/requirejs/tests/all.js b/public/components/requirejs/tests/all.js
index 1f78d32..9c11208 100644
--- a/public/components/requirejs/tests/all.js
+++ b/public/components/requirejs/tests/all.js
@@ -9,6 +9,9 @@ doh.registerUrl("simple", "../simple.html");
 //PS3 does not like this test
 doh.registerUrl("baseUrl", "../baseUrl.html");
 
+doh.registerUrl("toUrl", "../toUrl/toUrl.html");
+doh.registerUrl("urlArgsToUrl", "../urlArgsToUrl.html");
+
 doh.registerUrl("config", "../config.html");
 doh.registerUrl("configRequirejs", "../configRequirejs.html");
 doh.registerUrl("dataMain", "../dataMain/dataMain.html");
@@ -108,7 +111,9 @@ doh.registerUrl("pluginsSync", "../plugins/sync.html");
 doh.registerUrl("pluginsOnError", "../plugins/onerror/onerror.html");
 doh.registerUrl("doublePluginCall", "../plugins/double.html");
 doh.registerUrl("pluginsNameOnly", "../plugins/nameOnly.html");
+doh.registerUrl("pluginsDelegated", "../plugins/delegated/delegated.html");
 doh.registerUrl("pluginsFromText", "../plugins/fromText/fromText.html");
+doh.registerUrl("pluginsFromTextEvalError", "../plugins/fromTextEvalError/fromTextEvalError.html");
 doh.registerUrl("pluginsFromTextConfig", "../plugins/fromText/fromTextConfig.html");
 doh.registerUrl("pluginsFromTextNoDefine", "../plugins/fromTextNoDefine/fromTextNoDefine.html");
 doh.registerUrl("pluginsTextDepend", "../plugins/textDepend/textDepend.html");</div></li>
 <li>public/components/requirejs/tests/i18n/common.html<div>diff --git a/public/components/requirejs/tests/i18n/common.html b/public/components/requirejs/tests/i18n/common.html
index 114dff2..277cb84 100644
--- a/public/components/requirejs/tests/i18n/common.html
+++ b/public/components/requirejs/tests/i18n/common.html
@@ -23,7 +23,11 @@
             blue = "bleu";
         }
         require({
-            locale: locale,
+            config: {
+                'i18n': {
+                    locale: locale
+                }
+            },
             baseUrl: "./",
             paths: {
                 i18n: "../../../i18n/i18n"</div></li>
 <li>public/components/requirejs/tests/i18n/i18n.html<div>diff --git a/public/components/requirejs/tests/i18n/i18n.html b/public/components/requirejs/tests/i18n/i18n.html
index c4b9bad..e160726 100644
--- a/public/components/requirejs/tests/i18n/i18n.html
+++ b/public/components/requirejs/tests/i18n/i18n.html
@@ -44,7 +44,11 @@
             expected.blue = "bleu";
         }
         require({
-            locale: locale,
+            config: {
+                'i18n': {
+                    locale: locale
+                }
+            },
             baseUrl: "./",
             paths: {
                 i18n: "../../../i18n/i18n"</div></li>
 <li>public/components/requirejs/tests/plugins/delegated/a.refine<div>diff --git a/public/components/requirejs/tests/plugins/delegated/a.refine b/public/components/requirejs/tests/plugins/delegated/a.refine
new file mode 100644
index 0000000..a3c3061
--- /dev/null
+++ b/public/components/requirejs/tests/plugins/delegated/a.refine
@@ -0,0 +1,4 @@
+//The refine plugin changes the word refine into define.
+refine({
+    name: 'a'
+});</div></li>
 <li>public/components/requirejs/tests/plugins/delegated/delegated-tests.js<div>diff --git a/public/components/requirejs/tests/plugins/delegated/delegated-tests.js b/public/components/requirejs/tests/plugins/delegated/delegated-tests.js
new file mode 100644
index 0000000..b5642ea
--- /dev/null
+++ b/public/components/requirejs/tests/plugins/delegated/delegated-tests.js
@@ -0,0 +1,25 @@
+require.config({
+    baseUrl: requirejs.isBrowser ? './' : './plugins/fromTextEvalError',
+    paths: {
+        'refine': '../fromText/refine',
+        'text': '../../../../text/text'
+    },
+    map: {
+        '*': {
+            r: 'refine'
+        }
+    }
+});
+
+require(['delegated!r!a'], function (a) {
+
+    doh.register(
+        'pluginsDelegated',
+        [
+            function pluginsDelegated(t){
+                t.is('a', a.name);
+             }
+        ]
+    );
+    doh.run();
+});</div></li>
 <li>public/components/requirejs/tests/plugins/delegated/delegated.html<div>diff --git a/public/components/requirejs/tests/plugins/delegated/delegated.html b/public/components/requirejs/tests/plugins/delegated/delegated.html
new file mode 100644
index 0000000..f991416
--- /dev/null
+++ b/public/components/requirejs/tests/plugins/delegated/delegated.html
@@ -0,0 +1,14 @@
+<!DOCTYPE html>
+<html>
+<head>
+    <title>require.js: Delegated Map Plugin Test</title>
+    <script type="text/javascript" src="../../doh/runner.js"></script>
+    <script type="text/javascript" src="../../doh/_browserRunner.js"></script>
+    <script type="text/javascript" data-main="delegated-tests.js"  src="../../../require.js"></script>
+</head>
+<body>
+    <h1>require.js: Delegated Map Plugin Test</h1>
+    <p>Make sure map works on plugin resource IDs. <a href="https://github.com/jrburke/requirejs/issues/563">More info</a>.</p>
+    <p>Check console for messages</p>
+</body>
+</html></div></li>
 <li>public/components/requirejs/tests/plugins/delegated/delegated.js<div>diff --git a/public/components/requirejs/tests/plugins/delegated/delegated.js b/public/components/requirejs/tests/plugins/delegated/delegated.js
new file mode 100644
index 0000000..b6464b2
--- /dev/null
+++ b/public/components/requirejs/tests/plugins/delegated/delegated.js
@@ -0,0 +1,5 @@
+define({
+    load: function(name, req, load) {
+        req([name], load);
+    }
+});</div></li>
 <li>public/components/requirejs/tests/plugins/fromText/refine.js<div>diff --git a/public/components/requirejs/tests/plugins/fromText/refine.js b/public/components/requirejs/tests/plugins/fromText/refine.js
index 0a98e6e..87db22c 100644
--- a/public/components/requirejs/tests/plugins/fromText/refine.js
+++ b/public/components/requirejs/tests/plugins/fromText/refine.js
@@ -1,11 +1,11 @@
 
 /*jslint strict: false, plusplus: false */
 /*global define: false, require: false,  XMLHttpRequest: false, ActiveXObject: false,
-  window: false, Packages: false, java: false, process: false */
+  window: false, Packages: false, java: false, process: false, Components, FileUtils */
 
 (function () {
     //Load the text plugin, so that the XHR calls can be made.
-    var buildMap = {}, fetchText, fs,
+    var buildMap = {}, fetchText, fs, Cc, Ci,
         progIds = ['Msxml2.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.4.0'];
 
     function createXhr() {
@@ -94,6 +94,37 @@
             }
             callback(content);
         };
+    } else if (typeof Components !== 'undefined' && Components.classes &&
+            Components.interfaces) {
+        //Avert your gaze!
+        Cc = Components.classes,
+        Ci = Components.interfaces;
+        Components.utils['import']('resource://gre/modules/FileUtils.jsm');
+
+        fetchText = function (url, callback) {
+            var inStream, convertStream,
+                readData = {},
+                fileObj = new FileUtils.File(url);
+
+            //XPCOM, you so crazy
+            try {
+                inStream = Cc['@mozilla.org/network/file-input-stream;1']
+                           .createInstance(Ci.nsIFileInputStream);
+                inStream.init(fileObj, 1, 0, false);
+
+                convertStream = Cc['@mozilla.org/intl/converter-input-stream;1']
+                                .createInstance(Ci.nsIConverterInputStream);
+                convertStream.init(inStream, "utf-8", inStream.available(),
+                Ci.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER);
+
+                convertStream.readString(inStream.available(), readData);
+                convertStream.close();
+                inStream.close();
+                callback(readData.value);
+            } catch (e) {
+                throw new Error((fileObj && fileObj.path || '') + ': ' + e);
+            }
+        };
     }
 
     define(function () {
@@ -111,10 +142,6 @@
                     text += "\r\n//@ sourceURL=" + url;
 
                     load.fromText(text);
-
-                    parentRequire([name], function (value) {
-                        load(value);
-                    });
                 });
             },
 </div></li>
 <li>public/components/requirejs/tests/plugins/fromTextEvalError/a.refine<div>diff --git a/public/components/requirejs/tests/plugins/fromTextEvalError/a.refine b/public/components/requirejs/tests/plugins/fromTextEvalError/a.refine
new file mode 100644
index 0000000..1064a2b
--- /dev/null
+++ b/public/components/requirejs/tests/plugins/fromTextEvalError/a.refine
@@ -0,0 +1,5 @@
+//The refine plugin changes the word refine into define.
+refine({
+    name: 'a'
+//Notice missing curly
+);</div></li>
 <li>public/components/requirejs/tests/plugins/fromTextEvalError/b.refine<div>diff --git a/public/components/requirejs/tests/plugins/fromTextEvalError/b.refine b/public/components/requirejs/tests/plugins/fromTextEvalError/b.refine
new file mode 100644
index 0000000..4f4fc2d
--- /dev/null
+++ b/public/components/requirejs/tests/plugins/fromTextEvalError/b.refine
@@ -0,0 +1,7 @@
+//The refine plugin changes the word refine into define.
+refine(function (require, exports, module) {
+    return {
+        name: 'b',
+        color: module.config().color
+    };
+});</div></li>
 <li>public/components/requirejs/tests/plugins/fromTextEvalError/fromTextEvalError-tests.js<div>diff --git a/public/components/requirejs/tests/plugins/fromTextEvalError/fromTextEvalError-tests.js b/public/components/requirejs/tests/plugins/fromTextEvalError/fromTextEvalError-tests.js
new file mode 100644
index 0000000..3935113
--- /dev/null
+++ b/public/components/requirejs/tests/plugins/fromTextEvalError/fromTextEvalError-tests.js
@@ -0,0 +1,23 @@
+require.config({
+        baseUrl: requirejs.isBrowser ? './' : './plugins/fromTextEvalError',
+        paths: {
+            'refine': '../fromText/refine',
+            'text': '../../../../text/text'
+        }
+});
+
+require(['refine!a'], function (a) {
+    //This should not be called
+}, function (err) {
+    var message = err + '';
+
+    doh.register(
+        'pluginsFromTextEvalError',
+        [
+            function pluginsFromTextEvalError(t){
+                t.is(-1, message.indexOf('timeout'));
+             }
+        ]
+    );
+    doh.run();
+});</div></li>
 <li>public/components/requirejs/tests/plugins/fromTextEvalError/fromTextEvalError.html<div>diff --git a/public/components/requirejs/tests/plugins/fromTextEvalError/fromTextEvalError.html b/public/components/requirejs/tests/plugins/fromTextEvalError/fromTextEvalError.html
new file mode 100644
index 0000000..f0b2258
--- /dev/null
+++ b/public/components/requirejs/tests/plugins/fromTextEvalError/fromTextEvalError.html
@@ -0,0 +1,14 @@
+<!DOCTYPE html>
+<html>
+<head>
+    <title>require.js: fromText Eval Error Plugin Test</title>
+    <script type="text/javascript" src="../../doh/runner.js"></script>
+    <script type="text/javascript" src="../../doh/_browserRunner.js"></script>
+    <script type="text/javascript" data-main="fromTextEvalError-tests.js"  src="../../../require.js"></script>
+</head>
+<body>
+    <h1>require.js: fromText Eval Error Plugin Test</h1>
+    <p>Trigger errbacks for plugin fromText eval errors. <a href="https://github.com/jrburke/requirejs/issues/583">More info</a>.</p>
+    <p>Check console for messages</p>
+</body>
+</html></div></li>
 <li>public/components/requirejs/tests/requirePluginLoad/requirePluginLoad-tests.js<div>diff --git a/public/components/requirejs/tests/requirePluginLoad/requirePluginLoad-tests.js b/public/components/requirejs/tests/requirePluginLoad/requirePluginLoad-tests.js
index 32a06d3..666bb59 100644
--- a/public/components/requirejs/tests/requirePluginLoad/requirePluginLoad-tests.js
+++ b/public/components/requirejs/tests/requirePluginLoad/requirePluginLoad-tests.js
@@ -36,19 +36,21 @@ require({
     },
     ["app/run"],
     function() {
-        doh.register(
-            "requirePluginLoad",
-            [
-                function requirePluginLoad(t){
-                    var main = globals.main;
-
-                    t.is("main", main.name);
-                    t.is("test", main.test.name);
-                    t.is("test2", main.test2.name);
-                }
-            ]
-        );
-
-        doh.run();
+        require(["plug!app/main"], function () {
+            doh.register(
+                "requirePluginLoad",
+                [
+                    function requirePluginLoad(t){
+                        var main = globals.main;
+
+                        t.is("main", main.name);
+                        t.is("test", main.test.name);
+                        t.is("test2", main.test2.name);
+                    }
+                ]
+            );
+
+            doh.run();
+        });
     }
 );</div></li>
 <li>public/components/requirejs/tests/shim/f.js<div>diff --git a/public/components/requirejs/tests/shim/f.js b/public/components/requirejs/tests/shim/f.js
new file mode 100644
index 0000000..83c0abc
--- /dev/null
+++ b/public/components/requirejs/tests/shim/f.js
@@ -0,0 +1,4 @@
+var FCAP = {
+    name: 'FCAP',
+    globalA: A
+};</div></li>
 <li>public/components/requirejs/tests/toUrl/.hidden.html<div>diff --git a/public/components/requirejs/tests/toUrl/.hidden.html b/public/components/requirejs/tests/toUrl/.hidden.html
new file mode 100644
index 0000000..d3a9a71
--- /dev/null
+++ b/public/components/requirejs/tests/toUrl/.hidden.html
@@ -0,0 +1 @@
+.hidden
\ No newline at end of file</div></li>
 <li>public/components/requirejs/tests/toUrl/auxil.html<div>diff --git a/public/components/requirejs/tests/toUrl/auxil.html b/public/components/requirejs/tests/toUrl/auxil.html
new file mode 100644
index 0000000..53dfe42
--- /dev/null
+++ b/public/components/requirejs/tests/toUrl/auxil.html
@@ -0,0 +1 @@
+aux
\ No newline at end of file</div></li>
 <li>public/components/requirejs/tests/toUrl/main.html<div>diff --git a/public/components/requirejs/tests/toUrl/main.html b/public/components/requirejs/tests/toUrl/main.html
new file mode 100644
index 0000000..e3710e7
--- /dev/null
+++ b/public/components/requirejs/tests/toUrl/main.html
@@ -0,0 +1 @@
+main.html
\ No newline at end of file</div></li>
 <li>public/components/requirejs/tests/toUrl/main.js<div>diff --git a/public/components/requirejs/tests/toUrl/main.js b/public/components/requirejs/tests/toUrl/main.js
new file mode 100644
index 0000000..5f415f8
--- /dev/null
+++ b/public/components/requirejs/tests/toUrl/main.js
@@ -0,0 +1,8 @@
+define(function (require) {
+    return {
+        html: require('text!./main.html'),
+        noext: require('text!sub/noext'),
+        hidden: require('text!.hidden.html'),
+        util: require('sub/util')
+    };
+});
\ No newline at end of file</div></li>
 <li>public/components/requirejs/tests/toUrl/sub/nested/thing.js<div>diff --git a/public/components/requirejs/tests/toUrl/sub/nested/thing.js b/public/components/requirejs/tests/toUrl/sub/nested/thing.js
new file mode 100644
index 0000000..c9bb90b
--- /dev/null
+++ b/public/components/requirejs/tests/toUrl/sub/nested/thing.js
@@ -0,0 +1,7 @@
+define(function (require) {
+    return {
+        noext: require('text!../noext'),
+        dirPath: require.toUrl('.'),
+        parentPath: require.toUrl('..')
+    };
+});
\ No newline at end of file</div></li>
 <li>public/components/requirejs/tests/toUrl/sub/noext<div>diff --git a/public/components/requirejs/tests/toUrl/sub/noext b/public/components/requirejs/tests/toUrl/sub/noext
new file mode 100644
index 0000000..34dea4f
--- /dev/null
+++ b/public/components/requirejs/tests/toUrl/sub/noext
@@ -0,0 +1 @@
+noext
\ No newline at end of file</div></li>
 <li>public/components/requirejs/tests/toUrl/sub/util.html<div>diff --git a/public/components/requirejs/tests/toUrl/sub/util.html b/public/components/requirejs/tests/toUrl/sub/util.html
new file mode 100644
index 0000000..4621784
--- /dev/null
+++ b/public/components/requirejs/tests/toUrl/sub/util.html
@@ -0,0 +1 @@
+util
\ No newline at end of file</div></li>
 <li>public/components/requirejs/tests/toUrl/sub/util.js<div>diff --git a/public/components/requirejs/tests/toUrl/sub/util.js b/public/components/requirejs/tests/toUrl/sub/util.js
new file mode 100644
index 0000000..008823e
--- /dev/null
+++ b/public/components/requirejs/tests/toUrl/sub/util.js
@@ -0,0 +1,8 @@
+define(function (require) {
+    return {
+        dotPath: require.toUrl('.'),
+        html: require('text!./util.html'),
+        auxHtml: require('text!../auxil.html'),
+        thing: require('./nested/thing')
+    };
+});</div></li>
 <li>public/components/requirejs/tests/toUrl/toUrl-tests.js<div>diff --git a/public/components/requirejs/tests/toUrl/toUrl-tests.js b/public/components/requirejs/tests/toUrl/toUrl-tests.js
new file mode 100644
index 0000000..3a95ba7
--- /dev/null
+++ b/public/components/requirejs/tests/toUrl/toUrl-tests.js
@@ -0,0 +1,30 @@
+require.config({
+    paths: {
+        text: '../../../text/text'
+    }
+});
+
+require(['main'], function(main) {
+
+    var subRegExp = /\/sub$/,
+        nestedRegExp = /\/sub\/nested$/;
+
+    doh.register(
+        "toUrl",
+        [
+            function toUrl(t){
+                t.is(".hidden", main.hidden);
+                t.is("main.html", main.html);
+                t.is("noext", main.noext);
+                t.is("aux", main.util.auxHtml);
+                t.is(true, subRegExp.test(main.util.dotPath));
+                t.is("util", main.util.html);
+
+                t.is(true, nestedRegExp.test(main.util.thing.dirPath));
+                t.is(true, subRegExp.test(main.util.thing.parentPath));
+                t.is("noext", main.util.thing.noext);
+            }
+        ]
+    );
+    doh.run();
+});</div></li>
 <li>public/components/requirejs/tests/toUrl/toUrl.html<div>diff --git a/public/components/requirejs/tests/toUrl/toUrl.html b/public/components/requirejs/tests/toUrl/toUrl.html
new file mode 100644
index 0000000..6a45015
--- /dev/null
+++ b/public/components/requirejs/tests/toUrl/toUrl.html
@@ -0,0 +1,14 @@
+<!DOCTYPE html>
+<html>
+<head>
+    <title>require.js: toUrl Test</title>
+    <script src="../doh/runner.js"></script>
+    <script src="../doh/_browserRunner.js"></script>
+    <script src="../../require.js"></script>
+    <script src="toUrl-tests.js"></script>
+</head>
+<body>
+    <h1>require.js: toUrl Test</h1>
+    <p>Check console for messages</p>
+</body>
+</html></div></li>
 <li>public/components/requirejs/tests/urlArgsToUrl.html<div>diff --git a/public/components/requirejs/tests/urlArgsToUrl.html b/public/components/requirejs/tests/urlArgsToUrl.html
new file mode 100644
index 0000000..5706c2c
--- /dev/null
+++ b/public/components/requirejs/tests/urlArgsToUrl.html
@@ -0,0 +1,33 @@
+<!DOCTYPE html>
+<html>
+<head>
+    <title>require.js: urlArgs + toUrl Test</title>
+    <script type="text/javascript" src="doh/runner.js"></script>
+    <script type="text/javascript" src="doh/_browserRunner.js"></script>
+    <script type="text/javascript" src="../require.js"></script>
+    <script>
+    require.config({
+        baseUrl: 'js',
+        urlArgs: 'v=1234'
+    });
+
+    doh.register(
+        'urlArgsToUrl',
+        [
+            function urlArgsToUrl(t){
+                t.is('js/view.html?v=1234', require.toUrl('view.html'));
+                t.is('js/view?v=1234', require.toUrl('view'));
+            }
+        ]
+    );
+    doh.run();
+</script>
+</head>
+<body>
+    <h1>require.js: urlArgs + toUrl Test</h1>
+    <p>Makes sure urlArgs are applied correctly with the fixes for
+        <a href="https://github.com/jrburke/requirejs/issues/515">515</a> and
+        <a href="https://github.com/jrburke/requirejs/issues/614">614</a> are done.</p>
+    <p>Check console for messages.</p>
+</body>
+</html></div></li>
 <li>public/components/text/LICENSE<div>diff --git a/public/components/text/LICENSE b/public/components/text/LICENSE
deleted file mode 100644
index ffaf317..0000000
--- a/public/components/text/LICENSE
+++ /dev/null
@@ -1,58 +0,0 @@
-RequireJS is released under two licenses: new BSD, and MIT. You may pick the
-license that best suits your development needs. The text of both licenses are
-provided below.
-
-
-The "New" BSD License:
-----------------------
-
-Copyright (c) 2010-2011, The Dojo Foundation
-All rights reserved.
-
-Redistribution and use in source and binary forms, with or without
-modification, are permitted provided that the following conditions are met:
-
-  * Redistributions of source code must retain the above copyright notice, this
-    list of conditions and the following disclaimer.
-  * Redistributions in binary form must reproduce the above copyright notice,
-    this list of conditions and the following disclaimer in the documentation
-    and/or other materials provided with the distribution.
-  * Neither the name of the Dojo Foundation nor the names of its contributors
-    may be used to endorse or promote products derived from this software
-    without specific prior written permission.
-
-THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
-ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
-WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
-DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
-FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
-DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
-SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
-CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
-OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
-OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-
-
-
-MIT License
------------
-
-Copyright (c) 2010-2011, The Dojo Foundation
-
-Permission is hereby granted, free of charge, to any person obtaining a copy
-of this software and associated documentation files (the "Software"), to deal
-in the Software without restriction, including without limitation the rights
-to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
-copies of the Software, and to permit persons to whom the Software is
-furnished to do so, subject to the following conditions:
-
-The above copyright notice and this permission notice shall be included in
-all copies or substantial portions of the Software.
-
-THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
-IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
-FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
-AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
-LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
-OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
-THE SOFTWARE.</div></li>
 <li>public/components/text/README.md<div>diff --git a/public/components/text/README.md b/public/components/text/README.md
deleted file mode 100644
index 5026058..0000000
--- a/public/components/text/README.md
+++ /dev/null
@@ -1,194 +0,0 @@
-# text
-
-A [RequireJS](http://requirejs.org)/AMD loader plugin for loading text
-resources.
-
-Known to work in RequireJS, but should work in other AMD loaders that support
-the same loader plugin API.
-
-## Docs
-
-See the [RequireJS API text section](http://requirejs.org/docs/api.html#text).
-
-## Latest release
-
-The latest release is always available from [the "latest" tag](https://raw.github.com/requirejs/text/latest/text.js).
-
-It can also be installed using [volo](https://github.com/volojs/volo):
-
-    volo add requirejs/text
-
-## Usage
-
-It is nice to build HTML using regular HTML tags, instead of building up DOM
-structures in script. However, there is no good way to embed HTML in a
-JavaScript file. The best that can be done is using a string of HTML, but that
-can be hard to manage, particularly for multi-line HTML.
-
-The text.js AMD loader plugin can help with this issue. It will automatically be
-loaded if the text! prefix is used for a dependency. Download the plugin and put
-it in the app's [baseUrl](http://requirejs.org/docs/api.html#config-baseUrl)
-directory.
-
-You can specify a text file resource as a dependency like so:
-
-```javascript
-require(["some/module", "text!some/module.html", "text!some/module.css"],
-    function(module, html, css) {
-        //the html variable will be the text
-        //of the some/module.html file
-        //the css variable will be the text
-        //of the some/module.css file.
-    }
-);
-```
-
-Notice the .html and .css suffixes to specify the extension of the file. The
-"some/module" part of the path will be resolved according to normal module name
-resolution: it will use the **baseUrl** and **paths** [configuration
-options](http://requirejs.org/docs/api.html#config) to map that name to a path.
-
-For HTML/XML/SVG files, there is another option. You can pass !strip, which
-strips XML declarations so that external SVG and XML documents can be added to a
-document without worry. Also, if the string is an HTML document, only the part
-inside the body tag is returned. Example:
-
-```javascript
-require(["text!some/module.html!strip"],
-    function(html) {
-        //the html variable will be the text of the
-        //some/module.html file, but only the part
-        //inside the body tag.
-    }
-);
-```
-
-The text files are loaded via asynchronous XMLHttpRequest (XHR) calls, so you
-can only fetch files from the same domain as the web page (see **XHR
-restrictions** below).
-
-However, [the RequireJS optimizer](http://requirejs.org/docs/optimization.html)
-will inline any text! references with the actual text file contents into the
-modules, so after a build, the modules that have text! dependencies can be used
-from other domains.
-
-## Configuration
-
-### XHR restrictions
-
-The text plugin works by using XMLHttpRequest (XHR) to fetch the text for the
-resources it handles.
-
-However, XHR calls have some restrictions, due to browser/web security policies:
-
-1) Many browsers do not allow file:// access to just any file. You are better
-off serving the application from a local web server than using local file://
-URLs. You will likely run into trouble otherwise.
-
-2) There are restrictions for using XHR to access files on another web domain.
-While CORS can help enable the server for cross-domain access, doing so must
-be done with care (in particular if you also host an API from that domain),
-and not all browsers support CORS.
-
-So if the text plugin determines that the request for the resource is on another
-domain, it will try to access a ".js" version of the resource by using a
-script tag. Script tag GET requests are allowed across domains. The .js version
-of the resource should just be a script with a define() call in it that returns
-a string for the module value.
-
-Example: if the resource is 'text!example.html' and that resolves to a path
-on another web domain, the text plugin will do a script tag load for
-'example.html.js'.
-
-The [requirejs optimizer](http://requirejs.org/docs/optimization.html) will
-generate these '.js' versions of the text resources if you set this in the
-build profile:
-
-    optimizeAllPluginResources: true
-
-In some cases, you may want the text plugin to not try the .js resource, maybe
-because you hae configured CORS on the other server, and you know that only
-browsers that support CORS will be used. In that case you can use the
-[module config](http://requirejs.org/docs/api.html#config-moduleconfig)
-(requires RequireJS 2+) to override some of the basic logic the plugin uses to
-determine if the .js file should be requested:
-
-```javascript
-requirejs.config({
-    config: {
-        text: {
-            useXhr: function (url, protocol, hostname, port) {
-                //Override function for determining if XHR should be used.
-                //url: the URL being requested
-                //protocol: protocol of page text.js is running on
-                //hostname: hostname of page text.js is running on
-                //port: port of page text.js is running on
-                //Use protocol, hostname, and port to compare against the url
-                //being requested.
-                //Return true of false. true means "use xhr", false means
-                //"fetch the .js version of this resource".
-            }
-        }
-    }
-});
-```
-
-### Custom XHR hooks
-
-There may be cases where you might want to provide the XHR object to use
-in the request, or you may just want to add some custom headers to the
-XHR object used to make the request. You can use the following hooks:
-
-```javascript
-requirejs.config({
-    config: {
-        text: {
-            onXhr: function (xhr, url) {
-                //Called after the XHR has been created and after the
-                //xhr.open() call, but before the xhr.send() call.
-                //Useful time to set headers.
-                //xhr: the xhr object
-                //url: the url that is being used with the xhr object.
-            },
-            createXhr: function () {
-                //Overrides the creation of the XHR object. Return an XHR
-                //object from this function.
-                //Available in text.js 2.0.1 or later.
-            }
-        }
-    }
-});
-```
-
-### Forcing the environment implemention
-
-The text plugin tries to detect what environment it is available for loading
-text resources, Node, XMLHttpRequest (XHR) or Rhino, but sometimes the
-Node or Rhino environment may have loaded a library that introduces an XHR
-implementation. You can foce the environment implementation to use by passing
-an "env" module config to the plugin:
-
-```javascript
-requirejs.config({
-    config: {
-        text: {
-            //Valid values are 'node', 'xhr', or 'rhino'
-            env: 'rhino'
-        }
-    }
-});
-```
-
-## License
-
-Dual-licensed -- new BSD or MIT.
-
-## Where are the tests?
-
-They are in the [requirejs](https://github.com/jrburke/requirejs) and
-[r.js](https://github.com/jrburke/r.js) repos.
-
-## History
-
-This plugin was in the [requirejs repo](https://github.com/jrburke/requirejs)
-up until the requirejs 2.0 release.</div></li>
 <li>public/components/text/component.json<div>diff --git a/public/components/text/component.json b/public/components/text/component.json
deleted file mode 100644
index 47c0d8c..0000000
--- a/public/components/text/component.json
+++ /dev/null
@@ -1,8 +0,0 @@
-{
-  "name": "text",
-  "version": "2.0.3",
-  "repository": {
-    "type": "git",
-    "url": "git://github.com/requirejs/text.git"
-  }
-}
\ No newline at end of file</div></li>
 <li>public/components/text/package.json<div>diff --git a/public/components/text/package.json b/public/components/text/package.json
deleted file mode 100644
index 0fc60fd..0000000
--- a/public/components/text/package.json
+++ /dev/null
@@ -1,32 +0,0 @@
-{
-    "name": "text",
-    "version": "2.0.3",
-    "description": "An AMD loader plugin for loading text resources.",
-    "categories": [
-        "Loader plugins"
-    ],
-    "main": "text.js",
-    "github": "https://github.com/requirejs/text",
-    "bugs": {
-        "web": "https://github.com/requirejs/text/issues"
-    },
-    "repositories": [
-        {
-            "type": "git",
-            "url": "https://github.com/requirejs/text.git"
-        }
-    ],
-    "licenses": [
-        {
-            "type": "MIT",
-            "url": "http://www.opensource.org/licenses/mit-license.php"
-        },
-        {
-            "type": "BSD New",
-            "url": "http://opensource.org/licenses/BSD-3-Clause"
-        }
-    ],
-    "volo": {
-        "url": "https://raw.github.com/requirejs/text/{version}/text.js"
-    }
-}</div></li>
 <li>public/components/text/text.js<div>diff --git a/public/components/text/text.js b/public/components/text/text.js
deleted file mode 100644
index bf61a3f..0000000
--- a/public/components/text/text.js
+++ /dev/null
@@ -1,308 +0,0 @@
-/**
- * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
- * Available via the MIT or new BSD license.
- * see: http://github.com/requirejs/text for details
- */
-/*jslint regexp: true */
-/*global require: false, XMLHttpRequest: false, ActiveXObject: false,
-  define: false, window: false, process: false, Packages: false,
-  java: false, location: false */
-
-define(['module'], function (module) {
-    'use strict';
-
-    var text, fs,
-        progIds = ['Msxml2.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.4.0'],
-        xmlRegExp = /^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,
-        bodyRegExp = /<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,
-        hasLocation = typeof location !== 'undefined' && location.href,
-        defaultProtocol = hasLocation && location.protocol && location.protocol.replace(/\:/, ''),
-        defaultHostName = hasLocation && location.hostname,
-        defaultPort = hasLocation && (location.port || undefined),
-        buildMap = [],
-        masterConfig = (module.config && module.config()) || {};
-
-    text = {
-        version: '2.0.3',
-
-        strip: function (content) {
-            //Strips <?xml ...?> declarations so that external SVG and XML
-            //documents can be added to a document without worry. Also, if the string
-            //is an HTML document, only the part inside the body tag is returned.
-            if (content) {
-                content = content.replace(xmlRegExp, "");
-                var matches = content.match(bodyRegExp);
-                if (matches) {
-                    content = matches[1];
-                }
-            } else {
-                content = "";
-            }
-            return content;
-        },
-
-        jsEscape: function (content) {
-            return content.replace(/(['\\])/g, '\\$1')
-                .replace(/[\f]/g, "\\f")
-                .replace(/[\b]/g, "\\b")
-                .replace(/[\n]/g, "\\n")
-                .replace(/[\t]/g, "\\t")
-                .replace(/[\r]/g, "\\r")
-                .replace(/[\u2028]/g, "\\u2028")
-                .replace(/[\u2029]/g, "\\u2029");
-        },
-
-        createXhr: masterConfig.createXhr || function () {
-            //Would love to dump the ActiveX crap in here. Need IE 6 to die first.
-            var xhr, i, progId;
-            if (typeof XMLHttpRequest !== "undefined") {
-                return new XMLHttpRequest();
-            } else if (typeof ActiveXObject !== "undefined") {
-                for (i = 0; i < 3; i += 1) {
-                    progId = progIds[i];
-                    try {
-                        xhr = new ActiveXObject(progId);
-                    } catch (e) {}
-
-                    if (xhr) {
-                        progIds = [progId];  // so faster next time
-                        break;
-                    }
-                }
-            }
-
-            return xhr;
-        },
-
-        /**
-         * Parses a resource name into its component parts. Resource names
-         * look like: module/name.ext!strip, where the !strip part is
-         * optional.
-         * @param {String} name the resource name
-         * @returns {Object} with properties "moduleName", "ext" and "strip"
-         * where strip is a boolean.
-         */
-        parseName: function (name) {
-            var strip = false, index = name.indexOf("."),
-                modName = name.substring(0, index),
-                ext = name.substring(index + 1, name.length);
-
-            index = ext.indexOf("!");
-            if (index !== -1) {
-                //Pull off the strip arg.
-                strip = ext.substring(index + 1, ext.length);
-                strip = strip === "strip";
-                ext = ext.substring(0, index);
-            }
-
-            return {
-                moduleName: modName,
-                ext: ext,
-                strip: strip
-            };
-        },
-
-        xdRegExp: /^((\w+)\:)?\/\/([^\/\\]+)/,
-
-        /**
-         * Is an URL on another domain. Only works for browser use, returns
-         * false in non-browser environments. Only used to know if an
-         * optimized .js version of a text resource should be loaded
-         * instead.
-         * @param {String} url
-         * @returns Boolean
-         */
-        useXhr: function (url, protocol, hostname, port) {
-            var uProtocol, uHostName, uPort,
-                match = text.xdRegExp.exec(url);
-            if (!match) {
-                return true;
-            }
-            uProtocol = match[2];
-            uHostName = match[3];
-
-            uHostName = uHostName.split(':');
-            uPort = uHostName[1];
-            uHostName = uHostName[0];
-
-            return (!uProtocol || uProtocol === protocol) &&
-                   (!uHostName || uHostName.toLowerCase() === hostname.toLowerCase()) &&
-                   ((!uPort && !uHostName) || uPort === port);
-        },
-
-        finishLoad: function (name, strip, content, onLoad) {
-            content = strip ? text.strip(content) : content;
-            if (masterConfig.isBuild) {
-                buildMap[name] = content;
-            }
-            onLoad(content);
-        },
-
-        load: function (name, req, onLoad, config) {
-            //Name has format: some.module.filext!strip
-            //The strip part is optional.
-            //if strip is present, then that means only get the string contents
-            //inside a body tag in an HTML string. For XML/SVG content it means
-            //removing the <?xml ...?> declarations so the content can be inserted
-            //into the current doc without problems.
-
-            // Do not bother with the work if a build and text will
-            // not be inlined.
-            if (config.isBuild && !config.inlineText) {
-                onLoad();
-                return;
-            }
-
-            masterConfig.isBuild = config.isBuild;
-
-            var parsed = text.parseName(name),
-                nonStripName = parsed.moduleName + '.' + parsed.ext,
-                url = req.toUrl(nonStripName),
-                useXhr = (masterConfig.useXhr) ||
-                         text.useXhr;
-
-            //Load the text. Use XHR if possible and in a browser.
-            if (!hasLocation || useXhr(url, defaultProtocol, defaultHostName, defaultPort)) {
-                text.get(url, function (content) {
-                    text.finishLoad(name, parsed.strip, content, onLoad);
-                }, function (err) {
-                    if (onLoad.error) {
-                        onLoad.error(err);
-                    }
-                });
-            } else {
-                //Need to fetch the resource across domains. Assume
-                //the resource has been optimized into a JS module. Fetch
-                //by the module name + extension, but do not include the
-                //!strip part to avoid file system issues.
-                req([nonStripName], function (content) {
-                    text.finishLoad(parsed.moduleName + '.' + parsed.ext,
-                                    parsed.strip, content, onLoad);
-                });
-            }
-        },
-
-        write: function (pluginName, moduleName, write, config) {
-            if (buildMap.hasOwnProperty(moduleName)) {
-                var content = text.jsEscape(buildMap[moduleName]);
-                write.asModule(pluginName + "!" + moduleName,
-                               "define(function () { return '" +
-                                   content +
-                               "';});\n");
-            }
-        },
-
-        writeFile: function (pluginName, moduleName, req, write, config) {
-            var parsed = text.parseName(moduleName),
-                nonStripName = parsed.moduleName + '.' + parsed.ext,
-                //Use a '.js' file name so that it indicates it is a
-                //script that can be loaded across domains.
-                fileName = req.toUrl(parsed.moduleName + '.' +
-                                     parsed.ext) + '.js';
-
-            //Leverage own load() method to load plugin value, but only
-            //write out values that do not have the strip argument,
-            //to avoid any potential issues with ! in file names.
-            text.load(nonStripName, req, function (value) {
-                //Use own write() method to construct full module value.
-                //But need to create shell that translates writeFile's
-                //write() to the right interface.
-                var textWrite = function (contents) {
-                    return write(fileName, contents);
-                };
-                textWrite.asModule = function (moduleName, contents) {
-                    return write.asModule(moduleName, fileName, contents);
-                };
-
-                text.write(pluginName, nonStripName, textWrite, config);
-            }, config);
-        }
-    };
-
-    if (masterConfig.env === 'node' || (!masterConfig.env &&
-            typeof process !== "undefined" &&
-            process.versions &&
-            !!process.versions.node)) {
-        //Using special require.nodeRequire, something added by r.js.
-        fs = require.nodeRequire('fs');
-
-        text.get = function (url, callback) {
-            var file = fs.readFileSync(url, 'utf8');
-            //Remove BOM (Byte Mark Order) from utf8 files if it is there.
-            if (file.indexOf('\uFEFF') === 0) {
-                file = file.substring(1);
-            }
-            callback(file);
-        };
-    } else if (masterConfig.env === 'xhr' || (!masterConfig.env &&
-            text.createXhr())) {
-        text.get = function (url, callback, errback) {
-            var xhr = text.createXhr();
-            xhr.open('GET', url, true);
-
-            //Allow overrides specified in config
-            if (masterConfig.onXhr) {
-                masterConfig.onXhr(xhr, url);
-            }
-
-            xhr.onreadystatechange = function (evt) {
-                var status, err;
-                //Do not explicitly handle errors, those should be
-                //visible via console output in the browser.
-                if (xhr.readyState === 4) {
-                    status = xhr.status;
-                    if (status > 399 && status < 600) {
-                        //An http 4xx or 5xx error. Signal an error.
-                        err = new Error(url + ' HTTP status: ' + status);
-                        err.xhr = xhr;
-                        errback(err);
-                    } else {
-                        callback(xhr.responseText);
-                    }
-                }
-            };
-            xhr.send(null);
-        };
-    } else if (masterConfig.env === 'rhino' || (!masterConfig.env &&
-            typeof Packages !== 'undefined' && typeof java !== 'undefined')) {
-        //Why Java, why is this so awkward?
-        text.get = function (url, callback) {
-            var stringBuffer, line,
-                encoding = "utf-8",
-                file = new java.io.File(url),
-                lineSeparator = java.lang.System.getProperty("line.separator"),
-                input = new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(file), encoding)),
-                content = '';
-            try {
-                stringBuffer = new java.lang.StringBuffer();
-                line = input.readLine();
-
-                // Byte Order Mark (BOM) - The Unicode Standard, version 3.0, page 324
-                // http://www.unicode.org/faq/utf_bom.html
-
-                // Note that when we use utf-8, the BOM should appear as "EF BB BF", but it doesn't due to this bug in the JDK:
-                // http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4508058
-                if (line && line.length() && line.charAt(0) === 0xfeff) {
-                    // Eat the BOM, since we've already found the encoding on this file,
-                    // and we plan to concatenating this buffer with others; the BOM should
-                    // only appear at the top of a file.
-                    line = line.substring(1);
-                }
-
-                stringBuffer.append(line);
-
-                while ((line = input.readLine()) !== null) {
-                    stringBuffer.append(lineSeparator);
-                    stringBuffer.append(line);
-                }
-                //Make sure we return a JavaScript string and not a Java string.
-                content = String(stringBuffer.toString()); //String
-            } finally {
-                input.close();
-            }
-            callback(content);
-        };
-    }
-
-    return text;
-});</div></li>
 <li>public/js/SocialNet.js<div>diff --git a/public/js/SocialNet.js b/public/js/SocialNet.js
index 923dfd9..91fb07e 100644
--- a/public/js/SocialNet.js
+++ b/public/js/SocialNet.js
@@ -5,10 +5,12 @@ define(['router', 'SocialNetSockets'], function(router, socket) {
     };
 
     var checkLogin = function(callback) {
-        $.get('/account/authenticated').done(function(data) {
+        $.get('/account/authenticated')
+        .done(function(data) {
             router.socketEvents.trigger('app:loggedin', data);
             return callback(true);
-        }).fail(function() {
+        })
+        .fail(function() {
             return callback(false);
         });
     };</div></li>
 <li>public/js/SocialNetSockets.js<div>diff --git a/public/js/SocialNetSockets.js b/public/js/SocialNetSockets.js
index be3f706..a5fcd99 100644
--- a/public/js/SocialNetSockets.js
+++ b/public/js/SocialNetSockets.js
@@ -16,7 +16,7 @@ function(sio, ContactCollection, ChatView) {
 
             socket.on('connect', function() {
                 console.log('socket.io:connect--from client');
-                eventDispatcher.bind('socket:chat', sendChat);
+                eventDispatcher.on('socket:chat', sendChat);
                 socket.on('chatserver', function(data) {
                     eventDispatcher.trigger('socket:chat:start:' + data.from);
                     eventDispatcher.trigger('socket:chat:in:' + data.from, data);
@@ -30,7 +30,7 @@ function(sio, ContactCollection, ChatView) {
                     collection: myContacts,
                     socketEvents: eventDispatcher
                 }).render();
-                myContacts.fetch();
+                myContacts.fetch({reset:true});
             });
         };
 
@@ -50,7 +50,7 @@ function(sio, ContactCollection, ChatView) {
             }
         };
 
-        eventDispatcher.bind('app:loggedin', connectSocket);
+        eventDispatcher.on('app:loggedin', connectSocket);
     };
 
     return {</div></li>
 <li>public/js/main.js<div>diff --git a/public/js/main.js b/public/js/main.js
index 227e5a7..42a0cb9 100644
--- a/public/js/main.js
+++ b/public/js/main.js
@@ -5,20 +5,18 @@ require.config({
         Backbone: '/components/backbone/backbone',
         Sockets: '/socket.io/socket.io',
         models: 'models',
-        text: '/components/text/text',
+        text: '/components/requirejs-text/text',
         bootstrap: '/components/bootstrap/docs/assets/js/bootstrap.min',
         templates: '../templates'
-        //jqmigrate: '/components/jquery/jquery-migrate'
     },
-
+    
     shim: {
-        'jqmigrate':['jQuery'],
         'Backbone': ['Underscore', 'jQuery'],
         'SocialNet': ['Backbone'],
         'bootstrap' : ['jQuery']
     }
 });
 
-require(['SocialNet', 'bootstrap' /*,'jqmigrate'*/], function(SocialNet) {    
+require(['SocialNet', 'bootstrap' ], function(SocialNet) {    
     SocialNet.initialize();
 });</div></li>
 <li>public/js/router.js<div>diff --git a/public/js/router.js b/public/js/router.js
index 337cfa3..ed1bd78 100644
--- a/public/js/router.js
+++ b/public/js/router.js
@@ -33,7 +33,7 @@ ContactCollection) {
                 collection: statusCollection,
                 socketEvents: this.socketEvents
             }));
-            statusCollection.fetch();
+            statusCollection.fetch({reset:true});
         },
 
         addcontact: function() {
@@ -66,15 +66,15 @@ ContactCollection) {
         },
 
         contacts: function(id) {
-            console.log(id + ' contacts route');
+            //console.log(id + ' contacts route');
             var contactId = id ? id : 'me';
             var contactCollection = new ContactCollection();
             contactCollection.url = '/accounts/' + contactId + '/contacts';
-            console.log(contactCollection.url);
+            //console.log(contactCollection.url);
             this.changeView(new ContactsView({
                 collection: contactCollection
             }));
-            contactCollection.fetch();
+            contactCollection.fetch({reset:true});
         }
     });
 </div></li>
 <li>public/js/views/addcontact.js<div>diff --git a/public/js/views/addcontact.js b/public/js/views/addcontact.js
index a7b22d5..d538534 100644
--- a/public/js/views/addcontact.js
+++ b/public/js/views/addcontact.js
@@ -10,26 +10,31 @@ function(SocialNetView, Contact, ContactView, addcontactTemplate) {
 
         search: function() {
             var view = this;
-            $.post('/contacts/find',
-            this.$('form').serialize(), function(data) {
+            // promise
+            var postFind = $.post('/contacts/find',this.$('form').serialize());
+            
+            postFind.done(function(data) {
                 //console.log(data);
                 view.render(data);
-            }).error(function() {
+            });
+            
+            postFind.fail(function() {
                 $("#results").text('No contacts found.');
                 $("#results").slideDown();
             });
             return false;
         },
 
+        // collectionview
         render: function(resultList) {
-            var view = this;
+            //var view = this;
             this.$el.html(_.template(addcontactTemplate));
             if (null !== resultList) {
                 _.each(resultList, function(contactJson) {
-                    console.log(contactJson);
+                    //console.log(contactJson);
 
                     var contactModel = new Contact(contactJson);
-                    console.dir(contactModel);
+                    //console.dir(contactModel);
 
                     var contactHtml = (new ContactView({
                         addButton: true,</div></li>
 <li>public/js/views/chat.js<div>diff --git a/public/js/views/chat.js b/public/js/views/chat.js
index de04a1c..52bf3ed 100644
--- a/public/js/views/chat.js
+++ b/public/js/views/chat.js
@@ -35,7 +35,7 @@ function(SocialNetView, ChatSessionView, ChatItemView, chatItemTemplate) {
                     socketEvents: that.socketEvents,
                     model: contact
                 });
-                chatItemView.bind('chat:start', that.startChatSession, that);
+                chatItemView.on('chat:start', that.startChatSession, that);
                 var statusHtml = (chatItemView).render().el;
                 $(statusHtml).appendTo('.chat_list');
             });</div></li>
 <li>public/js/views/chatitem.js<div>diff --git a/public/js/views/chatitem.js b/public/js/views/chatitem.js
index 342c361..17dac4c 100644
--- a/public/js/views/chatitem.js
+++ b/public/js/views/chatitem.js
@@ -12,13 +12,13 @@ function(SocialNetView, chatItemTemplate) {
 
         initialize: function(options) {
             var accountId = this.model.get('accountId');
-            options.socketEvents.bind('login:' + accountId,
+            options.socketEvents.on('login:' + accountId,
             this.handleContactLogin,
             this);
-            options.socketEvents.bind('logout:' + accountId,
+            options.socketEvents.on('logout:' + accountId,
             this.handleContactLogout,
             this);
-            options.socketEvents.bind('socket:chat:start:' + accountId,
+            options.socketEvents.on('socket:chat:start:' + accountId,
             this.startChatSession,
             this);
         },
@@ -30,7 +30,7 @@ function(SocialNetView, chatItemTemplate) {
 
         handleContactLogout: function() {
             this.model.set('online', false);
-            var  $onlineIndicator = this.$el.find('.online_indicator');
+            var $onlineIndicator = this.$el.find('.online_indicator');
             while ($onlineIndicator.hasClass('online')) {
                 $onlineIndicator.removeClass('online');
             }</div></li>
 <li>public/js/views/chatsession.js<div>diff --git a/public/js/views/chatsession.js b/public/js/views/chatsession.js
index 613cfe8..41dfa45 100644
--- a/public/js/views/chatsession.js
+++ b/public/js/views/chatsession.js
@@ -16,10 +16,10 @@ function(SocialNetView, chatItemTemplate) {
             this.socketEvents = options.socketEvents;
             var accountId = this.model.get('accountId');
             this.socketEvents.on('socket:chat:in:' + accountId, this.receiveChat, this);
-            this.socketEvents.bind('login:' + accountId,
+            this.socketEvents.on('login:' + accountId,
             this.handleContactLogin,
             this);
-            this.socketEvents.bind('logout:' + accountId,
+            this.socketEvents.on('logout:' + accountId,
             this.handleContactLogout,
             this);
         },</div></li>
 <li>public/js/views/contact.js<div>diff --git a/public/js/views/contact.js b/public/js/views/contact.js
index 762af7b..6a8d368 100644
--- a/public/js/views/contact.js
+++ b/public/js/views/contact.js
@@ -16,8 +16,8 @@ define(['SocialNetView', 'text!templates/contact.html'], function(SocialNetView,
             var posted = $.post('/accounts/me/contact', {
                 contactId: this.model.get('_id')
             });
-            posted.done(function() {
-                //console.log('addContact->Success');
+            posted.done(function(data) {
+                console.log('addContact->Success' + data);
                 $responseArea.text('Contact Added: ' + that.model.get('name').first);
             });
             posted.fail(function() {
@@ -28,15 +28,19 @@ define(['SocialNetView', 'text!templates/contact.html'], function(SocialNetView,
         removeContact: function() {
             var $responseArea = this.$('.actionarea');
             $responseArea.text('Removing contact...');
-            $.ajax({
+            var ajax = $.ajax({
                 url: '/accounts/me/contact',
                 type: 'DELETE',
                 data: {
                     contactId: this.model.get('accountId')
                 }
-            }).done(function() {
+            });
+            
+            ajax.done(function() {
                 $responseArea.text('Contact Removed');
-            }).fail(function() {
+            });
+            
+            ajax.fail(function() {
                 $responseArea.text('Could not remove contact');
             });
         },</div></li>
 <li>public/js/views/forgotpassword.js<div>diff --git a/public/js/views/forgotpassword.js b/public/js/views/forgotpassword.js
index df6eb01..74bdd3e 100644
--- a/public/js/views/forgotpassword.js
+++ b/public/js/views/forgotpassword.js
@@ -9,14 +9,15 @@ define(['SocialNetView', 'text!templates/forgotpassword.html'], function(SocialN
         },
 
         password: function() {
-            $.post('/forgotpassword', {
-                email: $('input[name=email]').val()
-            }, function(data) {
+            var post = $.post('/forgotpassword', {email: $('input[name=email]').val()});
+            
+            post.done(function(data) {
                 console.log(data);
             });
+            
             return false;
         },
-
+        
         render: function() {
             this.$el.html(forgotpasswordTemplate);
         }</div></li>
 <li>public/js/views/index.js<div>diff --git a/public/js/views/index.js b/public/js/views/index.js
index 0abcd4d..98dc906 100644
--- a/public/js/views/index.js
+++ b/public/js/views/index.js
@@ -9,7 +9,7 @@ function(SocialNetView, indexTemplate, StatusView, Status) {
         },
 
         initialize: function(options) {
-            options.socketEvents.bind('status:me', this.onSocketStatusAdded, this);
+            options.socketEvents.on('status:me', this.onSocketStatusAdded, this);
             this.collection.on('add', this.onStatusAdded, this);
             this.collection.on('reset', this.onStatusCollectionReset, this);
         },
@@ -34,7 +34,7 @@ function(SocialNetView, indexTemplate, StatusView, Status) {
                 this.collection.add(new Status({
                     status: newStatus.status,
                     name: newStatus.name
-                }))
+                }));
             }
         },
 
@@ -47,7 +47,7 @@ function(SocialNetView, indexTemplate, StatusView, Status) {
 
         updateStatus: function() {
             var statusText = $('input[name=status]').val();
-            var statusCollection = this.collection;
+            //var statusCollection = this.collection;
             $.post('/accounts/me/status', {
                 status: statusText
             }).done(function(data) {console.log(data)}); // New: no longer adding to screen</div></li>
 <li>public/js/views/profile.js<div>diff --git a/public/js/views/profile.js b/public/js/views/profile.js
index 1d9746f..5133633 100644
--- a/public/js/views/profile.js
+++ b/public/js/views/profile.js
@@ -1,7 +1,6 @@
 define(['SocialNetView', 'text!templates/profile.html', 'text!templates/status.html', 'models/Status', 'views/status'],
 
-function(SocialNetView, profileTemplate,
-statusTemplate, Status, StatusView) {
+function(SocialNetView, profileTemplate, statusTemplate, Status, StatusView) {
     var profileView = SocialNetView.extend({
         el: $('#content'),
 
@@ -11,7 +10,7 @@ statusTemplate, Status, StatusView) {
 
         initialize: function(options) {
             this.socketEvents = options.socketEvents;
-            this.model.bind('change', this.render, this);
+            this.model.on('change', this.render, this);
         },
 
         postStatus: function() {
@@ -29,7 +28,7 @@ statusTemplate, Status, StatusView) {
             this.prependStatus(new Status({
                 status: newStatus.status,
                 name: newStatus.name
-            }))
+            }));
         },
 
         prependStatus: function(statusModel) {
@@ -41,8 +40,9 @@ statusTemplate, Status, StatusView) {
 
         render: function() {
             if (this.model.get('_id')) {
-                this.socketEvents.bind('status:' + this.model.get('_id'), this.onSocketStatusAdded, this);
+                this.socketEvents.on('status:' + this.model.get('_id'), this.onSocketStatusAdded, this);
             }
+
             var that = this;
             this.$el.html(
             _.template(profileTemplate, this.model.toJSON()));</div></li>
 <li>public/js/views/register.js<div>diff --git a/public/js/views/register.js b/public/js/views/register.js
index b55d852..8a0af9f 100644
--- a/public/js/views/register.js
+++ b/public/js/views/register.js
@@ -9,17 +9,22 @@ define(['SocialNetView', 'text!templates/register.html'], function(SocialNetView
         },
 
         register: function() {
-            $.post('/register', {
+           var post= $.post('/register', {
                 firstName: $('input[name=firstName]').val(),
                 lastName: $('input[name=lastName]').val(),
                 email: $('input[name=email]').val(),
                 password: $('input[name=password]').val(),
-            }).done(function(data) {
+            });
+            
+            post.done(function(data) {
                 console.log('register:success');
                 window.location.hash = 'login';
-            }).fail(function(data) {
+            });
+            
+            post.fail(function(data) {
                 console.log('register:failcode: '+data);
             });
+
             return false;
         },
 </div></li>
 </ul><br/></div>
 </div>
 <div class=row>
 <div class=span12><p>committ stats</p></div>
 </div>
 </div>
 </div>
 <div class='row'>
 <div class='span12'>
 <h4><span class=text-info>Revision-Subject: updates: .gitignore  layout.jade and gitlog.sh changelog generation</span></h4>
 <div class=row>
 <div class=span6><strong>Author: Ted Killilea</strong></div><div class=span6><strong>Email: lrrs259@gmail.com</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Date: Wed Mar 13 17:08:27 2013 -0400</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Description: </strong></div>
 </div>
 <div class=row>
 <div class=span12><p>STATISTICS</p></div>
 </div>
 <div class=row>
<div class=span12>
<strong>List of modified files:</strong>
<ul class=unstyled>
 <li>gitlog.sh<div></div></li>
 <li>public/changelog.html<div></div></li>
 </ul><br/></div>
 </div>
 <div class=row>
 <div class=span12><p>committ stats</p></div>
 </div>
 </div>
 </div>
 <div class='row'>
 <div class='span12'>
 <h4><span class=text-info>Revision-Subject: updates: .gitignore  layout.jade and gitlog.sh changelog generation</span></h4>
 <div class=row>
 <div class=span6><strong>Author: Ted Killilea</strong></div><div class=span6><strong>Email: lrrs259@gmail.com</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Date: Wed Mar 13 17:07:51 2013 -0400</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Description: </strong></div>
 </div>
 <div class=row>
 <div class=span12><p>STATISTICS</p></div>
 </div>
 <div class=row>
<div class=span12>
<strong>List of modified files:</strong>
<ul class=unstyled>
 <li>.c9revisions/.gitignore.c9save<div></div></li>
 <li>.c9revisions/views/layout.jade.c9save<div></div></li>
 <li>.gitignore<div></div></li>
 <li>views/layout.jade<div></div></li>
 </ul><br/></div>
 </div>
 <div class=row>
 <div class=span12><p>committ stats</p></div>
 </div>
 </div>
 </div>
 <div class='row'>
 <div class='span12'>
 <h4><span class=text-info>Revision-Subject: cleanup</span></h4>
 <div class=row>
 <div class=span6><strong>Author: Ted Killilea</strong></div><div class=span6><strong>Email: lrrs259@gmail.com</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Date: Sat Mar 9 11:03:00 2013 -0500</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Description: </strong></div>
 </div>
 <div class=row>
 <div class=span12><p>STATISTICS</p></div>
 </div>
 <div class=row>
<div class=span12>
<strong>List of modified files:</strong>
<ul class=unstyled>
 <li>.gitignore<div></div></li>
 </ul><br/></div>
 </div>
 <div class=row>
 <div class=span12><p>committ stats</p></div>
 </div>
 </div>
 </div>
 <div class='row'>
 <div class='span12'>
 <h4><span class=text-info>Revision-Subject: tweak bootstrap templates</span></h4>
 <div class=row>
 <div class=span6><strong>Author: Ted Killilea</strong></div><div class=span6><strong>Email: lrrs259@gmail.com</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Date: Thu Mar 7 16:26:19 2013 -0500</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Description: </strong></div>
 </div>
 <div class=row>
 <div class=span12><p>STATISTICS</p></div>
 </div>
 <div class=row>
<div class=span12>
<strong>List of modified files:</strong>
<ul class=unstyled>
 <li>.c9revisions/config/mail.js.c9save<div></div></li>
 <li>.c9revisions/public/templates/addcontact.html.c9save<div></div></li>
 <li>.c9revisions/public/templates/contact.html.c9save<div></div></li>
 <li>.c9revisions/public/templates/contacts.html.c9save<div></div></li>
 <li>.c9revisions/public/templates/index.html.c9save<div></div></li>
 <li>.c9revisions/public/templates/profile.html.c9save<div></div></li>
 <li>.c9revisions/public/templates/register.html.c9save<div></div></li>
 <li>.c9revisions/public/templates/status.html.c9save<div></div></li>
 <li>.c9revisions/views/index.jade.c9save<div></div></li>
 <li>public/templates/addcontact.html<div></div></li>
 <li>public/templates/contact.html<div></div></li>
 <li>public/templates/contacts.html<div></div></li>
 <li>public/templates/index.html<div></div></li>
 <li>public/templates/profile.html<div></div></li>
 <li>public/templates/status.html<div></div></li>
 </ul><br/></div>
 </div>
 <div class=row>
 <div class=span12><p>committ stats</p></div>
 </div>
 </div>
 </div>
 <div class='row'>
 <div class='span12'>
 <h4><span class=text-info>Revision-Subject: integrate bootstrap 2.3.1</span></h4>
 <div class=row>
 <div class=span6><strong>Author: Ted Killilea</strong></div><div class=span6><strong>Email: lrrs259@gmail.com</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Date: Wed Mar 6 07:51:46 2013 -0500</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Description: </strong></div>
 </div>
 <div class=row>
 <div class=span12><p>STATISTICS</p></div>
 </div>
 <div class=row>
<div class=span12>
<strong>List of modified files:</strong>
<ul class=unstyled>
 <li>.c9revisions/component.json.c9save<div></div></li>
 <li>.c9revisions/public/components/backbone/component.json.c9save<div></div></li>
 <li>.c9revisions/public/components/bootstrap/component.json.c9save<div></div></li>
 <li>.c9revisions/public/components/bootstrap/docs/assets/css/bootstrap.css.c9save<div></div></li>
 <li>.c9revisions/public/components/bootstrap/docs/components.html.c9save<div></div></li>
 <li>.c9revisions/public/components/jquery/component.json.c9save<div></div></li>
 <li>.c9revisions/public/components/requirejs/component.json.c9save<div></div></li>
 <li>.c9revisions/public/holder.js.c9save<div></div></li>
 <li>.c9revisions/public/js/libs/backbone.js.c9save<div></div></li>
 <li>.c9revisions/public/js/libs/jquery.js.c9save<div></div></li>
 <li>.c9revisions/public/js/main.js.c9save<div></div></li>
 <li>.c9revisions/public/styles/bootstrap.css.c9save<div></div></li>
 <li>.c9revisions/public/styles/styles.1.css.c9save<div></div></li>
 <li>.c9revisions/public/styles/styles.css.c9save<div></div></li>
 <li>.c9revisions/public/templates/contact.html.c9save<div></div></li>
 <li>.c9revisions/public/templates/contacts.html.c9save<div></div></li>
 <li>.c9revisions/public/templates/index.html.c9save<div></div></li>
 <li>.c9revisions/public/templates/login.html.c9save<div></div></li>
 <li>.c9revisions/public/templates/profile.html.c9save<div></div></li>
 <li>.c9revisions/public/templates/status.html.c9save<div></div></li>
 <li>.c9revisions/snippets/account_contact.js.c9save<div></div></li>
 <li>.c9revisions/views/index.jade.c9save<div></div></li>
 <li>.c9revisions/views/layout.jade.c9save<div></div></li>
 <li>component.json<div></div></li>
 <li>public/components/bootstrap/CHANGELOG.md<div></div></li>
 <li>public/components/bootstrap/Makefile<div></div></li>
 <li>public/components/bootstrap/README.md<div></div></li>
 <li>public/components/bootstrap/component.json<div></div></li>
 <li>public/components/bootstrap/composer.json<div></div></li>
 <li>public/components/bootstrap/docs/assets/css/bootstrap-responsive.css<div></div></li>
 <li>public/components/bootstrap/docs/assets/css/bootstrap.css<div></div></li>
 <li>public/components/bootstrap/docs/assets/css/docs.css<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/bootstrap-docs-readme.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-carousel.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-fluid.jpg<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-fluid.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-hero.jpg<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-justified-nav.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-marketing-narrow.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-marketing.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-signin.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-starter.jpg<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-starter.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-sticky-footer.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/application.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-affix.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-alert.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-button.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-carousel.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-collapse.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-dropdown.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-modal.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-popover.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-scrollspy.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-tab.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-tooltip.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-transition.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-typeahead.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap.min.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/holder/holder.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/html5shiv.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/jquery.js<div></div></li>
 <li>public/components/bootstrap/docs/base-css.html<div></div></li>
 <li>public/components/bootstrap/docs/components.html<div></div></li>
 <li>public/components/bootstrap/docs/customize.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/carousel.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/fluid.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/hero.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/justified-nav.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/marketing-alternate.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/marketing-narrow.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/signin.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/starter-template.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/sticky-footer-navbar.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/sticky-footer.html<div></div></li>
 <li>public/components/bootstrap/docs/extend.html<div></div></li>
 <li>public/components/bootstrap/docs/getting-started.html<div></div></li>
 <li>public/components/bootstrap/docs/index.html<div></div></li>
 <li>public/components/bootstrap/docs/javascript.html<div></div></li>
 <li>public/components/bootstrap/docs/scaffolding.html<div></div></li>
 <li>public/components/bootstrap/docs/templates/layout.mustache<div></div></li>
 <li>public/components/bootstrap/docs/templates/pages/base-css.mustache<div></div></li>
 <li>public/components/bootstrap/docs/templates/pages/components.mustache<div></div></li>
 <li>public/components/bootstrap/docs/templates/pages/extend.mustache<div></div></li>
 <li>public/components/bootstrap/docs/templates/pages/getting-started.mustache<div></div></li>
 <li>public/components/bootstrap/docs/templates/pages/index.mustache<div></div></li>
 <li>public/components/bootstrap/docs/templates/pages/javascript.mustache<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-affix.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-alert.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-button.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-carousel.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-collapse.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-dropdown.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-modal.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-popover.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-scrollspy.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-tab.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-tooltip.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-transition.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-typeahead.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-carousel.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-modal.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-tooltip.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-typeahead.js<div></div></li>
 <li>public/components/bootstrap/js/tests/vendor/jquery.js<div></div></li>
 <li>public/components/bootstrap/less/bootstrap.less<div></div></li>
 <li>public/components/bootstrap/less/button-groups.less<div></div></li>
 <li>public/components/bootstrap/less/buttons.less<div></div></li>
 <li>public/components/bootstrap/less/carousel.less<div></div></li>
 <li>public/components/bootstrap/less/close.less<div></div></li>
 <li>public/components/bootstrap/less/dropdowns.less<div></div></li>
 <li>public/components/bootstrap/less/forms.less<div></div></li>
 <li>public/components/bootstrap/less/labels-badges.less<div></div></li>
 <li>public/components/bootstrap/less/media.less<div></div></li>
 <li>public/components/bootstrap/less/mixins.less<div></div></li>
 <li>public/components/bootstrap/less/navbar.less<div></div></li>
 <li>public/components/bootstrap/less/navs.less<div></div></li>
 <li>public/components/bootstrap/less/pager.less<div></div></li>
 <li>public/components/bootstrap/less/pagination.less<div></div></li>
 <li>public/components/bootstrap/less/popovers.less<div></div></li>
 <li>public/components/bootstrap/less/reset.less<div></div></li>
 <li>public/components/bootstrap/less/responsive-767px-max.less<div></div></li>
 <li>public/components/bootstrap/less/responsive-navbar.less<div></div></li>
 <li>public/components/bootstrap/less/responsive-utilities.less<div></div></li>
 <li>public/components/bootstrap/less/responsive.less<div></div></li>
 <li>public/components/bootstrap/less/scaffolding.less<div></div></li>
 <li>public/components/bootstrap/less/sprites.less<div></div></li>
 <li>public/components/bootstrap/less/tables.less<div></div></li>
 <li>public/components/bootstrap/less/tests/css-tests.css<div></div></li>
 <li>public/components/bootstrap/less/tests/css-tests.html<div></div></li>
 <li>public/components/bootstrap/less/thumbnails.less<div></div></li>
 <li>public/components/bootstrap/less/tooltip.less<div></div></li>
 <li>public/components/bootstrap/less/type.less<div></div></li>
 <li>public/components/bootstrap/less/variables.less<div></div></li>
 <li>public/components/bootstrap/package.json<div></div></li>
 <li>public/components/jquery/component.json<div></div></li>
 <li>public/components/jquery/composer.json<div></div></li>
 <li>public/components/jquery/jquery-migrate.js<div></div></li>
 <li>public/components/jquery/jquery-migrate.min.js<div></div></li>
 <li>public/components/jquery/jquery.js<div></div></li>
 <li>public/components/jquery/jquery.min.js<div></div></li>
 <li>public/components/underscore/.gitignore<div></div></li>
 <li>public/components/underscore/.npmignore<div></div></li>
 <li>public/components/underscore/.travis.yml<div></div></li>
 <li>public/components/underscore/CONTRIBUTING.md<div></div></li>
 <li>public/components/underscore/LICENSE<div></div></li>
 <li>public/components/underscore/Rakefile<div></div></li>
 <li>public/components/underscore/component.json<div></div></li>
 <li>public/components/underscore/docs/images/underscore.png<div></div></li>
 <li>public/components/underscore/docs/underscore.html<div></div></li>
 <li>public/components/underscore/index.html<div></div></li>
 <li>public/components/underscore/package.json<div></div></li>
 <li>public/components/underscore/test/arrays.js<div></div></li>
 <li>public/components/underscore/test/collections.js<div></div></li>
 <li>public/components/underscore/test/functions.js<div></div></li>
 <li>public/components/underscore/test/index.html<div></div></li>
 <li>public/components/underscore/test/objects.js<div></div></li>
 <li>public/components/underscore/test/utility.js<div></div></li>
 <li>public/components/underscore/test/vendor/runner.js<div></div></li>
 <li>public/components/underscore/underscore-min.js<div></div></li>
 <li>public/components/underscore/underscore.js<div></div></li>
 <li>public/holder.js<div></div></li>
 <li>public/js/libs/backbone.js<div></div></li>
 <li>public/js/libs/jquery.js<div></div></li>
 <li>public/js/libs/require.js<div></div></li>
 <li>public/js/libs/text.js<div></div></li>
 <li>public/js/libs/underscore.js<div></div></li>
 <li>public/js/main.js<div></div></li>
 <li>public/styles/bootstrap.css<div></div></li>
 <li>public/styles/styles.1.css<div></div></li>
 <li>public/styles/styles.css<div></div></li>
 <li>public/templates/addcontact.html<div></div></li>
 <li>public/templates/contact.html<div></div></li>
 <li>public/templates/contacts.html<div></div></li>
 <li>public/templates/index.html<div></div></li>
 <li>public/templates/login.html<div></div></li>
 <li>public/templates/profile.html<div></div></li>
 <li>public/templates/status.html<div></div></li>
 <li>views/index.jade<div></div></li>
 <li>views/layout.jade<div></div></li>
 <li>views/resetPassword.jade<div></div></li>
 <li>views/resetPasswordSuccess.jade<div></div></li>
 </ul><br/></div>
 </div>
 <div class=row>
 <div class=span12><p>committ stats</p></div>
 </div>
 </div>
 </div>
 <div class='row'>
 <div class='span12'>
 <h4><span class=text-info>Revision-Subject: style with bootstrap</span></h4>
 <div class=row>
 <div class=span6><strong>Author: Ted Killilea</strong></div><div class=span6><strong>Email: lrrs259@gmail.com</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Date: Sun Jan 20 10:51:03 2013 -0500</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Description: </strong></div>
 </div>
 <div class=row>
 <div class=span12><p>STATISTICS</p></div>
 </div>
 <div class=row>
<div class=span12>
<strong>List of modified files:</strong>
<ul class=unstyled>
 <li>.c9revisions/public/styles/styles.1.css.c9save<div></div></li>
 <li>.c9revisions/public/styles/styles.css.c9save<div></div></li>
 <li>.c9revisions/public/templates/login.html.c9save<div></div></li>
 <li>.c9revisions/views/index.jade.c9save<div></div></li>
 <li>.c9revisions/views/layout.jade.c9save<div></div></li>
 <li>component.json<div></div></li>
 <li>public/components/bootstrap/.gitignore<div></div></li>
 <li>public/components/bootstrap/.travis.yml<div></div></li>
 <li>public/components/bootstrap/CONTRIBUTING.md<div></div></li>
 <li>public/components/bootstrap/LICENSE<div></div></li>
 <li>public/components/bootstrap/Makefile<div></div></li>
 <li>public/components/bootstrap/README.md<div></div></li>
 <li>public/components/bootstrap/component.json<div></div></li>
 <li>public/components/bootstrap/composer.json<div></div></li>
 <li>public/components/bootstrap/docs/assets/css/bootstrap-responsive.css<div></div></li>
 <li>public/components/bootstrap/docs/assets/css/bootstrap.css<div></div></li>
 <li>public/components/bootstrap/docs/assets/css/docs.css<div></div></li>
 <li>public/components/bootstrap/docs/assets/ico/apple-touch-icon-114-precomposed.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/ico/apple-touch-icon-144-precomposed.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/ico/apple-touch-icon-57-precomposed.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/ico/apple-touch-icon-72-precomposed.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/ico/favicon.ico<div></div></li>
 <li>public/components/bootstrap/docs/assets/ico/favicon.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/bootstrap-mdo-sfmoma-01.jpg<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/bootstrap-mdo-sfmoma-02.jpg<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/bootstrap-mdo-sfmoma-03.jpg<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/bs-docs-bootstrap-features.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/bs-docs-masthead-pattern.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/bs-docs-responsive-illustrations.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/bs-docs-twitter-github.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/example-sites/8020select.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/example-sites/adoptahydrant.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/example-sites/breakingnews.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/example-sites/fleetio.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/example-sites/gathercontent.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/example-sites/jshint.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/example-sites/kippt.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/example-sites/soundready.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-carousel.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-fluid.jpg<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-hero.jpg<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-marketing-narrow.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-signin.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-starter.jpg<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/bootstrap-example-sticky-footer.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/browser-icon-chrome.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/browser-icon-firefox.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/browser-icon-safari.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/slide-01.jpg<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/slide-02.jpg<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/examples/slide-03.jpg<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/glyphicons-halflings-white.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/glyphicons-halflings.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/grid-baseline-20px.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/less-logo-large.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/img/responsive-illustrations.png<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/README.md<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/application.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-affix.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-alert.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-button.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-carousel.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-collapse.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-dropdown.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-modal.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-popover.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-scrollspy.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-tab.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-tooltip.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-transition.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap-typeahead.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/bootstrap.min.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/google-code-prettify/prettify.css<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/google-code-prettify/prettify.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/holder/holder.js<div></div></li>
 <li>public/components/bootstrap/docs/assets/js/jquery.js<div></div></li>
 <li>public/components/bootstrap/docs/base-css.html<div></div></li>
 <li>public/components/bootstrap/docs/build/index.js<div></div></li>
 <li>public/components/bootstrap/docs/build/package.json<div></div></li>
 <li>public/components/bootstrap/docs/components.html<div></div></li>
 <li>public/components/bootstrap/docs/customize.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/carousel.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/fluid.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/hero.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/marketing-alternate.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/marketing-narrow.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/signin.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/starter-template.html<div></div></li>
 <li>public/components/bootstrap/docs/examples/sticky-footer.html<div></div></li>
 <li>public/components/bootstrap/docs/extend.html<div></div></li>
 <li>public/components/bootstrap/docs/getting-started.html<div></div></li>
 <li>public/components/bootstrap/docs/index.html<div></div></li>
 <li>public/components/bootstrap/docs/javascript.html<div></div></li>
 <li>public/components/bootstrap/docs/scaffolding.html<div></div></li>
 <li>public/components/bootstrap/docs/templates/layout.mustache<div></div></li>
 <li>public/components/bootstrap/docs/templates/pages/base-css.mustache<div></div></li>
 <li>public/components/bootstrap/docs/templates/pages/components.mustache<div></div></li>
 <li>public/components/bootstrap/docs/templates/pages/customize.mustache<div></div></li>
 <li>public/components/bootstrap/docs/templates/pages/extend.mustache<div></div></li>
 <li>public/components/bootstrap/docs/templates/pages/getting-started.mustache<div></div></li>
 <li>public/components/bootstrap/docs/templates/pages/index.mustache<div></div></li>
 <li>public/components/bootstrap/docs/templates/pages/javascript.mustache<div></div></li>
 <li>public/components/bootstrap/docs/templates/pages/scaffolding.mustache<div></div></li>
 <li>public/components/bootstrap/img/glyphicons-halflings-white.png<div></div></li>
 <li>public/components/bootstrap/img/glyphicons-halflings.png<div></div></li>
 <li>public/components/bootstrap/js/.jshintrc<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-affix.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-alert.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-button.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-carousel.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-collapse.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-dropdown.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-modal.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-popover.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-scrollspy.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-tab.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-tooltip.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-transition.js<div></div></li>
 <li>public/components/bootstrap/js/bootstrap-typeahead.js<div></div></li>
 <li>public/components/bootstrap/js/tests/index.html<div></div></li>
 <li>public/components/bootstrap/js/tests/phantom.js<div></div></li>
 <li>public/components/bootstrap/js/tests/server.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-affix.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-alert.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-button.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-carousel.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-collapse.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-dropdown.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-modal.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-phantom.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-popover.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-scrollspy.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-tab.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-tooltip.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-transition.js<div></div></li>
 <li>public/components/bootstrap/js/tests/unit/bootstrap-typeahead.js<div></div></li>
 <li>public/components/bootstrap/js/tests/vendor/jquery.js<div></div></li>
 <li>public/components/bootstrap/js/tests/vendor/qunit.css<div></div></li>
 <li>public/components/bootstrap/js/tests/vendor/qunit.js<div></div></li>
 <li>public/components/bootstrap/less/accordion.less<div></div></li>
 <li>public/components/bootstrap/less/alerts.less<div></div></li>
 <li>public/components/bootstrap/less/bootstrap.less<div></div></li>
 <li>public/components/bootstrap/less/breadcrumbs.less<div></div></li>
 <li>public/components/bootstrap/less/button-groups.less<div></div></li>
 <li>public/components/bootstrap/less/buttons.less<div></div></li>
 <li>public/components/bootstrap/less/carousel.less<div></div></li>
 <li>public/components/bootstrap/less/close.less<div></div></li>
 <li>public/components/bootstrap/less/code.less<div></div></li>
 <li>public/components/bootstrap/less/component-animations.less<div></div></li>
 <li>public/components/bootstrap/less/dropdowns.less<div></div></li>
 <li>public/components/bootstrap/less/forms.less<div></div></li>
 <li>public/components/bootstrap/less/grid.less<div></div></li>
 <li>public/components/bootstrap/less/hero-unit.less<div></div></li>
 <li>public/components/bootstrap/less/labels-badges.less<div></div></li>
 <li>public/components/bootstrap/less/layouts.less<div></div></li>
 <li>public/components/bootstrap/less/media.less<div></div></li>
 <li>public/components/bootstrap/less/mixins.less<div></div></li>
 <li>public/components/bootstrap/less/modals.less<div></div></li>
 <li>public/components/bootstrap/less/navbar.less<div></div></li>
 <li>public/components/bootstrap/less/navs.less<div></div></li>
 <li>public/components/bootstrap/less/pager.less<div></div></li>
 <li>public/components/bootstrap/less/pagination.less<div></div></li>
 <li>public/components/bootstrap/less/popovers.less<div></div></li>
 <li>public/components/bootstrap/less/progress-bars.less<div></div></li>
 <li>public/components/bootstrap/less/reset.less<div></div></li>
 <li>public/components/bootstrap/less/responsive-1200px-min.less<div></div></li>
 <li>public/components/bootstrap/less/responsive-767px-max.less<div></div></li>
 <li>public/components/bootstrap/less/responsive-768px-979px.less<div></div></li>
 <li>public/components/bootstrap/less/responsive-navbar.less<div></div></li>
 <li>public/components/bootstrap/less/responsive-utilities.less<div></div></li>
 <li>public/components/bootstrap/less/responsive.less<div></div></li>
 <li>public/components/bootstrap/less/scaffolding.less<div></div></li>
 <li>public/components/bootstrap/less/sprites.less<div></div></li>
 <li>public/components/bootstrap/less/tables.less<div></div></li>
 <li>public/components/bootstrap/less/tests/buttons.html<div></div></li>
 <li>public/components/bootstrap/less/tests/css-tests.css<div></div></li>
 <li>public/components/bootstrap/less/tests/css-tests.html<div></div></li>
 <li>public/components/bootstrap/less/tests/forms-responsive.html<div></div></li>
 <li>public/components/bootstrap/less/tests/forms.html<div></div></li>
 <li>public/components/bootstrap/less/tests/navbar-fixed-top.html<div></div></li>
 <li>public/components/bootstrap/less/tests/navbar-static-top.html<div></div></li>
 <li>public/components/bootstrap/less/tests/navbar.html<div></div></li>
 <li>public/components/bootstrap/less/thumbnails.less<div></div></li>
 <li>public/components/bootstrap/less/tooltip.less<div></div></li>
 <li>public/components/bootstrap/less/type.less<div></div></li>
 <li>public/components/bootstrap/less/utilities.less<div></div></li>
 <li>public/components/bootstrap/less/variables.less<div></div></li>
 <li>public/components/bootstrap/less/wells.less<div></div></li>
 <li>public/components/bootstrap/package.json<div></div></li>
 <li>public/styles/styles.1.css<div></div></li>
 <li>public/templates/login.html<div></div></li>
 <li>views/index.jade<div></div></li>
 <li>views/layout.jade<div></div></li>
 </ul><br/></div>
 </div>
 <div class=row>
 <div class=span12><p>committ stats</p></div>
 </div>
 </div>
 </div>
 <div class='row'>
 <div class='span12'>
 <h4><span class=text-info>Revision-Subject: update components and readme</span></h4>
 <div class=row>
 <div class=span6><strong>Author: Ted Killilea</strong></div><div class=span6><strong>Email: lrrs259@gmail.com</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Date: Fri Jan 18 12:52:00 2013 -0500</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Description: </strong></div>
 </div>
 <div class=row>
 <div class=span12><p>STATISTICS</p></div>
 </div>
 <div class=row>
<div class=span12>
<strong>List of modified files:</strong>
<ul class=unstyled>
 <li>.c9revisions/README.md.c9save<div></div></li>
 <li>README.md<div></div></li>
 </ul><br/></div>
 </div>
 <div class=row>
 <div class=span12><p>committ stats</p></div>
 </div>
 </div>
 </div>
 <div class='row'>
 <div class='span12'>
 <h4><span class=text-info>Revision-Subject: update components and readme</span></h4>
 <div class=row>
 <div class=span6><strong>Author: Ted Killilea</strong></div><div class=span6><strong>Email: lrrs259@gmail.com</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Date: Fri Jan 18 12:49:25 2013 -0500</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Description: </strong></div>
 </div>
 <div class=row>
 <div class=span12><p>STATISTICS</p></div>
 </div>
 <div class=row>
<div class=span12>
<strong>List of modified files:</strong>
<ul class=unstyled>
 <li>.c9revisions/README.md.c9save<div></div></li>
 <li>README.md<div></div></li>
 <li>public/components/backbone/.npmignore<div></div></li>
 <li>public/components/backbone/CNAME<div></div></li>
 <li>public/components/backbone/CONTRIBUTING.md<div></div></li>
 <li>public/components/backbone/backbone-min.js<div></div></li>
 <li>public/components/backbone/backbone.js<div></div></li>
 <li>public/components/backbone/component.json<div></div></li>
 <li>public/components/backbone/docs/backbone-localstorage.html<div></div></li>
 <li>public/components/backbone/docs/backbone.html<div></div></li>
 <li>public/components/backbone/docs/images/blossom.png<div></div></li>
 <li>public/components/backbone/docs/todos.html<div></div></li>
 <li>public/components/backbone/examples/backbone-localstorage.js<div></div></li>
 <li>public/components/backbone/examples/todos/index.html<div></div></li>
 <li>public/components/backbone/examples/todos/todos.js<div></div></li>
 <li>public/components/backbone/index.html<div></div></li>
 <li>public/components/backbone/package.json<div></div></li>
 <li>public/components/backbone/test/collection.js<div></div></li>
 <li>public/components/backbone/test/events.js<div></div></li>
 <li>public/components/backbone/test/index.html<div></div></li>
 <li>public/components/backbone/test/model.js<div></div></li>
 <li>public/components/backbone/test/router.js<div></div></li>
 <li>public/components/backbone/test/speed.js<div></div></li>
 <li>public/components/backbone/test/test-zepto.html<div></div></li>
 <li>public/components/backbone/test/vendor/jquery-1.7.1.js<div></div></li>
 <li>public/components/backbone/test/vendor/jquery.js<div></div></li>
 <li>public/components/backbone/test/vendor/jslitmus.js<div></div></li>
 <li>public/components/backbone/test/vendor/zepto-0.6.js<div></div></li>
 <li>public/components/backbone/test/vendor/zepto.js<div></div></li>
 <li>public/components/backbone/test/view.js<div></div></li>
 </ul><br/></div>
 </div>
 <div class=row>
 <div class=span12><p>committ stats</p></div>
 </div>
 </div>
 </div>
 <div class='row'>
 <div class='span12'>
 <h4><span class=text-info>Revision-Subject: refresh components</span></h4>
 <div class=row>
 <div class=span6><strong>Author: Ted Killilea</strong></div><div class=span6><strong>Email: lrrs259@gmail.com</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Date: Tue Jan 15 22:33:15 2013 -0500</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Description: </strong></div>
 </div>
 <div class=row>
 <div class=span12><p>STATISTICS</p></div>
 </div>
 <div class=row>
<div class=span12>
<strong>List of modified files:</strong>
<ul class=unstyled>
 <li>.c9revisions/public/components/backbone/backbone.js.c9save<div></div></li>
 <li>.c9revisions/public/components/jquery/jquery.js.c9save<div></div></li>
 <li>.c9revisions/public/components/requirejs/require.js.c9save<div></div></li>
 </ul><br/></div>
 </div>
 <div class=row>
 <div class=span12><p>committ stats</p></div>
 </div>
 </div>
 </div>
 <div class='row'>
 <div class='span12'>
 <h4><span class=text-info>Revision-Subject: update components via bower update</span></h4>
 <div class=row>
 <div class=span6><strong>Author: Ted Killilea</strong></div><div class=span6><strong>Email: lrrs259@gmail.com</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Date: Tue Jan 15 18:34:00 2013 -0500</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Description: </strong></div>
 </div>
 <div class=row>
 <div class=span12><p>STATISTICS</p></div>
 </div>
 <div class=row>
<div class=span12>
<strong>List of modified files:</strong>
<ul class=unstyled>
 <li>public/components/jquery/component.json<div></div></li>
 <li>public/components/jquery/jquery.js<div></div></li>
 <li>public/components/jquery/jquery.min.js<div></div></li>
 </ul><br/></div>
 </div>
 <div class=row>
 <div class=span12><p>committ stats</p></div>
 </div>
 </div>
 </div>
 <div class='row'>
 <div class='span12'>
 <h4><span class=text-info>Revision-Subject: Readme updates</span></h4>
 <div class=row>
 <div class=span6><strong>Author: Ted Killilea</strong></div><div class=span6><strong>Email: lrrs259@gmail.com</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Date: Mon Jan 14 22:56:54 2013 -0500</strong></div>
 </div>
 <div class=row>
 <div class=span12><strong>Description: </strong></div>
 </div>
 <div class=row>
 <div class=span12><p>STATISTICS</p></div>
 </div>
 <div class=row>
<div class=span12>
<strong>List of modified files:</strong>
<ul class=unstyled>
 <li>.c9revisions/README.md.c9save<div></div></li>
 <li>README.md<div></div></li>
 </ul><br/></div>
 </div>
 <div class=row>
 <div class=span12><p>committ stats</p></div>
 </div>
 </div>
 </div>
</div>
<script src='http://code.jquery.com/jquery.js'></script>
<script src='/components/bootstrap/docs/assets/js/bootstrap.min.js'></script>
</body>
</html>
